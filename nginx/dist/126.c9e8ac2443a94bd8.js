"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[126],{9220:(H,M,l)=>{l.d(M,{it:()=>a,Qm:()=>p,v$:()=>x,jB:()=>A,k1:()=>D,dT:()=>R,e8:()=>N,dH:()=>v,gO:()=>G,Os:()=>Z,xt:()=>u});const a=[{taxID:"9606",name:"Homo Sapiens"},{taxID:"10090",name:"Mus Musculus"},{taxID:"10116",name:"Rattus norvegicus"}],p=(new Map([["9606","Homo Sapiens"],["10090","Mus Musculus"]]),new Map([["9606","NcbiEntrezGene"],["10090","NcbiEntrezGene"]])),x=[{name:"EnsemblGene",description:"Ensembl Gene"},{name:"NcbiEntrezGene",description:"Entrez Gene"}],A=[{name:"UniprotID",description:"Uniprot Accession"},{name:"NcbiRefseqProtein",description:"NCBI Refseq Protein"}],D=[{name:"SYMBOL",description:"Gene Symbol"},{name:"NcbiEntrezGene",description:"NCBI Entrez Gene"},{name:"EnsemblGene",description:"Ensembl Gene"},{name:"UniprotID",description:"Uniprot Accession"},{name:"NcbiRefseqProtein",description:"NCBI Refseq Protein"}],R=["Mentha"],Z=["log2","log10","No Log Transformed"],N=new Map([["Expression profiling by array","limma"],["RNA-seq of coding RNA","deseq2"],["Protein profiling by Mass Spec","writtenByUs"],["Other","writtenByUs"]]),v={limma:"PROBEID",deseq2:"Gene.ID",writtenByUs:"Protein IDs"},G={deseq2:{foldChangeAttr:"log2FoldChange",rawPvalueAttr:"pvalue",adjPvalueAttr:"padj",geneIDattr:"Gene.ID"},limma:{foldChangeAttr:"logFC",rawPvalueAttr:"P.Value",adjPvalueAttr:"adj.P.Val",geneIDattr:"PROBEID"},writtenByUs:{foldChangeAttr:"log2FoldChange",rawPvalueAttr:"P-value",adjPvalueAttr:"adjusted P-Value",geneIDattr:"Protein IDs"}},u=["KEGG Pathway","REACTOME Pathway","Biological Process","Molecular Function","Cellular Component"]},9868:(H,M,l)=>{l.d(M,{h:()=>x});var a=l(4099),h=l(3668),p=l(1144);let x=(()=>{class A{constructor(D){this.router=D,this.keggPathwayFromOtherAppSubject=new a.X(null),this.geneListIDFromOtherAppSubject=new a.X(null),this.keggPathwayFromOtherApp$=this.keggPathwayFromOtherAppSubject.asObservable(),this.geneListIDFromOtherApp$=this.geneListIDFromOtherAppSubject.asObservable()}sendPathway2KeggExp(D){this.keggPathwayFromOtherAppSubject.next(D),this.router.navigate(["/KeggExp"])}sendGeneList2PPIExp(D){this.geneListIDFromOtherAppSubject.next(D),this.router.navigate(["/PPIExp"])}}return A.\u0275fac=function(D){return new(D||A)(h.LFG(p.F0))},A.\u0275prov=h.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},7499:(H,M,l)=>{l.d(M,{Oi:()=>a,sj:()=>h,Dj:()=>p});const a=function(x,A,E,D,R){if("Protein profiling by Mass Spec"===x){const w=E.split(";");let Z=[],N=[];return w.forEach(v=>{if(null==A?void 0:A.hasOwnProperty(v)){const G=A[v],u=G[R];Z.push(G[D]),N.push(u)}else Z.push(null),N.push(null)}),[Z.join(";"),N.join(";")]}if(null==A?void 0:A.hasOwnProperty(E)){const w=A[E];return[w[D],w[R]]}return[null,null]},h=function(x,A){return x+"-"+A},p=function(x,A){const E=x.samples,D=x.geneIDs,R=x.expressionValues,w=A.attributes,Z=A.genesInfoDic;let N=[];for(let v=0;v<D.length;v++){let G={};G.ID=D[v];const e=R[v];for(let u=0;u<E.length;u++)G[E[u]]=e[u];if(null==Z?void 0:Z.hasOwnProperty(D[v])){const u=Z[D[v]];for(let S=0;S<w.length;S++)G[w[S]]=u[S]}else for(let u=0;u<w.length;u++)G[w[u]]="";N.push(G)}return{features:["ID",...w].concat(E),genesInfo:N}}},2307:(H,M,l)=>{l.d(M,{H9:()=>a,pP:()=>h,Po:()=>p});const a=function(x){return x*parseFloat(getComputedStyle(document.documentElement).fontSize)*.8},h=function(x){return x*parseFloat(getComputedStyle(document.documentElement).fontSize)},p=function(x){return x*parseFloat(getComputedStyle(document.documentElement).fontSize)}},8060:(H,M,l)=>{l.r(M),l.d(M,{DiffExpModule:()=>kt});var a=l(6019),h=l(4522),p=l(9133),x=l(3063),A=l(5479),E=l(7695),D=l(9256),R=l(8638),w=l(3856),Z=l(3667),N=l(3928),v=l(8702),G=l(1144),e=l(3668),u=l(3405),S=l(4102),P=l(7089),m=l(8472),C=l(4099),k=l(2668),ee=l(2411),be=l(6813),Se=l(8526),F=l(8053),I=l(8735),T=l(9204),j=l(6636),re=l(2047),K=l(5571),de=l(5389),Te=l(877),le=l(1890),Fe=l(8970),W=l(7473),xe=l(9744),te=l(3052),fe=l(6149),ce=l(7548),Ce=l(1118),ue=l(5136),he=l(425);const me=n=>n.geneListEnrichedAnnotationsState,ge=(0,m.P1)(me,he.g$),Ge=(0,m.P1)(me,he.OR),ye=(0,m.P1)(ge,(n,f)=>n.includes(f.geneListID)),Pe=(0,m.P1)(Ge,(n,f)=>n[f.geneListID]);var we=l(661),pe=l(8425),J=l(9220);const se=function(n,f,t,s,o){const r=`${t} VS ${f}`;return"third_party_software"==(null==o?void 0:o.FCcalMethod)?[n,r,s].join("/"):[n,r,`${s}-${o.FCcalMethod}-${o.pValuCalMethod}-${o.pValueAdjMethod}`].join("/")},De=function(n,f){const t=n.groups;let s;for(let o of t)if(o.name===f){s=o.samples;break}return s};var Ze=l(8956),je=l(9232),Ne=l(7499),Re=l(7194),Me=l(726),Ve=l(8779),Le=l(9990),Je=l(9868),Ue=l(5535),qe=l(4473),Be=l(4205);let Ie=(()=>{class n extends Re.g{constructor(t,s,o,r,g,O,U,Q){super(t,Q,O,U),this.store=t,this.diffAnalysisRequestService=s,this.enrichmentService=o,this.trySamppleService=r,this.interAppsInteractService=g,this.storeDiffAnalysisResultIDs=this.store.pipe((0,m.Ys)(te.Nq),(0,S.d)()),this.storeGeneListIDsHasEnrichedAnnotations$=this.store.pipe((0,m.Ys)(ge)),this.requestGroupsOfSelectedDataset$=new C.X(null),this.datasetDiffGroupPairRequest$=new C.X(null),this.diffFilterInput$=new C.X(null),this.requestDiffGenesEnrichedAnnotations$=new C.X(null),this.oneGeneExpRequestSubject=new C.X(null),this.selectedPathwaySubject=new C.X(null),this.diffGenesPPIrequestSubject=new C.X(null),this.addDiffGenesToGeneListSubject=new C.X(null),this.requestDiffAnalysisOfRemoteDataFromServer$=new C.X(null),this.requestDiffAnalysisOfLocalDataFromServer$=new C.X(null),this.datasetIDsubject=new C.X(null),this.speciesIDsubject=new C.X(null),this.geneIDtypeSubject=new C.X(null),this.diffSoftwareSubject=new C.X(null),this.selectedDiffAnalysisResultForPresentationSubject$=new C.X(null),this.geneListEnrichedResultSubject$=new C.X(null),this.requestDiffAnalysisAllGenesDiffInfo$=new C.X(null),this.selectedDiffAnalysisResultForPresentationStatus$=this.selectedDiffAnalysisResultForPresentationSubject$.asObservable(),this.geneListEnrichedResultStatus$=this.geneListEnrichedResultSubject$.asObservable(),this.allDiffAnalysisIDsForDisplay$=this.storeDiffAnalysisResultIDs.pipe((0,F.U)(i=>(0,je.NT)(i))),this.allDatasetInfoForDisplay$=this.store.pipe((0,m.Ys)(W.yz)).pipe((0,F.U)(i=>[...i].reverse())),this.selectedDatasetGroups$=this.requestGroupsOfSelectedDataset$.pipe((0,I.h)(i=>null!==i),(0,T.w)(i=>this.store.pipe((0,m.Ys)(W.pO,{datasetID:i}),(0,j.q)(1)))),(0,k.aj)([this.datasetDiffGroupPairRequest$.pipe((0,I.h)(i=>null!=i)),this.storeDiffAnalysisResultIDs]).pipe((0,T.w)(([i,d])=>i.hasOwnProperty("id")?this._checkIfDiffAnalysisExisted(i.id).pipe((0,I.h)(c=>c),(0,F.U)(c=>i)):this.store.pipe((0,m.Ys)(W.iR,{datasetID:i.datasetID}),(0,j.q)(1),(0,F.U)(c=>{const y=J.e8.get(c.experimentType);return se(i.datasetID,i.baseGroup,i.targetGroup,y,i.diffAnalysisSettings)}),(0,T.w)(c=>this._checkIfDiffAnalysisExisted(c).pipe((0,I.h)(y=>y),(0,F.U)(y=>i))))),(0,T.w)(i=>this._obtainDiffAnalysisResult(i).pipe((0,T.w)(d=>{const c=d.speciesID+"-"+d.IDtype,y=function(n,f,t){if("Protein profiling by Mass Spec"===t){let s=[];return n[J.dH[f]].forEach(o=>{const r=o.split(";");s=s.concat(r)}),s}return n[J.dH[f]]}(d.diffResults,d.diffSoftware,d.experimentType);return this.store.pipe((0,m.Ys)(le.tw,{ID:c}),(0,j.q)(1)).pipe((0,T.w)(_=>_?this.store.pipe((0,m.Ys)(le.en,{IDtype:c,geneIDs:y}),(0,j.q)(1)):(0,ee.of)(null)),(0,F.U)(_=>Object.assign(Object.assign({},d),{genesInfo:_||null})))}))),(0,F.U)(i=>({status:"finished",statusValue:"finished",result:i}))).subscribe(this.selectedDiffAnalysisResultForPresentationSubject$),this.datasetDiffGroupPairRequest$.pipe((0,I.h)(i=>null!=i),(0,T.w)(i=>i.hasOwnProperty("id")?this._checkIfDiffAnalysisExisted(i.id).pipe((0,I.h)(d=>!d),(0,F.U)(d=>i)):this.store.pipe((0,m.Ys)(W.iR,{datasetID:i.datasetID}),(0,j.q)(1),(0,F.U)(d=>{const y=J.e8.get(d.experimentType);return se(i.datasetID,i.baseGroup,i.targetGroup,y,i.diffAnalysisSettings)}),(0,T.w)(d=>this._checkIfDiffAnalysisExisted(d).pipe((0,I.h)(c=>!c),(0,F.U)(c=>i))))),(0,T.w)(i=>{const d=i.datasetID,c=i.baseGroup,y=i.targetGroup;return this.store.pipe((0,m.Ys)(W.iR,{datasetID:d}),(0,F.U)(_=>{const b=_.expressLocalOrRemote,$=_.experimentType,B=_.IDtype,Y=_.speciesID,L=De(_,c),q=De(_,y);return{datasetID:d,localOrRemote:b,experimentType:$,IDtype:B,speciesID:Y,baseGroup:c,targetGroup:y,baseSamples:L,targetSamples:q,diffAnalysisSettings:i.diffAnalysisSettings}}))})).subscribe(i=>{const d={datasetID:i.datasetID,experimentType:i.experimentType,IDtype:i.IDtype,speciesID:i.speciesID,baseGroup:i.baseGroup,targetGroup:i.targetGroup,baseSamples:i.baseSamples,targetSamples:i.targetSamples,diffAnalysisSettings:i.diffAnalysisSettings};this.selectedDiffAnalysisResultForPresentationSubject$.next({status:"loading",statusValue:"Wait for a moment. The app is requesting differential analysis results from the server"}),i.localOrRemote===Te.M.local?this.requestDiffAnalysisOfLocalDataFromServer$.next(d):this.requestDiffAnalysisOfRemoteDataFromServer$.next(d)}),this.requestDiffAnalysisOfLocalDataFromServer$.pipe((0,I.h)(i=>null!=i),(0,T.w)(i=>{const d=i.datasetID,c=i.experimentType,y=i.speciesID,_=i.IDtype,b=i.baseSamples,$=i.targetSamples,B=i.targetGroup,Y=i.baseGroup,L=J.e8.get(c),q=b.concat($);return this.store.pipe((0,m.Ys)(ce.ZM,{datasetID:d}),(0,j.q)(1)).pipe((0,T.w)(V=>{const oe=V.genes,ae=(0,Ze.l)(V.values,V.samples,q);return"Expression profiling by array"===c?this.diffAnalysisRequestService.requestLocalArrayDiffAnalysisOneGroupPair({valuesDic:ae,genes:oe,baseSamples:b,targetSamples:$,experimentType:c,diffSoftware:L,diffAnalysisSettings:i.diffAnalysisSettings,annoLibrary:_+".db"}):"RNA-seq of coding RNA"===c?this.diffAnalysisRequestService.requestLocalSeqDiffAnalysisOneGroupPair({valuesDic:ae,genes:oe,baseSamples:b,targetSamples:$,experimentType:c,diffSoftware:L,diffAnalysisSettings:i.diffAnalysisSettings}):"Protein profiling by Mass Spec"===c||"Other"===c?this.diffAnalysisRequestService.requestLocalProteomicsDiffAnalysisOneGroupPair({valuesDic:ae,genes:oe,baseSamples:b,targetSamples:$,experimentType:c,diffSoftware:L,diffAnalysisSettings:i.diffAnalysisSettings}):void 0}),(0,F.U)(V=>{const X=V.diffResults;return{id:se(d,Y,B,L,i.diffAnalysisSettings),datasetID:d,baseGroup:Y,targetGroup:B,diffSoftware:L,experimentType:c,IDtype:_,speciesID:y,diffResults:X}}),(0,re.K)(V=>(0,ee.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${V.status}, errorText:${V.statusText}`})))})).subscribe(i=>{i.hasOwnProperty("status")?this.selectedDiffAnalysisResultForPresentationSubject$.next(i):this.store.dispatch(fe.zc({diffAnalysisResultInfo:i}))}),this.requestDiffAnalysisOfRemoteDataFromServer$.pipe((0,I.h)(i=>null!=i),(0,T.w)(i=>{const d=i.datasetID,c=i.experimentType,y=i.speciesID,_=i.IDtype,b=i.baseSamples,$=i.targetSamples,B=i.baseGroup,Y=i.targetGroup,L=J.e8.get(c);return this.store.pipe((0,m.Ys)(W.iR,{datasetID:d}),(0,j.q)(1)).pipe((0,T.w)(q=>this.diffAnalysisRequestService.requestRemoteDatasetDiffAnalysisOneGroupPair({database:q.database,datasetID:d,experimentType:c,IDtype:_,baseSamples:b,targetSamples:$,diffSoftware:L})),(0,F.U)(q=>{const V=q.diffResults;return{id:se(d,B,Y,L,i.diffAnalysisSettings),datasetID:d,baseGroup:B,targetGroup:Y,diffSoftware:L,experimentType:c,IDtype:_,speciesID:y,diffResults:V}}),(0,re.K)(q=>(0,ee.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${q.status}, errorText:${q.statusText}`})))})).subscribe(i=>{i.hasOwnProperty("status")?this.selectedDiffAnalysisResultForPresentationSubject$.next(i):this.store.dispatch(fe.zc({diffAnalysisResultInfo:i}))}),this.datasetDiffGroupPairRequest$.pipe((0,I.h)(i=>null!=i),(0,F.U)(i=>i.hasOwnProperty("datasetID")?i.datasetID:i.id.split("/")[0]),(0,T.w)(i=>this.store.pipe((0,m.Ys)(W.iR,{datasetID:i}),(0,j.q)(1)))).subscribe(i=>{this.datasetIDsubject.next(i.datasetID),this.speciesIDsubject.next(i.speciesID),this.diffSoftwareSubject.next(J.e8.get(i.experimentType)),this.geneIDtypeSubject.next(i.IDtype)}),this.requestDiffGenesEnrichedAnnotations$.pipe((0,I.h)(i=>null!=i),(0,K.M)(this.speciesIDsubject,this.geneIDtypeSubject),(0,T.w)(([i,d,c])=>{const y={genes:i.genes,backgroundGenes:i.backgroundGenes,speciesID:d,geneIDtype:c};return this._obtainGeneListIDofDiffGenesForRequest(i.diffType).pipe((0,T.w)(_=>this.store.pipe((0,m.Ys)(ye,{geneListID:_}),(0,I.h)(b=>!b),(0,T.w)(b=>this.enrichmentService.requestGenesEnrichedAnnotations(y).pipe((0,F.U)($=>({geneListID:_,geneIDtype:c,speciesID:d,enrichedAnnotations:$})),(0,re.K)($=>(0,ee.of)({status:"error",statusValue:`Error occured while requesting enriched annoations. error:${$.status}, errorText:${$.statusText}`})))))))})).subscribe(i=>{i.hasOwnProperty("status")?this.geneListEnrichedResultSubject$.next(i):this.store.dispatch(ue.w({geneListEnrichedAnnotations:i}))}),(0,k.aj)([this.requestDiffGenesEnrichedAnnotations$.pipe((0,I.h)(i=>null!=i)),this.storeGeneListIDsHasEnrichedAnnotations$]).pipe((0,F.U)(([i,d])=>i),(0,T.w)(i=>this._obtainGeneListIDofDiffGenesForRequest(i.diffType)),(0,T.w)(i=>this.store.pipe((0,m.Ys)(ye,{geneListID:i}),(0,I.h)(d=>d),(0,F.U)(d=>i))),(0,T.w)(i=>this.store.pipe((0,m.Ys)(Pe,{geneListID:i})))).subscribe(i=>{this.geneListEnrichedResultSubject$.next({status:"finished",statusValue:"finished",result:i})}),this.selectedGeneExpForBoxPlot$=this.oneGeneExpRequestSubject.pipe((0,I.h)(i=>null!=i),(0,K.M)(this.datasetIDsubject,this.geneIDtypeSubject,this.speciesIDsubject,this.diffSoftwareSubject,this.selectedDiffAnalysisResultForPresentationStatus$),(0,T.w)(([i,d,c,y,_,b])=>{const $=(0,Ne.sj)(y,c),B=this.store.pipe((0,m.Ys)(le.ek,{IDtype:$,geneID:i}),(0,j.q)(1)),Y=this.store.pipe((0,m.Ys)(W.pO,{datasetID:d}),(0,j.q)(1)),L=this.store.pipe((0,m.Ys)(ce.l,{datasetID:d,geneIDs:[i]}),(0,j.q)(1)),q=(0,P.Y6)(b.result.diffResults,_,"rawPvalue",i);return(0,be.D)([B,Y,L]).pipe((0,F.U)(([V,X,ie])=>{const oe=ie.expressionValues[0],ae=ie.samples;return{geneInfo:V,groupsExpInfo:X.map(Ae=>{const ts=Ae.samples.map(ve=>({sampleName:ve,value:oe[ae.indexOf(ve)]}));return{groupName:Ae.name,samplesExpInfo:ts}}),groupPairsPvalue:[{baseGroup:b.result.baseGroup,targetGroup:b.result.targetGroup,pValue:q.pValue}]}}))})),this.selectedPathwaySubject.pipe((0,I.h)(Boolean),(0,K.M)(this.speciesIDsubject)).subscribe(([i,d])=>{this.interAppsInteractService.sendPathway2KeggExp({speciesID:d,pathwayID:i})}),(0,Se.T)(this.diffGenesPPIrequestSubject,this.addDiffGenesToGeneListSubject).pipe((0,I.h)(i=>null!=i),(0,K.M)(this.speciesIDsubject,this.geneIDtypeSubject),(0,T.w)(([i,d,c])=>{const y=i.genes;return this._obtainGeneListIDofDiffGenesForRequest(i.diffType).pipe((0,F.U)(_=>({name:_,speciesID:d,IDtype:c,genes:y})))}),(0,T.w)(i=>this.store.pipe((0,m.Ys)(pe.Ef,{geneListID:i.name}),(0,j.q)(1),(0,I.h)(d=>!d),(0,F.U)(d=>i)))).subscribe(i=>{this.store.dispatch(we.J({geneList:i}))}),(0,k.aj)([this.store.pipe((0,m.Ys)(pe.Dm)),this.diffGenesPPIrequestSubject.pipe((0,I.h)(i=>null!=i))]).pipe((0,T.w)(([i,d])=>this._obtainGeneListIDofDiffGenesForRequest(d.diffType).pipe((0,T.w)(c=>this.store.pipe((0,m.Ys)(pe.Ef,{geneListID:c}),(0,j.q)(1),(0,I.h)(y=>y),(0,F.U)(y=>c))))),(0,de.x)()).subscribe(i=>{this.interAppsInteractService.sendGeneList2PPIExp(i)}),this.trySamppleService.trySampleData$.pipe((0,I.h)(Boolean)).subscribe(i=>{this.store.dispatch(xe.CF({newState:i.datasetListState})),this.store.dispatch(Ce.gw({newState:i.localExpressDataState})),this.store.dispatch(fe.Uw({newState:i.diffAnalysisResultState})),this.store.dispatch(Fe.A({newState:i.geneAnnotationsState})),this.store.dispatch(ue.V({newState:i.geneListEnrichedAnnotationsState}))}),this.trySamplePercentage$=this.trySamppleService.trySamplePercentage$}_obtainDiffAnalysisResult(t){return t.hasOwnProperty("id")?this.store.pipe((0,m.Ys)(te.bc,{ID:t.id}),(0,j.q)(1)):this.store.pipe((0,m.Ys)(te.H5,{datasetID:t.datasetID,baseGroup:t.baseGroup,targetGroup:t.targetGroup}),(0,I.h)(s=>s),(0,T.w)(s=>this.store.pipe((0,m.Ys)(te.fh,{datasetID:t.datasetID,baseGroup:t.baseGroup,targetGroup:t.targetGroup}),(0,j.q)(1))))}_checkIfDiffAnalysisExisted(t){return this.store.pipe((0,m.Ys)(te.N8,{ID:t}),(0,j.q)(1))}_obtainGeneListIDofDiffGenesForRequest(t){return(0,ee.of)(t).pipe((0,K.M)(this.datasetDiffGroupPairRequest$,this.diffFilterInput$,this.diffSoftwareSubject),(0,F.U)(([s,o,r,g])=>function(n,f,t,s){const o=t.pValueType,r=t.pValue,g=t.foldChangeType,O=t.foldChange;if(n.hasOwnProperty("id"))return`${n.id}/${g}-${O}-${o}-${r}/${s}`;{const d=t.pValueType,c=t.pValue,y=t.foldChangeType,_=t.foldChange;return`${se(n.datasetID,n.baseGroup,n.targetGroup,f,n.diffAnalysisSettings)}/${y}-${_}-${d}-${c}/${s}`}}(o,g,r,s)),(0,j.q)(1))}requestSelectedDatasetGroups(t){this.requestGroupsOfSelectedDataset$.next(t)}requestDatasetGroupPairDiffAnalysis(t){this.datasetDiffGroupPairRequest$.next(t)}storeDiffFilterInput(t){this.diffFilterInput$.next(t)}requestDiffGenesEnrichedAnnotations(t){this.requestDiffGenesEnrichedAnnotations$.next(t)}requestOneGeneExpressionForBoxplot(t){this.oneGeneExpRequestSubject.next(t)}visDiffGenesPPIs(t){this.diffGenesPPIrequestSubject.next(t)}addDiffGenesToGeneList(t){this.addDiffGenesToGeneListSubject.next(t)}prepareTrySampleData(t){this.trySamppleService.requestTrySampleData(t)}processSelectedKEGGpathway(t){this.selectedPathwaySubject.next(t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(m.yh),e.LFG(Me.h),e.LFG(Ve.g),e.LFG(Le.v),e.LFG(Je.h),e.LFG(Ue.f),e.LFG(qe.h),e.LFG(Be.b))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Qe=l(6087),_e=l(1125),ne=l(8805);function Ye(n,f){if(1&n&&(e.TgZ(0,"option",6),e._uU(1),e.qZA()),2&n){const t=f.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij("",t.name," ")}}function We(n,f){if(1&n&&(e.TgZ(0,"option",6),e._uU(1),e.qZA()),2&n){const t=f.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function He(n,f){1&n&&(e.TgZ(0,"label",7),e._uU(1,"Experiment group should not equal control group "),e.qZA())}const Ke=n=>{const f=n.get("baseGroup"),t=n.get("targetGroup");return f.value&&f&&t&&f.value===t.value?{identityRevealed:!0}:null};let ze=(()=>{class n{constructor(t){this.ele=t,this.formWidth=15,this.diffGroupPair$=new e.vpe,this.destroyNotifier$=new u.xQ}ngOnInit(){this.groupPairForm=new p.cw({baseGroup:new p.NI("",[p.kI.required,p.kI.minLength(1)]),targetGroup:new p.NI("",[p.kI.required,p.kI.minLength(1)])},{validators:Ke}),this.groupPairForm.valueChanges.pipe((0,ne.R)(this.destroyNotifier$)).subscribe(t=>{var s;"VALID"===(null===(s=this.groupPairForm)||void 0===s?void 0:s.status)?this.diffGroupPair$.next(t):this.diffGroupPair$.next(null)})}ngAfterViewInit(){}ngOnChanges(t){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-generate-diff-grouppair"]],inputs:{datasetGroups:"datasetGroups",formWidth:"formWidth"},outputs:{diffGroupPair$:"diffGroupPair$"},features:[e.TTD],decls:13,vars:4,consts:[[3,"formGroup"],[1,"align-self-start"],["formControlName","baseGroup",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["formControlName","targetGroup",1,"form-control","form-control-sm"],["class","text-danger font-weight-light",4,"ngIf"],[3,"value"],[1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"form",0),e.TgZ(2,"div",1),e.TgZ(3,"h5"),e._uU(4,"Control Group:"),e.qZA(),e.TgZ(5,"select",2),e.YNc(6,Ye,2,2,"option",3),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"h5"),e._uU(9,"Experiment Group:"),e.qZA(),e.TgZ(10,"select",4),e.YNc(11,We,2,2,"option",3),e.qZA(),e.YNc(12,He,2,0,"label",5),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",s.groupPairForm),e.xp6(5),e.Q6J("ngForOf",s.datasetGroups),e.xp6(5),e.Q6J("ngForOf",s.datasetGroups),e.xp6(1),e.Q6J("ngIf",null==s.groupPairForm.errors?null:s.groupPairForm.errors.identityRevealed))},directives:[p._Y,p.JL,p.sg,p.EJ,p.JJ,p.u,a.sg,a.O5,p.YN,p.Kr],styles:[""],changeDetection:0}),n})();var Xe=l(1026),ke=l(438);let et=(()=>{class n{constructor(){this.diffAnalysisInfo$=new e.vpe,this.foldChangeCalculationMethods=[{name:"mean",description:"Mean(Exp)/Mean(Ctrl)"},{name:"median",description:"Median(Exp)/Median(Ctrl)"}],this.differentialStatisticMethod=[{name:"ranksums",description:"Wilcoxon Rank Sum Test"},{name:"welch-t",description:"Welch-t Test"},{name:"student-t",description:"Student-t Test"}],this.pValueCorrectionMethods=[{name:"fdr_bh",description:"FDR-BH"},{name:"bonferroni",description:"Bonferroni"},{name:"holm-sidak",description:"Holm-Sidak"}],this.foldChangeCalMethodSubject=new C.X(null),this.pValueCalMethodSubject=new C.X(null),this.pValueAdjMethodSubject=new C.X(null),this.destroyNotifier$=new u.xQ}ngOnInit(){(0,k.aj)([this.foldChangeCalMethodSubject.pipe((0,I.h)(t=>null!=t)),this.pValueCalMethodSubject.pipe((0,I.h)(t=>null!=t)),this.pValueAdjMethodSubject.pipe((0,I.h)(t=>null!=t))]).pipe((0,F.U)(([t,s,o])=>({FCcalMethod:t,pValuCalMethod:s,pValueAdjMethod:o}))).subscribe(t=>{this.diffAnalysisInfo$.next(t)})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processFoldChangeCalculationMethod(t){this.foldChangeCalMethodSubject.next(t.name)}processPvalueCalculationMethod(t){this.pValueCalMethodSubject.next(t.name)}processPvalueAdjustMethod(t){this.pValueAdjMethodSubject.next(t.name)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-proteomics-diff-analysis-settings"]],inputs:{formWidth:"formWidth"},outputs:{diffAnalysisInfo$:"diffAnalysisInfo$"},decls:3,vars:22,consts:[["data-testid","foldChangeMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","ifWidthAuto","formWidth","selectedItemObject$"],["data-testid","pValueMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","ifWidthAuto","selectedItemObject$"],["data-testid","pValueAdjMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","ifWidthAuto","selectedItemObject$"]],template:function(t,s){1&t&&(e.TgZ(0,"app-select-item-object",0),e.NdJ("selectedItemObject$",function(r){return s.processFoldChangeCalculationMethod(r)}),e.qZA(),e.TgZ(1,"app-select-item-object",1),e.NdJ("selectedItemObject$",function(r){return s.processPvalueCalculationMethod(r)}),e.qZA(),e.TgZ(2,"app-select-item-object",2),e.NdJ("selectedItemObject$",function(r){return s.processPvalueAdjustMethod(r)}),e.qZA()),2&t&&(e.Q6J("inputObjects",s.foldChangeCalculationMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","Method for Calculating Fold Change")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("ifWidthAuto",!0)("formWidth",s.formWidth),e.xp6(1),e.Q6J("inputObjects",s.differentialStatisticMethod)("idAttribute","name")("displayAttribute","description")("itemLabel","Differential Statistics Method")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("ifWidthAuto",!0),e.xp6(1),e.Q6J("inputObjects",s.pValueCorrectionMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","P vaule Adjust Method")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("ifWidthAuto",!0))},directives:[ke.w],styles:[""],changeDetection:0}),n})();const tt=["submitButton"];function st(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"app-select-dataset",7),e.NdJ("selectedDatasetID$",function(o){return e.CHM(t),e.oxw().processSelectedDataset(o)}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("allDatasetInfoForDisplay",t.allDatasetInfoForDisplay)("formInlineOrNot",!1)}}function nt(n,f){1&n&&(e.TgZ(0,"p"),e._uU(1,"Please import a Expression Profile data first. "),e.TgZ(2,"a",8),e._uU(3,"Import Data"),e.qZA(),e.qZA())}function it(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"app-proteomics-diff-analysis-settings",9),e.NdJ("diffAnalysisInfo$",function(o){return e.CHM(t),e.oxw().processProteomicsDiffAnalysisSettings(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("formWidth",t.formWidth)}}let ot=(()=>{class n{constructor(t,s){this.ele=t,this.cdr=s,this.selectedDatasetID$=new e.vpe,this.diffGroupPairRequest$=new e.vpe,this.formWidth=50,this.selectedDatasetExperimentType="RNA-seq of coding RNA",this._selectedDatasetID$=new C.X(null),this._diffGroupPair$=new C.X(null),this._diffAnalysisSettings$=new C.X(null),this.destroyNotifier$=new u.xQ}ngOnInit(){}ngAfterViewInit(){this._generateFormWidth(),this.submitStream$=(0,Qe.R)(this.submitButton.nativeElement,"click"),this.ifSubmitAvailable$=(0,k.aj)([this._selectedDatasetID$,this._diffGroupPair$,this._diffAnalysisSettings$]).pipe((0,F.U)(([t,s,o])=>!!(t&&s&&o)),(0,_e.O)(!1),(0,ne.R)(this.destroyNotifier$)),this.submitStream$.pipe((0,ne.R)(this.destroyNotifier$),(0,I.h)(t=>null!=t),(0,K.M)(this._selectedDatasetID$.pipe((0,I.h)(t=>null!==t),(0,ne.R)(this.destroyNotifier$)),this._diffGroupPair$.pipe((0,I.h)(t=>null!=t)),this._diffAnalysisSettings$.pipe((0,I.h)(t=>null!=t)))).subscribe(([t,s,o,r])=>{this.diffGroupPairRequest$.next({datasetID:s,targetGroup:o.targetGroup,baseGroup:o.baseGroup,diffAnalysisSettings:r}),this.cdr.detectChanges()})}ngOnChanges(t){t.allDatasetInfoForDisplay&&(this.allDatasetInfoForDisplay=[...this.allDatasetInfoForDisplay])}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedDataset(t){this._selectedDatasetID$.next(t),this.selectedDatasetID$.next(t),this.selectedDatasetExperimentType=this._obtainExprimentType(t),"Protein profiling by Mass Spec"!==this.selectedDatasetExperimentType&&this._diffAnalysisSettings$.next({FCcalMethod:"third_party_software",pValuCalMethod:"third_party_software",pValueAdjMethod:"third_party_software"})}processDiffGroupPair(t){this._diffGroupPair$.next(t),this.cdr.detectChanges()}processProteomicsDiffAnalysisSettings(t){this._diffAnalysisSettings$.next(t),this.cdr.detectChanges()}_obtainExprimentType(t){let s;for(let o of this.allDatasetInfoForDisplay)if(o.datasetID===t){s=o.experimentType;break}return s}_generateFormWidth(){this.formWidth=this.ele.nativeElement.offsetWidth-5,this.cdr.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-generate-diff-analysis"]],viewQuery:function(t,s){if(1&t&&e.Gf(tt,5),2&t){let o;e.iGM(o=e.CRH())&&(s.submitButton=o.first)}},inputs:{allDatasetInfoForDisplay:"allDatasetInfoForDisplay",datasetGroups:"datasetGroups"},outputs:{selectedDatasetID$:"selectedDatasetID$",diffGroupPairRequest$:"diffGroupPairRequest$"},features:[e.TTD],decls:12,vars:8,consts:[[1,"mt-4"],[4,"ngIf","ngIfElse"],["importDataNote",""],[3,"datasetGroups","formWidth","diffGroupPair$"],[3,"formWidth","diffAnalysisInfo$",4,"ngIf"],["data-testid","submitDiffAnalysis",1,"mt-3","btn","btn-expressvis",3,"disabled"],["submitButton",""],[3,"allDatasetInfoForDisplay","formInlineOrNot","selectedDatasetID$"],["routerLink","/importData"],[3,"formWidth","diffAnalysisInfo$"]],template:function(t,s){if(1&t&&(e.TgZ(0,"h5",0),e._uU(1," Generate a Differential Analysis\n"),e.qZA(),e.TgZ(2,"div"),e.YNc(3,st,2,2,"div",1),e.YNc(4,nt,4,0,"ng-template",null,2,e.W1O),e.TgZ(6,"app-generate-diff-grouppair",3),e.NdJ("diffGroupPair$",function(r){return s.processDiffGroupPair(r)}),e.qZA(),e.YNc(7,it,1,1,"app-proteomics-diff-analysis-settings",4),e.TgZ(8,"button",5,6),e.ALo(10,"async"),e._uU(11," Submit "),e.qZA(),e.qZA()),2&t){const o=e.MAs(5);e.xp6(3),e.Q6J("ngIf",(null==s.allDatasetInfoForDisplay?null:s.allDatasetInfoForDisplay.length)>0)("ngIfElse",o),e.xp6(3),e.Q6J("datasetGroups",s.datasetGroups)("formWidth",s.formWidth),e.xp6(1),e.Q6J("ngIf","Protein profiling by Mass Spec"===s.selectedDatasetExperimentType||"Other"===s.selectedDatasetExperimentType),e.xp6(1),e.Q6J("disabled",!e.lcZ(10,6,s.ifSubmitAvailable$))}},directives:[a.O5,ze,Xe.z,G.yS,et],pipes:[a.Ov],styles:[""],changeDetection:0}),n})();function at(n,f){if(1&n&&(e.TgZ(0,"option",4),e._uU(1),e.qZA()),2&n){const t=f.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function rt(n,f){1&n&&(e.TgZ(0,"label",5),e._uU(1,"Please Generate or Load a Differential Analysis First "),e.qZA())}let lt=(()=>{class n{constructor(t){this.cdr=t,this.selectedDiffAnalysisId$=new e.vpe,this.destroyNotifier$=new u.xQ,this.diffAnalysisForm=new p.cw({diffAnalysisID:new p.NI("",p.kI.required)})}ngOnInit(){this.diffAnalysisForm.get("diffAnalysisID").valueChanges.pipe((0,ne.R)(this.destroyNotifier$)).subscribe(t=>{var s;"VALID"===(null===(s=this.diffAnalysisForm.get("diffAnalysisID"))||void 0===s?void 0:s.status)&&(this.selectedDiffAnalysisId$.next(t),this.cdr.detectChanges())}),this.allDiffAnalysisIds&&this.allDiffAnalysisIds.length>=1&&this.diffAnalysisForm.patchValue({diffAnalysisID:this.allDiffAnalysisIds[this.allDiffAnalysisIds.length-1]})}ngAfterViewInit(){}ngOnChanges(t){t.allDiffAnalysisIds&&!t.allDiffAnalysisIds.isFirstChange()&&this.allDiffAnalysisIds&&this.allDiffAnalysisIds.length>=1&&this.diffAnalysisForm.patchValue({diffAnalysisID:this.allDiffAnalysisIds[this.allDiffAnalysisIds.length-1]})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-select-diff-analysis"]],inputs:{allDiffAnalysisIds:"allDiffAnalysisIds"},outputs:{selectedDiffAnalysisId$:"selectedDiffAnalysisId$"},features:[e.TTD],decls:6,vars:3,consts:[[1,"form-inline",3,"formGroup"],["formControlName","diffAnalysisID","placeholder","Select a Differential Analysis",1,"form-control","form-control-sm","form-inline"],[3,"value",4,"ngFor","ngForOf"],["data-testid","diffAlert","class","text-danger font-weight-light",4,"ngIf"],[3,"value"],["data-testid","diffAlert",1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"h5"),e._uU(2,"Available Differential Analysis:"),e.qZA(),e.TgZ(3,"select",1),e.YNc(4,at,2,2,"option",2),e.qZA(),e.YNc(5,rt,2,0,"label",3),e.qZA()),2&t&&(e.Q6J("formGroup",s.diffAnalysisForm),e.xp6(4),e.Q6J("ngForOf",s.allDiffAnalysisIds),e.xp6(1),e.Q6J("ngIf",!(s.allDiffAnalysisIds&&s.allDiffAnalysisIds.length>0)))},directives:[p._Y,p.JL,p.sg,p.EJ,p.JJ,p.u,a.sg,a.O5,p.YN,p.Kr],styles:[""],changeDetection:0}),n})();var ft=l(9918),pt=l(5686);function dt(n,f){1&n&&(e.TgZ(0,"label",11),e._uU(1," P value should be between 0 and 1 "),e.qZA())}function ct(n,f){1&n&&(e.TgZ(0,"label",11),e._uU(1," Raw fold change should be up 1 "),e.qZA())}function ut(n,f){1&n&&(e.TgZ(0,"label",11),e._uU(1," Log2 fold change should be up 0 "),e.qZA())}const ht=function(n){return{"form-inline":n}},mt=function(n){let f=n.get("foldChangeType").value,t=n.get("foldChange").value;return"rawFoldChange"===f?t>=1?null:{foldChangeValid:!0}:t>=0?null:{foldChangeValid:!0}};let gt=(()=>{class n{constructor(){this.formInlineOrNot=!0,this.diffFilterInfo$=new e.vpe,this.diffFilterInfoForm=new p.cw({pValueType:new p.NI("rawPvalue",p.kI.required),pValue:new p.NI(.01,[p.kI.required,p.kI.min(0),p.kI.max(1)]),foldChangeType:new p.NI("rawFoldChange"),foldChange:new p.NI(2,[p.kI.required,p.kI.min(0)])},{validators:mt}),this._defaultDiffFilterInput={pValueType:"rawPvalue",pValue:.01,foldChangeType:"rawFoldChange",foldChange:2}}ngOnInit(){this.diffFilterInfoForm.get("foldChangeType").valueChanges.subscribe(t=>{"rawFoldChange"===t?this.diffFilterInfoForm.get("foldChange").setValue(2):this.diffFilterInfoForm.get("foldChange").setValue(1)}),this.diffFilterInfoForm.get("pValueType").valueChanges.subscribe(t=>{"rawPvalue"===t?this.diffFilterInfoForm.get("pValue").setValue(.01):this.diffFilterInfoForm.get("pValue").setValue(.05)}),this.diffFilterInfoForm.valueChanges.pipe((0,pt.b)(500),(0,de.x)(),(0,_e.O)(this._defaultDiffFilterInput)).subscribe(t=>{var s;"VALID"===(null===(s=this.diffFilterInfoForm)||void 0===s?void 0:s.status)&&this.diffFilterInfo$.next(t)})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-input-diff-filter-info"]],inputs:{formInlineOrNot:"formInlineOrNot"},outputs:{diffFilterInfo$:"diffFilterInfo$"},decls:24,vars:7,consts:[[3,"formGroup","ngClass"],[1,"mr-3","align-self-start"],["formControlName","pValueType",1,"form-control","form-control-sm"],["value","rawPvalue"],["value","adjPvalue"],["type","number","formControlName","pValue","required","",1,"form-control","form-control-sm",2,"width","5em"],["class","text-danger font-weight-light",4,"ngIf"],["formControlName","foldChangeType",1,"form-control","form-control-sm"],["value","rawFoldChange"],["value","log2FoldChange"],["type","number","formControlName","foldChange",1,"form-control","form-control-sm",2,"width","5em"],[1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e._uU(2," P value Type: "),e.TgZ(3,"select",2),e.TgZ(4,"option",3),e._uU(5,"Raw P-value"),e.qZA(),e.TgZ(6,"option",4),e._uU(7,"adjusted P-value"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",1),e._uU(9," P value: "),e._UZ(10,"input",5),e.YNc(11,dt,2,0,"label",6),e.qZA(),e.TgZ(12,"div",1),e._uU(13," Fold Change Type: "),e.TgZ(14,"select",7),e.TgZ(15,"option",8),e._uU(16,"Raw Fold Change"),e.qZA(),e.TgZ(17,"option",9),e._uU(18,"Log2 Fold Change"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",1),e._uU(20," Fold Change: "),e._UZ(21,"input",10),e.YNc(22,ct,2,0,"label",6),e.YNc(23,ut,2,0,"label",6),e.qZA(),e.qZA()),2&t&&(e.Q6J("formGroup",s.diffFilterInfoForm)("ngClass",e.VKq(5,ht,s.formInlineOrNot)),e.xp6(11),e.Q6J("ngIf",s.diffFilterInfoForm.get("pValue").invalid),e.xp6(11),e.Q6J("ngIf",(null==s.diffFilterInfoForm.errors?null:s.diffFilterInfoForm.errors.foldChangeValid)&&"rawFoldChange"===s.diffFilterInfoForm.get("foldChangeType").value),e.xp6(1),e.Q6J("ngIf",(null==s.diffFilterInfoForm.errors?null:s.diffFilterInfoForm.errors.foldChangeValid)&&"log2FoldChange"===s.diffFilterInfoForm.get("foldChangeType").value))},directives:[p._Y,p.JL,p.sg,a.mk,p.EJ,p.JJ,p.u,p.YN,p.Kr,p.wV,p.Fj,p.Q7,a.O5],styles:[""],changeDetection:0}),n})();var z=l(5043);const Dt=function(n,f,t,s){if("Protein profiling by Mass Spec"===n){const o=t.split(";");let r=[];return o.forEach(g=>{(null==f?void 0:f.hasOwnProperty(g))?r.push(f[g][s]):r.push(null)}),r.join(";")}return(null==f?void 0:f.hasOwnProperty(t))?f[t][s]:null};var _t=l(5863),At=l(8908);const vt={grid:{show:!0,borderWidth:1,borderColor:"black",bottom:100,left:100,right:50},xAxis:{name:"Log2(Fold Change)",nameLocation:"center",nameGap:30,splitLine:{show:!1},nameTextStyle:{fontSize:20}},yAxis:{name:"-Log10(Pvalue)",nameLocation:"middle",nameGap:30,nameTextStyle:{fontSize:20},splitLine:{show:!1}},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"empty"},{type:"slider",yAxisIndex:0,filterMode:"empty"},{type:"inside",xAxisIndex:0,filterMode:"empty"},{type:"inside",yAxisIndex:0,filterMode:"empty"}],series:[]};var bt=l(5636);const St=["canvasContainer"];let Tt=(()=>{class n{constructor(t){this.cdr=t,this.faDownload=z.q7m,this.faFilePdf=z.gSj,this.idIndex=0,this.nameIndex=1,this.foldChangeIndex=2,this.pValueIndex=3,this.initOpts={width:400,height:450},this.options=vt}ngOnInit(){}ngOnViewInit(){var t,s;this.circlesInfo&&this._setScattersPointsInfo(),this.diffFilterCutoff&&this._setMarkerLinesInfo(),this.basicSetting&&(this.initOpts={width:null===(t=this.basicSetting)||void 0===t?void 0:t.width,height:null===(s=this.basicSetting)||void 0===s?void 0:s.height})}ngOnChanges(t){var s,o,r,g,O;t.circlesInfo&&this.circlesInfo&&(this._setScattersPointsInfo(),this._setMarkerLinesInfo(),null===(s=this.echart)||void 0===s||s.setOption(this.options)),t.diffFilterCutoff&&!t.diffFilterCutoff.isFirstChange()&&(this._setScattersPointsInfo(),this._setMarkerLinesInfo(),null===(o=this.echart)||void 0===o||o.setOption(this.options)),t.basicSetting&&!t.basicSetting.isFirstChange()&&(this.initOpts={width:null===(r=this.basicSetting)||void 0===r?void 0:r.width,height:null===(g=this.basicSetting)||void 0===g?void 0:g.height},this._setScattersPointsInfo(),this._setMarkerLinesInfo(),null===(O=this.echart)||void 0===O||O.resize(this.initOpts))}onChartInit(t){this.echart=t}_setScattersPointsInfo(){let t=this.circlesInfo.map(s=>{const o=s[this.foldChangeIndex],r=s[this.pValueIndex];return{value:[o,r],name:s[this.idIndex],symbol:s[this.nameIndex],itemStyle:{color:this._determineColor(o,r,this.diffFilterCutoff.foldChangeCutoff,this.diffFilterCutoff.pValueCutoff)}}});this.options=Object.assign(Object.assign({},this.options),{series:{data:t,type:"scatter",symbolSize:5,animation:!0,tooltip:{formatter:function(s){return"ID:"+s.name+"<br>Symbol:"+s.data.symbol+"<br>log2 Fold Change:"+s.value[0]+"<br>-log10 P value:"+s.value[1]},position:"right"}},tooltip:{formatter:function(s){return""}}})}_setMarkerLinesInfo(){this.options=Object.assign(Object.assign({},this.options),{series:Object.assign(Object.assign({},this.options.series),{markLine:{symbol:"none",lineStyle:{color:"grey",width:1,type:"dashed"},data:[{xAxis:this.diffFilterCutoff.foldChangeCutoff},{xAxis:-this.diffFilterCutoff.foldChangeCutoff},{yAxis:this.diffFilterCutoff.pValueCutoff}]}})})}_determineColor(t,s,o,r){return t>=o&&s>=r?"red":t<=-o&&s>=r?"green":"grey"}downloadPlot(t){const s=document.createElement("a");s.download="diff-analysis-volcanoplot.png",s.href=this.echart.getDataURL(),s.click(),s.remove()}downloadPlotAsPDF(t){const s=new At.kH({unit:"px"});s.addImage(this.echart.getDataURL(),"png",0,0,this.initOpts.width,this.initOpts.height),s.save("diff-analysis-volcanoplot.pdf")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-echarts-volcano-plot"]],viewQuery:function(t,s){if(1&t&&e.Gf(St,5),2&t){let o;e.iGM(o=e.CRH())&&(s.canvasContainer=o.first)}},inputs:{circlesInfo:"circlesInfo",diffFilterCutoff:"diffFilterCutoff",basicSetting:"basicSetting"},features:[e.TTD],decls:7,vars:6,consts:[["echarts","",2,"height","600px",3,"initOpts","options","chartInit"],["canvasContainer",""],[1,"d-flex"],[1,"mr-2"],["ngbTooltip","Downlaod Figure as PNG",1,"hoverBigger",3,"icon","size","click"],["ngbTooltip","Downlaod Figure as PDF",1,"hoverBigger",3,"icon","size","click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0,1),e.NdJ("chartInit",function(r){return s.onChartInit(r)}),e.qZA(),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"fa-icon",4),e.NdJ("click",function(r){return s.downloadPlot(r)}),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"fa-icon",5),e.NdJ("click",function(r){return s.downloadPlotAsPDF(r)}),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("initOpts",s.initOpts)("options",s.options),e.xp6(4),e.Q6J("icon",s.faDownload)("size","1x"),e.xp6(2),e.Q6J("icon",s.faFilePdf)("size","1x"))},directives:[bt._w,w.BN,R._L],styles:[""],changeDetection:0}),n})();var Ft=l(3945);function xt(n,f){1&n&&(e.TgZ(0,"p",2),e._uU(1,"Please generate a differential analysis in left sidebar first"),e.qZA())}function Ct(n,f){if(1&n&&(e.TgZ(0,"div",4),e._UZ(1,"fa-icon",5),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("icon",t.faSpinner)("size","3x")("spin",!0)}}function Gt(n,f){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA(),e.YNc(2,Ct,2,3,"div",3)),2&n){const t=e.oxw();e.xp6(1),e.Oqu(null==t.diffAnalysisResultForPresentationStatus?null:t.diffAnalysisResultForPresentationStatus.statusValue),e.xp6(1),e.Q6J("ngIf","loading"===(null==t.diffAnalysisResultForPresentationStatus?null:t.diffAnalysisResultForPresentationStatus.status))}}function Pt(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"app-change-figure-settings",14),e.NdJ("modifiedSettings$",function(o){return e.CHM(t),e.oxw(2).changePlotSettings(o)})("closeSignal$",function(o){return e.CHM(t),e.oxw(2).showSettings(o)}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("plotSettingInfoList",t.plotSettingInfoList)}}const wt=function(n){return{"min-height":n}};function Ot(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",6),e.TgZ(2,"div"),e._UZ(3,"app-display-notes-with-question-mark",7),e.qZA(),e.TgZ(4,"div",4),e.TgZ(5,"fa-icon",8),e.NdJ("click",function(o){return e.CHM(t),e.oxw().showSettings(o)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(6,Pt,2,1,"div",9),e.TgZ(7,"div",10,11),e._UZ(9,"app-echarts-volcano-plot",12),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("note","The horizontal axis represents log2(fold-change), the vertical axis represents -log10(p-value). Each dot represents one gene/protein. The grey dots represent genes/proteins that are not differentially-expressed, the red dots and the green ones represent up-expressed genes/proteins and down-expressed genes/proteins, respectively")("placement","auto"),e.xp6(2),e.Q6J("icon",t.faCog)("size","sm"),e.xp6(1),e.Q6J("ngIf",t.ifShowSettingsComponent),e.xp6(1),e.Q6J("ngStyle",e.VKq(9,wt,t.containerMinHeight)),e.xp6(2),e.Q6J("circlesInfo",t.circlesInfo)("diffFilterCutoff",t.diffFilterCutoff)("basicSetting",t.basicVisSettings)}}let $t=(()=>{class n{constructor(t,s){this.cdr=t,this.ele=s,this.faCog=z.b7W,this.faSpinner=z.LM3,this.faFilter=z.G_j,this.faTimes=z.NBC,this.ifShowFilterBox=!1,this.ifShowSettingsComponent=!1,this.containerMinHeight=500,this.plotSettingInfoList=[{name:"width",defaultValue:300,minValue:50,maxValue:500,stepValue:1},{name:"height",defaultValue:250,minValue:50,maxValue:600,stepValue:1}],this.basicVisSettings={width:400,height:500}}ngOnInit(){this._obtainCirclesInfo(),this._determineContainerMinHeight(),this._preparePlotSettingInfoList()}ngOnChanges(t){t.diffAnalysisResultForPresentationStatus&&!t.diffAnalysisResultForPresentationStatus.isFirstChange()&&(this._obtainCirclesInfo(),this._determineContainerMinHeight(),this.basicVisSettings=this._obtainBasicSettings(),this._preparePlotSettingInfoList()),t.diffFilterCutoff&&!t.diffFilterCutoff.isFirstChange()&&this._obtainCirclesInfo()}showSettings(t){this.ifShowSettingsComponent=!this.ifShowSettingsComponent}changePlotSettings(t){this.basicVisSettings=Object.assign({},t),this._preparePlotSettingInfoList(),this.cdr.detectChanges()}_obtainCirclesInfo(){var t;if("finished"===(null===(t=this.diffAnalysisResultForPresentationStatus)||void 0===t?void 0:t.status)){const s=this.diffAnalysisResultForPresentationStatus.result;this.circlesInfo=function(n,f,t,s,o,r){const g=function(n){return"EnsemblGene"===n||"NcbiEntrezGene"===n||"NcbiRefseqProtein"===n?0:1}(s),O=J.gO[n].geneIDattr;let Q=J.gO[n].rawPvalueAttr;"adjPvalue"===o&&(Q=J.gO[n].adjPvalueAttr);const i=[...f[O]],d=[...f[Q]],c=[...f[J.gO[n].foldChangeAttr]];let y=[];y.length=f[O].length;for(let b=0;b<i.length;b++){const $=i[b],B=Dt(r,t,$,g);y[b]=[$,B,c[b],-Math.log10(d[b])]}return y.filter(b=>!isNaN(b[2])&&!isNaN(b[3])&&b[3]!=1/0)}(s.diffSoftware,s.diffResults,s.genesInfo?s.genesInfo.genesInfoDic:null,s.IDtype,this.diffFilterCutoff.pValueType,s.experimentType)}}_determineContainerMinHeight(){this.containerMinHeight=.7*document.documentElement.clientHeight-500>0?.7*document.documentElement.clientHeight:500}_obtainBasicSettings(){return{width:this._obtainSvgWidth(),height:this.containerMinHeight-20}}_obtainSvgWidth(){const t=this.ele.nativeElement.clientWidth;return t>this.basicVisSettings.width?this.basicVisSettings.width:t}_preparePlotSettingInfoList(){this.plotSettingInfoList=[{name:"width",defaultValue:this.basicVisSettings.width,minValue:50,maxValue:1e3,stepValue:1},{name:"height",defaultValue:this.basicVisSettings.height,minValue:100,maxValue:700,stepValue:1}]}_generateFilenameForDiffAnalysis(){const t=this.diffAnalysisResultForPresentationStatus.result;return`${t.datasetID}-${t.targetGroup} VS ${t.baseGroup}.txt`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(e.SBq))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-volcano-plot"]],inputs:{diffAnalysisResultForPresentationStatus:"diffAnalysisResultForPresentationStatus",diffFilterCutoff:"diffFilterCutoff"},features:[e.TTD],decls:3,vars:3,consts:[[3,"ngIf"],[4,"ngIf"],["data-testid","generateDiffNote",1,"mt-2","text-danger"],["class","form-inline",4,"ngIf"],[1,"form-inline"],[1,"hoverBigger",3,"icon","size","spin"],[1,"d-flex","justify-content-end","align-items-center"],[1,"align-self-center","mr-3","questionMark",3,"note","placement"],["ngbTooltip","Click to change settings of the plot",1,"hoverBigger","close",3,"icon","size","click"],["cdkDrag","","class","border p-3","style","position: absolute; z-index: 1014;top: 2rem; right: -10rem; background-color: white",4,"ngIf"],[1,"d-flex","justify-content-center",3,"ngStyle"],["svgContainer",""],[3,"circlesInfo","diffFilterCutoff","basicSetting"],["cdkDrag","",1,"border","p-3",2,"position","absolute","z-index","1014","top","2rem","right","-10rem","background-color","white"],[3,"plotSettingInfoList","modifiedSettings$","closeSignal$"]],template:function(t,s){1&t&&(e.YNc(0,xt,2,0,"ng-template",0),e.YNc(1,Gt,3,2,"ng-template",0),e.YNc(2,Ot,10,11,"div",1)),2&t&&(e.Q6J("ngIf",!s.diffAnalysisResultForPresentationStatus),e.xp6(1),e.Q6J("ngIf","error"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)||"loading"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(1),e.Q6J("ngIf","finished"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)))},directives:[a.O5,w.BN,_t.m,R._L,a.PC,Tt,E.Zt,Ft.q],styles:[""],changeDetection:0}),n})();var Et=l(2473),Zt=l(6458);const jt=function(n){return{active:n}};function Nt(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"li",10),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().setActiveGenesDiffType(r.name)}),e.TgZ(1,"a",11),e._uU(2),e.qZA(),e.qZA()}if(2&n){const t=f.$implicit;e.xp6(1),e.Q6J("ngClass",e.VKq(2,jt,t.ifActive)),e.xp6(1),e.hij(" ",t.name," ")}}function Rt(n,f){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"p",12),e._uU(2,"Please generate a differential analysis in left sidebar first"),e.qZA(),e.qZA())}function Mt(n,f){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(null==t.diffAnalysisResultForPresentationStatus?null:t.diffAnalysisResultForPresentationStatus.statusValue)}}function Vt(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"app-display-genes-info-table-pagination",13),e.NdJ("selectedGene$",function(o){return e.CHM(t),e.oxw().processedSelectedGene(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("genesInfoForTable",t.genesInfoForTable)}}function Lt(n,f){if(1&n&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" The differential genes named '",t.diffGeneListID,"' has been added to gene lists. You can use it in other apps\n")}}let Jt=(()=>{class n{constructor(){this.diffGenesEnrichRequest=new e.vpe,this.diffGenesPPIrequest$=new e.vpe,this.selectedGene$=new e.vpe,this.genesForAdding$=new e.vpe,this.genesDiffTypes=[{name:"Up-expressed",ifActive:!0},{name:"Down-expressed",ifActive:!1},{name:"All",ifActive:!1}],this.ifShowDiffGeneType=!0,this.ifShowPageRouter=!1,this.ifShowForwardButton=!1,this.ifDiffAnalysisPrepared=!1,this.selectedDiffType="up",this.ifShowDiffGenesHasBeenAddedNote=!1}ngOnInit(){this.diffAnalysisResultForPresentationStatus&&this.diffAnalysisResultForPresentationStatus.hasOwnProperty("result")&&(this.ifDiffAnalysisPrepared=!0,this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded())}ngOnChanges(t){var s,o,r;t.diffAnalysisResultForPresentationStatus&&!t.diffAnalysisResultForPresentationStatus.isFirstChange()&&("finished"===(null===(s=this.diffAnalysisResultForPresentationStatus)||void 0===s?void 0:s.status)?(this.ifDiffAnalysisPrepared=!0,this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()):this.ifDiffAnalysisPrepared=!1),t.diffFilterInput&&!t.diffFilterInput.isFirstChange()&&"finished"===(null===(o=this.diffAnalysisResultForPresentationStatus)||void 0===o?void 0:o.status)&&(this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()),t.allAvailableGenelistIDs&&"finished"===(null===(r=this.diffAnalysisResultForPresentationStatus)||void 0===r?void 0:r.status)&&this._checkIfGeneListHasBeenAdded()}_prepareDataForDisplay(){this.diffGenesInfoForTable=(0,P.gE)(this.diffAnalysisResultForPresentationStatus.result.experimentType,this.diffAnalysisResultForPresentationStatus.result.diffSoftware,this.diffAnalysisResultForPresentationStatus.result.IDtype,this.diffAnalysisResultForPresentationStatus.result.diffResults,this.diffAnalysisResultForPresentationStatus.result.genesInfo?this.diffAnalysisResultForPresentationStatus.result.genesInfo.genesInfoDic:null,this.diffFilterInput)}_changeGenesInfoAccordingToDiffType(){this.ifDiffAnalysisPrepared&&(this.genesInfoForTable="up"===this.selectedDiffType?{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.upGenes}:"down"===this.selectedDiffType?{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.downGenes}:{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.upGenes.concat(this.diffGenesInfoForTable.downGenes)})}_checkIfGeneListHasBeenAdded(){var t;const s=function(n,f,t){return`${n}/${t.foldChangeType}-${t.foldChange}-${t.pValueType}-${t.pValue}/${f}`}(this.diffAnalysisResultForPresentationStatus.result.id,this.selectedDiffType,this.diffFilterInput);this.ifShowDiffGenesHasBeenAddedNote=!!(null===(t=this.allAvailableGenelistIDs)||void 0===t?void 0:t.includes(s)),this.diffGeneListID=s}setActiveGenesDiffType(t){this.genesDiffTypes=this.genesDiffTypes.map(s=>Object.assign(Object.assign({},s),s.name===t?{ifActive:!0}:{ifActive:!1})),this.selectedDiffType="Up-expressed"===t?"up":"Down-expressed"===t?"down":"allDiff",this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()}_obtainDiffGenesForEnchriment(){const t=this.diffGenesInfoForTable.geneIDattr;return"up"===this.selectedDiffType?this.diffGenesInfoForTable.upGenes.map(o=>o[t]).map(o=>o.split(";")[0]):"down"===this.selectedDiffType?this.diffGenesInfoForTable.downGenes.map(o=>o[t]).map(o=>o.split(";")[0]):this.diffGenesInfoForTable.upGenes.concat(this.diffGenesInfoForTable.downGenes).map(o=>o[t]).map(o=>o.split(";")[0])}_obtainBackgroundGenesForEncirhment(){return this.diffAnalysisResultForPresentationStatus.result.diffResults[J.gO[this.diffAnalysisResultForPresentationStatus.result.diffSoftware].geneIDattr].map(g=>g.split(";")[0])}requestEnrichedAnalysis(t){const s=this._obtainDiffGenesForEnchriment(),o=this._obtainBackgroundGenesForEncirhment();this.diffGenesEnrichRequest.next({diffType:this.selectedDiffType,genes:s,backgroundGenes:o})}processedSelectedGene(t){this.selectedGene$.next(t)}requestPPInetwork(t){const s=this._obtainDiffGenesForEnchriment();this.diffGenesPPIrequest$.next({diffType:this.selectedDiffType,genes:s})}addDiffGenesToGeneList(t){const s=this._obtainDiffGenesForEnchriment();this.genesForAdding$.next({diffType:this.selectedDiffType,genes:s})}_formatGenesDownloadFile(){const t=this.diffAnalysisResultForPresentationStatus.result;return`${t.datasetID}-${t.targetGroup} VS ${t.baseGroup}-${this.selectedDiffType}.txt`}downloadGenes(t){const s=this.genesInfoForTable.features,o=this.genesInfoForTable.genesInfo;let r=s.join("\t")+"\n";r+=o.map(i=>s.map(c=>i[c]).join("\t")).join("\n");const U=this._formatGenesDownloadFile();let Q=new Blob([r],{type:"text/csv;charset=utf-8"});(0,Et.saveAs)(Q,U)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-table-management"]],inputs:{diffAnalysisResultForPresentationStatus:"diffAnalysisResultForPresentationStatus",diffFilterInput:"diffFilterInput",allAvailableGenelistIDs:"allAvailableGenelistIDs"},outputs:{diffGenesEnrichRequest:"diffGenesEnrichRequest",diffGenesPPIrequest$:"diffGenesPPIrequest$",selectedGene$:"selectedGene$",genesForAdding$:"genesForAdding$"},features:[e.TTD],decls:15,vars:9,consts:[["data-testid","switchDiffType",1,"nav","nav-tabs"],["class","nav-item",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12"],[3,"genesInfoForTable","selectedGene$",4,"ngIf"],["data-testid","enrichSubmit",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],[1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["data-testid","triggerVisPPI",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["data-testid","addToGeneList",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["class","text-success","data-testid","diffGenesHasBeenAddedNote",4,"ngIf"],[1,"nav-item",3,"click"],["href","javascript:void(0)",1,"nav-link",3,"ngClass"],["data-testid","generateDiffNote",1,"mt-5","text-danger"],[3,"genesInfoForTable","selectedGene$"],["data-testid","diffGenesHasBeenAddedNote",1,"text-success"]],template:function(t,s){1&t&&(e.TgZ(0,"ul",0),e.YNc(1,Nt,3,4,"li",1),e.qZA(),e.YNc(2,Rt,3,0,"div",2),e.YNc(3,Mt,3,1,"div",2),e.TgZ(4,"div",3),e.YNc(5,Vt,1,1,"app-display-genes-info-table-pagination",4),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(r){return s.requestEnrichedAnalysis(r)}),e._uU(7," Enrichment Analysis\n"),e.qZA(),e.TgZ(8,"button",6),e.NdJ("click",function(r){return s.downloadGenes(r)}),e._uU(9," Download\n"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(r){return s.requestPPInetwork(r)}),e._uU(11," Visualize PPIs in PPIExp\n"),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(r){return s.addDiffGenesToGeneList(r)}),e._uU(13," Add Genes To Gene Lists\n"),e.qZA(),e.YNc(14,Lt,2,1,"p",9)),2&t&&(e.xp6(1),e.Q6J("ngForOf",s.genesDiffTypes),e.xp6(1),e.Q6J("ngIf",!s.diffAnalysisResultForPresentationStatus),e.xp6(1),e.Q6J("ngIf","error"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)||"loading"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(2),e.Q6J("ngIf","finished"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(1),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared||s.ifShowDiffGenesHasBeenAddedNote),e.xp6(2),e.Q6J("ngIf",s.ifShowDiffGenesHasBeenAddedNote))},directives:[a.sg,a.O5,a.mk,Zt.T],styles:[".modalBigSize[_ngcontent-%COMP%]{width:100vw}"],changeDetection:0}),n})();var Ut=l(4547),qt=l(5826),Bt=l(6988),Qt=l(4146);const Yt=["enrichmentContent"];function Wt(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"div",23),e.TgZ(1,"app-try-sample",24),e.NdJ("sampleForTryName$",function(o){return e.CHM(t),e.oxw().processTrySampleFileName(o)})("sampleForImportName$",function(o){return e.CHM(t),e.oxw().processDownloadSampleData(o)})("closeMe$",function(o){return e.CHM(t),e.oxw().closeTrySampleComponent(o)}),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("fileInfos",t.trySamplesInfos)("trySamplePercentage",e.lcZ(2,3,t.trySamplePercentage$))("downloadSampleDataPercentage",e.lcZ(3,5,t.downloadSampleDataPercentage$))}}function Ht(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"app-display-one-gene-expression",25),e.NdJ("closeSignal$",function(o){return e.CHM(t),e.oxw().closeModalForExpression(o)}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("geneExpForBoxPlot",e.lcZ(1,1,t.geneExpForBoxPlot$))}}function Kt(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"div",26),e.TgZ(1,"h4",27),e._uU(2,"Genes Enrichment Analysis"),e.qZA(),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return null==o.enrichedModalRef?null:o.enrichedModalRef.hide()}),e.TgZ(4,"span",29),e._uU(5,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",30),e.TgZ(7,"app-display-enriched-annotations",31),e.NdJ("selectedAnnotationTermGenes$",function(o){return e.CHM(t),e.oxw().processSelectedAnnotationTermGenes(o)})("selectedKEGGpathway$",function(o){return e.CHM(t),e.oxw().processSelectedKEGGpathway(o)})("selectedGene$",function(o){return e.CHM(t),e.oxw().processSelectedGene(o)}),e.ALo(8,"async"),e.qZA(),e.qZA(),e.TgZ(9,"div",32),e.TgZ(10,"button",33),e.NdJ("click",function(){return e.CHM(t),e.oxw().enrichedModalRef.hide()}),e._uU(11," close "),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("geneListErichedResultStatus",e.lcZ(8,2,t.geneListEnrichedResultStatus$))("annotationTermGenesInfoForTable",t.selectedAnnotationTermGenesInfoForTable)}}const zt=[{path:"",component:(()=>{class n{constructor(t,s,o){this.facade=t,this.modalService=s,this.cdr=o,this.trySamplesInfos=[{fileForImport:"RNA-seq-sample-data1.zip",fileForTry:"RNAseqDiffExp.json.gz",description:"RNA-seq Data"}],this.tutorialGifInfos=[{name:"New differential analysis",src:"/static/images/interactiveOperations/DiffExp-1-Import.gif"},{name:"Key operations in volcano plot",src:"/static/images/interactiveOperations/DiffExp-2-Volcano.gif"},{name:"Filter diff genes and display one gene's expression",src:"/static/images/interactiveOperations/DiffExp-3-Differentially.gif"},{name:"Functional enrichment analysis and its related operations",src:"/static/images/interactiveOperations/DiffExp-4-Enrichment.gif"}],this.allDatasetInfoForDisplay$=this.facade.allDatasetInfoForDisplay$,this.allAvailableGenelistIDs$=this.facade.allGeneListIDs$,this.trySamplePercentage$=this.facade.trySamplePercentage$,this.downloadSampleDataPercentage$=this.facade.downloadSampleDataPercentage$,this.ifShowTrySampleComponent=!0,this.ifShowOneGeneExpression=!1,this.destroyNotifier$=new u.xQ,this.selectedDatasetGroups$=this.facade.selectedDatasetGroups$,this.diffAnalysisResultForPresentationStatus$=this.facade.selectedDiffAnalysisResultForPresentationStatus$.pipe((0,S.d)(1)),this.geneListEnrichedResultStatus$=this.facade.geneListEnrichedResultStatus$,this.allDiffAnalysisIDsForDisplay$=this.facade.allDiffAnalysisIDsForDisplay$,this.geneExpForBoxPlot$=this.facade.selectedGeneExpForBoxPlot$,this.diffAnalysisResultForPresentationStatus$.subscribe(r=>{this.diffAnalysisResultForPresentationStatus=r})}ngOnInit(){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedDatasetID(t){this.facade.requestSelectedDatasetGroups(t)}processOutputDiffGroupPair(t){this.facade.requestDatasetGroupPairDiffAnalysis(t)}processSelectedDiffAnalysis(t){this.facade.requestDatasetGroupPairDiffAnalysis({id:t})}processOutputDiffGenesEnrichRequest(t){this.facade.requestDiffGenesEnrichedAnnotations(t),this.enrichedModalRef=this.modalService.show(this.enrichmentContent,Object.assign({},{class:"modal-xl"})),this.ifShowOneGeneExpression=!1}processSelectedGene(t){this.ifShowOneGeneExpression=!0,this.facade.requestOneGeneExpressionForBoxplot(t)}closeModalForExpression(t){this.ifShowOneGeneExpression=!1}processOutputDiffGenesPPIrequest(t){this.facade.visDiffGenesPPIs(t)}processGenesForAdding(t){this.facade.addDiffGenesToGeneList(t)}processSelectedAnnotationTermGenes(t){this.selectedAnnotationTermGenesInfoForTable=Object.assign({},(0,P.AP)(this.diffAnalysisResultForPresentationStatus.result.experimentType,this.diffAnalysisResultForPresentationStatus.result.diffSoftware,this.diffAnalysisResultForPresentationStatus.result.IDtype,this.diffAnalysisResultForPresentationStatus.result.diffResults,this.diffAnalysisResultForPresentationStatus.result.genesInfo.genesInfoDic,t.genes))}processDiffFilterInfo(t){let s;s="rawFoldChange"===t.foldChangeType?{pValueType:t.pValueType,pValueCutoff:-Math.log10(t.pValue),foldChangeCutoff:Math.log2(t.foldChange)}:{pValueType:t.pValueType,pValueCutoff:-Math.log10(t.pValue),foldChangeCutoff:t.foldChange},this.diffFilterCutoff=Object.assign({},s),this.diffFilterInput=t,this.facade.storeDiffFilterInput(t)}processDownloadProjectSignal(t){this.facade.downloadProjectSignal()}processTrySampleFileName(t){this.facade.prepareTrySampleData(t)}processDownloadSampleData(t){this.facade.downloadSampleData(t)}closeTrySampleComponent(t){this.ifShowTrySampleComponent=!1}processSelectedKEGGpathway(t){var s;this.facade.processSelectedKEGGpathway(t),null===(s=this.enrichedModalRef)||void 0===s||s.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ie),e.Y36(D.tT),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-exp"]],viewQuery:function(t,s){if(1&t&&e.Gf(Yt,5,e.Rgc),2&t){let o;e.iGM(o=e.CRH())&&(s.enrichmentContent=o.first)}},decls:32,vars:23,consts:[[1,"row","flex-xl-nowrap"],[1,"col-12","col-md-3","col-xl-2","border","bd-sidebar"],[1,"pt-2",3,"allDatasetInfoForDisplay","datasetGroups","selectedDatasetID$","diffGroupPairRequest$"],[1,"col-12","col-md-9","col-xl-10","mt-2"],[1,"row","mt-1"],[1,"col-12"],["class","border",4,"ngIf"],[1,"mt-3","d-flex","justify-content-between"],[3,"allDiffAnalysisIds","selectedDiffAnalysisId$"],[3,"tutorialGifInfos"],[1,"pt-3"],[3,"diffFilterInfo$"],[1,"row","row-cols-3","mt-1"],[1,"col-12","col-md-7","order-1","order-md-1","border"],[1,"text-center",2,"margin-bottom","0"],[1,"col-12","col-md-5","order-3","order-md-3","border"],[1,"text-center"],[1,"col-12","col-md-7","order-2","order-md-4","border","mainVisSection",3,"diffAnalysisResultForPresentationStatus","diffFilterCutoff"],[1,"col-12","col-md-5","order-4","order-md-6","border","mainVisSection",3,"diffAnalysisResultForPresentationStatus","diffFilterInput","allAvailableGenelistIDs","diffGenesEnrichRequest","diffGenesPPIrequest$","genesForAdding$","selectedGene$"],[1,"row","mt-4"],[3,"downloadProjectSignal$"],["cdkDrag","","class","moveFreeDiv border p-2",3,"geneExpForBoxPlot","closeSignal$",4,"ngIf"],["enrichmentContent",""],[1,"border"],[3,"fileInfos","trySamplePercentage","downloadSampleDataPercentage","sampleForTryName$","sampleForImportName$","closeMe$"],["cdkDrag","",1,"moveFreeDiv","border","p-2",3,"geneExpForBoxPlot","closeSignal$"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"geneListErichedResultStatus","annotationTermGenesInfoForTable","selectedAnnotationTermGenes$","selectedKEGGpathway$","selectedGene$"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"app-generate-diff-analysis",2),e.NdJ("selectedDatasetID$",function(r){return s.processSelectedDatasetID(r)})("diffGroupPairRequest$",function(r){return s.processOutputDiffGroupPair(r)}),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"div",4),e.TgZ(7,"div",5),e.YNc(8,Wt,4,7,"div",6),e.TgZ(9,"div",7),e.TgZ(10,"app-select-diff-analysis",8),e.NdJ("selectedDiffAnalysisId$",function(r){return s.processSelectedDiffAnalysis(r)}),e.ALo(11,"async"),e.qZA(),e._UZ(12,"app-trigger-to-display-tutorial-gif",9),e.qZA(),e.TgZ(13,"div",10),e.TgZ(14,"app-input-diff-filter-info",11),e.NdJ("diffFilterInfo$",function(r){return s.processDiffFilterInfo(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"div",12),e.TgZ(16,"div",13),e.TgZ(17,"h5",14),e._uU(18," Volcano Plot "),e.qZA(),e.qZA(),e.TgZ(19,"div",15),e.TgZ(20,"h5",16),e._uU(21," Differentially-Expressed Genes "),e.qZA(),e.qZA(),e._UZ(22,"app-diff-volcano-plot",17),e.ALo(23,"async"),e.TgZ(24,"app-diff-table-management",18),e.NdJ("diffGenesEnrichRequest",function(r){return s.processOutputDiffGenesEnrichRequest(r)})("diffGenesPPIrequest$",function(r){return s.processOutputDiffGenesPPIrequest(r)})("genesForAdding$",function(r){return s.processGenesForAdding(r)})("selectedGene$",function(r){return s.processSelectedGene(r)}),e.ALo(25,"async"),e.ALo(26,"async"),e.qZA(),e.qZA(),e.TgZ(27,"div",19),e.TgZ(28,"app-download-project",20),e.NdJ("downloadProjectSignal$",function(r){return s.processDownloadProjectSignal(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(29,Ht,2,3,"app-display-one-gene-expression",21),e.YNc(30,Kt,12,4,"ng-template",null,22,e.W1O)),2&t&&(e.xp6(2),e.Q6J("allDatasetInfoForDisplay",e.lcZ(3,11,s.allDatasetInfoForDisplay$))("datasetGroups",e.lcZ(4,13,s.selectedDatasetGroups$)),e.xp6(6),e.Q6J("ngIf",s.ifShowTrySampleComponent),e.xp6(2),e.Q6J("allDiffAnalysisIds",e.lcZ(11,15,s.allDiffAnalysisIDsForDisplay$)),e.xp6(2),e.Q6J("tutorialGifInfos",s.tutorialGifInfos),e.xp6(10),e.Q6J("diffAnalysisResultForPresentationStatus",e.lcZ(23,17,s.diffAnalysisResultForPresentationStatus$))("diffFilterCutoff",s.diffFilterCutoff),e.xp6(2),e.Q6J("diffAnalysisResultForPresentationStatus",e.lcZ(25,19,s.diffAnalysisResultForPresentationStatus$))("diffFilterInput",s.diffFilterInput)("allAvailableGenelistIDs",e.lcZ(26,21,s.allAvailableGenelistIDs$)),e.xp6(5),e.Q6J("ngIf",s.ifShowOneGeneExpression))},directives:[ot,a.O5,lt,ft.n,gt,$t,Jt,Ut.E,qt.P,Bt.R,E.Zt,Qt.r],pipes:[a.Ov],styles:[""]}),n})(),data:{key:"DiffExp"}}];let Xt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[G.Bz.forChild(zt)],G.Bz]}),n})(),kt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[Ie],imports:[[a.ez,h.JF,p.u5,p.UX,D.zk.forRoot(),A.Cl,E._t,x.Q8,R.HK,R.jF,w.uH,Z.D,N.m,v.f,Xt]]}),n})()},1026:(H,M,l)=>{l.d(M,{z:()=>N});var a=l(3668),h=l(9133),p=l(3405),x=l(8735),A=l(8805),E=l(5389),D=l(6019);function R(v,G){if(1&v&&(a.TgZ(0,"option",5),a._uU(1),a.qZA()),2&v){const e=G.$implicit;a.Q6J("value",e.datasetID),a.xp6(1),a.hij(" ",e.description," ")}}function w(v,G){1&v&&(a.TgZ(0,"label",6),a._uU(1,"Please import a dataset first "),a.qZA())}const Z=function(v){return{"form-inline":v}};let N=(()=>{class v{constructor(e){this.cdr=e,this.formInlineOrNot=!0,this.formWidth="15rem",this.selectedDatasetID$=new a.vpe,this.destroyNotifier$=new p.xQ,this.datasetForm=new h.cw({datasetID:new h.NI("",h.kI.required)})}ngOnInit(){this.datasetForm.get("datasetID").valueChanges.pipe((0,x.h)(e=>e),(0,A.R)(this.destroyNotifier$),(0,E.x)()).subscribe(e=>{"VALID"===this.datasetForm.get("datasetID").status&&this.selectedDatasetID$.next(e)})}ngOnChanges(e){e.allDatasetInfoForDisplay&&this.cdr.detectChanges()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return v.\u0275fac=function(e){return new(e||v)(a.Y36(a.sBO))},v.\u0275cmp=a.Xpm({type:v,selectors:[["app-select-dataset"]],inputs:{allDatasetInfoForDisplay:"allDatasetInfoForDisplay",formInlineOrNot:"formInlineOrNot",formWidth:"formWidth"},outputs:{selectedDatasetID$:"selectedDatasetID$"},features:[a.TTD],decls:7,vars:8,consts:[[3,"formGroup"],[1,"align-self-start",3,"ngClass"],["formControlName","datasetID","placeholder","select a dataset",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger font-weight-light",4,"ngIf"],[3,"value"],[1,"text-danger","font-weight-light"]],template:function(e,u){1&e&&(a.TgZ(0,"form",0),a.TgZ(1,"div",1),a.TgZ(2,"h5"),a._uU(3,"Dataset:"),a.qZA(),a.TgZ(4,"select",2),a.YNc(5,R,2,2,"option",3),a.qZA(),a.YNc(6,w,2,0,"label",4),a.qZA(),a.qZA()),2&e&&(a.Q6J("formGroup",u.datasetForm),a.xp6(1),a.Q6J("ngClass",a.VKq(6,Z,u.formInlineOrNot)),a.xp6(3),a.Udp("max-width",u.formWidth),a.xp6(1),a.Q6J("ngForOf",u.allDatasetInfoForDisplay),a.xp6(1),a.Q6J("ngIf",!(u.allDatasetInfoForDisplay&&u.allDatasetInfoForDisplay.length>0)))},directives:[h._Y,h.JL,h.sg,D.mk,h.EJ,h.JJ,h.u,D.sg,D.O5,h.YN,h.Kr],styles:[""],changeDetection:0}),v})()},438:(H,M,l)=>{l.d(M,{w:()=>G});var a=l(3668),h=l(9133),p=l(3405),x=l(8735),A=l(8805),E=l(5389),D=l(6019);function R(e,u){1&e&&(a.TgZ(0,"option",6),a._uU(1," --- "),a.qZA())}function w(e,u){if(1&e&&(a.TgZ(0,"option",7),a._uU(1),a.qZA()),2&e){const S=u.$implicit,P=a.oxw();a.Q6J("value",S[P.idAttribute]),a.xp6(1),a.hij(" ",S[P.displayAttribute]," ")}}function Z(e,u){if(1&e&&(a.TgZ(0,"label",8),a._uU(1),a.qZA()),2&e){const S=a.oxw();a.xp6(1),a.hij(" ",S.emptyNote," ")}}const N=function(e){return{"form-inline":e}},v=function(e){return{"max-width":e}};let G=(()=>{class e{constructor(S){this.cdr=S,this.formInlineOrNot=!1,this.ifOutputFirstValue=!1,this.emptyNote="",this.ifWidthAuto=!1,this.formWidth="15rem",this.selectedItemObject$=new a.vpe,this.destroyNotifier$=new p.xQ,this.itemForm=new h.cw({itemValue:new h.NI("",h.kI.required)})}ngOnInit(){}ngAfterViewInit(){this.itemForm.get("itemValue").valueChanges.pipe((0,x.h)(S=>S),(0,A.R)(this.destroyNotifier$),(0,E.x)()).subscribe(S=>{if("VALID"===this.itemForm.get("itemValue").status){let P;for(let m of this.inputObjects)m[this.idAttribute]===S&&(P=m);this.selectedItemObject$.next(P||null)}else this.selectedItemObject$.next(null);this.cdr.detectChanges()}),this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnChanges(S){S.inputObjects&&!S.inputObjects.isFirstChange()&&(this.ifOutputFirstValue?this._outputSetFirstItemAsSelctedItem():this.itemForm.patchValue({itemValue:""}))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_outputSetFirstItemAsSelctedItem(){this.inputObjects&&this.inputObjects.length>=1&&this.itemForm.patchValue({itemValue:this.inputObjects[0][this.idAttribute]})}}return e.\u0275fac=function(S){return new(S||e)(a.Y36(a.sBO))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-select-item-object"]],inputs:{inputObjects:"inputObjects",idAttribute:"idAttribute",displayAttribute:"displayAttribute",itemLabel:"itemLabel",formInlineOrNot:"formInlineOrNot",ifOutputFirstValue:"ifOutputFirstValue",emptyNote:"emptyNote",ifWidthAuto:"ifWidthAuto",formWidth:"formWidth"},outputs:{selectedItemObject$:"selectedItemObject$"},features:[a.TTD],decls:8,vars:11,consts:[[3,"ngClass","formGroup"],[1,"align-self-start"],["formControlName","itemValue","data-testid","selectItem",1,"form-control","form-control-sm",3,"ngStyle"],["value","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger font-weight-light",4,"ngIf"],["value",""],[3,"value"],[1,"text-danger","font-weight-light"]],template:function(S,P){1&S&&(a.TgZ(0,"form",0),a.TgZ(1,"div",1),a.TgZ(2,"h5"),a._uU(3),a.qZA(),a.TgZ(4,"select",2),a.YNc(5,R,2,0,"option",3),a.YNc(6,w,2,2,"option",4),a.qZA(),a.YNc(7,Z,2,1,"label",5),a.qZA(),a.qZA()),2&S&&(a.Q6J("ngClass",a.VKq(7,N,P.formInlineOrNot))("formGroup",P.itemForm),a.xp6(3),a.hij("",P.itemLabel,":"),a.xp6(1),a.Q6J("ngStyle",a.VKq(9,v,P.ifWidthAuto?"none":P.formWidth)),a.xp6(1),a.Q6J("ngIf",!P.ifOutputFirstValue),a.xp6(1),a.Q6J("ngForOf",P.inputObjects),a.xp6(1),a.Q6J("ngIf",!((null==P.inputObjects?null:P.inputObjects.length)>=1)))},directives:[h._Y,h.JL,D.mk,h.sg,h.EJ,h.JJ,h.u,D.PC,D.O5,D.sg,h.YN,h.Kr],styles:[""],changeDetection:0}),e})()}}]);