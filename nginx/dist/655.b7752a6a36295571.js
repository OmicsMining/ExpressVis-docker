"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[655],{4165:(rt,V,L)=>{L.d(V,{W:()=>_t});var i=L(2411),s=L(9232),b=L(7500);const G=Number.isInteger||function(o){return o<<0===o};function N(h){return"[object String]"===Object.prototype.toString.call(h)}const M=(0,b.Z)(function(o,a){var g=o<0?a.length+o:o;return N(a)?a.charAt(g):a[g]}),Z=(0,b.Z)(function(o,a){return o.map(function(g){for(var _,m=a,u=0;u<g.length;){if(null==m)return;m=G(_=g[u])?M(_,m):m[_],u+=1}return m})}),q=(0,b.Z)(function(o,a){return Z([o],a)[0]}),U=(0,b.Z)(function(o,a){return o.map(function(g){return q([g],a)})});var E=L(4182);const nt=(0,b.Z)(function(o,a){return Number(o)+Number(a)});var A=L(2);function ot(h){return function o(a,g,m){switch(arguments.length){case 0:return o;case 1:return(0,A.Z)(a)?o:(0,b.Z)(function(u,_){return h(a,u,_)});case 2:return(0,A.Z)(a)&&(0,A.Z)(g)?o:(0,A.Z)(a)?(0,b.Z)(function(u,_){return h(u,g,_)}):(0,A.Z)(g)?(0,b.Z)(function(u,_){return h(a,u,_)}):(0,E.Z)(function(u){return h(a,g,u)});default:return(0,A.Z)(a)&&(0,A.Z)(g)&&(0,A.Z)(m)?o:(0,A.Z)(a)&&(0,A.Z)(g)?(0,b.Z)(function(u,_){return h(u,_,m)}):(0,A.Z)(a)&&(0,A.Z)(m)?(0,b.Z)(function(u,_){return h(u,g,_)}):(0,A.Z)(g)&&(0,A.Z)(m)?(0,b.Z)(function(u,_){return h(a,u,_)}):(0,A.Z)(a)?(0,E.Z)(function(u){return h(u,g,m)}):(0,A.Z)(g)?(0,E.Z)(function(u){return h(a,u,m)}):(0,A.Z)(m)?(0,E.Z)(function(u){return h(a,g,u)}):h(a,g,m)}}}const st=Array.isArray||function(o){return null!=o&&o.length>=0&&"[object Array]"===Object.prototype.toString.call(o)},ht=(0,E.Z)(function(o){return!!st(o)||!(!o||"object"!=typeof o||N(o))&&(1===o.nodeType?!!o.length:0===o.length||o.length>0&&o.hasOwnProperty(0)&&o.hasOwnProperty(o.length-1))});var dt=function(){function h(o){this.f=o}return h.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},h.prototype["@@transducer/result"]=function(o){return o},h.prototype["@@transducer/step"]=function(o,a){return this.f(o,a)},h}();const pt=(0,b.Z)(function(o,a){return function(h,o){switch(h){case 0:return function(){return o.apply(this,arguments)};case 1:return function(a){return o.apply(this,arguments)};case 2:return function(a,g){return o.apply(this,arguments)};case 3:return function(a,g,m){return o.apply(this,arguments)};case 4:return function(a,g,m,u){return o.apply(this,arguments)};case 5:return function(a,g,m,u,_){return o.apply(this,arguments)};case 6:return function(a,g,m,u,_,W){return o.apply(this,arguments)};case 7:return function(a,g,m,u,_,W,Y){return o.apply(this,arguments)};case 8:return function(a,g,m,u,_,W,Y,O){return o.apply(this,arguments)};case 9:return function(a,g,m,u,_,W,Y,O,z){return o.apply(this,arguments)};case 10:return function(a,g,m,u,_,W,Y,O,z,F){return o.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}(o.length,function(){return o.apply(a,arguments)})});function K(h,o,a){for(var g=a.next();!g.done;){if((o=h["@@transducer/step"](o,g.value))&&o["@@transducer/reduced"]){o=o["@@transducer/value"];break}g=a.next()}return h["@@transducer/result"](o)}function t(h,o,a,g){return h["@@transducer/result"](a[g](pt(h["@@transducer/step"],h),o))}var e="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function r(h,o,a){if("function"==typeof h&&(h=function(h){return new dt(h)}(h)),ht(a))return function(h,o,a){for(var g=0,m=a.length;g<m;){if((o=h["@@transducer/step"](o,a[g]))&&o["@@transducer/reduced"]){o=o["@@transducer/value"];break}g+=1}return h["@@transducer/result"](o)}(h,o,a);if("function"==typeof a["fantasy-land/reduce"])return t(h,o,a,"fantasy-land/reduce");if(null!=a[e])return K(h,o,a[e]());if("function"==typeof a.next)return K(h,o,a);if("function"==typeof a.reduce)return t(h,o,a,"reduce");throw new TypeError("reduce: list must be array or iterable")}const p=ot(r)(nt,0),H=(0,E.Z)(function(o){return p(o)/o.length}),S=function(h,o,a){const g=function(h,o){let a=new Map;return o.forEach(g=>{a.set(g.name,(0,s.yF)(g.samples,h))}),a}(o,a);let m=[];return m.length=h.length,h.forEach((u,_)=>{const W=function(h,o){let a=[];for(let[g,m]of o){const u=U(m,h);a.push(H(u))}return a}(u,g);m[_]=W}),m};var y=L(3692),T=L(3668);const D=function(h,o){return document.getElementById(h)?Promise.resolve():new Promise((g,m)=>{let u=document.createElement("script");document.body.appendChild(u),u.onload=()=>g(),u.onerror=_=>m(_.error),u.id=h,u.async=!0,u.src=o})},w=function(h){const a=h[0].length;let g=[];return g.length=h.length*a,h.forEach((m,u)=>{m.forEach((_,W)=>{g[u*a+W]=_})}),g};class x{constructor(o,a,g,m=null){this.node_id=o,this.xPos=a,this.yPos=g,this.children=m}}class ut{constructor(o,a,g,m){this.nodesID2nodes=new Map,this.merge=o,this.height=a,this.order=g,this.rowNum=m}_computMaxHeight(){this.maxHeight=Math.max(...this.height)}_generateNodeIDFromMergeValue(o){return o<0?-o-1:o+this.rowNum-1}_generateLeavesNodes(){const o=1/this.rowNum;this.order.forEach((a,g)=>{const m=a-1,_=new x(m,1,o*(g+.5));this.nodesID2nodes.set(m,_)})}_generateNonLeavesNodes(){const o=this.rowNum-1;for(let a=0;a<o;a++){const g=a+this.rowNum,m=this._generateNodeIDFromMergeValue(this.merge[a]),u=this._generateNodeIDFromMergeValue(this.merge[a+o]),_=this.nodesID2nodes.get(m),W=this.nodesID2nodes.get(u),F=new x(g,1-this.height[a]/this.maxHeight,(_.yPos+W.yPos)/2,[W,_]);this.nodesID2nodes.set(g,F),this.nodesID2nodes.delete(m),this.nodesID2nodes.delete(u)}}resultTree(){return this._computMaxHeight(),this._generateLeavesNodes(),this._generateNonLeavesNodes(),new x(1e5,void 0,void 0,[this.nodesID2nodes.get(2*(this.rowNum-1))])}}var J=L(8260);const it=h=>h;let ft=(()=>{class h{constructor(){this.resolveModule()}resolveModule(){D("hclustfastModule",J.N.wasmUrl+"hclustfast.js").then(()=>{const a={locateFile:m=>J.N.wasmUrl+"hclustfast.wasm"};return(this.moduleDecorator||it)(a),window.hclustfastModule(a)}).then(a=>{this.module=a,this.hclustWasmFunction=a.cwrap("hclustFastWasm",null,["number","number","number","number","number","number","number"])})}clusterUsingHclust(a,g){const m=a.length,u=a[0].length,_=w(a),W=this.module.HEAPF64.BYTES_PER_ELEMENT,Y=new Float64Array(_),O=this.module._malloc(Y.length*W);this.module.HEAPF64.set(Y,O/W);const z=this.module._malloc(2*(m-1)*this.module.HEAP32.BYTES_PER_ELEMENT),F=this.module._malloc((m-1)*this.module.HEAPF64.BYTES_PER_ELEMENT),k=this.module._malloc(m*this.module.HEAP32.BYTES_PER_ELEMENT);this.hclustWasmFunction(O,m,u,g,z,F,k);let It=[],St=[],Lt=[];It.length=m;for(let B=0;B<m;B++)It[B]=this.module.HEAP32[k/Uint32Array.BYTES_PER_ELEMENT+B];St.length=m-1;for(let B=0;B<m-1;B++)St[B]=this.module.HEAPF64[F/Float64Array.BYTES_PER_ELEMENT+B];Lt.length=2*(m-1);for(let B=0;B<2*(m-1);B++)Lt[B]=this.module.HEAP32[z/Uint32Array.BYTES_PER_ELEMENT+B];return this.module._free(O),this.module._free(z),this.module._free(k),this.module._free(F),new ut(Lt,St,It,m).resultTree()}}return h.\u0275fac=function(a){return new(a||h)},h.\u0275prov=T.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();const vt=h=>h;let et=(()=>{class h{constructor(){this.resolveModule()}resolveModule(){D("kmeansModule",J.N.wasmUrl+"kmeansLloyd.js").then(()=>{const a={locateFile:m=>J.N.wasmUrl+"kmeansLloyd.wasm"};return(this.moduleDecorator||vt)(a),window.kmeansModule(a)}).then(a=>{this.module=a,this.kmeansWasmFunction=a.cwrap("kmeansLloydForWasm",null,["number","number","number","number","number"])})}clusterUsingKmeans(a,g){const m=a.length,u=a[0].length,_=w(a),W=this.module.HEAPF32.BYTES_PER_ELEMENT,Y=new Float32Array(_),O=this.module._malloc(Y.length*W);this.module.HEAPF32.set(Y,O/W);const z=this.module._malloc(m*this.module.HEAPU32.BYTES_PER_ELEMENT);this.kmeansWasmFunction(O,m,u,g,z);let F=[];F.length=m;for(let k=0;k<m;k++)F[k]=this.module.HEAPU32[z/Uint32Array.BYTES_PER_ELEMENT+k];return this.module._free(O),this.module._free(z),F}}return h.\u0275fac=function(a){return new(a||h)},h.\u0275prov=T.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();const at={single:0,complete:1,average:2};let _t=(()=>{class h{constructor(a,g){this.wasmHclustFastService=a,this.wasmKmeansService=g}requestNormalizedValuesSpecificClusterResult(a){const g=y.Pn[a.experimentType](a.dataArray);let m,u;if("Across Samples"===a.acrossGroupsOrSamples?(m=[...g],u=a.samples):(m=S(g,a.samples,a.groups),u=a.groups.map(_=>_.name)),"Hierarchical"===a.clusterMethod){const _=at[a.clusterMethodSetting],W=this.wasmHclustFastService.clusterUsingHclust(m,_),Y=this.wasmHclustFastService.clusterUsingHclust((0,s.Wy)(m),_);return(0,i.of)({leftDendgrogramInfor:W,topDendgrogramInfor:Y,dataArray:m,leftUniqueTerms:a.genes,leftDisplayTerms:a.genes,topUniqueTerms:u,topDisplayTerms:u})}if("Kmeans"===a.clusterMethod){const _=this.wasmKmeansService.clusterUsingKmeans(m,a.clusterMethodSetting);return(0,i.of)({dataArray:m,clusterIndex:_,leftDisplayTerms:a.genes,leftUniqueTerms:a.genes,topDisplayTerms:u,topUniqueTerms:u})}}}return h.\u0275fac=function(a){return new(a||h)(T.LFG(ft),T.LFG(et))},h.\u0275prov=T.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},9868:(rt,V,L)=>{L.d(V,{h:()=>G});var i=L(4099),s=L(3668),b=L(1144);let G=(()=>{class N{constructor(M){this.router=M,this.keggPathwayFromOtherAppSubject=new i.X(null),this.geneListIDFromOtherAppSubject=new i.X(null),this.keggPathwayFromOtherApp$=this.keggPathwayFromOtherAppSubject.asObservable(),this.geneListIDFromOtherApp$=this.geneListIDFromOtherAppSubject.asObservable()}sendPathway2KeggExp(M){this.keggPathwayFromOtherAppSubject.next(M),this.router.navigate(["/KeggExp"])}sendGeneList2PPIExp(M){this.geneListIDFromOtherAppSubject.next(M),this.router.navigate(["/PPIExp"])}}return N.\u0275fac=function(M){return new(M||N)(s.LFG(b.F0))},N.\u0275prov=s.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},2307:(rt,V,L)=>{L.d(V,{H:()=>i,P:()=>s});const i=function(b){return b*parseFloat(getComputedStyle(document.documentElement).fontSize)*.8},s=function(b){return b*parseFloat(getComputedStyle(document.documentElement).fontSize)}},5150:(rt,V,L)=>{L.d(V,{J:()=>pt});var i=L(3668),s=L(2707),b=L(4099),G=L(3405),N=L(8805),X=L(8735),M=L(5686),$=L(8105),Z=L(2307);const Q=["svgContainer"],q=["svgElement"],P=["heatmap"],U=["heatmapCoverRects"],E=["verticalScaleIndicators"],tt=["leftDendgrogram"],nt=["leftDendgroCoverRects"],A=["horizontalScaleIndicators"],ot=["topDendgrogram"],st=["topDendgroCoverRects"],lt=["xLabels"],ht=["xLabelsCoverRects"],dt=["yLabels"],ct=["yLabelsCoverRects"],gt=["upCoverForSelectNodes"],mt=["downCoverForSelectNodes"];let pt=(()=>{class j{constructor(t){this.cdr=t,this.nodesSelected$=new i.vpe,this.nodeSelected$=new i.vpe,this.mapSettings$=new i.vpe,this.width=300,this.height=500,this.marginTop=10,this.marginRight=30,this.marginBottom=50,this.marginLeft=5,this.padRight=10,this.padLeft=10,this.leftDendgroWidth=50,this.topDendgroHeight=50,this.heatmapWidth=200,this.verticalScaleIndicatorWidth=20,this.horizontalScaleIndicatorHeight=15,this.dendgroIndicatorGap=3,this.xLabelRotationDegree=-30,this.xLabelsFontSize=1.5,this.yLablesFontSize=1,this.basicSetting={width:300,height:500,marginTop:10,marginRight:30,marginBottom:50,marginLeft:5,leftDendgroWidth:50,topDendgroHeight:50,heatmapWidth:200,heatmapHeight:300,verticalScaleIndicatorWidth:20,horizontalScaleIndicatorHeight:15,xLabelRotationDegree:-30,xLabelsFontSize:1.5},this.VERTICAL_MOVE_BAR_HEIGHT=10,this.HORIZONAL_MOVE_BAR_WIDTH=10,this.transformOneDirectionInfo={realTranslateX:0,realTranslateY:0,zoomTranslateX:0,zoomTranslateY:0,realScaleX:1,realScaleY:1,zoomScale:1},this.initialyLableYTranslate=[],this.initialxLableXTranslate=[],this.zoomFromScaleBar$=new b.X(null),this.zoomFromMapElements$=new b.X(null),this.mapSettingsDebouncer$=new b.X(null),this.destroyNotifier$=new G.xQ,this.mapSettingsDebouncer$.pipe((0,N.R)(this.destroyNotifier$),(0,X.h)(e=>null!=e),(0,M.b)(1e3)).subscribe(e=>{this.mapSettings$.next(e)}),this.zoomFromMapElements$.pipe((0,N.R)(this.destroyNotifier$),(0,X.h)(e=>null!=e),(0,$.e)(this.auditTime)).subscribe(e=>{const{x:r,y:d,k:n,pointerX:f,pointerY:p}=e,c=this._computeRealZoomValues(r,d,n,f,p);this._transformMapUsingRealZoomValues(c.realTranslateX,c.realTranslateY,c.realScaleX,c.realScaleY),this._modifyVerticalScaleIndicatorsFromScroll(c.realTranslateY,c.realScaleY),this._modifyHorizontalScaleIndicatorsFromScroll(c.realTranslateX,c.realScaleX),this._toggleYlabelsVisibility(c.realScaleY),this._toggleXlabelsVisibility(c.realScaleX),this._updateTransformInfo(c),this._updateD3svg__zoom(c.zoomTranslateX,c.zoomTranslateY,c.zoomScale),this.selectedPathNode&&this._highlightRowsAndPathsWhenSelectingNodes(this.selectedPathNode,(0,s.Ys)(this.selectedPathNodeIdentifier)),this.mapSettings$.next({transform:Object.assign({},c),basicSetting:Object.assign({},this.basicSetting)})}),this.zoomFromScaleBar$.pipe((0,N.R)(this.destroyNotifier$),(0,X.h)(e=>null!=e),(0,$.e)(this.auditTime)).subscribe(e=>{const r=e.scaleBarSetting;if("vertical"===e.sourceOrientation){const d=this._convertScrollBarParameters2zoomParameters(e.sourceOrientation,r,Object.assign({},this.transformOneDirectionInfo));this._transformMapUsingRealZoomValues(d.realTranslateX,d.realTranslateY,d.realScaleX,d.realScaleY),this._updateTransformInfo(d),this._modifyVerticalScaleIndicators(r.smallEndRectLong,r.middleRectLong,r.bigEndRectLong,r.indicatorLong,this.VERTICAL_MOVE_BAR_HEIGHT),this.selectedPathNode&&this._highlightRowsAndPathsWhenSelectingNodes(this.selectedPathNode,(0,s.Ys)(this.selectedPathNodeIdentifier)),this._toggleYlabelsVisibility(d.realScaleY),this.mapSettings$.next({transform:Object.assign({},d),basicSetting:Object.assign({},this.basicSetting)})}else if("horizontal"===e.sourceOrientation){const d=this._convertScrollBarParameters2zoomParameters(e.sourceOrientation,r,Object.assign({},this.transformOneDirectionInfo));this._transformMapUsingRealZoomValues(d.realTranslateX,d.realTranslateY,d.realScaleX,d.realScaleY),this._updateTransformInfo(d),this._modifyHorizontalScaleIndicators(r.smallEndRectLong,r.middleRectLong,r.bigEndRectLong,r.indicatorLong,this.HORIZONAL_MOVE_BAR_WIDTH),this._toggleXlabelsVisibility(d.realScaleX),this.mapSettings$.next({transform:Object.assign({},d),basicSetting:Object.assign({},this.basicSetting)})}})}ngOnInit(){}ngAfterViewInit(){this._actionWhenHiearchicalResultChanges()}ngOnChanges(t){t.hierarchicalResultForDisplay&&!t.hierarchicalResultForDisplay.isFirstChange()&&this._actionWhenHiearchicalResultChanges(),t.disSelectedNodes&&!t.disSelectedNodes.isFirstChange()&&this.disSelectedNodes&&(this._disHighlightRowsAndPathsWhenSelectingNodes(this.selectedPathNode),this._resetSelecteNodeIfClickedAttr(),this._resetSelectedPathNode())}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_actionWhenHiearchicalResultChanges(){this.hierarchicalResultForDisplay&&(this._removeGraphicAndResetSettings(),this._initMap())}_removeGraphicAndResetSettings(){if(this.d3Svg){let t=function(e){(0,s.Ys)(e).selectAll("*").remove()};t(this.heatmap.nativeElement),t(this.heatmapCoverRects.nativeElement),t(this.verticalScaleIndicators.nativeElement),t(this.leftDendgrogram.nativeElement),t(this.leftDendgroCoverRects.nativeElement),t(this.horizontalScaleIndicators.nativeElement),t(this.topDendgrogram.nativeElement),t(this.topDendgroCoverRects.nativeElement),t(this.xLabels.nativeElement),t(this.xLabelsCoverRects.nativeElement),t(this.yLabels.nativeElement),t(this.yLabelsCoverRects.nativeElement),t(this.upCoverForSelectNodes.nativeElement),t(this.downCoverForSelectNodes.nativeElement)}this.transformOneDirectionInfo={realTranslateX:0,realTranslateY:0,zoomTranslateX:0,zoomTranslateY:0,realScaleX:1,realScaleY:1,zoomScale:1},this.initialyLableYTranslate=[],this.initialxLableXTranslate=[]}_initMap(){this.d3Svg=(0,s.Ys)(this.svgElement.nativeElement),this._prepareVisData(),this._obtainBasicSettings(),this._obtainTransform(),this._drawLeftDendgro(),this._drawHeatmap(),this._addYLabels(),this._addXlabels(),this._addCoverBoxes(),this._drawTopDendgro(),this._addVerticalScaleIndicators(),this._addHorizontalScaleIndicators(),this._zoomMap(),this._transformInitalMap(),this._modifyVerticalScaleIndicatorsFromScroll(this.transformOneDirectionInfo.realTranslateY,this.transformOneDirectionInfo.realScaleY),this._modifyHorizontalScaleIndicatorsFromScroll(this.transformOneDirectionInfo.realTranslateX,this.transformOneDirectionInfo.realScaleX),this._toggleYlabelsVisibility(this.transformOneDirectionInfo.realScaleY),this._toggleXlabelsVisibility(this.transformOneDirectionInfo.realScaleX)}_prepareVisData(){const t=this.hierarchicalResultForDisplay.clusterResult;this.leftDendgrogramInfor=t.leftDendgrogramInfor,this.topDendgrogramInfor=t.topDendgrogramInfor,this.heatmapArray=t.dataArray,this.leftDisplayTerms=t.leftDisplayTerms,this.topDisplayTerms=t.topUniqueTerms,this.leftUniqueTerms=t.leftUniqueTerms;let e=(0,s.ki8)().size([500,300]),r=(0,s.bT9)(this.leftDendgrogramInfor);e(r),this.leftDendgroRoot=r,this.leftDendgrogramLeavels=r.leaves(),this.leftDendgrogramLeavelsIDs=this.leftDendgrogramLeavels.map(c=>c.data.node_id),this.leftDendgrogramLeavelsLength=this.leftDendgrogramLeavels.length;let d=(0,s.ki8)(),n=(0,s.bT9)(this.topDendgrogramInfor);d(n),this.topDendgroRoot=n,this.topDendgrogramLeavels=n.leaves(),this.topDendgrogramLeavelIDs=this.topDendgrogramLeavels.map(c=>c.data.node_id);let f=r.descendants().slice(1).map(c=>"#LVNode"+c.data.node_id+",#LHNode"+c.data.node_id),p=r.leaves().map(c=>"#row"+c.data.node_id);this.allLeftLinksSelector=f.toString(),this.allLeftRowsSelector=p.toString()}_obtainBasicSettings(){const e=this.hierarchicalResultForDisplay.basicSetting;this.width=e&&e.width?e.width:this._obtainSvgWidth(),this.height=e&&e.height?e.height:this._obtainSvgHeight(),this.marginTop=e&&e.marginTop?e.marginTop:2,this.marginRight=e&&e.marginRight?e.marginRight:this._obtainMarginRight(),this.marginBottom=e&&e.marginBottom?e.marginBottom:this._obtainMarginBottom(),this.marginLeft=e&&e.marginLeft?e.marginLeft:2,this.leftDendgroWidth=e&&e.leftDendgroWidth?e.leftDendgroWidth:30,this.topDendgroHeight=e&&e.topDendgroHeight?e.topDendgroHeight:50,this.verticalScaleIndicatorWidth=e&&e.verticalScaleIndicatorWidth?e.verticalScaleIndicatorWidth:10,this.horizontalScaleIndicatorHeight=e&&e.horizontalScaleIndicatorHeight?e.horizontalScaleIndicatorHeight:10,this.heatmapWidth=e&&e.heatmapWidth?e.heatmapWidth:this._obtainHeatmapWidth(),this.heatmapHeight=e&&e.heatmapHeight?e.heatmapHeight:this._obtainHeatmapHeight(),this.xLabelRotationDegree=e&&e.xLabelRotationDegree?e.xLabelRotationDegree:-30,this.xLabelsFontSize=e&&e.xLabelsFontSize?e.xLabelsFontSize:1,this.svgTop2HeatmapHeight=this.marginTop+this.horizontalScaleIndicatorHeight+this.dendgroIndicatorGap+this.topDendgroHeight,this.svgLeft2HeatmapWidth=this.marginLeft+this.verticalScaleIndicatorWidth+this.dendgroIndicatorGap+this.leftDendgroWidth,this.heatmapInitRowHeight=this.heatmapHeight/this.heatmapArray.length,this.heatmapInitRectWidth=this.heatmapWidth/this.heatmapArray[0].length,this.Y_LABLE_CHARACTER_HEIGHT=(0,Z.P)(this.yLablesFontSize),this.X_LABLE_CHARACTER_WIDTH=(0,Z.H)(this.xLabelsFontSize),this.d3Svg.attr("width",this.width),this.d3Svg.attr("height",this.height),this.basicSetting=Object.assign(Object.assign({},this.basicSetting),{width:this.width,height:this.height,marginTop:this.marginTop,marginRight:this.marginRight,marginBottom:this.marginBottom,marginLeft:this.marginLeft,leftDendgroWidth:this.leftDendgroWidth,topDendgroHeight:this.topDendgroHeight,verticalScaleIndicatorWidth:this.verticalScaleIndicatorWidth,horizontalScaleIndicatorHeight:this.horizontalScaleIndicatorHeight,heatmapWidth:this.heatmapWidth,heatmapHeight:this.heatmapHeight,xLabelRotationDegree:this.xLabelRotationDegree,xLabelsFontSize:this.xLabelsFontSize})}_obtainTransform(){const t=Object.assign({},this.hierarchicalResultForDisplay.transform);this.transformOneDirectionInfo={realTranslateX:t.realTranslateX?t.realTranslateX:0,realTranslateY:t.realTranslateY?t.realTranslateY:0,zoomTranslateX:t.zoomTranslateX?t.zoomTranslateX:0,zoomTranslateY:t.zoomTranslateY?t.realTranslateY:0,realScaleX:t.realScaleX?t.realScaleX:1,realScaleY:t.realScaleY?t.realScaleY:1,zoomScale:t.zoomScale?t.zoomScale:1}}_obtainSvgWidth(){return this.svgContainer.nativeElement.clientWidth}_obtainSvgHeight(){return this.svgContainer.nativeElement.clientHeight}_obtainHeatmapWidth(){const t=this.width-this.marginLeft-this.marginRight-this.leftDendgroWidth-this.dendgroIndicatorGap-this.verticalScaleIndicatorWidth;return t>=.5*this.width?t:.5*this.width}_obtainHeatmapHeight(){return this.height-this.marginBottom-this.marginTop-this.topDendgroHeight-this.dendgroIndicatorGap-this.horizontalScaleIndicatorHeight}_drawLeftDendgro(){let t=this;const e=this.heatmapHeight;let r=(0,s.Ys)(t.leftDendgrogram.nativeElement).attr("transform","translate("+(t.marginLeft+t.verticalScaleIndicatorWidth+t.dendgroIndicatorGap+20)+" "+t.svgTop2HeatmapHeight+")");r.append("rect").attr("class","grid").attr("width",t.leftDendgroWidth).attr("height",e).attr("id","leftScrollRect").style("fill","white");const d=(p,c,H)=>{p.stopPropagation();let l=(0,s.Ys)(H);const I=l.attr("ifClick");"false"===I?(t._disHighlightRowsAndPathsWhenSelectingNodes(t.selectedPathNode),t._highlightRowsAndPathsWhenSelectingNodes(c,H),t._outputSelectedNodes(c,I),l.attr("ifClick",!0),t.selectedPathNodeIdentifier="#"+l.attr("id"),t.selectedPathNode=c):(t._disHighlightRowsAndPathsWhenSelectingNodes(t.selectedPathNode),t._outputSelectedNodes(c,I),l.attr("ifClick",!1),t._resetSelectedPathNode())};r.selectAll(".link").data(t.leftDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","leftHorizontalLink linkGrey").style("cursor","pointer").attr("id",function(p){return"LHNode"+p.data.node_id}).attr("d",function(p){if(null!=p.parent.data.xPos)return"M"+t.leftDendgroWidth*p.parent.data.xPos+" "+e*p.data.yPos+"H"+t.leftDendgroWidth*p.data.xPos}).attr("ifClick",!1).on("click",function(p,c){d(p,c,this),t.cdr.detectChanges()}),r.selectAll(".link").data(t.leftDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","leftVerticalLink linkGrey").style("cursor","pointer").attr("id",function(p){return"LVNode"+p.data.node_id}).attr("d",function(p){return null==p.parent.data.xPos||p.children?"M"+t.leftDendgroWidth*p.data.xPos+" "+e*p.children[0].data.yPos+"L"+t.leftDendgroWidth*p.data.xPos+" "+e*p.children[1].data.yPos:void 0}).attr("ifClick",!1).on("click",function(p,c){d(p,c,this),t.cdr.detectChanges()})}_drawTopDendgro(){let t=this,e=(0,s.Ys)(t.topDendgrogram.nativeElement).attr("transform","translate("+t.svgLeft2HeatmapWidth+" "+(t.marginTop+t.horizontalScaleIndicatorHeight+t.dendgroIndicatorGap)+")");e.selectAll(".link").data(t.topDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","topVerticalLink").attr("id",function(n){return"topNode"+n.data.node_id}).attr("d",function(n){if(null!=n.parent.data.yPos)return"M"+t.heatmapWidth*n.data.yPos+" "+t.topDendgroHeight*n.parent.data.xPos+"V"+t.topDendgroHeight*n.data.xPos}).style("stroke","grey"),e.selectAll(".link").data(t.topDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","topHorizontalLink").attr("id",function(n){return"topNode"+n.data.node_id}).attr("d",function(n){return null==n.parent.data.yPos||n.children?"M"+t.heatmapWidth*n.children[0].data.yPos+" "+t.topDendgroHeight*n.data.xPos+"L"+t.heatmapWidth*n.children[1].data.yPos+" "+t.topDendgroHeight*n.data.xPos:void 0}).style("stroke","grey")}_drawHeatmap(){let t=this,e=(0,s.sXR)("blue","yellow"),r=[];this.heatmapArray.forEach(D=>{D.forEach(w=>{r.push(w)})});let d=(0,s.BYU)().domain([(0,s.VV$)(r),(0,s.Fp7)(r)]).range([0,1]);const n=this.heatmapArray[0].length,f=this.heatmapWidth/n;let p=(0,s.BYU)().domain([0,n]).range([0,this.heatmapWidth]);const c=this.leftDendgroRoot.leaves(),H=c.length,S=(c[0].data.yPos*t.heatmapHeight-c[H-1].data.yPos*t.heatmapHeight)/(H-1),v=t.svgLeft2HeatmapWidth+1;(0,s.Ys)(t.heatmap.nativeElement).attr("transform","translate("+v+" "+t.svgTop2HeatmapHeight+")").selectAll(".row").data(c).enter().append("g").style("cursor","pointer").attr("id",function(D){return"row"+D.data.node_id}).attr("transform",function(D,w){return"translate(0,"+(D.data.yPos*t.heatmapHeight-S/2)+")"}).attr("class","rowNormal").attr("ifClick",!1).on("dblclick",function(D,w){t.nodeSelected$.next(t.leftUniqueTerms[w.data.node_id])}).selectAll(".rect").data(function(D){const w=[...t.heatmapArray[D.data.node_id]];return t.topDendgrogramLeavelIDs.map(x=>w[x]).reverse()}).enter().append("rect").attr("width",f).attr("height",S).attr("x",function(D,w){return p(w)}).style("stroke-width",0).style("fill",function(D,w){if(isNaN(D))return"white";{const C=d(D);return e(C)}})}_addYLabels(){let t=this;const e=t.marginLeft+t.verticalScaleIndicatorWidth+t.leftDendgroWidth+t.heatmapWidth,r=t.marginTop+t.horizontalScaleIndicatorHeight+t.topDendgroHeight;(0,s.Ys)(t.yLabels.nativeElement).attr("transform","translate("+e+" "+r+")").attr("visibility","hidden").selectAll(".yLabels").data(t.leftDendgrogramLeavels).enter().append("text").attr("transform",function(f,p){let c=f.data.yPos*t.heatmapHeight;return t.initialyLableYTranslate.push(c),"translate(0 "+c+")"}).text(function(f){return t.leftDisplayTerms[f.data.node_id]}).attr("dy","0.32em").style("font-size","1em")}_toggleYlabelsVisibility(t){(0,s.Ys)(this.yLabels.nativeElement).attr("visibility",t*this.heatmapInitRowHeight>=this.Y_LABLE_CHARACTER_HEIGHT?"visible":"hidden")}_toggleXlabelsVisibility(t){(0,s.Ys)(this.xLabels.nativeElement).attr("visibility",t*this.heatmapInitRectWidth>=this.X_LABLE_CHARACTER_WIDTH?"visible":"hidden")}_addXlabels(){let t=this;const e=t.heatmapWidth;(0,s.Ys)(t.xLabels.nativeElement).attr("transform","translate("+t.svgLeft2HeatmapWidth+" "+(t.svgTop2HeatmapHeight+t.heatmapHeight+15)+")").selectAll(".xLabels").data(t.topDendgrogramLeavels).enter().append("text").attr("transform",function(n,f){let p=n.data.yPos*e;return t.initialxLableXTranslate.push(p),"translate("+p+",0) rotate("+t.xLabelRotationDegree+")"}).text(function(n){return t.topDisplayTerms[n.data.node_id]}).style("text-anchor","end").attr("font-size",t.xLabelsFontSize+"em").attr("dy","0.32em")}_addCoverBoxes(){this._addleftDendgroCoverRects(),this._addHeatmapCoverRects(),this._addTopDendgroCoverRects(),this._addXlabelsCoverRects(),this._addYlabelsCoverRects(),this._addCoversForSelectingNodes()}_addleftDendgroCoverRects(){var t=this;let e=(0,s.Ys)(t.leftDendgroCoverRects.nativeElement).attr("transform","translate(0 0)");e.append("rect").attr("height",t.svgTop2HeatmapHeight).attr("width",t.svgLeft2HeatmapWidth).attr("fill","white"),e.append("rect").attr("width",t.svgLeft2HeatmapWidth).attr("height",t.height-t.svgTop2HeatmapHeight-t.heatmapHeight+10).attr("y",t.svgTop2HeatmapHeight+t.heatmapHeight).attr("fill","white")}_addHeatmapCoverRects(){var t=this;let e=(0,s.Ys)(t.heatmapCoverRects.nativeElement).attr("transform","translate(0 0)");e.append("rect").attr("height",t.svgTop2HeatmapHeight).attr("width",t.width).attr("fill","white"),e.append("rect").attr("x",0).attr("y",t.svgTop2HeatmapHeight+t.heatmapHeight).attr("width",t.width).attr("height",t.height-t.svgTop2HeatmapHeight-t.heatmapHeight+10).attr("fill","white"),e.append("rect").attr("y",t.svgTop2HeatmapHeight).attr("x",-2).attr("width",t.svgLeft2HeatmapWidth).attr("height",t.heatmapHeight).attr("fill","white"),e.append("rect").attr("x",t.svgLeft2HeatmapWidth+t.heatmapWidth).attr("y",t.svgTop2HeatmapHeight).attr("width",t.marginRight+2).attr("height",t.heatmapHeight).attr("fill","white")}_addTopDendgroCoverRects(){var t=this;let e=(0,s.Ys)(t.topDendgroCoverRects.nativeElement).attr("transform","translate(0 0)");e.append("rect").attr("height",t.svgTop2HeatmapHeight).attr("width",t.marginRight).attr("x",t.svgLeft2HeatmapWidth+t.heatmapWidth).attr("fill","white"),e.append("rect").attr("height",t.svgTop2HeatmapHeight).attr("width",t.svgLeft2HeatmapWidth).attr("fill","white")}_addXlabelsCoverRects(){var t=this;(0,s.Ys)(t.xLabelsCoverRects.nativeElement).append("rect").attr("x",0).attr("y",t.svgTop2HeatmapHeight+t.heatmapHeight).attr("width",t.marginLeft+t.verticalScaleIndicatorWidth).attr("height",t.marginBottom).attr("fill","white")}_addYlabelsCoverRects(){var t=this;let e=(0,s.Ys)(t.yLabelsCoverRects.nativeElement);const r=t.svgLeft2HeatmapWidth+t.heatmapWidth;e.append("rect").attr("id","yLableTopCover").attr("transform","translate("+r+" 0)").attr("width",t.marginRight).attr("height",t.svgTop2HeatmapHeight).attr("fill","white");const d=t.svgLeft2HeatmapWidth+t.heatmapWidth,n=t.svgTop2HeatmapHeight+t.heatmapHeight;e.append("rect").attr("id","yLableDownCover").attr("transform","translate("+d+" "+n+")").attr("width",t.marginRight).attr("height",t.marginBottom).attr("fill","white")}_highlightRowsAndPathsWhenSelectingNodesChangeingClass(t){(0,s.td_)(this.allLeftRowsSelector).attr("class","rowDim");let d=t.descendants().map(c=>"#LHNode"+c.data.node_id+",#LVNode"+c.data.node_id).toString();(0,s.td_)(d).classed("linkGrey",!1).classed("linkRed",!0);let p=t.leaves().map(c=>c.data.node_id).map(c=>"#row"+c).toString();""!=p&&(0,s.td_)(p).attr("class","rowNormal")}_disHighlightRowsAndPathsWhenSelectingNodesUsingCover(t){if((0,s.Ys)("#upCoverForSelectNodes").attr("visibility","hidden"),(0,s.Ys)("#downCoverForSelectNodes").attr("visibility","hidden"),t){const e=t.leaves(),d=t.data.node_id;(0,s.td_)("#LHNode"+d+",#LVNode"+d+",#LHNode"+e[0].data.node_id+",#LHNode"+e[e.length-1].data.node_id).classed("linkRed",!1).classed("linkGrey",!0)}}_disHighlightRowsAndPathsWhenSelectingNodesChangingClass(){this.allLeftRowsSelector&&(0,s.td_)(this.allLeftRowsSelector).classed("rowNormal",!0).classed("rowDim",!1),this.allLeftLinksSelector&&(0,s.td_)(this.allLeftLinksSelector).classed("linkRed",!1).classed("linkGrey",!0)}_resetSelectedPathNode(){this.selectedPathNode=null,this.selectedPathNodeIdentifier=null}_resetSelecteNodeIfClickedAttr(){this.selectedPathNodeIdentifier&&(0,s.Ys)(this.selectedPathNodeIdentifier).attr("ifClick",!1)}_disHighlightRowsAndPathsWhenSelectingNodes(t){"useCover"===this.highlightUseCoverOrClass?this._disHighlightRowsAndPathsWhenSelectingNodesUsingCover(t):this._disHighlightRowsAndPathsWhenSelectingNodesChangingClass()}_highlightRowsAndPathsWhenSelectingNodesUsingCover(t){const e=t.leaves(),d=t.data.node_id,n=e[e.length-1].data.node_id,f=e[0].data.node_id;(0,s.td_)("#LHNode"+d+",#LVNode"+d+",#LHNode"+f+",#LHNode"+n).classed("linkRed",!0).classed("linkGrey",!1);const c=this.leftDendgrogramLeavelsIDs.indexOf(n)+1,H=this.leftDendgrogramLeavelsIDs.indexOf(f)+1,l=this.transformOneDirectionInfo.realTranslateY,I=this.transformOneDirectionInfo.realScaleY;let v,y,S=l+I*this.heatmapHeight*(this.leftDendgrogramLeavelsLength-c)/this.leftDendgrogramLeavelsLength;l+I*this.heatmapHeight>=this.heatmapHeight?(v=this.heatmapHeight-(l+I*this.heatmapHeight*(this.leftDendgrogramLeavelsLength-H+1)/this.leftDendgrogramLeavelsLength),y=this.heatmapHeight-v):(y=l+I*this.heatmapHeight*(this.leftDendgrogramLeavelsLength-H+1)/this.leftDendgrogramLeavelsLength,v=l+I*this.heatmapHeight-y),S=S>=0?S:0,v=v>=0?v:0,(0,s.Ys)("#upCoverForSelectNodes").attr("height",S).attr("visibility","visible"),(0,s.Ys)("#downCoverForSelectNodes").attr("y",y).attr("height",v).attr("visibility","visible")}_highlightRowsAndPathsWhenSelectingNodes(t,e){"useCover"===this.highlightUseCoverOrClass?this._highlightRowsAndPathsWhenSelectingNodesUsingCover(t):this._highlightRowsAndPathsWhenSelectingNodesChangeingClass(t)}_outputSelectedNodes(t,e){if("false"===e){const d=t.leaves().map(n=>n.data.node_id).map(n=>this.leftUniqueTerms[n]);this.nodesSelected$.next({clickedNode:t.data.node_id.toString(),selectedNodes:d})}else this.nodesSelected$.next({clickedNode:"",selectedNodes:[]})}_addCoversForSelectingNodes(){let t=this;(0,s.Ys)(t.upCoverForSelectNodes.nativeElement).attr("transform","translate("+(t.marginLeft+t.verticalScaleIndicatorWidth)+" "+t.svgTop2HeatmapHeight+")").append("rect").attr("id","upCoverForSelectNodes").attr("width",t.leftDendgroWidth+t.heatmapWidth+t.marginRight).attr("height",0).attr("fill","white").attr("visibility","hidden").style("opacity",.9),(0,s.Ys)(t.downCoverForSelectNodes.nativeElement).attr("transform","translate("+(t.marginLeft+t.verticalScaleIndicatorWidth)+" "+t.svgTop2HeatmapHeight+")").append("rect").attr("id","downCoverForSelectNodes").attr("x",0).attr("y",0).attr("width",t.leftDendgroWidth+t.heatmapWidth+t.marginRight).attr("fill","white").attr("visibility","hidden").style("opacity",.9)}_addVerticalScaleIndicators(){var t=this;const e=this.heatmapHeight;let r=(0,s.Ys)(this.verticalScaleIndicators.nativeElement).attr("transform","translate("+t.marginLeft+" "+t.svgTop2HeatmapHeight+")"),d=r.append("g").attr("id","verticalScaleLinks");d.selectAll(".link").data(t.leftDendgroRoot.descendants().slice(1)).enter().append("path").attr("d",function(l){if(null!=l.parent.data.xPos)return"M"+t.verticalScaleIndicatorWidth*l.parent.data.xPos+" "+e*l.data.yPos+"H"+t.verticalScaleIndicatorWidth*l.data.xPos}).style("stroke","grey"),d.selectAll(".link").data(t.leftDendgroRoot.descendants().slice(1)).enter().append("path").attr("d",function(l){return null==l.parent.data.xPos||l.children?"M"+t.verticalScaleIndicatorWidth*l.data.xPos+" "+e*l.children[0].data.yPos+"L"+t.verticalScaleIndicatorWidth*l.data.xPos+" "+e*l.children[1].data.yPos:void 0}).style("stroke","grey"),r.append("rect").attr("id","indicatorUp").attr("height",0).attr("width",t.verticalScaleIndicatorWidth).attr("fill","grey").attr("fill-opacity",.5);var p=(0,s.ohM)().on("start",function(l,I){const v=(0,s.Ys)(this).attr("y")-l.y;I.deltaY=v}).on("drag",function(l,I){let S=(0,s.Ys)(this);const v=l.y+I.deltaY,y=parseFloat(S.attr("height"));let T;T=v<=0?0:v>=t.heatmapHeight-y?t.heatmapHeight-y:v;const C=t.heatmapHeight-T-y;t.zoomFromScaleBar$.next({sourceOrientation:"vertical",scaleBarSetting:{smallEndRectLong:T,middleRectLong:y,bigEndRectLong:C,indicatorLong:y+T+C}})});r.append("g").selectAll("rect").data([{deltaX:0,deltaY:0}]).enter().append("rect").attr("id","indicatorMiddle").attr("height",e).attr("width",t.verticalScaleIndicatorWidth).attr("x",0).attr("y",0).attr("fill","grey").attr("fill-opacity",.1).style("cursor","row-resize").call(p),r.append("rect").attr("id","indicatorDown").attr("height",0).attr("width",t.verticalScaleIndicatorWidth).attr("fill","grey").attr("fill-opacity",.5);var c=(0,s.ohM)().on("start",function(l,I){const v=(0,s.Ys)(this).attr("y")-l.y;I.deltaY=v}).on("drag",function(l,I){const S=parseFloat((0,s.Ys)("#moveBarDown").attr("y")),v=l.y+I.deltaY;if(v<S&&v>=-15&&l.y<=e){let y;y=l.y<=-t.VERTICAL_MOVE_BAR_HEIGHT?-t.VERTICAL_MOVE_BAR_HEIGHT:l.y>=e?e:l.y,(0,s.Ys)(this).attr("y",y);const T=S-y-t.VERTICAL_MOVE_BAR_HEIGHT,D=y+t.VERTICAL_MOVE_BAR_HEIGHT,w=e-S;t.zoomFromScaleBar$.next({sourceOrientation:"vertical",scaleBarSetting:{smallEndRectLong:D,middleRectLong:T,bigEndRectLong:w,indicatorLong:T+D+w}})}});r.append("g").selectAll("rect").data([{deltaY:0}]).enter().append("rect").attr("id","moveBarUp").attr("height",t.VERTICAL_MOVE_BAR_HEIGHT).attr("width",t.verticalScaleIndicatorWidth).attr("fill","black").style("cursor","row-resize").attr("y",-t.VERTICAL_MOVE_BAR_HEIGHT).call(c);var H=(0,s.ohM)().on("drag",function(l){const I=parseFloat((0,s.Ys)("#moveBarUp").attr("y")),S=l.y;if(S>=I+t.VERTICAL_MOVE_BAR_HEIGHT&&S>=-15&&S<=e+5){let v;v=l.y<=-t.VERTICAL_MOVE_BAR_HEIGHT?-t.VERTICAL_MOVE_BAR_HEIGHT:l.y>=e?e:S,(0,s.Ys)(this).attr("y",v);const y=v-I-t.VERTICAL_MOVE_BAR_HEIGHT,T=I+t.VERTICAL_MOVE_BAR_HEIGHT,D=e-v;t.zoomFromScaleBar$.next({sourceOrientation:"vertical",scaleBarSetting:{smallEndRectLong:T,middleRectLong:y,bigEndRectLong:D,indicatorLong:y+T+D}})}});r.append("rect").attr("id","moveBarDown").attr("height",t.VERTICAL_MOVE_BAR_HEIGHT).attr("width",t.verticalScaleIndicatorWidth).attr("y",e).attr("fill","black").style("cursor","row-resize").call(H)}_modifyVerticalScaleIndicatorsFromScroll(t,e){const r=this._converRoomEventParameters2VerticalIndicatorSettings(t,e);this._modifyVerticalScaleIndicators(r.smallEndRectLong,r.middleRectLong,r.bigEndRectLong,r.indicatorLong,this.VERTICAL_MOVE_BAR_HEIGHT)}_modifyVerticalScaleIndicators(t,e,r,d,n){(0,s.Ys)("#verticalScaleLinks").attr("transform","translate(0 0) scale(1 "+d/this.heatmapHeight+")"),(0,s.Ys)("#indicatorUp").attr("height",t),(0,s.Ys)("#indicatorMiddle").attr("height",e).attr("y",t),(0,s.Ys)("#indicatorDown").attr("height",r).attr("y",t+e),(0,s.Ys)("#moveBarUp").attr("y",t-n),(0,s.Ys)("#moveBarDown").attr("y",t+e)}_addHorizontalScaleIndicators(){var t=this;let e=(0,s.Ys)(this.horizontalScaleIndicators.nativeElement).attr("transform","translate("+t.svgLeft2HeatmapWidth+" "+t.marginTop+")"),r=e.append("g").attr("id","horizonalScaleLinks");r.selectAll(".link").data(t.topDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","topVerticalLink").attr("id",function(l){return"topNode"+l.data.node_id}).attr("d",function(l){if(null!=l.parent.data.yPos)return"M"+t.heatmapWidth*l.data.yPos+" "+t.horizontalScaleIndicatorHeight*l.parent.data.xPos+"V"+t.horizontalScaleIndicatorHeight*l.data.xPos}).style("stroke","grey"),r.selectAll(".link").data(t.topDendgroRoot.descendants().slice(1)).enter().append("path").attr("class","topHorizontalLink").attr("id",function(l){return"topNode"+l.data.node_id}).attr("d",function(l){return null==l.parent.data.yPos||l.children?"M"+t.heatmapWidth*l.children[0].data.yPos+" "+t.horizontalScaleIndicatorHeight*l.data.xPos+"L"+t.heatmapWidth*l.children[1].data.yPos+" "+t.horizontalScaleIndicatorHeight*l.data.xPos:void 0}).style("stroke","grey"),e.append("rect").attr("id","topIndicatorLeft").attr("height",t.horizontalScaleIndicatorHeight).attr("width",0).attr("fill","grey").attr("fill-opacity",.5);var f=(0,s.ohM)().on("start",function(l,I){const v=(0,s.Ys)(this).attr("x")-l.x;I.deltaX=v}).on("drag",function(l,I){let S=(0,s.Ys)(this);const v=l.x+I.deltaX,y=parseFloat(S.attr("width"));let T;T=v<=0?0:v>=t.heatmapWidth-y?t.heatmapWidth-y:v;const C=t.heatmapWidth-T-y;t.zoomFromScaleBar$.next({sourceOrientation:"horizontal",scaleBarSetting:{smallEndRectLong:T,middleRectLong:y,bigEndRectLong:C,indicatorLong:T+y+C}})});e.append("g").selectAll("rect").data([{deltaX:0,deltaY:0}]).enter().append("rect").attr("id","topIndicatorMiddle").attr("height",t.horizontalScaleIndicatorHeight).attr("width",t.heatmapWidth).attr("fill","grey").attr("fill-opacity",.1).style("cursor","col-resize").call(f),e.append("rect").attr("id","topIndicatorRight").attr("height",t.horizontalScaleIndicatorHeight).attr("width",0).attr("fill","grey").attr("fill-opacity",.5);var c=(0,s.ohM)().on("start",function(l,I){const v=(0,s.Ys)(this).attr("x")-l.x;I.deltaX=v}).on("drag",function(l){const I=parseFloat((0,s.Ys)("#moveBarRight").attr("x")),S=l.x;if(S<I&&S>=-15&&S<=t.heatmapWidth){let v;v=S<=-t.HORIZONAL_MOVE_BAR_WIDTH?-t.HORIZONAL_MOVE_BAR_WIDTH:S>=t.heatmapWidth?t.heatmapWidth:S,(0,s.Ys)(this).attr("x",v);const y=I-v-t.HORIZONAL_MOVE_BAR_WIDTH,T=v+t.HORIZONAL_MOVE_BAR_WIDTH,D=t.heatmapWidth-I;t.zoomFromScaleBar$.next({sourceOrientation:"horizontal",scaleBarSetting:{smallEndRectLong:T,middleRectLong:y,bigEndRectLong:D,indicatorLong:T+y+D}})}});e.append("g").selectAll("rect").data([{deltaX:0}]).enter().append("rect").attr("id","moveBarLeft").attr("height",t.horizontalScaleIndicatorHeight).attr("width",t.HORIZONAL_MOVE_BAR_WIDTH).attr("fill","black").style("cursor","col-resize").attr("x",-t.HORIZONAL_MOVE_BAR_WIDTH).call(c);var H=(0,s.ohM)().on("drag",function(l){const I=parseFloat((0,s.Ys)("#moveBarLeft").attr("x")),S=l.x;if(S>I+t.HORIZONAL_MOVE_BAR_WIDTH&&S<=t.heatmapWidth+t.HORIZONAL_MOVE_BAR_WIDTH){let v;v=S<=-t.HORIZONAL_MOVE_BAR_WIDTH?-t.HORIZONAL_MOVE_BAR_WIDTH:S>=t.heatmapWidth?t.heatmapWidth:S,(0,s.Ys)(this).attr("x",v);const y=v-I-t.HORIZONAL_MOVE_BAR_WIDTH,T=I+t.HORIZONAL_MOVE_BAR_WIDTH,D=t.heatmapWidth-v;t.zoomFromScaleBar$.next({sourceOrientation:"horizontal",scaleBarSetting:{smallEndRectLong:T,middleRectLong:y,bigEndRectLong:D,indicatorLong:T+y+D}})}});e.append("rect").attr("id","moveBarRight").attr("height",t.horizontalScaleIndicatorHeight).attr("width",10).attr("x",t.heatmapWidth).attr("fill","black").style("cursor","col-resize").call(H)}_computeHorizontalIndicatorSettings(t,e,r){const d=this;let n=d.heatmapWidth;t+e*d.heatmapWidth<=d.heatmapWidth&&(n=e*d.heatmapWidth+t);const f=n/(e*d.heatmapWidth),p=-t*f,c=n*f;let H=n-p-c;return H<0&&(H=0),{smallEndRectLong:p,middleRectLong:c,bigEndRectLong:H,indicatorLong:n}}_modifyHorizontalScaleIndicatorsFromScroll(t,e){const r=this._computeHorizontalIndicatorSettings(t,e,this.HORIZONAL_MOVE_BAR_WIDTH);this._modifyHorizontalScaleIndicators(r.smallEndRectLong,r.middleRectLong,r.bigEndRectLong,r.indicatorLong,this.HORIZONAL_MOVE_BAR_WIDTH)}_modifyHorizontalScaleIndicators(t,e,r,d,n){(0,s.Ys)("#horizonalScaleLinks").attr("transform","scale("+d/this.heatmapWidth+",1)"),(0,s.Ys)("#topIndicatorLeft").attr("width",t),(0,s.Ys)("#topIndicatorMiddle").attr("width",e).attr("x",t),(0,s.Ys)("#topIndicatorRight").attr("width",r).attr("x",t+e),(0,s.Ys)("#moveBarLeft").attr("x",t-n),(0,s.Ys)("#moveBarRight").attr("x",t+e)}_convertScrollBarParameters2zoomParameters(t,e,r){const{smallEndRectLong:d,middleRectLong:n,indicatorLong:p}=Object.assign({},e),c=p/n,H=-d*c;return"vertical"===t?Object.assign(Object.assign({},r),{realScaleY:c,realTranslateY:H}):"horizontal"===t?Object.assign(Object.assign({},r),{realScaleX:c,realTranslateX:H}):void 0}_converRoomEventParameters2VerticalIndicatorSettings(t,e){const r=this;let d=r.heatmapHeight;t+e*r.heatmapHeight<=r.heatmapHeight&&(d=e*r.heatmapHeight+t);const n=d/(e*r.heatmapHeight),f=-t*n,p=d*n;let c=d-f-p;return c<0&&(c=0),{smallEndRectLong:f,middleRectLong:p,bigEndRectLong:c,indicatorLong:d}}_zoomMap(){this.d3Svg.node().__zoom=s.CRH}_computeRealZoomValues(t,e,r,d,n){const f=this;let p,c,H,l,I=t,S=e,v=r;if(f._determineIfPointerInElement(f.leftDendgrogram.nativeElement,d,n)||f._determineIfPointerInElement(f.yLabels.nativeElement,d,n))c=e-this.transformOneDirectionInfo.zoomTranslateY+f.transformOneDirectionInfo.realTranslateY,l=r-this.transformOneDirectionInfo.zoomScale+this.transformOneDirectionInfo.realScaleY,p=this.transformOneDirectionInfo.realTranslateX,H=this.transformOneDirectionInfo.realScaleX,c+l*f.heatmapHeight<=f.heatmapHeight&&(c=(1-l)*f.heatmapHeight),c>=0&&(c=0);else if(f._determineIfPointerInElement(f.topDendgrogram.nativeElement,d,n)||f._determineIfPointerInElement(f.xLabels.nativeElement,d,n)){if(p=t-this.transformOneDirectionInfo.zoomTranslateX+this.transformOneDirectionInfo.realTranslateX,H=r-this.transformOneDirectionInfo.zoomScale+this.transformOneDirectionInfo.realScaleX,c=this.transformOneDirectionInfo.realTranslateY,l=this.transformOneDirectionInfo.realScaleY,p+H*f.heatmapWidth<=.5*f.heatmapWidth&&(p=(.5-H)*f.heatmapWidth),p>=0&&(p=0),H<=.1)return Object.assign({},this.transformOneDirectionInfo)}else{if(!f._determineIfPointerInElement(f.heatmap.nativeElement,d,n))return Object.assign({},this.transformOneDirectionInfo);if(p=t-this.transformOneDirectionInfo.zoomTranslateX+this.transformOneDirectionInfo.realTranslateX,H=r-this.transformOneDirectionInfo.zoomScale+this.transformOneDirectionInfo.realScaleX,c=e-this.transformOneDirectionInfo.zoomTranslateY+f.transformOneDirectionInfo.realTranslateY,l=r-this.transformOneDirectionInfo.zoomScale+this.transformOneDirectionInfo.realScaleY,c+l*f.heatmapHeight<=.5*f.heatmapHeight&&(c=(.5-l)*f.heatmapHeight),c>=0&&(c=0),l<=.1)return Object.assign({},this.transformOneDirectionInfo);if(p+H*f.heatmapWidth<=.5*f.heatmapWidth&&(p=(.5-H)*f.heatmapWidth),p>=0&&(p=0),H<=.1)return Object.assign({},this.transformOneDirectionInfo)}return{realTranslateX:p,realTranslateY:c,realScaleX:H,realScaleY:l,zoomTranslateX:I,zoomTranslateY:S,zoomScale:v}}_updateTransformInfo(t){this.transformOneDirectionInfo=Object.assign({},t)}_updateD3svg__zoom(t,e,r){let d=this.d3Svg.node(),n=s.CRH;n=n.translate(t,e),n=n.scale(r),d.__zoom=n}_transformMapUsingRealZoomValues(t,e,r,d){const n=this,f=(0,s.Ys)(n.leftDendgrogram.nativeElement),p=(0,s.Ys)(n.heatmap.nativeElement),c=(0,s.Ys)(n.topDendgrogram.nativeElement),H=(0,s.Ys)(n.yLabels.nativeElement),l=(0,s.Ys)(n.xLabels.nativeElement),T=((0,s.Ys)("#yLableTopCover"),(0,s.Ys)("#yLableDownCover"),n.svgLeft2HeatmapWidth+t),D=n.svgTop2HeatmapHeight+e,w=n.svgLeft2HeatmapWidth+t,C=n.marginTop+n.horizontalScaleIndicatorHeight+n.dendgroIndicatorGap;let x=n.svgLeft2HeatmapWidth+r*n.heatmapWidth+t;const ut=n.svgTop2HeatmapHeight+e,J=n.svgLeft2HeatmapWidth+t;let it=n.svgTop2HeatmapHeight+e+d*n.heatmapHeight;e+d*n.heatmapHeight>=n.heatmapHeight&&(it=n.svgTop2HeatmapHeight+n.heatmapHeight+15),t+r*n.heatmapWidth>=n.heatmapWidth&&(x=n.svgLeft2HeatmapWidth+n.heatmapWidth+5),f.attr("transform","translate("+(n.marginLeft+n.verticalScaleIndicatorWidth+n.dendgroIndicatorGap)+" "+(n.svgTop2HeatmapHeight+e)+") scale(1 "+d+")"),p.attr("transform","translate("+T+" "+D+") scale("+r+" "+d+")"),c.attr("transform","translate("+w+" "+C+") scale("+r+" 1)"),H.attr("transform","translate("+x+" "+ut+") scale(1 1)"),l.attr("transform","translate("+J+" "+it+")");const Ht=n.initialxLableXTranslate.length;l.selectAll("text").attr("transform",function(vt,et){return"translate("+r*(n.initialxLableXTranslate[0]-n.initialxLableXTranslate[1])*(Ht-1-et+.5)+" 0)rotate("+n.xLabelRotationDegree+")"});const ft=n.initialyLableYTranslate.length;H.selectAll("text").attr("transform",function(vt,et){return"translate(0,"+d*(n.initialyLableYTranslate[0]-n.initialyLableYTranslate[1])*(ft-1-et+.5)+")"}),n.d3Svg.selectAll(".topVerticalLink").attr("stroke-width",1/r+"px"),n.d3Svg.selectAll(".leftHorizontalLink").attr("stroke-width",1/d+"px")}_transformInitalMap(){const e=this.hierarchicalResultForDisplay.transform;this._transformMapUsingRealZoomValues(e.realTranslateX?e.realTranslateX:0,e.realTranslateY?e.realTranslateY:0,e.realScaleX?e.realScaleX:1,e.realScaleY?e.realScaleY:1)}_determineIfPointerInElement(t,e,r){const d=t.getBoundingClientRect();return e>=d.x&&e<=d.x+d.width&&r>=d.y&&r<=d.y+d.height}_obtainMarginRight(){let t=0;const e=(0,Z.H)(1);return this.leftDisplayTerms.forEach(r=>{const d=(null==r?void 0:r.length)*e;d>t&&(t=d)}),t+5}_obtainMarginBottom(){let t=0;const e=(0,Z.H)(this.xLabelsFontSize);return this.topDisplayTerms.forEach(r=>{const d=-this.xLabelRotationDegree*Math.PI/180,n=r.length*e*Math.sin(d)+1.32*e*Math.cos(d);n>t&&(t=n)}),t+5}}return j.\u0275fac=function(t){return new(t||j)(i.Y36(i.sBO))},j.\u0275cmp=i.Xpm({type:j,selectors:[["app-dendgrogram-vis"]],viewQuery:function(t,e){if(1&t&&(i.Gf(Q,5),i.Gf(q,5),i.Gf(P,5),i.Gf(U,5),i.Gf(E,5),i.Gf(tt,5),i.Gf(nt,5),i.Gf(A,5),i.Gf(ot,5),i.Gf(st,5),i.Gf(lt,5),i.Gf(ht,5),i.Gf(dt,5),i.Gf(ct,5),i.Gf(gt,5),i.Gf(mt,5)),2&t){let r;i.iGM(r=i.CRH())&&(e.svgContainer=r.first),i.iGM(r=i.CRH())&&(e.svgElement=r.first),i.iGM(r=i.CRH())&&(e.heatmap=r.first),i.iGM(r=i.CRH())&&(e.heatmapCoverRects=r.first),i.iGM(r=i.CRH())&&(e.verticalScaleIndicators=r.first),i.iGM(r=i.CRH())&&(e.leftDendgrogram=r.first),i.iGM(r=i.CRH())&&(e.leftDendgroCoverRects=r.first),i.iGM(r=i.CRH())&&(e.horizontalScaleIndicators=r.first),i.iGM(r=i.CRH())&&(e.topDendgrogram=r.first),i.iGM(r=i.CRH())&&(e.topDendgroCoverRects=r.first),i.iGM(r=i.CRH())&&(e.xLabels=r.first),i.iGM(r=i.CRH())&&(e.xLabelsCoverRects=r.first),i.iGM(r=i.CRH())&&(e.yLabels=r.first),i.iGM(r=i.CRH())&&(e.yLabelsCoverRects=r.first),i.iGM(r=i.CRH())&&(e.upCoverForSelectNodes=r.first),i.iGM(r=i.CRH())&&(e.downCoverForSelectNodes=r.first)}},inputs:{hierarchicalResultForDisplay:"hierarchicalResultForDisplay",auditTime:"auditTime",disSelectedNodes:"disSelectedNodes",highlightUseCoverOrClass:"highlightUseCoverOrClass"},outputs:{nodesSelected$:"nodesSelected$",nodeSelected$:"nodeSelected$",mapSettings$:"mapSettings$"},features:[i.TTD],decls:32,vars:0,consts:[[2,"height","70vh"],["svgContainer",""],["svgElement",""],["data-testid","heatmap"],["heatmap",""],["heatmapCoverRects",""],["data-testid","leftDendgrogram"],["leftDendgrogram",""],["leftDendgroCoverRects",""],["data-testid","topDendgrogram"],["topDendgrogram",""],["topDendgroCoverRects",""],["data-testid","xLabels"],["xLabels",""],["xLabelsCoverRects",""],["data-testid","yLabels"],["yLabels",""],["yLabelsCoverRects",""],["upCoverForSelectNodes",""],["downCoverForSelectNodes",""],["verticalScaleIndicators",""],["horizontalScaleIndicators",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0,1),i.O4$(),i.TgZ(2,"svg",null,2),i._UZ(4,"g",3,4),i._UZ(6,"g",null,5),i._UZ(8,"g",6,7),i._UZ(10,"g",null,8),i._UZ(12,"g",9,10),i._UZ(14,"g",null,11),i._UZ(16,"g",12,13),i._UZ(18,"g",null,14),i._UZ(20,"g",15,16),i._UZ(22,"g",null,17),i._UZ(24,"g",null,18),i._UZ(26,"g",null,19),i._UZ(28,"g",null,20),i._UZ(30,"g",null,21),i.qZA(),i.qZA())},styles:[".rowNormal{opacity:1}.rowDim{opacity:.5}.linkRed{stroke:red}.linkGrey{stroke:gray}\n"],encapsulation:2,changeDetection:0}),j})()},1954:(rt,V,L)=>{L.d(V,{W:()=>q});var i=L(3668),s=L(9133),b=L(3405),G=L(8735),N=L(8805),X=L(5389),M=L(6019);function $(P,U){if(1&P&&(i.TgZ(0,"h5"),i._uU(1),i.qZA()),2&P){const E=i.oxw(2);i.xp6(1),i.hij("",E.itemLabel,":")}}const Z=function(P){return{"form-inline":P}};function Q(P,U){if(1&P&&(i.TgZ(0,"form",1),i.TgZ(1,"div",2),i.YNc(2,$,2,1,"h5",3),i.TgZ(3,"label"),i._UZ(4,"input",4),i.TgZ(5,"span"),i._uU(6),i.qZA(),i.qZA(),i.TgZ(7,"label"),i._UZ(8,"input",4),i.TgZ(9,"span"),i._uU(10),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&P){const E=i.oxw();i.Q6J("formGroup",E.itemForm),i.xp6(1),i.Q6J("ngClass",i.VKq(7,Z,E.formInlineOrNot)),i.xp6(1),i.Q6J("ngIf",E.ifShowLabel),i.xp6(2),i.Q6J("value",E.inputItems[0]),i.xp6(2),i.Oqu(E.inputItems[0]),i.xp6(2),i.Q6J("value",E.inputItems[1]),i.xp6(2),i.Oqu(E.inputItems[1])}}let q=(()=>{class P{constructor(E){this.cdr=E,this.inputItems=[],this.formInlineOrNot=!0,this.ifShowLabel=!1,this.resetToDefault=!1,this.selectedItem$=new i.vpe,this.destroyNotifier$=new b.xQ,this.ifOutputFirstValue=!0,this.itemForm=new s.cw({itemValue:new s.NI("",s.kI.required)})}ngOnInit(){this.itemForm.get("itemValue").valueChanges.pipe((0,G.h)(E=>E),(0,N.R)(this.destroyNotifier$),(0,X.x)()).subscribe(E=>{"VALID"===this.itemForm.get("itemValue").status&&this.selectedItem$.next(E),this.cdr.detectChanges()}),this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnChanges(E){E.inputItems&&!E.inputItems.isFirstChange()&&this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem(),E.resetToDefault&&!E.resetToDefault.isFirstChange()&&this.resetToDefault&&this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_outputSetFirstItemAsSelctedItem(){this.inputItems&&this.inputItems.length>=1&&this.itemForm.patchValue({itemValue:this.inputItems[0]})}}return P.\u0275fac=function(E){return new(E||P)(i.Y36(i.sBO))},P.\u0275cmp=i.Xpm({type:P,selectors:[["app-select-between-two-using-radio"]],inputs:{inputItems:"inputItems",itemLabel:"itemLabel",formInlineOrNot:"formInlineOrNot",ifShowLabel:"ifShowLabel",resetToDefault:"resetToDefault"},outputs:{selectedItem$:"selectedItem$"},features:[i.TTD],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[3,"ngClass"],[4,"ngIf"],["type","radio","formControlName","itemValue",3,"value"]],template:function(E,tt){1&E&&i.YNc(0,Q,11,9,"form",0),2&E&&i.Q6J("ngIf",2===tt.inputItems.length)},directives:[M.O5,s._Y,s.JL,s.sg,M.mk,s._,s.Fj,s.JJ,s.u],styles:[""],changeDetection:0}),P})()}}]);