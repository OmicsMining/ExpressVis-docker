"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[399],{7582:(nt,E,p)=>{p.d(E,{q:()=>l});const l=(u,T)=>u<T?-1:u>T?1:0},8466:(nt,E,p)=>{p.r(E),p.d(E,{SurvivalExpModule:()=>sn});var l=p(6019),u=p(9133),T=p(7695),Z=p(8638),R=p(9256),F=p(3856),$=p(3667),P=p(8702),m=p(3928),C=p(5658),v=p(1144),t=p(3668),_=p(4099),J=p(2668),_t=p(4102),S=p(8735),D=p(8053),Vt=p(1366),Q=p(1125),H=p(5571),vt=p(9220),tt=p(6813),h=p(8472),N=p(9204),A=p(6636),jt=p(7194),et=p(7473),Ht=p(9744),St=p(8425),kt=p(661),Yt=p(1118),rt=p(7548),Dt=p(1890),Wt=p(8970),yt=p(1672);const st=n=>n.survivalExpState.datasetGeneListSurvivalResultState,zt=(0,h.P1)(st,(n,o)=>n.entities[o.ID].survivalAnno),bt=(0,h.P1)(st,(n,o)=>n.ids),It=(0,h.P1)(bt,(n,o)=>n.indexOf(o.ID)>=0),Qt=(0,h.P1)(st,(n,o)=>{const e=n.entities[o.ID].survivalSplit;return{endpointTime:e.endpointTime,endpointStatus:e.endpointStatus,highOrLows:e[o.geneID]}}),Kt=(0,h.P1)(st,(n,o)=>{const i=n.entities[o.ID].survivalAnno,s=i.Variable.indexOf(o.geneID),a={};for(const c of Object.keys(i))a[c]=i[c][s];return a});var k=p(9232),pt=p(613);const ct=n=>n.localFollowUpDataState,xt=(0,h.P1)(ct,pt.j8),Bt=(0,h.P1)(ct,pt.jw),Xt=(0,h.P1)(Bt,n=>(null==n?void 0:n.length)>=1?n[n.length-1].toString():null),K=(0,h.P1)(ct,pt.bJ),Ct=(0,h.P1)(xt,(n,o)=>{const e=o.datasetID;let i=!1;return n.forEach(s=>{s.hasOwnProperty("relatedDatasetID")&&s.relatedDatasetID===e&&(i=!0)}),i}),wt=(0,h.P1)(K,(n,o)=>n[o.ID].followUpInfo),Tt=((0,h.P1)(K,(n,o)=>n[o.ID].followUpInfo.followUpAttributes),(0,h.P1)(K,(n,o)=>[...new Set(n[o.ID].followUpInfo.followUpAttrValues[o.statusAttribute])]),(0,h.P1)(K,(n,o)=>n[o.ID].followUpInfo.followUpAttrValues[o.attributeName])),te=(0,h.P1)(K,(n,o)=>n[o.ID].followUpInfo.patientIDs),At=(0,h.P1)(K,(n,o)=>{const i=o.endpointStatusAttribute,s=o.endpointTimesAttribute,a=n[o.ID],c=a.sample2patientID,d=o.samples.map(y=>c[y]),r=(0,k.Wv)(d,a.followUpInfo.patientIDs),g=a.followUpInfo.followUpAttrValues[s],f=a.followUpInfo.followUpAttrValues[i];return{endpointTime:r.map(y=>parseFloat(g[y])),endpointStatus:r.map(y=>parseInt(f[y])),patientIDs:d,endpointTimeCol:"endpointTime",endpointStatusCol:"endpointStatus"}});var ee=p(5911);const Zt=function(n){let o;if("maxstatSplit"===n.highLowSplitSetting.method){const i=n.highLowSplitSetting;o=["split",i.method,i.settings.minProb,i.settings.maxProb].join("-")}else if("percentageSplit"===n.highLowSplitSetting.method){const i=n.highLowSplitSetting;o=["split",i.method,i.settings.percentageThreshold].join("-")}const e=["end",n.endpointSettings.timesAttribute,n.endpointSettings.statusAttribute].join("-");return[n.datasetID,n.groupName,n.geneListID,o,e].join("/")},at=function(n){return"related-with-"+n};var ne=p(7499),it=p(4522),ut=p(8260),Y=p(172),gt=p(2047);let se=(()=>{class n{constructor(e){this.http=e,this.survivalRequestUrl=ut.N.serverUrl+"restful/clinical/localDataSurvivalAndForest/",this.KMrequestUrl=ut.N.serverUrl+"restful/clinical/localDataKMinfoForPlot/",this.categoryKMrequestUrl=ut.N.serverUrl+"restful/clinical/localDataCategoryKMinfoForPlot/"}handleResponse(e){return e.type===it.dt.Response?e.body:Y.E}requestLocaldDataSurvival(e){const i=new it.aW("POST",this.survivalRequestUrl,e,{reportProgress:!1,responseType:"json"});return this.http.request(i).pipe((0,D.U)(s=>this.handleResponse(s)),(0,gt.K)(s=>Y.E),(0,S.h)(s=>s!==Y.E))}requestKMdataInfoForPlot(e){const i=new it.aW("POST",this.KMrequestUrl,e,{reportProgress:!1,responseType:"json"});return this.http.request(i).pipe((0,D.U)(s=>this.handleResponse(s)),(0,gt.K)(s=>Y.E),(0,S.h)(s=>s!==Y.E))}requestCategoryKMdataInfoForPlot(e){const i=new it.aW("POST",this.categoryKMrequestUrl,e,{reportProgress:!1,responseType:"json"});return this.http.request(i).pipe((0,D.U)(s=>this.handleResponse(s)),(0,gt.K)(s=>Y.E),(0,S.h)(s=>s!==Y.E))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(it.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ae=p(9990),oe=p(4205),le=p(5535),re=p(4473);let dt=(()=>{class n extends jt.g{constructor(e,i,s,a,c,d){super(e,a,c,d),this.store=e,this.survivalRequestService=i,this.trySamppleService=s,this.selectedDatasetSubject=new _.X(null),this.speciesIDsubject=new _.X(null),this.geneIDtypeSubject=new _.X(null),this.datasetGeneListSurvivalRequest$=new _.X(null),this.survivalResultIDforRequest$=new _.X(null),this.oneGeneForKMinfoRequesSubject=new _.X(null),this.followUPdataIDsubject=new _.X(null),this.categoryKMlineDataInfoForPlotSubject=new _.X(null),this.categorySurvivalRequestInfoSubject=new _.X(null),this.allDatasetInfoForDisplay$=this.store.pipe((0,h.Ys)(et.yz)).pipe((0,D.U)(r=>[...r].reverse())),this.availableFollowUpDataIDs$=this.store.pipe((0,h.Ys)(xt)).pipe((0,D.U)(r=>r.map(g=>g.ID))),this.availableGeneListNames$=this.store.pipe((0,h.Ys)(St.Dm),(0,D.U)(r=>(0,k.NT)(r))),this.allSurvivalResultIDs$=this.store.pipe((0,h.Ys)(bt),(0,D.U)(r=>(0,k.NT)(r))),this.ifSelectedDatasetHasClinical$=this.selectedDatasetSubject.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>this.store.pipe((0,h.Ys)(Ct,{datasetID:r})))),this.latestDatasetIDhasClinical$=this.store.pipe((0,h.Ys)(rt.Xl)),this.latestFollowUpDataID$=this.store.pipe((0,h.Ys)(Xt)),this.datasetGroupNames$=this.selectedDatasetSubject.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>this.store.pipe((0,h.Ys)(et.XF,{datasetID:r})))),this.followUpDataInfoForGenes$=this.selectedDatasetSubject.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>this.store.pipe((0,h.Ys)(Ct,{datasetID:r}),(0,S.h)(g=>g),(0,N.w)(g=>{const f=at(r);return this.store.pipe((0,h.Ys)(wt,{ID:f}),(0,A.q)(1))})))),this.datasetGeneListSurvivalRequest$.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>{const g=Zt(r);return this.store.pipe((0,h.Ys)(It,{ID:g}),(0,A.q)(1),(0,S.h)(f=>!f),(0,D.U)(f=>r))}),(0,N.w)(r=>{const g=r.datasetID,f=r.endpointSettings,b=Zt(r),I=this.store.pipe((0,h.Ys)(et.iR,{datasetID:g}),(0,A.q)(1)),y=this.store.pipe((0,h.Ys)(St.Vq,{ID:r.geneListID}),(0,A.q)(1)),w=this.store.pipe((0,h.Ys)(et.df,{datasetID:r.datasetID,groupName:r.groupName}),(0,A.q)(1));return(0,tt.D)([I,y,w]).pipe((0,N.w)(([G,q,V])=>{if(q.IDtype===G.IDtype){const L=this.store.pipe((0,h.Ys)(rt.to,{datasetID:r.datasetID,geneIDs:q.genes,samples:V}),(0,A.q)(1)),O=this.store.pipe((0,h.Ys)(At,{ID:at(r.datasetID),samples:V,endpointStatusAttribute:f.statusAttribute,endpointTimesAttribute:f.timesAttribute}),(0,A.q)(1));return(0,tt.D)([L,O]).pipe((0,D.U)(([z,j])=>({clinicalDic:{endpointTime:j.endpointTime,endpointStatus:j.endpointStatus},patientIDs:j.patientIDs,endpointTimeCol:j.endpointTimeCol,endpointStatusCol:j.endpointStatusCol,expressionDic:z})))}return this.store.pipe((0,h.Ys)(Dt.by,{ID:`${q.speciesID}-${G.IDtype}`,symbols:q.genes}),(0,A.q)(1),(0,N.w)(O=>{const z=this.store.pipe((0,h.Ys)(rt.to,{datasetID:r.datasetID,geneIDs:O,samples:V}),(0,A.q)(1)),j=this.store.pipe((0,h.Ys)(At,{ID:at(r.datasetID),samples:V,endpointStatusAttribute:f.statusAttribute,endpointTimesAttribute:f.timesAttribute}),(0,A.q)(1));return(0,tt.D)([z,j]).pipe((0,D.U)(([lt,U])=>({clinicalDic:{endpointTime:U.endpointTime,endpointStatus:U.endpointStatus},patientIDs:U.patientIDs,endpointTimeCol:U.endpointTimeCol,endpointStatusCol:U.endpointStatusCol,expressionDic:lt})))}))}),(0,D.U)(G=>Object.assign(Object.assign({},G),{highLowSplitSetting:r.highLowSplitSetting})),(0,N.w)(G=>this.survivalRequestService.requestLocaldDataSurvival(G)),(0,D.U)(G=>Object.assign(Object.assign({},G),{ID:b})))})).subscribe(r=>{this.store.dispatch(yt.X({survivalResult:r}))}),this.datasetGeneListSurvivalAnno$=this.survivalResultIDforRequest$.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>this.store.pipe((0,h.Ys)(It,{ID:r}),(0,A.q)(1),(0,S.h)(g=>g),(0,D.U)(g=>r))),(0,N.w)(r=>this.store.pipe((0,h.Ys)(zt,{ID:r}),(0,A.q)(1)))),this.survivalResultIDforRequest$.pipe((0,S.h)(r=>null!=r),(0,D.U)(r=>function(n){return n.split("/")[0]}(r)),(0,N.w)(r=>this.store.pipe((0,h.Ys)(et.iR,{datasetID:r}),(0,A.q)(1)))).subscribe(r=>{this.selectedDatasetSubject.next(null==r?void 0:r.datasetID),this.speciesIDsubject.next(null==r?void 0:r.speciesID),this.geneIDtypeSubject.next(null==r?void 0:r.IDtype)}),this.oneGeneKMlineDataInfoForPlot$=this.oneGeneForKMinfoRequesSubject.pipe((0,S.h)(r=>null!=r),(0,H.M)(this.survivalResultIDforRequest$,this.speciesIDsubject,this.geneIDtypeSubject),(0,N.w)(([r,g,f,b])=>{const I=(0,ne.sj)(f,b),y=this.store.pipe((0,h.Ys)(Dt.ek,{IDtype:I,geneID:r}),(0,A.q)(1)),w=this.store.pipe((0,h.Ys)(Kt,{ID:g,geneID:r}),(0,A.q)(1)),G=this.store.pipe((0,h.Ys)(Qt,{ID:g,geneID:r}),(0,A.q)(1)).pipe((0,N.w)(q=>this.survivalRequestService.requestKMdataInfoForPlot({eventTimes:q.endpointTime,eventStatus:q.endpointStatus,highOrLows:q.highOrLows}).pipe((0,D.U)(L=>{let O=[];const z=Array.from(new Set(L.Label));for(const j of z){let lt={label:j,data:[]};for(let U=0;U<L.Label.length;U++)L.Label[U]===j&&lt.data.push({timeLine:L.TimeLine[U],probability:L.Probability[U],obversed:L.Obversed[U],censored:L.Censored[U],riskNumber:L["Number at Risk"][U]});O.push(lt)}return O}))));return(0,tt.D)([y,w,G]).pipe((0,D.U)(([q,V,L])=>({geneInfo:q,KMlineDataInfos:L,survivalAnno:V})))})),this.followUpDataInfoForClinicalFeature$=this.followUPdataIDsubject.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>this.store.pipe((0,h.Ys)(wt,{ID:r}),(0,A.q)(1)))),this.categorySurvivalRequestInfoSubject.pipe((0,S.h)(r=>null!=r),(0,N.w)(r=>{const g=this.store.pipe((0,h.Ys)(Tt,{ID:r.followUpDataID,attributeName:r.endpointSettings.timesAttribute}),(0,A.q)(1),(0,D.U)(I=>I.map(y=>parseFloat(y)))),f=this.store.pipe((0,h.Ys)(Tt,{ID:r.followUpDataID,attributeName:r.endpointSettings.statusAttribute}),(0,A.q)(1)),b=this.store.pipe((0,h.Ys)(te,{ID:r.followUpDataID}),(0,A.q)(1));return(0,tt.D)([g,f,b]).pipe((0,D.U)(([I,y,w])=>{const G=r.clinicalCategory.categories;let q=new Map;return G.forEach(O=>{O.patientIDs.forEach(z=>{q.set(z,O.name)})}),{eventTimes:I,eventStatus:y,categories:w.map(O=>q.get(O)),categoryOrder:G.map(O=>O.name)}}))}),(0,N.w)(r=>this.survivalRequestService.requestCategoryKMdataInfoForPlot(r)),(0,D.U)(r=>{let g=[];const f=r.kmDF,b=Array.from(new Set(f.Label));for(const I of b){let y={label:I,data:[]};for(let w=0;w<f.Label.length;w++)f.Label[w]===I&&y.data.push({timeLine:f.TimeLine[w],probability:f.Probability[w],obversed:f.Obversed[w],censored:f.Censored[w],riskNumber:f["Number at Risk"][w]});g.push(y)}return{description:{hrText:r.survivalDescription,pValue:.01},KmlineDataMeta:g}})).subscribe(r=>{this.categoryKMlineDataInfoForPlotSubject.next(r)}),this.categoryKMlineDataInfoForPlot$=this.categoryKMlineDataInfoForPlotSubject.asObservable(),this.trySamppleService.trySampleData$.pipe((0,S.h)(Boolean)).subscribe(r=>{this.store.dispatch(Ht.CF({newState:r.datasetListState})),this.store.dispatch(Yt.gw({newState:r.localExpressDataState})),this.store.dispatch(Wt.A({newState:r.geneAnnotationsState})),this.store.dispatch(kt.c({newState:r.geneListState})),this.store.dispatch(yt.R({newState:r.survivalExpState}))}),this.trySamplePercentage$=this.trySamppleService.trySamplePercentage$}processSelectedDatasetID(e){this.selectedDatasetSubject.next(e)}requestDatasetGeneListSurvivalInfo(e){this.datasetGeneListSurvivalRequest$.next(e)}requestSurvivalInfoFromStore(e){this.survivalResultIDforRequest$.next(e)}requestKMinfoForPlotOfOneGene(e){this.oneGeneForKMinfoRequesSubject.next(e)}processFollowUpData(e){this.store.dispatch(ee.b({followUpData:e}))}processSelectedFollowUpDataID(e){this.followUPdataIDsubject.next(e)}processCategorySurvivalRequestInfo(e){this.categorySurvivalRequestInfoSubject.next(e)}downloadProjectSignal(){this.downloadService.downloadProject()}prepareTrySampleData(e){this.trySamppleService.requestTrySampleData(e)}downloadSampleData(e){this.downloadSampleService.downloadSampleData(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(h.yh),t.LFG(se),t.LFG(ae.v),t.LFG(oe.b),t.LFG(le.f),t.LFG(re.h))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var B=p(3405),Ft=p(6087),M=p(8805);function pe(n,o){if(1&n&&(t.TgZ(0,"option"),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ce(n,o){if(1&n&&(t.TgZ(0,"option"),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ue(n,o){if(1&n&&(t.TgZ(0,"option"),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ge(n,o){1&n&&(t.TgZ(0,"p",7),t._uU(1," Times Attribute should not equal Status Attribute "),t.qZA())}const mt=function(n){return{"max-width":n}},de=n=>n.get("timesAttribute").value===n.get("statusAttribute").value?{timesEqualStatus:!0}:null;let $t=(()=>{class n{constructor(e){this.cdr=e,this.availableStatusValues=["1","0"],this.formWidth="15rem",this.ifWidthAuto=!0,this.selectedStatusAttribute$=new t.vpe,this.endpointSettings$=new t.vpe,this.destroyNotifier$=new B.xQ}ngOnInit(){this.endAttrForm=new u.cw({timesAttribute:new u.NI("",[u.kI.required]),statusAttribute:new u.NI("",[u.kI.required]),statusValueToOne:new u.NI("",[u.kI.required])},[de]),this.endAttrForm.get("statusAttribute").valueChanges.pipe((0,M.R)(this.destroyNotifier$)).subscribe(e=>{"VALID"===this.endAttrForm.get("statusAttribute").status&&this.selectedStatusAttribute$.next(e)}),this.endAttrForm.valueChanges.pipe((0,M.R)(this.destroyNotifier$)).subscribe(e=>{"VALID"===this.endAttrForm.status&&(this.endpointSettings$.next(e),this.cdr.detectChanges())})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-endpoint-settings"]],inputs:{clinicalAttributes:"clinicalAttributes",availableStatusValues:"availableStatusValues",formWidth:"formWidth",ifWidthAuto:"ifWidthAuto"},outputs:{selectedStatusAttribute$:"selectedStatusAttribute$",endpointSettings$:"endpointSettings$"},decls:20,vars:14,consts:[[3,"formGroup"],["formControlName","timesAttribute",1,"form-control","form-control-sm",3,"ngStyle"],[4,"ngFor","ngForOf"],[1,"mt-2"],["formControlName","statusAttribute",1,"form-control","form-control-sm",3,"ngStyle"],["formControlName","statusValueToOne",1,"form-control","form-control-sm",3,"ngStyle"],["style","color: red",4,"ngIf"],[2,"color","red"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"h5"),t._uU(2,"Select Survival Time:"),t.qZA(),t.TgZ(3,"select",1),t.TgZ(4,"option"),t._uU(5,"---"),t.qZA(),t.YNc(6,pe,2,1,"option",2),t.qZA(),t.TgZ(7,"h5",3),t._uU(8,"Select Status of End of Study:"),t.qZA(),t.TgZ(9,"select",4),t.TgZ(10,"option"),t._uU(11,"---"),t.qZA(),t.YNc(12,ce,2,1,"option",2),t.qZA(),t.TgZ(13,"h5",3),t._uU(14,"Endpoint of Interest in Status:"),t.qZA(),t.TgZ(15,"select",5),t.TgZ(16,"option"),t._uU(17,"---"),t.qZA(),t.YNc(18,ue,2,1,"option",2),t.qZA(),t.YNc(19,ge,2,0,"p",6),t.qZA()),2&e&&(t.Q6J("formGroup",i.endAttrForm),t.xp6(3),t.Q6J("ngStyle",t.VKq(8,mt,i.ifWidthAuto?"none":i.formWidth)),t.xp6(3),t.Q6J("ngForOf",i.clinicalAttributes),t.xp6(3),t.Q6J("ngStyle",t.VKq(10,mt,i.ifWidthAuto?"none":i.formWidth)),t.xp6(3),t.Q6J("ngForOf",i.clinicalAttributes),t.xp6(3),t.Q6J("ngStyle",t.VKq(12,mt,i.ifWidthAuto?"none":i.formWidth)),t.xp6(3),t.Q6J("ngForOf",i.availableStatusValues),t.xp6(1),t.Q6J("ngIf",null==i.endAttrForm.errors?null:i.endAttrForm.errors.timesEqualStatus))},directives:[u._Y,u.JL,u.sg,u.EJ,u.JJ,u.u,l.PC,u.YN,u.Kr,l.sg,l.O5],styles:[""],changeDetection:0}),n})();var W=p(3013),me=p(438),fe=p(4816);function he(n,o){1&n&&(t.TgZ(0,"p",4),t._uU(1," Max probability should be bigger than min probability "),t.qZA())}const Nt=function(n){return{"max-width":n}},_e=n=>parseFloat(n.get("minProbability").value)>=parseFloat(n.get("maxProbability").value)?{minUpMax:!0}:null;let ve=(()=>{class n{constructor(e){this.cdr=e,this.maxStatSplitSetting$=new t.vpe(null),this.ifWidthAuto=!0,this.formWidth="15rem",this.destroyNotifier$=new B.xQ,this.probilityForm=new u.cw({minProbability:new u.NI(.1,[u.kI.required,u.kI.min(0),u.kI.max(1)]),maxProbability:new u.NI(.9,[u.kI.required,u.kI.min(0),u.kI.max(1)])},[_e])}ngOnInit(){this.probilityForm.valueChanges.pipe((0,Q.O)(this.probilityForm.value),(0,M.R)(this.destroyNotifier$)).subscribe(e=>{"VALID"===this.probilityForm.status&&(this.maxStatSplitSetting$.next(e),this.cdr.detectChanges())})}ngAfterViewInit(){this.probilityForm.statusChanges.subscribe(e=>{this.cdr.detectChanges()})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-min-max-probility-maxstatsplit"]],inputs:{ifWidthAuto:"ifWidthAuto",formWidth:"formWidth"},outputs:{maxStatSplitSetting$:"maxStatSplitSetting$"},decls:10,vars:12,consts:[[3,"formGroup"],["formControlName","minProbability","type","range","min","0","max","1","step","0.01",1,"form-control","form-control-sm",3,"ngStyle"],["formControlName","maxProbability","type","range","step","0.01",1,"form-control","form-control-sm",3,"ngStyle","min","max"],["style","color: red",4,"ngIf"],[2,"color","red"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"h5"),t._uU(2,"Min Percent of Low Group:"),t.qZA(),t._UZ(3,"input",1),t._uU(4),t.TgZ(5,"h5"),t._uU(6,"Max Percent of Low Group:"),t.qZA(),t._UZ(7,"input",2),t._uU(8),t.YNc(9,he,2,0,"p",3),t.qZA()),2&e&&(t.Q6J("formGroup",i.probilityForm),t.xp6(3),t.Q6J("ngStyle",t.VKq(8,Nt,i.ifWidthAuto?"none":i.formWidth)),t.xp6(1),t.hij(" ",100*i.probilityForm.get("minProbability").value,"% "),t.xp6(3),t.Q6J("ngStyle",t.VKq(10,Nt,i.ifWidthAuto?"none":i.formWidth))("min",0)("max",1),t.xp6(1),t.hij(" ",100*i.probilityForm.get("maxProbability").value,"% "),t.xp6(1),t.Q6J("ngIf",null==i.probilityForm.errors?null:i.probilityForm.errors.minUpMax))},directives:[u._Y,u.JL,u.sg,u.Fj,u.eT,u.JJ,u.u,l.PC,l.O5],styles:[""],changeDetection:0}),n})();function Se(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-input-number-with-range",3),t.NdJ("outputNumber$",function(s){return t.CHM(e),t.oxw().processProbilityOfLowGroup(s)}),t.qZA()}2&n&&t.Q6J("minValue",0)("maxValue",1)("defaultValue",.5)("formInlineOrNot",!1)("step",.01)("itemLabel","Probility of Low Group")}function De(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-generate-min-max-probility-maxstatsplit",4),t.NdJ("maxStatSplitSetting$",function(s){return t.CHM(e),t.oxw().processMaxStatSplitSettings(s)}),t.qZA()}}function ye(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-generate-min-max-probility-maxstatsplit",4),t.NdJ("maxStatSplitSetting$",function(s){return t.CHM(e),t.oxw().processMaxStatSplitSettings(s)}),t.qZA()}}let be=(()=>{class n{constructor(e){this.cdr=e,this.highLowSplitSetting$=new t.vpe,this.highLowSplitMethods=[{name:"maxstatSplit",description:"Approximative maximally selected statistics (Monte Carlo)"},{name:"percentageSplit",description:"Split High/Low Group Based on Percentage Threshold"},{name:"maxstatSplit",description:"Optimize High/Low Group to Find Smallest Log-rank P"}],this.selectedHighLowSplitMethod$=new _.X(null)}ngOnInit(){}processHighLowSplitMethod(e){this.selectedHighLowSplitMethod$.next(e.name),this.cdr.detectChanges()}processProbilityOfLowGroup(e){this.highLowSplitSetting$.next({method:"percentageSplit",settings:{percentageThreshold:e}})}processMaxStatSplitSettings(e){this.highLowSplitSetting$.next({method:"maxstatSplit",settings:{minProb:e.minProbability,maxProb:e.maxProbability}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-survival-settings"]],outputs:{highLowSplitSetting$:"highLowSplitSetting$"},decls:7,vars:17,consts:[["data-testid","splitMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","ifWidthAuto","emptyNote","selectedItemObject$"],["data-testid","proOfLowGroup",3,"minValue","maxValue","defaultValue","formInlineOrNot","step","itemLabel","outputNumber$",4,"ngIf"],[3,"maxStatSplitSetting$",4,"ngIf"],["data-testid","proOfLowGroup",3,"minValue","maxValue","defaultValue","formInlineOrNot","step","itemLabel","outputNumber$"],[3,"maxStatSplitSetting$"]],template:function(e,i){1&e&&(t.TgZ(0,"app-select-item-object",0),t.NdJ("selectedItemObject$",function(a){return i.processHighLowSplitMethod(a)}),t.qZA(),t.YNc(1,Se,1,6,"app-input-number-with-range",1),t.ALo(2,"async"),t.YNc(3,De,1,0,"app-generate-min-max-probility-maxstatsplit",2),t.ALo(4,"async"),t.YNc(5,ye,1,0,"app-generate-min-max-probility-maxstatsplit",2),t.ALo(6,"async")),2&e&&(t.Q6J("inputObjects",i.highLowSplitMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","Method to Split High&Low")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("ifWidthAuto",!0)("emptyNote","No methods is available"),t.xp6(1),t.Q6J("ngIf","percentageSplit"===t.lcZ(2,11,i.selectedHighLowSplitMethod$)),t.xp6(2),t.Q6J("ngIf","maxstatSplit"===t.lcZ(4,13,i.selectedHighLowSplitMethod$)),t.xp6(2),t.Q6J("ngIf","approximativeMaxstatSplit"===t.lcZ(6,15,i.selectedHighLowSplitMethod$)))},directives:[me.w,l.O5,fe.C,ve],pipes:[l.Ov],styles:[""],changeDetection:0}),n})();var Ie=p(1026);const xe=["submitButton"];function Ce(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"app-select-dataset",9),t.NdJ("selectedDatasetID$",function(s){return t.CHM(e),t.oxw().processSelectedDataset(s)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("allDatasetInfoForDisplay",e.allDatasetInfoForDisplay)("formInlineOrNot",!1)}}function we(n,o){1&n&&(t.TgZ(0,"p",10),t._uU(1,"Please import a Expression Profile data first. "),t.TgZ(2,"a",11),t._uU(3,"Import Data"),t.qZA(),t.qZA())}function Te(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"p",12),t._uU(2,"Warning: This dataset has no follow-up information. Please"),t.TgZ(3,"a",13),t.NdJ("click",function(s){return t.CHM(e),t.oxw().triggerImportClinicalDataSignal(s)}),t._uU(4,"import follow-up files and mapping files"),t.qZA(),t.qZA(),t.qZA()}}function Ae(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"app-select-item",14),t.NdJ("selectedItem$",function(s){return t.CHM(e),t.oxw().processSelectedGenelistID(s)}),t.qZA(),t.TgZ(2,"p",15),t._uU(3,"Info: If the genes of interest are not in the list. You can "),t.TgZ(4,"a",16),t.NdJ("click",function(s){return t.CHM(e),t.oxw().triggerInputGeneListSignal(s)}),t._uU(5," input a new gene list"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("inputItems",e.availableGeneListNames)("itemLabel","Gene List")("emptyNote","Please load or generate a new gene list first")("formInlineOrNot",!1)("ifWidthAuto",!0)}}function Ze(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"p"),t._uU(1,"Please load or generate a new gene list."),t.TgZ(2,"a",17),t.NdJ("click",function(s){return t.CHM(e),t.oxw().triggerInputGeneListSignal(s)}),t._uU(3,"New Gene List"),t.qZA(),t.qZA()}}let Fe=(()=>{class n{constructor(e){this.cdr=e,this.inputGeneListSignal$=new t.vpe,this.importClinicalSingal$=new t.vpe,this.selectedDatasetID$=new t.vpe,this.survivalAnalysisequest$=new t.vpe,this.extendedDatasetGroupNames=["Use all samples"],this.selectedDatasetIDSubject=new _.X(null),this.selectedGroupSubject=new _.X(null),this.selectedGeneListIDSubject=new _.X(null),this.endpointSettingsSubject=new _.X(null),this.highLowSplitSettingSubject=new _.X(null),this.destroyNotifier$=new B.xQ}ngOnInit(){this.followUpData&&(this.clinicalAttributes=this.followUpData.followUpAttributes)}ngAfterViewInit(){this.submitStream$=(0,Ft.R)(this.submitButton.nativeElement,"click"),this.ifSubmitAvailable$=(0,J.aj)([this.selectedDatasetIDSubject,this.selectedGroupSubject,this.selectedGeneListIDSubject,this.endpointSettingsSubject,this.highLowSplitSettingSubject]).pipe((0,D.U)(([e,i,s,a,c])=>!!(e&&i&&s&&a&&c)),(0,Q.O)(!1),(0,M.R)(this.destroyNotifier$)),this.submitStream$.pipe((0,S.h)(e=>null!=e),(0,H.M)(this.selectedDatasetIDSubject.pipe((0,S.h)(e=>null!=e)),this.selectedGroupSubject.pipe((0,S.h)(e=>null!=e)),this.selectedGeneListIDSubject.pipe((0,S.h)(e=>null!=e)),this.endpointSettingsSubject.pipe((0,S.h)(e=>null!=e)),this.highLowSplitSettingSubject.pipe((0,S.h)(e=>null!=e)))).subscribe(([e,i,s,a,c,d])=>{this.survivalAnalysisequest$.next({datasetID:i,groupName:s,geneListID:a,endpointSettings:c,highLowSplitSetting:d})})}ngOnChanges(e){e.groupNames&&(this.extendedDatasetGroupNames=["Use all samples"].concat(this.groupNames),this.cdr.detectChanges()),e.followUpData&&!e.followUpData.isFirstChange()&&this.followUpData&&(this.clinicalAttributes=this.followUpData.followUpAttributes)}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}triggerInputGeneListSignal(e){this.inputGeneListSignal$.next(!0)}triggerImportClinicalDataSignal(e){this.importClinicalSingal$.next(!0)}processSelectedDataset(e){this.selectedDatasetID$.next(e),this.selectedDatasetIDSubject.next(e)}processSelectedStatusAttribute(e){this.availableStatusValues=[...new Set(this.followUpData.followUpAttrValues[e])]}processSelectedGroupName(e){this.selectedGroupSubject.next(e)}processEndpointSettings(e){this.endpointSettingsSubject.next(e)}processSelectedGenelistID(e){this.selectedGeneListIDSubject.next(e)}processHighLowSplitSettings(e){this.highLowSplitSettingSubject.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-new-survival-analysis"]],viewQuery:function(e,i){if(1&e&&t.Gf(xe,5),2&e){let s;t.iGM(s=t.CRH())&&(i.submitButton=s.first)}},inputs:{allDatasetInfoForDisplay:"allDatasetInfoForDisplay",ifShowImportClinical:"ifShowImportClinical",followUpData:"followUpData",groupNames:"groupNames",availableGeneListNames:"availableGeneListNames"},outputs:{inputGeneListSignal$:"inputGeneListSignal$",importClinicalSingal$:"importClinicalSingal$",selectedDatasetID$:"selectedDatasetID$",survivalAnalysisequest$:"survivalAnalysisequest$"},features:[t.TTD],decls:15,vars:15,consts:[[4,"ngIf","ngIfElse"],["importDataNote",""],[4,"ngIf"],[3,"clinicalAttributes","availableStatusValues","selectedStatusAttribute$","endpointSettings$"],["data-testid","selectGroup",1,"mt-2",3,"inputItems","itemLabel","emptyNote","formInlineOrNot","ifWidthAuto","selectedItem$"],["importGeneListNote",""],[3,"highLowSplitSetting$"],["data-testid","submitSurvivalAnalysis",1,"mt-3","btn","btn-expressvis",3,"disabled"],["submitButton",""],[3,"allDatasetInfoForDisplay","formInlineOrNot","selectedDatasetID$"],["data-testid","importDataNote"],["href","javascript:void(0)","routerLink","/importData"],[1,"text-warning"],["data-testid","importClinicalData","href","javascript:void(0)",3,"click"],["data-testid","selectGeneListForSurvival",1,"mt-2",3,"inputItems","itemLabel","emptyNote","formInlineOrNot","ifWidthAuto","selectedItem$"],[1,"test-info"],["data-testid","moreNewGeneList","href","javascript:void(0)",3,"click"],["data-testid","newGeneList","href","javascript:void(0)",3,"click"]],template:function(e,i){if(1&e&&(t.YNc(0,Ce,2,2,"div",0),t.YNc(1,we,4,0,"ng-template",null,1,t.W1O),t.YNc(3,Te,5,0,"div",2),t.TgZ(4,"app-generate-endpoint-settings",3),t.NdJ("selectedStatusAttribute$",function(a){return i.processSelectedStatusAttribute(a)})("endpointSettings$",function(a){return i.processEndpointSettings(a)}),t.qZA(),t.TgZ(5,"div"),t.TgZ(6,"app-select-item",4),t.NdJ("selectedItem$",function(a){return i.processSelectedGroupName(a)}),t.qZA(),t.qZA(),t.YNc(7,Ae,6,5,"div",0),t.YNc(8,Ze,4,0,"ng-template",null,5,t.W1O),t.TgZ(10,"app-generate-survival-settings",6),t.NdJ("highLowSplitSetting$",function(a){return i.processHighLowSplitSettings(a)}),t.qZA(),t.TgZ(11,"button",7,8),t.ALo(13,"async"),t._uU(14," Submit\n"),t.qZA()),2&e){const s=t.MAs(2),a=t.MAs(9);t.Q6J("ngIf",(null==i.allDatasetInfoForDisplay?null:i.allDatasetInfoForDisplay.length)>=1)("ngIfElse",s),t.xp6(3),t.Q6J("ngIf",i.ifShowImportClinical),t.xp6(1),t.Q6J("clinicalAttributes",i.clinicalAttributes)("availableStatusValues",i.availableStatusValues),t.xp6(2),t.Q6J("inputItems",i.extendedDatasetGroupNames)("itemLabel","Select a Group for Analysis")("emptyNote","no groun")("formInlineOrNot",!1)("ifWidthAuto",!0),t.xp6(1),t.Q6J("ngIf",(null==i.availableGeneListNames?null:i.availableGeneListNames.length)>0)("ngIfElse",a),t.xp6(4),t.Q6J("disabled",!t.lcZ(13,13,i.ifSubmitAvailable$))}},directives:[l.O5,$t,W.y,be,Ie.z,v.yS],pipes:[l.Ov],styles:[""],changeDetection:0}),n})();var $e=p(9918),X=p(5043),Ne=p(1113),x=p(3203);const Le=["elementSvg"];let Me=(()=>{class n{constructor(e){this.cdr=e,this._baseSettings={svgConfigures:{svgWidth:480,svgMargin:{marginLeft:10,marginRight:10},svgBorder:{borderSzie:1,borderStyle:"solid",borderColor:"black"},svgBackgroundColor:"white"},headTextColor:"black",forestLineColor:"black"},this._fixSettings={fontFamily:"Arial",svgHeight:100,headTextWidth:80,headTextHeigth:40,variablesText:"Variables",hrText:"HR (95% CI)",pValueText:"PValue",xTitleText:"Hazard Ratio",editableTextOutline:1,baseHeightIncreasingValue:20,marginTop:10,marginBottom:10}}ngOnChanges(e){e.inputSettings&&!e.inputSettings.isFirstChange()&&this.forestData&&this.inputSettings&&(this._removeGraphic(),this._processSettings(),this._initPlot()),e.forestData&&!e.forestData.isFirstChange()&&this.forestData.length>0&&this.forestData&&(this._removeGraphic(),this._processSettings(),this._initPlot())}ngOnInit(){}ngAfterViewInit(){this.forestData&&(this._processSettings(),this._initPlot())}_initPlot(){this._drawSvg(),this._drawHeadText(),this._setScale(),this._setXYAxis(),this._drawForestGraph(),this._drawDataTable(),this._setXTitle()}_setXTitle(){const s=this._fixSettings.marginTop,r=4*this._baseSettings.svgConfigures.svgMargin.marginLeft,f=this._baseSettings.svgConfigures.svgWidth-this._baseSettings.svgConfigures.svgMargin.marginRight-2*this._fixSettings.headTextWidth-r,b=this._fixSettings.xTitleText,y=`\n      outline: ${this._fixSettings.editableTextOutline};\n      text-align: center;\n      font-family: ${this._fixSettings.fontFamily};\n      font-size: 12px;\n      font-weight: bold;\n    `;this._svgD3.append("g").attr("class","xTitle_g").append("foreignObject").attr("class","xTitleForeignObject").attr("requiredExtension","http://www.w3.org/1990/xhtml").attr("x",r).attr("y",6*s+this._increasedHeight).attr("width",f).attr("height",40).html(`\n        <p spellcheck=false style="${y}">\n          ${b}\n        </p>\n        `)}_drawDataTable(){const i=this._fixSettings.marginTop,s=this._fixSettings.fontFamily,a=this._baseSettings.svgConfigures.svgWidth,c=this._fixSettings.headTextWidth,d=a-this._baseSettings.svgConfigures.svgMargin.marginRight-2*c;this.forestData.forEach((r,g)=>{this._svgD3.append("g").attr("class","hrText").append("text").text(`${r.HR.toFixed(2)} (${r.HRLow.toFixed(2)}-${r.HRHigh.toFixed(2)})`).attr("x",d+5).attr("y",4*i+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()).style("font-family",s).style("font-size","10px").style("font-weight","bold"),this._svgD3.append("g").attr("class","pValueText").append("text").text(`${r.PValue.toExponential(2)}`).attr("x",d+15+c+(a-d-2*c)/2).attr("y",4*i+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()).style("font-family",s).style("font-size","10px").style("font-weight","bold")})}_drawForestGraph(){const e=this._fixSettings.marginTop,i=this._fixSettings.fontFamily,s=this._baseSettings.forestLineColor,a=this._svgD3.append("g").attr("class","dataGroup");this.forestData.forEach((r,g)=>{const f=a.append("g").attr("class",`group_${g}`);f.append("line").attr("x1",this._xScale(r.HRLow)).attr("y1",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()).attr("x2",this._xScale(r.HRHigh)).attr("y2",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()).attr("stroke",s).attr("stroke-width",1),f.append("line").attr("x1",this._xScale(r.HRLow)).attr("y1",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()+6).attr("x2",this._xScale(r.HRLow)).attr("y2",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()-6).attr("stroke",s).attr("stroke-width",1),f.append("line").attr("x1",this._xScale(r.HRHigh)).attr("y1",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()+6).attr("x2",this._xScale(r.HRHigh)).attr("y2",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()-6).attr("stroke",s).attr("stroke-width",1),f.append("rect").attr("width",6).attr("height",6).attr("x",this._xScale(r.HR)-3).attr("y",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()-3).attr("fill",s),f.on("mousemove",()=>{this._svgD3.append("foreignObject").attr("class","info").attr("width",180).attr("height",90).html(`\n          <div style="background-color: ${(0,x.B8C)(0,0,0,.1)}; padding-left: 10px">\n          <p>\n            name: ${r.variableName}&nbsp;&nbsp;Low: ${r.HRLow.toFixed(2)}<br>\n            HR: ${r.HR.toFixed(2)}&nbsp;&nbsp;High: ${r.HRHigh.toFixed(2)}<br>\n            pvalue: ${r.PValue.toFixed(4)}\n          </p>\n          </div>\n          `).attr("x",this._xScale(r.HRHigh)).attr("y",4*e+this._yScale.bandwidth()/2+g*this._yScale.bandwidth()).attr("color","white").style("font-size",12).style("font-weight","bold").style("font-family",i)}).on("mouseout",()=>{this._svgD3.selectAll(".info").remove()})})}_setXYAxis(){const e=this._baseSettings.svgConfigures.svgMargin.marginLeft,i=this._baseSettings.svgConfigures.svgMargin.marginRight,s=this._fixSettings.marginTop,a=this._fixSettings.fontFamily,c=this._baseSettings.svgConfigures.svgWidth,d=this._fixSettings.headTextWidth,r=this._setTicksNumber(parseFloat((0,x.VV$)(this.forestData,y=>y.HRLow)+""),parseFloat((0,x.Fp7)(this.forestData,y=>y.HRHigh)+""));this._xAxis=(0,x.LLu)(this._xScale).ticks(r).tickFormat(y=>{if(y<1){let w=-1;for(;Math.pow(2,w)!==y;)w--;return`1/${Math.pow(2,Math.abs(w))}`}return y}),this._svgD3.append("g").call(this._xAxis).attr("class","xAxis").attr("transform",`translate(0, ${4*s+this._increasedHeight})`).attr("stroke-width",2);const g=this._getTicksAndOneIndexBySelector(".xAxis .tick text"),f=e+d,I=f+(c-i-2*d-f)/(g.size-1)*g.oneIndex;this._yAxis=(0,x.y4O)(this._yScale).tickPadding(I-f+5).tickSize(0),this._svgD3.append("g").call(this._yAxis).attr("class","yAxis").attr("transform",`translate(${I}, 0)`).attr("stroke-width",2).style("stroke-dasharray","4.4"),this._svgD3.selectAll(".xAxis .tick text").style("font-family",a).style("font-size",10).style("font-weight","bold"),this._svgD3.selectAll(".yAxis .tick text").style("font-family",a).style("font-weight","bold").style("font-size",10)}_getTicksAndOneIndexBySelector(e){const i=[];return this._svgD3.selectAll(e).each(s=>i.push(Number(s))),{oneIndex:i.indexOf(1),size:i.length}}_setTicksNumber(e,i){let s=1;if(e>=1&&e<i){let a=1;for(;i>1&&!(i<=Math.pow(2,a));)a++;s+=a}if(i<=1&&e<i){let a=-1;for(;e<1&&!(e>=Math.pow(2,a));)a--;s+=Math.abs(a)}if(e<1&&i>1){let a=1,c=-1;for(;i>1&&!(i<=Math.pow(2,a));)a++;for(;e<1&&!(e>=Math.pow(2,c));)c--;s+=a+Math.abs(c)}return s}_setScale(){const e=this._fixSettings.baseHeightIncreasingValue,i=this._baseSettings.svgConfigures.svgMargin.marginLeft,s=this._baseSettings.svgConfigures.svgMargin.marginRight,a=this._fixSettings.marginTop,c=this._baseSettings.svgConfigures.svgWidth,d=this._fixSettings.svgHeight,r=this._fixSettings.headTextWidth,g=parseFloat((0,x.VV$)(this.forestData,b=>b.HRLow)+""),f=parseFloat((0,x.Fp7)(this.forestData,b=>b.HRHigh)+"");this._increasedHeight=this.forestData.length*e,this._svgD3.attr("height",d+this._increasedHeight),this._xScale=(0,x.p2C)().base(2).domain([g,f]).range([i+r,c-s-2*r]).nice(),this._yScale=(0,x.tiA)().domain(this.forestData.map(b=>b.variableName)).range([4*a,4*a+this._increasedHeight])}_drawHeadText(){const e=this._baseSettings.svgConfigures.svgWidth,i=this._baseSettings.svgConfigures.svgMargin.marginLeft,s=this._fixSettings.marginTop,a=this._baseSettings.svgConfigures.svgMargin.marginRight,c=this._fixSettings.headTextWidth,d=this._fixSettings.headTextHeigth,r=this._fixSettings.variablesText,g=this._fixSettings.hrText,f=this._fixSettings.pValueText,b=this._fixSettings.fontFamily,I=this._svgD3.append("g").attr("class","headTextGroup");I.append("text").text(r).attr("x",i).attr("y",2*s).attr("width",c).attr("height",d).style("font-family",b).style("font-size","12px").style("font-weight","bold"),I.append("text").text(g).attr("x",e-a-2*c+5).attr("y",2*s).attr("width",c).attr("height",d).style("font-family",b).style("font-size","12px").style("font-weight","bold"),I.append("text").text(f).attr("x",e-a-c+20).attr("y",2*s).attr("width",c).attr("height",d).style("font-family",b).style("font-size","12px").style("font-weight","bold")}_drawSvg(){const e=this._baseSettings.svgConfigures.svgWidth,i=this._fixSettings.svgHeight,s=this._baseSettings.svgConfigures.svgBorder.borderSzie,a=this._baseSettings.svgConfigures.svgBorder.borderStyle,c=this._baseSettings.svgConfigures.svgBorder.borderColor,d=this._baseSettings.svgConfigures.svgBackgroundColor;this._svgD3=(0,x.Ys)(this.elementSvg.nativeElement),this._svgD3.attr("width",e).attr("height",i).style("border",`${s}px ${a} ${c}`).style("background-color",d)}_processSettings(){this.inputSettings&&(this._baseSettings=this.inputSettings)}_removeGraphic(){this._svgD3&&this._svgD3.selectAll("*").remove()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-d3-forest-plot"]],viewQuery:function(e,i){if(1&e&&t.Gf(Le,7),2&e){let s;t.iGM(s=t.CRH())&&(i.elementSvg=s.first)}},inputs:{forestData:"forestData",inputSettings:"inputSettings"},features:[t.TTD],decls:2,vars:0,consts:[["elementSvg",""]],template:function(e,i){1&e&&(t.O4$(),t._UZ(0,"svg",null,0))},styles:[""],changeDetection:0}),n})();var ft=p(2326),Lt=p(3945);const Ue=["d3Container"];function Ge(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-display-terms-info-table-pagination",10),t.NdJ("selectedItems$",function(s){return t.CHM(e),t.oxw().processSelectedProteins(s)})("clickedTermForPlot$",function(s){return t.CHM(e),t.oxw().processClickedGeneForPlot(s)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("termsInfoForTable",e.survivalAnnoInfoForTable)("termName","Genes/Proteins")("uniqueFeature",e.variableFeature)("viewPlotName","View KM plot")}}function qe(n,o){1&n&&(t.TgZ(0,"p",11),t._uU(1," Please generate a new survival anslysis in the left side "),t.qZA())}const Oe=function(n){return{width:n}};function Ee(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",12),t.TgZ(2,"div",13),t.TgZ(3,"fa-icon",14),t.NdJ("click",function(s){return t.CHM(e),t.oxw().showSettings(s)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",15),t._UZ(5,"app-d3-forest-plot",16),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("icon",e.faCog)("size","sm"),t.xp6(1),t.Q6J("ngStyle",t.VKq(5,Oe,e.forestSettings.svgConfigures.svgWidth)),t.xp6(1),t.Q6J("forestData",e.forestData)("inputSettings",e.forestSettings)}}function Re(n,o){1&n&&(t.TgZ(0,"p",17),t._uU(1,"Select variables from the table"),t.qZA())}function Pe(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",18),t.TgZ(1,"app-change-figure-settings",19),t.NdJ("modifiedSettings$",function(s){return t.CHM(e),t.oxw().changePlotSettings(s)})("closeSignal$",function(s){return t.CHM(e),t.oxw().showSettings(s)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("plotSettingInfoList",e.plotSettingInfoList)}}let Je=(()=>{class n{constructor(e){this.cdr=e,this.selectedGeneForKMplot$=new t.vpe,this.faCog=X.b7W,this.features=["Variable","n/N in high group","n/N in low group","favor/unfavor","Hazard ratio","Hazard ratio lower","Hazard ratio upper","HR (95% CI)","Wald test p-value","Log-rank test p-value"],this.variableFeature="Variable",this.ifShowSettingsComponent=!1,this.downloadPngName="survival-analysis-forest-plot.png"}ngOnInit(){this.survivalAnno&&this._prepareForTable()}ngOnChanges(e){e.survivalAnno&&!e.survivalAnno.isFirstChange()&&this._prepareForTable()}_prepareForTable(){const e=(0,k.gG)(this.survivalAnno);this.survivalAnnoInfoForTable={features:this.features,termsInfo:e},this.cdr.detectChanges()}_obtainContainerWidth(){return this.d3Container.nativeElement.clientWidth}changePlotSettings(e){this.forestSettings={svgConfigures:{svgWidth:e.Width,svgMargin:{marginLeft:e.marginLeft,marginRight:e.marginRight},svgBorder:{borderSzie:1,borderStyle:"solid",borderColor:"black"},svgBackgroundColor:"white"},headTextColor:"black",forestLineColor:"black"},this.cdr.detectChanges()}showSettings(e){this.ifShowSettingsComponent=!this.ifShowSettingsComponent}processSelectedProteins(e){const i=(0,k.Wv)(e,[...this.survivalAnno[this.variableFeature]]);let s=[];const a=this.survivalAnno.Variable,c=this.survivalAnno["Hazard ratio lower"],d=this.survivalAnno["Hazard ratio"],r=this.survivalAnno["Hazard ratio upper"],g=this.survivalAnno["Wald test p-value"];i.forEach(w=>{s.push({variableName:a[w],HRLow:c[w],HR:d[w],HRHigh:r[w],PValue:g[w]})});const f=this._obtainContainerWidth()-30;let y;y=f<340?340:f>500?500:f,this.plotSettingInfoList=[{name:"Width",defaultValue:y,minValue:340,maxValue:1e3,stepValue:2},{name:"marginLeft",defaultValue:1,minValue:10,maxValue:30,stepValue:1},{name:"marginRight",defaultValue:1,minValue:10,maxValue:30,stepValue:1}],this.forestSettings={svgConfigures:{svgWidth:y,svgMargin:{marginLeft:10,marginRight:10},svgBorder:{borderSzie:1,borderStyle:"solid",borderColor:"black"},svgBackgroundColor:"white"},headTextColor:"black",forestLineColor:"black"},this.forestData=[...s],this.cdr.detectChanges()}processClickedGeneForPlot(e){this.selectedGeneForKMplot$.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-display-survival-analysis-results"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ue,7),2&e){let s;t.iGM(s=t.CRH())&&(i.d3Container=s.first)}},inputs:{survivalAnno:"survivalAnno"},outputs:{selectedGeneForKMplot$:"selectedGeneForKMplot$"},features:[t.TTD],decls:15,vars:5,consts:[[1,"row"],[1,"col-12","col-md-6","border"],[1,"text-center"],[3,"termsInfoForTable","termName","uniqueFeature","viewPlotName","selectedItems$","clickedTermForPlot$",4,"ngIf","ngIfElse"],["generateNewSurvivalNote",""],[1,"col-12","col-md-6","border","forestPlotContainer"],["d3Container",""],[4,"ngIf","ngIfElse"],["selectVariablesNote",""],["cdkDrag","","class","border p-3","style","position: absolute; z-index: 1014;top: 5rem; right: 0rem; background-color: white",4,"ngIf"],[3,"termsInfoForTable","termName","uniqueFeature","viewPlotName","selectedItems$","clickedTermForPlot$"],[2,"color","red"],[1,"d-flex","justify-content-end"],[1,"form-inline","ml-1"],["ngbTooltip","Click to change settings of the plot",1,"hoverBigger","close",3,"icon","size","click"],["cdkDragBoundary",".forestPlotContainer","cdkDrag","",3,"ngStyle"],["appD3ExportMap","",3,"forestData","inputSettings"],[1,"text-danger"],["cdkDrag","",1,"border","p-3",2,"position","absolute","z-index","1014","top","5rem","right","0rem","background-color","white"],[3,"plotSettingInfoList","modifiedSettings$","closeSignal$"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t._uU(3," Survival Analysis Annotation "),t.qZA(),t.YNc(4,Ge,1,4,"app-display-terms-info-table-pagination",3),t.YNc(5,qe,2,0,"ng-template",null,4,t.W1O),t.qZA(),t.TgZ(7,"div",5,6),t.TgZ(9,"h5",2),t._uU(10," Survival Forest of the Selected Variables "),t.qZA(),t.YNc(11,Ee,6,7,"div",7),t.YNc(12,Re,2,0,"ng-template",null,8,t.W1O),t.YNc(14,Pe,2,1,"div",9),t.qZA(),t.qZA()),2&e){const s=t.MAs(6),a=t.MAs(13);t.xp6(4),t.Q6J("ngIf",i.survivalAnnoInfoForTable)("ngIfElse",s),t.xp6(7),t.Q6J("ngIf",(null==i.forestData?null:i.forestData.length)>=1)("ngIfElse",a),t.xp6(3),t.Q6J("ngIf",i.ifShowSettingsComponent)}},directives:[l.O5,Ne.v,F.BN,Z._L,T.Zt,l.PC,Me,ft.I,Lt.q],styles:[""],changeDetection:0}),n})();var Ve=p(4547),je=p(5826),He=p(1954),ot=p(3314),Mt=p(3139);let Ut=(()=>{class n extends Mt.S{constructor(){super()}obtainClinicalImportInfo(e,i,s){return function(n,o,e,i){let s=[],a={};const c=o.indexOf(e);let d=new Map;return i.forEach(r=>{a[r]=[],d.set(r,o.indexOf(r))}),n.forEach(r=>{s.push(r[c]);for(const[g,f]of d.entries())a[g].push(r[f])}),{patientIDs:s,followUpAttrValues:a,followUpAttributes:i}}(this.textMatrix.slice(1),e,i,s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var Gt=p(6872);function Ye(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"a",5),t.NdJ("click",function(s){return t.CHM(e),t.oxw().presentFirstLinesOfTheFile(s)}),t._uU(1," View the first lines of the file\n"),t.qZA()}}function We(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"a",5),t.NdJ("click",function(s){return t.CHM(e),t.oxw().hiddenFirstLinesOfTheFile(s)}),t._uU(1," Hidden the first lines of the file\n"),t.qZA()}}function ze(n,o){if(1&n&&(t.TgZ(0,"th"),t.TgZ(1,"p",9),t._uU(2),t.qZA(),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.hij(" ",e," ")}}function Qe(n,o){if(1&n&&(t.TgZ(0,"td",11),t._uU(1),t.ALo(2,"trimString"),t.qZA()),2&n){const e=o.$implicit;t.s9C("title",e),t.xp6(1),t.hij(" ",t.xi3(2,2,e,20)," ")}}function Ke(n,o){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,Qe,3,5,"td",10),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function Be(n,o){if(1&n&&(t.TgZ(0,"div",6),t.TgZ(1,"table",7),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t.YNc(4,ze,3,1,"th",8),t.ALo(5,"async"),t.qZA(),t.qZA(),t.TgZ(6,"tbody"),t.YNc(7,Ke,2,1,"tr",8),t.ALo(8,"async"),t.qZA(),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,2,e.fileHeaders$)),t.xp6(3),t.Q6J("ngForOf",t.lcZ(8,4,e.firstLines$))}}let Xe=(()=>{class n{constructor(e){this.importService=e,this.followUpImportInfo$=new t.vpe,this.fileHeaders$=new ot.y(null),this.firstLines$=new ot.y(null),this.ifShowFirstLineOfTheFile=!1,this.patientIDcolumn$=new _.X(null),this.destroyNotifier$=new B.xQ}ngOnInit(){this.firstLines$=this.importService.firstLines$.pipe((0,M.R)(this.destroyNotifier$)),this.fileHeaders$=this.importService.fileHeaders$.pipe((0,M.R)(this.destroyNotifier$)),this.patientIDcolumn$.pipe((0,S.h)(e=>null!=e),(0,H.M)(this.fileHeaders$),(0,D.U)(([e,i])=>{let s=[];return i.forEach(a=>{a!=e&&s.push(a)}),this.importService.obtainClinicalImportInfo(i,e,s)}),(0,M.R)(this.destroyNotifier$)).subscribe(e=>{this.followUpImportInfo$.next(e)})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processClinicalFile(e){this.importService.initLoadedFile(e)}presentFirstLinesOfTheFile(e){this.ifShowFirstLineOfTheFile=!0}hiddenFirstLinesOfTheFile(e){this.ifShowFirstLineOfTheFile=!1}processSelectedPatientIDcolumn(e){this.patientIDcolumn$.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Ut))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import-clinical-values"]],outputs:{followUpImportInfo$:"followUpImportInfo$"},features:[t._Bn([Ut])],decls:12,vars:13,consts:[["data-testid","clinicalFile","role","form"],["type","file",1,"ml-2",3,"change"],["href","javascript:void(0)","class","inline",3,"click",4,"ngIf"],["class","table-responsive mr-2 ml-2",4,"ngIf"],["data-testid","selectPatientIDcol",1,"mt-2",3,"inputItems","itemLabel","emptyNote","formInlineOrNot","selectedItem$"],["href","javascript:void(0)",1,"inline",3,"click"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-bordered","mt-2"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"],[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div"),t.TgZ(2,"h5"),t._uU(3,"Follow-up File: "),t.qZA(),t.TgZ(4,"input",1),t.NdJ("change",function(a){return i.processClinicalFile(a)}),t.qZA(),t.qZA(),t.qZA(),t.YNc(5,Ye,2,0,"a",2),t.ALo(6,"async"),t.YNc(7,We,2,0,"a",2),t.ALo(8,"async"),t.YNc(9,Be,9,6,"div",3),t.TgZ(10,"app-select-item",4),t.NdJ("selectedItem$",function(a){return i.processSelectedPatientIDcolumn(a)}),t.ALo(11,"async"),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",t.lcZ(6,7,i.firstLines$)&&!i.ifShowFirstLineOfTheFile),t.xp6(2),t.Q6J("ngIf",t.lcZ(8,9,i.firstLines$)&&i.ifShowFirstLineOfTheFile),t.xp6(2),t.Q6J("ngIf",i.ifShowFirstLineOfTheFile),t.xp6(1),t.Q6J("inputItems",t.lcZ(11,11,i.fileHeaders$))("itemLabel","Choose PatientID Column of Follow-up File")("emptyNote","select clinical file first")("formInlineOrNot",!1))},directives:[u._Y,u.JL,u.F,l.O5,W.y,l.sg],pipes:[l.Ov,Gt.K],styles:[""],changeDetection:0}),n})(),qt=(()=>{class n extends Mt.S{constructor(){super()}obtainMapperObject(e,i){return((n,o,e)=>{const i=[...n[0]],s=i.indexOf(o),a=i.indexOf(e);let c={};return n.slice(1).forEach(d=>{c[d[a]]=d[s]}),c})(this.textMatrix,e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();function ei(n,o){if(1&n&&(t.TgZ(0,"th"),t.TgZ(1,"p",9),t._uU(2),t.qZA(),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.hij(" ",e," ")}}function ii(n,o){if(1&n&&(t.TgZ(0,"td",11),t._uU(1),t.ALo(2,"trimString"),t.qZA()),2&n){const e=o.$implicit;t.s9C("title",e),t.xp6(1),t.hij(" ",t.xi3(2,2,e,20)," ")}}function ni(n,o){if(1&n&&(t.TgZ(0,"tr"),t.YNc(1,ii,3,5,"td",10),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("ngForOf",e)}}function si(n,o){1&n&&(t.TgZ(0,"p",12),t._uU(1," Error: PatientID column should not equal sampleID column\n"),t.qZA())}let ai=(()=>{class n{constructor(e){this.importService=e,this.mapperDic$=new t.vpe,this.fileHeaders$=new ot.y(null),this.firstLines$=new ot.y(null),this.patientIDcolumnSubject=new _.X(null),this.sampleColumnSubject=new _.X(null),this.destroyNotifier$=new B.xQ}ngOnInit(){this.firstLines$=this.importService.firstLines$.pipe((0,M.R)(this.destroyNotifier$)),this.fileHeaders$=this.importService.fileHeaders$.pipe((0,M.R)(this.destroyNotifier$)),(0,J.aj)([this.patientIDcolumnSubject.pipe((0,S.h)(Boolean)),this.sampleColumnSubject.pipe((0,S.h)(Boolean))]).pipe((0,S.h)(([e,i])=>e!==i),(0,D.U)(([e,i])=>this.importService.obtainMapperObject(e.toString().trim(),i.toString().trim()))).subscribe(e=>{this.mapperDic$.next(e)}),this.ifShowEuqalError$=(0,J.aj)([this.patientIDcolumnSubject.pipe((0,S.h)(Boolean)),this.sampleColumnSubject.pipe((0,S.h)(Boolean))]).pipe((0,D.U)(([e,i])=>e===i),(0,Q.O)(!1),(0,M.R)(this.destroyNotifier$))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processMapperFile(e){this.importService.initLoadedFile(e)}processSelectedPatientIDcolumn(e){this.patientIDcolumnSubject.next(e)}processSelectedSampleIDColumn(e){this.sampleColumnSubject.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(qt))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import-mapper-file"]],outputs:{mapperDic$:"mapperDic$"},features:[t._Bn([qt])],decls:20,vars:23,consts:[["data-testid","sample2patientIDfile","role","form"],[1,"form-group"],["type","file",1,"form","ml-2",3,"change"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-bordered","mt-2"],[4,"ngFor","ngForOf"],["data-testid","selectPatientIDcolInMapper",1,"mt-2",3,"inputItems","itemLabel","emptyNote","formInlineOrNot","ifOutputFirstValue","selectedItem$"],["data-testid","selectSampleColInMapper",1,"mt-2",3,"inputItems","itemLabel","emptyNote","formInlineOrNot","ifOutputFirstValue","selectedItem$"],["data-testid","equalError","class","text-danger",4,"ngIf"],[1,"font-weight-bold"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],["data-testid","equalError",1,"text-danger"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div",1),t.TgZ(2,"h5"),t._uU(3,"Mapper File: "),t.qZA(),t.TgZ(4,"input",2),t.NdJ("change",function(a){return i.processMapperFile(a)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",3),t.TgZ(6,"table",4),t.TgZ(7,"thead"),t.TgZ(8,"tr"),t.YNc(9,ei,3,1,"th",5),t.ALo(10,"async"),t.qZA(),t.qZA(),t.TgZ(11,"tbody"),t.YNc(12,ni,2,1,"tr",5),t.ALo(13,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"app-select-item",6),t.NdJ("selectedItem$",function(a){return i.processSelectedPatientIDcolumn(a)}),t.ALo(15,"async"),t.qZA(),t.TgZ(16,"app-select-item",7),t.NdJ("selectedItem$",function(a){return i.processSelectedSampleIDColumn(a)}),t.ALo(17,"async"),t.qZA(),t.YNc(18,si,2,0,"p",8),t.ALo(19,"async")),2&e&&(t.xp6(9),t.Q6J("ngForOf",t.lcZ(10,13,i.fileHeaders$)),t.xp6(3),t.Q6J("ngForOf",t.lcZ(13,15,i.firstLines$)),t.xp6(2),t.Q6J("inputItems",t.lcZ(15,17,i.fileHeaders$))("itemLabel","Choose PatientID Column of Mapping File")("emptyNote","select clinical file first")("formInlineOrNot",!1)("ifOutputFirstValue",!1),t.xp6(2),t.Q6J("inputItems",t.lcZ(17,19,i.fileHeaders$))("itemLabel","Choose SampleID Column of Mapping File")("emptyNote","select clinical file first")("formInlineOrNot",!1)("ifOutputFirstValue",!1),t.xp6(2),t.Q6J("ngIf",t.lcZ(19,21,i.ifShowEuqalError$)))},directives:[u._Y,u.JL,u.F,l.sg,W.y,l.O5],pipes:[l.Ov,Gt.K],styles:[""],changeDetection:0}),n})();var oi=p(9769);function li(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-select-item",8),t.NdJ("selectedItem$",function(s){return t.CHM(e),t.oxw().processSelectedDatasetID(s)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("inputItems",e.availableDatasetIDs)("defaultItem",e.defaultSelectedDataset)("itemLabel","Select the dataset that follow-up data is related with")("emptyNote","No dataset is available")("ifOutputFirstValue",!1)("ifWidthAuto",!1)}}function ri(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",2),t.TgZ(1,"h5"),t._uU(2," Upload Mapping File of PatientID and SampleID: "),t.qZA(),t.TgZ(3,"app-import-mapper-file",9),t.NdJ("mapperDic$",function(s){return t.CHM(e),t.oxw().processSamples2patientIDs(s)}),t.qZA(),t.qZA()}}function pi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"h4"),t._uU(2," Input Follow-up Data Name "),t.qZA(),t.TgZ(3,"app-click-focus-input",10),t.NdJ("inputString$",function(s){return t.CHM(e),t.oxw().processInputFollowUpDataName(s)}),t.qZA(),t.qZA()}2&n&&(t.xp6(3),t.Q6J("placeholder","Follow-up Data Name"))}function ci(n,o){1&n&&(t.TgZ(0,"p",11),t._uU(1," Follow-up data is uploaded successfully\n"),t.qZA())}let Ot=(()=>{class n{constructor(){this.followUpData$=new t.vpe,this.ifRelatedWithDatasetItems=["No","Yes"],this.ifRelatedWithDataset="No",this.datasetIDsubject=new _.X(null),this.clinicalImportInfoSubject=new _.X(null),this.samples2patientIDsSubject=new _.X(null),this.followUpNameSubject=new _.X(null),this.clinicalSubmit$=new _.X(null),this.currentFollowUpDataName="",this.destroyNotifier$=new B.xQ}ngOnInit(){this.clinicalSubmit$.pipe((0,S.h)(e=>e),(0,H.M)(this.datasetIDsubject,this.clinicalImportInfoSubject,this.samples2patientIDsSubject,this.followUpNameSubject)).subscribe(([e,i,s,a,c])=>{if(null!=i){const d=at(i);this.currentFollowUpDataName=d,this.followUpData$.next({ID:d,relatedDatasetID:i,followUpInfo:s,sample2patientID:a})}else this.currentFollowUpDataName=c,this.followUpData$.next({ID:c,followUpInfo:s})})}ngAfterViewInit(){this.ifSubmitAvailable$=(0,J.aj)([this.datasetIDsubject,this.clinicalImportInfoSubject,this.samples2patientIDsSubject,this.followUpNameSubject]).pipe((0,D.U)(([e,i,s,a])=>"Yes"===this.ifRelatedWithDataset?!!(e&&i&&s):!(!i||!a)),(0,Q.O)(!1),(0,M.R)(this.destroyNotifier$))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedIfRelatedWithDataset(e){this.ifRelatedWithDataset=e}processSelectedDatasetID(e){this.datasetIDsubject.next(e)}processFollowUpImportInfo(e){this.clinicalImportInfoSubject.next(e)}processSamples2patientIDs(e){this.samples2patientIDsSubject.next(e)}processInputFollowUpDataName(e){this.followUpNameSubject.next(e)}submitClinicalImportInfo(e){this.clinicalSubmit$.next(!0)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-import-clinical-data"]],inputs:{availableDatasetIDs:"availableDatasetIDs",latestFollowUpDataID:"latestFollowUpDataID",ifRelatedWithDatasetDefault:"ifRelatedWithDatasetDefault",defaultSelectedDataset:"defaultSelectedDataset"},outputs:{followUpData$:"followUpData$"},decls:14,vars:12,consts:[["data-testid","ifFollowUpRelatedWithDataset",3,"inputItems","itemLabel","formInlineOrNot","ifOutputFirstValue","defaultValue","selectedItem$"],["data-testid","selectRelatedDataset",3,"inputItems","defaultItem","itemLabel","emptyNote","ifOutputFirstValue","ifWidthAuto","selectedItem$",4,"ngIf"],[1,"mt-3","border-top"],[3,"followUpImportInfo$"],["class","mt-3 border-top",4,"ngIf"],[4,"ngIf"],["data-testid","submitClinical",1,"btn","btn-expressvis","mt-2",3,"disabled","click"],["class","text-success",4,"ngIf"],["data-testid","selectRelatedDataset",3,"inputItems","defaultItem","itemLabel","emptyNote","ifOutputFirstValue","ifWidthAuto","selectedItem$"],[3,"mapperDic$"],["data-testid","inputFollowUpDataName",3,"placeholder","inputString$"],[1,"text-success"]],template:function(e,i){1&e&&(t.TgZ(0,"h5"),t._uU(1," If the follow up data is related with a dataset:\n"),t.qZA(),t.TgZ(2,"app-select-between-two-using-radio",0),t.NdJ("selectedItem$",function(a){return i.processSelectedIfRelatedWithDataset(a)}),t.qZA(),t.YNc(3,li,1,6,"app-select-item",1),t.TgZ(4,"div",2),t.TgZ(5,"h4"),t._uU(6," Upload Follow-up Data: "),t.qZA(),t.TgZ(7,"app-import-clinical-values",3),t.NdJ("followUpImportInfo$",function(a){return i.processFollowUpImportInfo(a)}),t.qZA(),t.YNc(8,ri,4,0,"div",4),t.qZA(),t.YNc(9,pi,4,1,"div",5),t.TgZ(10,"button",6),t.NdJ("click",function(a){return i.submitClinicalImportInfo(a)}),t.ALo(11,"async"),t._uU(12," Submit Follow-up and Mapping Files\n"),t.qZA(),t.YNc(13,ci,2,0,"p",7)),2&e&&(t.xp6(2),t.Q6J("inputItems",i.ifRelatedWithDatasetItems)("itemLabel","Rename Method")("formInlineOrNot",!1)("ifOutputFirstValue",!1)("defaultValue",i.ifRelatedWithDatasetDefault),t.xp6(1),t.Q6J("ngIf","Yes"===i.ifRelatedWithDataset),t.xp6(5),t.Q6J("ngIf","Yes"===i.ifRelatedWithDataset),t.xp6(1),t.Q6J("ngIf","No"===i.ifRelatedWithDataset),t.xp6(1),t.Q6J("disabled",!t.lcZ(11,10,i.ifSubmitAvailable$)),t.xp6(3),t.Q6J("ngIf",i.latestFollowUpDataID===i.currentFollowUpDataName))},directives:[He.W,l.O5,Xe,W.y,ai,oi.y],pipes:[l.Ov],styles:[""],changeDetection:0}),n})();var ui=p(7166);const gi=["svgElement"];let Et=(()=>{class n{constructor(){this.settings={svgWidth:600,svgMarginLeft:60,svgMarginRight:180,svgMarginTop:30,title:"Kaplan-Meier Curve",xTitle:"Time",yTitle:"Probability (%)"},this._svgHeight=380,this._colors=["rgb(111, 153, 109)","rgb(208, 57, 0)","rgb(34, 91, 150)","rgb(47, 79, 79)","rgb(255, 165, 0)","blue","cyan","green","pink","black","red","gray","brown","green","blue","brown","violet","orange","yellow"],this._ticks=[],this._riskNumberDataSet=[],this._initPlot=()=>{this._initSvg(),this._initTitle(),this._initScale(),this._initScale(),this._initAxis(),this._initXTitle(),this._initYTitle(),this._getLabels(),this._drawKmLine(),this._drawLegend(),this._descriptionText(),this._drawTable()},this._initYTitle=()=>{this._svgD3.append("g").attr("class","yTitle").append("text").text(this.settings.yTitle).attr("x",this.settings.svgMarginLeft).attr("y",280-2*this.settings.svgMarginTop).attr("transform",`rotate(-90 ${this.settings.svgMarginLeft} ${280-2*this.settings.svgMarginTop})`).style("font-family","Arial").style("font-weight","bold").style("font-size","16px")},this._initXTitle=()=>{this._svgD3.append("g").attr("class","xTitle").append("text").text(this.settings.xTitle).attr("transform",`translate(${(this.settings.svgWidth-this.settings.svgMarginLeft-this.settings.svgMarginRight)/2}, ${340-this.settings.svgMarginTop})`).style("font-family","Arial").style("font-weight","bold").style("font-size","16px")},this._initAxis=()=>{this._xAxis=(0,x.LLu)(this._xScale),this._yAxis=(0,x.y4O)(this._yScale),this._svgD3.append("g").call(this._xAxis).attr("class","xAxis").attr("transform",`translate(${this.settings.svgMarginLeft}, ${300-this.settings.svgMarginTop})`).attr("stroke-width",2),this._svgD3.append("g").call(this._yAxis).attr("class","yAxis").attr("transform",`translate(${2*this.settings.svgMarginLeft}, 0)`).attr("stroke-width",2),this._svgD3.selectAll(".tick text").style("font-family","Arial").style("font-weight","bold").style("font-size","10px")},this._initScale=()=>{const e=this.settings.svgMarginLeft,i=this.settings.svgWidth-this.settings.svgMarginRight-this.settings.svgMarginLeft,s=this.settings.svgMarginTop+20,a=300-this.settings.svgMarginTop;this._xScale=(0,x.BYU)(),this._xScale.domain(this._getTimeLineRange()).range([e,i]).nice(),this._yScale=(0,x.BYU)(),this._yScale.domain([0,100].reverse()).range([s,a]).nice()},this._getTimeLineRange=()=>{const e=[],i=[];return this.kmlineData.KmlineDataMeta.map(c=>{e.push(parseFloat((0,x.VV$)(c.data,d=>d.timeLine)+"")),i.push(parseFloat((0,x.Fp7)(c.data,d=>d.timeLine)+""))}),[parseFloat((0,x.VV$)(e,c=>c)+""),parseFloat((0,x.Fp7)(i,c=>c)+"")]},this._initTitle=()=>{const e=(this.settings.svgWidth-this.settings.svgMarginLeft-this.settings.svgMarginRight)/2+this.settings.svgMarginLeft;this._svgD3.append("g").attr("class","title").append("text").text(this.settings.title).attr("x",e).attr("y",this.settings.svgMarginTop).attr("text-anchor","middle").style("font-family","Arial").style("font-weight","bold").style("font-size","20px")},this._initSvg=()=>{this._svgD3=(0,x.Ys)(this.svgElement.nativeElement),this._svgD3.attr("width",this.settings.svgWidth).attr("height",this._svgHeight).style("border","1px solid black")},this._isEmptyData=e=>{var i,s,a;return!!((null===(i=null==e?void 0:e.description)||void 0===i?void 0:i.hrText)&&(null===(s=null==e?void 0:e.description)||void 0===s?void 0:s.pValue)&&(null===(a=null==e?void 0:e.KmlineDataMeta)||void 0===a?void 0:a.length))},this._cleanSvgElements=()=>{this._svgD3&&this._svgD3.selectAll("*").remove()}}ngOnChanges(e){(e.kmlineData||e.settings)&&this._isEmptyData(this.kmlineData)&&this.settings&&(this._cleanSvgElements(),this._initPlot())}ngOnInit(){}ngAfterViewInit(){this._isEmptyData(this.kmlineData)&&this.settings&&(this._cleanSvgElements(),this._initPlot())}_drawTable(){const s=20*this._labels.length,a=this.settings.svgWidth-this.settings.svgMarginRight-2*this.settings.svgMarginLeft;this._getAxisTicks(".xAxis .tick text"),this._getRiskData(this.kmlineData,this._ticks),this._svgD3.attr("height",this._svgHeight+s);const c=this._svgD3.append("g").attr("class","tableTitleText");c.append("text").text("Number at risk").attr("x",2*this.settings.svgMarginLeft).attr("y",390-this.settings.svgMarginTop).style("font-family","Arial").style("font-size","12px").style("font-weight","bold"),this._riskNumberDataSet.forEach((d,r)=>{c.append("text").text(this._labels[r]).attr("class","labelText"+r);const g=this._svgElemWidth((0,x.Ys)(".tableTitleText .labelText"+r).node());(0,x.Ys)(".tableTitleText .labelText"+r).attr("x",2*this.settings.svgMarginLeft-g).attr("y",410-this.settings.svgMarginTop+20*r).style("font-family","Arial").style("font-size","10px").style("font-weight","bold"),d.forEach((f,b)=>{c.append("text").text(f).attr("x",2*this.settings.svgMarginLeft+a/(this._ticks.length-1)*b-2).attr("y",410-this.settings.svgMarginTop+20*r).style("font-family","Arial").style("font-size","10px").style("font-weight","bold")})})}_getRiskData(e,i){const s=[];for(let a=0;a<e.KmlineDataMeta.length;a++){let c=[];for(let d=0;d<i.length;d++){let r=!1;for(let g=0;g<e.KmlineDataMeta[a].data.length;g++)if(i[d]===e.KmlineDataMeta[a].data[g].timeLine){c.push(e.KmlineDataMeta[a].data[g].riskNumber),r=!r;break}if(!r)for(let g=0;g<e.KmlineDataMeta[a].data.length;g++)e.KmlineDataMeta[a].data[g].timeLine<i[d]&&g+1<=e.KmlineDataMeta[a].data.length&&(g+1===e.KmlineDataMeta[a].data.length||e.KmlineDataMeta[a].data[g+1].timeLine>i[d])&&c.push(e.KmlineDataMeta[a].data[g].riskNumber)}s.push(c)}this._riskNumberDataSet=s}_getAxisTicks(e){const i=[];this._svgD3.selectAll(e).each(s=>{i.push(s)}),this._ticks=i}_descriptionText(){const e=`\n      HR (95% CI) = ${this.kmlineData.description.hrText}; p-value = ${this.kmlineData.description.pValue.toExponential(2)}\n    `;this._svgD3.append("g").attr("class","description").append("text").text(e).attr("x",2*this.settings.svgMarginLeft).attr("y",370-this.settings.svgMarginTop).style("font-family","Arial").style("font-size","10px").style("font-weight","bold")}_svgElemWidth(e){const i=[{fn:"getBBox",w:function(g){return g.width}},{fn:"getBoundingClientRect",w:function(g){return g.width}},{fn:"getComputedTextLength",w:function(g){return g}}],s=[];let a,c,d;for(c=0;c<i.length;c++)d=i[c],"function"==typeof e[d.fn]&&(a=d.w(e[d.fn]()),0!==a&&s.push(a));var r;if(s.length){for(r=0,c=0;c<s.length;c++)r+=s[c];r/=s.length}return r}_drawLegend(){const i=this._svgD3.append("g");for(let s=0;s<this._labels.length;s++)i.append("rect").attr("width",10).attr("height",10).attr("x",3*this.settings.svgWidth/4).attr("y",this.settings.svgMarginTop+20+20*s).attr("fill",this._colors[s]),this._svgD3.append("text").text(this._labels[s]).attr("x",3*this.settings.svgWidth/4+12).attr("y",this.settings.svgMarginTop+20+20*s+9).style("font-family","Arial").style("font-size",12).style("font-weight","bold")}_drawKmLine(){this.kmlineData.KmlineDataMeta.forEach((e,i)=>{let s="";e.data.forEach((a,c)=>{const d=a.censored>0?(0,x.NAG)().type(x.tJO).size(60):(0,x.NAG)().type(x.JFv).size(16);this._svgD3.append("g").attr("transform",`translate(${this._xScale(a.timeLine)+this.settings.svgMarginLeft}, ${this._yScale(100*a.probability)})`).append("path").attr("d",d).attr("transform","rotate(-45)").attr("fill",this._colors[this._labels.indexOf(e.label)]).on("mousemove",()=>{this._svgD3.append("foreignObject").attr("class","info").attr("width",130).attr("height",150).html(`\n              <div style="background-color: ${this._colors[i]}; padding-left: 10px">\n                <p>\n                  Label: ${e.label}<br>\n                  Time Line: ${a.timeLine}<br>\n                  Probability: ${a.probability.toExponential(2)}<br>\n                  Obversed: ${a.obversed}<br>\n                  Censored: ${a.censored}<br>\n                  Number at risk: ${a.riskNumber}\n                </p>\n              </div>\n              `).attr("x",this._xScale(a.timeLine)-this.settings.svgMarginLeft).attr("y",this._yScale(100*a.probability-2)).attr("color","white").style("font-size",10).style("font-weight","bold")}).on("mouseout",()=>{this._svgD3.selectAll(".info").remove()}),s+=0===c?`M ${this._xScale(a.timeLine)+this.settings.svgMarginLeft} ${this._yScale(100*a.probability)} `:`L ${this._xScale(a.timeLine)+this.settings.svgMarginLeft} ${this._yScale(100*this.kmlineData.KmlineDataMeta[i].data[c-1].probability)} L ${this._xScale(a.timeLine)+this.settings.svgMarginLeft} ${this._yScale(100*a.probability)} `}),this._svgD3.append("path").attr("d",s).attr("stroke",this._colors[i]).attr("fill","none").attr("stroke-width",3)})}_getLabels(){const e=[];this.kmlineData.KmlineDataMeta.forEach(i=>{e.push(i.label)}),this._labels=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-d3-kmline-plot"]],viewQuery:function(e,i){if(1&e&&t.Gf(gi,7),2&e){let s;t.iGM(s=t.CRH())&&(i.svgElement=s.first)}},inputs:{kmlineData:"kmlineData",settings:"settings"},features:[t.TTD],decls:2,vars:0,consts:[["svgElement",""]],template:function(e,i){1&e&&(t.O4$(),t._UZ(0,"svg",null,0))},styles:[""],changeDetection:0}),n})();function di(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"app-change-figure-settings",12),t.NdJ("modifiedSettings$",function(s){return t.CHM(e),t.oxw().changePlotSettings(s)})("closeSignal$",function(s){return t.CHM(e),t.oxw().showSettings(s)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("plotSettingInfoList",e.plotSettingInfoList)}}let mi=(()=>{class n{constructor(){this.closeSignal$=new t.vpe,this.downloadPngName="kmline-plot.png",this.downloadPDFname="kmline-plot.pdf",this.faCog=X.b7W,this.kmlineSettings={},this.ifShowSettingsComponent=!1}ngOnInit(){this._obtainKMlineData(),this._obtainGeneInfo()}ngOnChanges(e){e.oneGeneClinicalInfo&&!e.oneGeneClinicalInfo.isFirstChange()&&(this._obtainKMlineData(),this._obtainGeneInfo())}closeModalForOneGeneClinicalInfo(e){this.closeSignal$.next(!0)}changePlotSettings(e){this.kmlineSettings={svgWidth:e.Width,svgMarginLeft:e.marginLeft,svgMarginRight:e.marginRight,svgMarginTop:e.marginTop,title:"Kaplan-Meier Curve",xTitle:"Time",yTitle:"Probability (%)"}}showSettings(e){this.ifShowSettingsComponent=!this.ifShowSettingsComponent}_obtainKMlineData(){var e,i,s,a;this.oneGeneClinicalInfo&&(this.downloadPngName=(null===(e=this.oneGeneClinicalInfo)||void 0===e?void 0:e.geneInfo.SYMBOL)+"KM-line.png",this.kmLineData={KmlineDataMeta:[...null===(i=this.oneGeneClinicalInfo)||void 0===i?void 0:i.KMlineDataInfos],description:{hrText:null===(s=this.oneGeneClinicalInfo)||void 0===s?void 0:s.survivalAnno["HR (95% CI)"],pValue:null===(a=this.oneGeneClinicalInfo)||void 0===a?void 0:a.survivalAnno["Log-rank test p-value"]}},this.kmlineSettings={svgWidth:400,svgMarginLeft:40,svgMarginRight:60,svgMarginTop:30,title:"Kaplan-Meier Curve",xTitle:"Time",yTitle:"Probability (%)"},this.plotSettingInfoList=[{name:"Width",defaultValue:400,minValue:300,maxValue:1e3,stepValue:2},{name:"marginLeft",defaultValue:40,minValue:30,maxValue:60,stepValue:1},{name:"marginRight",defaultValue:60,minValue:40,maxValue:80,stepValue:1},{name:"marginTop",defaultValue:30,minValue:20,maxValue:50,stepValue:1}])}_obtainGeneInfo(){var e;this.oneGeneClinicalInfo&&(this.geneInfo=Object.assign({},null===(e=this.oneGeneClinicalInfo)||void 0===e?void 0:e.geneInfo))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-display-one-gene-clinical-info"]],inputs:{oneGeneClinicalInfo:"oneGeneClinicalInfo"},outputs:{closeSignal$:"closeSignal$"},features:[t.TTD],decls:15,vars:8,consts:[[2,"height","1rem"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"pr-3","pl-3"],[1,"p-3"],[1,"d-flex","flex-column"],[1,"d-flex","justify-content-end"],[1,"form-inline","ml-1"],["ngbTooltip","Click to change settings of the plot",1,"hoverBigger","close","pull-right",3,"icon","size","click"],["appD3ExportMap","",3,"pngName","pdfName","kmlineData","settings"],["cdkDrag","","class","border p-3","style","position: absolute; z-index: 1014;top: 7rem; right: 0rem; background-color: white",4,"ngIf"],["cdkDrag","",1,"border","p-3",2,"position","absolute","z-index","1014","top","7rem","right","0rem","background-color","white"],[3,"plotSettingInfoList","modifiedSettings$","closeSignal$"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(a){return i.closeModalForOneGeneClinicalInfo(a)}),t.TgZ(2,"span",2),t._uU(3,"\xd7"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"p"),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"div",5),t.TgZ(9,"div",6),t.TgZ(10,"div",7),t.TgZ(11,"fa-icon",8),t.NdJ("click",function(a){return i.showSettings(a)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div"),t._UZ(13,"app-d3-kmline-plot",9),t.qZA(),t.qZA(),t.qZA(),t.YNc(14,di,2,1,"div",10)),2&e&&(t.xp6(6),t.hij("SYMBOL: ",null==i.geneInfo?null:i.geneInfo.SYMBOL,""),t.xp6(5),t.Q6J("icon",i.faCog)("size","sm"),t.xp6(2),t.Q6J("pngName",i.downloadPngName)("pdfName",i.downloadPDFname)("kmlineData",i.kmLineData)("settings",i.kmlineSettings),t.xp6(1),t.Q6J("ngIf",i.ifShowSettingsComponent))},directives:[F.BN,Z._L,Et,ft.I,l.O5,T.Zt,Lt.q],styles:[""],changeDetection:0}),n})();const fi=["inputGeneListComponent"],hi=["importClinicalData"];function _i(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",18),t.TgZ(1,"div",11),t.TgZ(2,"app-try-sample",19),t.NdJ("sampleForTryName$",function(s){return t.CHM(e),t.oxw().processTrySampleFileName(s)})("sampleForImportName$",function(s){return t.CHM(e),t.oxw().processDownloadSampleData(s)})("closeMe$",function(s){return t.CHM(e),t.oxw().closeTrySampleComponent(s)}),t.ALo(3,"async"),t.ALo(4,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("fileInfos",e.trySamplesInfos)("trySamplePercentage",t.lcZ(3,3,e.trySamplePercentage$))("downloadSampleDataPercentage",t.lcZ(4,5,e.downloadSampleDataPercentage$))}}function vi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t.TgZ(1,"button",21),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return null==s.importClinicalModalRef?null:s.importClinicalModalRef.hide()}),t.TgZ(2,"span",22),t._uU(3,"\xd7"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",23),t.TgZ(5,"app-import-clinical-data",24),t.NdJ("followUpData$",function(s){return t.CHM(e),t.oxw().processFollowUpData(s)}),t.ALo(6,"async"),t.ALo(7,"async"),t.ALo(8,"async"),t.qZA(),t.qZA(),t.TgZ(9,"div",25),t.TgZ(10,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw().importClinicalModalRef.hide()}),t._uU(11," close "),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("ifRelatedWithDatasetDefault","Yes")("availableDatasetIDs",t.lcZ(6,4,e.availableDatasetIDs$))("latestFollowUpDataID",t.lcZ(7,6,e.latestFollowUpDataID$))("defaultSelectedDataset",t.lcZ(8,8,e.datasetIDSubject))}}function Si(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t.TgZ(1,"h3"),t._uU(2,"Generate a New Gene List"),t.qZA(),t.TgZ(3,"button",21),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return null==s.inputGenelistModalRef?null:s.inputGenelistModalRef.hide()}),t.TgZ(4,"span",22),t._uU(5,"\xd7"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(6,"div",23),t.TgZ(7,"app-generate-new-gene-list",27),t.NdJ("outputGeneList$",function(s){return t.CHM(e),t.oxw().processInputGeneList(s)})("annotationTermsRequest$",function(s){return t.CHM(e),t.oxw().processAnnotationTermsRequest(s)})("annotationGenesRequest$",function(s){return t.CHM(e),t.oxw().processAnnotationGenesRequest(s)})("geneListFromDatasetRequest$",function(s){return t.CHM(e),t.oxw().processGeneListFromDatasetRequest(s)}),t.ALo(8,"async"),t.ALo(9,"async"),t.ALo(10,"async"),t.ALo(11,"async"),t.ALo(12,"async"),t.ALo(13,"async"),t.qZA(),t.qZA(),t.TgZ(14,"div",25),t.TgZ(15,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().inputGenelistModalRef.hide()}),t._uU(16,"close"),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(7),t.Q6J("availableSpecies",t.lcZ(8,6,e.availableSpecies$))("availableGeneIDtypes",t.lcZ(9,8,e.availableGeneIDtypes$))("annotationTerms",t.lcZ(10,10,e.annotationTerms$))("allDatasetInfoForDisplay",t.lcZ(11,12,e.allDatasetInfoForDisplay$))("geneNumberAfterFilter",t.lcZ(12,14,e.geneNumberAfterFilter$))("latestAddedGeneListID",t.lcZ(13,16,e.latestAddedGenelistName$))}}function Di(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-display-one-gene-clinical-info",29),t.NdJ("closeSignal$",function(s){return t.CHM(e),t.oxw().closeModalForOneGeneClinicalInfo(s)}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("oneGeneClinicalInfo",t.lcZ(1,1,e.oneGeneClinicalInfo$))}}let yi=(()=>{class n{constructor(e,i,s){this.facade=e,this.modalService=i,this.cdr=s,this.trySamplesInfos=[{fileForTry:"Proteomics-preprocessed-Gao-SurvivalExp.json.gz",fileForImport:"Proteomics-preprocessed-Gao.zip",description:"Proteomics-preprocessed-Gao"}],this.trySamplePercentage$=this.facade.trySamplePercentage$,this.downloadSampleDataPercentage$=this.facade.downloadSampleDataPercentage$,this.ifShowTrySampleComponent=!0,this.tutorialGifInfos=[{name:"New survival analysis",src:"/static/images/interactiveOperations/SurvivalExp-1-Import.gif"},{name:"Select genes and display forest plot",src:"/static/images/interactiveOperations/SurvivalExp-2-forest.gif"},{name:"Select one gene and display its KM plot",src:"/static/images/interactiveOperations/SurvivalExp-3-kmline.gif"}],this.allDatasetInfoForDisplay$=this.facade.allDatasetInfoForDisplay$.pipe((0,_t.d)(5)),this.latestFollowUpDataID$=this.facade.latestFollowUpDataID$,this.followUpData$=this.facade.followUpDataInfoForGenes$,this.datasetGroupNames$=this.facade.datasetGroupNames$,this.availableGeneListNames$=this.facade.availableGeneListNames$,this.datasetGeneListSurvivalAnno$=this.facade.datasetGeneListSurvivalAnno$,this.oneGeneClinicalInfo$=this.facade.oneGeneKMlineDataInfoForPlot$,this.ifShowOneGeneClinicalInfo=!1,this.annotationTerms$=this.facade.annotationTerms$,this.allAvailableGeneIDtypes=vt.k1,this.allAvailableSpecies=vt.it,this.datasetIDSubject=new _.X(null),this.geneNumberAfterFilter$=this.facade.geneNumberAfterFilter$,this.latestAddedGenelistName$=this.facade.latestAddedGenelistName$,this.latestFollowUpDataID$.subscribe(a=>{this.currentFollowUpID===a&&(console.log("ID",a),this.facade.processSelectedDatasetID(this.currentDatsetID)),this.cdr.detectChanges()}),this.availableDatasetIDs$=this.facade.allDatasetInfoForDisplay$.pipe((0,S.h)(a=>null!=a),(0,D.U)(a=>a.map(c=>c.datasetID)),(0,Vt.b)(()=>{this.cdr.detectChanges()}))}ngOnInit(){this.allSurvivalResultIDs$=this.facade.allSurvivalResultIDs$.pipe((0,S.h)(Boolean),(0,D.U)(e=>e.reverse())),this.ifShowImportClinical$=this.facade.ifSelectedDatasetHasClinical$.pipe((0,D.U)(e=>!e),(0,Q.O)(!1)),this.availableSpecies$=this.datasetIDSubject.pipe((0,H.M)(this.allDatasetInfoForDisplay$),(0,D.U)(([e,i])=>{if(e&&i){let s;for(let c of i)if(c.datasetID===e){s=c.speciesID;break}let a=[];for(const c of this.allAvailableSpecies)c.taxID===s&&a.push(c);return a}return this.allAvailableSpecies})),this.availableGeneIDtypes$=this.datasetIDSubject.pipe((0,H.M)(this.allDatasetInfoForDisplay$),(0,D.U)(([e,i])=>{if(e&&i){let s,a;for(let d of i)if(d.datasetID===e){s=d.IDtype;break}for(const d of this.allAvailableGeneIDtypes)if(d.name===s){a=d;break}return[a,{name:"SYMBOL",description:"Gene Symbol"}]}return this.allAvailableGeneIDtypes})),this.ifShowClinicalSuccessNote$=(0,J.aj)([this.facade.latestDatasetIDhasClinical$.pipe((0,S.h)(Boolean)),this.datasetIDSubject.pipe((0,S.h)(Boolean))]).pipe((0,D.U)(([e,i])=>e===i))}processSelectedDataset(e){this.datasetIDSubject.next(e),this.currentDatsetID=e,this.facade.processSelectedDatasetID(e)}processImportClinicalDataSignal(e){this.importClinicalModalRef=this.modalService.show(this.importClinicalData),this.cdr.detectChanges()}processFollowUpData(e){this.currentFollowUpID=e.ID,this.facade.processFollowUpData(e)}processInputGeneListSignal(e){this.inputGenelistModalRef=this.modalService.show(this.inputGeneListComponent),this.cdr.detectChanges()}processInputGeneList(e){this.facade.inputGeneList(e)}processAnnotationTermsRequest(e){this.facade.requestAnnotationTerms(e)}processAnnotationGenesRequest(e){this.facade.requestAnnotationGenes(e)}processGeneListFromDatasetRequest(e){this.facade.processNewGeneListFromDatasetRequest(e)}processDatasetGenelistSurvivalRequest(e){this.facade.requestDatasetGeneListSurvivalInfo(e)}processSelectedResultID(e){this.facade.requestSurvivalInfoFromStore(e)}processSelectedGeneForKMplot(e){this.facade.requestKMinfoForPlotOfOneGene(e),this.ifShowOneGeneClinicalInfo=!0}closeModalForOneGeneClinicalInfo(e){this.ifShowOneGeneClinicalInfo=!1}processTrySampleFileName(e){this.facade.prepareTrySampleData(e)}closeTrySampleComponent(e){this.ifShowTrySampleComponent=!1}processDownloadProjectSignal(e){this.facade.downloadProjectSignal()}processDownloadSampleData(e){this.facade.downloadSampleData(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(dt),t.Y36(R.tT),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-survival-analysis-expression-split"]],viewQuery:function(e,i){if(1&e&&(t.Gf(fi,5,t.Rgc),t.Gf(hi,5,t.Rgc)),2&e){let s;t.iGM(s=t.CRH())&&(i.inputGeneListComponent=s.first),t.iGM(s=t.CRH())&&(i.importClinicalData=s.first)}},decls:30,vars:28,consts:[[1,"row"],[1,"col-12","col-md-3","col-xl-2","border","mt-2","pl-4"],[1,"mt-4"],[2,"height","90%",3,"allDatasetInfoForDisplay","ifShowImportClinical","followUpData","groupNames","availableGeneListNames","inputGeneListSignal$","importClinicalSingal$","selectedDatasetID$","survivalAnalysisequest$"],[1,"col-12","col-md-9","col-xl-10","mt-2"],["class","row border",4,"ngIf"],[1,"row","mt-3"],[1,"col-12","d-flex","justify-content-between"],[3,"inputItems","itemLabel","emptyNote","formInlineOrNot","ifOutputFirstValue","selectedItem$"],[3,"tutorialGifInfos"],[1,"row","mt-2"],[1,"col-12"],[3,"survivalAnno","selectedGeneForKMplot$"],[1,"row","mt-4"],[3,"downloadProjectSignal$"],["importClinicalData",""],["inputGeneListComponent",""],["cdkDrag","","class","moveFreeDiv border p-2",3,"oneGeneClinicalInfo","closeSignal$",4,"ngIf"],[1,"row","border"],[3,"fileInfos","trySamplePercentage","downloadSampleDataPercentage","sampleForTryName$","sampleForImportName$","closeMe$"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"ifRelatedWithDatasetDefault","availableDatasetIDs","latestFollowUpDataID","defaultSelectedDataset","followUpData$"],[1,"modal-footer"],["data-testid","closeClinicalImport","type","button",1,"btn","btn-default",3,"click"],[3,"availableSpecies","availableGeneIDtypes","annotationTerms","allDatasetInfoForDisplay","geneNumberAfterFilter","latestAddedGeneListID","outputGeneList$","annotationTermsRequest$","annotationGenesRequest$","geneListFromDatasetRequest$"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default","btn-sm",3,"click"],["cdkDrag","",1,"moveFreeDiv","border","p-2",3,"oneGeneClinicalInfo","closeSignal$"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h4",2),t._uU(3,"Generate a New Survival Analysis"),t.qZA(),t.TgZ(4,"div"),t.TgZ(5,"app-generate-new-survival-analysis",3),t.NdJ("inputGeneListSignal$",function(a){return i.processInputGeneListSignal(a)})("importClinicalSingal$",function(a){return i.processImportClinicalDataSignal(a)})("selectedDatasetID$",function(a){return i.processSelectedDataset(a)})("survivalAnalysisequest$",function(a){return i.processDatasetGenelistSurvivalRequest(a)}),t.ALo(6,"async"),t.ALo(7,"async"),t.ALo(8,"async"),t.ALo(9,"async"),t.ALo(10,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",4),t.YNc(12,_i,5,7,"div",5),t.TgZ(13,"div",6),t.TgZ(14,"div",7),t.TgZ(15,"app-select-item",8),t.NdJ("selectedItem$",function(a){return i.processSelectedResultID(a)}),t.ALo(16,"async"),t.qZA(),t._UZ(17,"app-trigger-to-display-tutorial-gif",9),t.qZA(),t.qZA(),t.TgZ(18,"div",10),t.TgZ(19,"div",11),t.TgZ(20,"app-display-survival-analysis-results",12),t.NdJ("selectedGeneForKMplot$",function(a){return i.processSelectedGeneForKMplot(a)}),t.ALo(21,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"div",13),t.TgZ(23,"app-download-project",14),t.NdJ("downloadProjectSignal$",function(a){return i.processDownloadProjectSignal(a)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"div",0),t.YNc(25,vi,12,10,"ng-template",null,15,t.W1O),t.YNc(27,Si,17,18,"ng-template",null,16,t.W1O),t.YNc(29,Di,2,3,"app-display-one-gene-clinical-info",17),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("allDatasetInfoForDisplay",t.lcZ(6,14,i.allDatasetInfoForDisplay$))("ifShowImportClinical",t.lcZ(7,16,i.ifShowImportClinical$))("followUpData",t.lcZ(8,18,i.followUpData$))("groupNames",t.lcZ(9,20,i.datasetGroupNames$))("availableGeneListNames",t.lcZ(10,22,i.availableGeneListNames$)),t.xp6(7),t.Q6J("ngIf",i.ifShowTrySampleComponent),t.xp6(3),t.Q6J("inputItems",t.lcZ(16,24,i.allSurvivalResultIDs$))("itemLabel","Available Survival Analysis")("emptyNote","Generate a survival analysis in the left sidebar")("formInlineOrNot",!0)("ifOutputFirstValue",!0),t.xp6(2),t.Q6J("tutorialGifInfos",i.tutorialGifInfos),t.xp6(3),t.Q6J("survivalAnno",t.lcZ(21,26,i.datasetGeneListSurvivalAnno$)),t.xp6(9),t.Q6J("ngIf",i.ifShowOneGeneClinicalInfo))},directives:[Fe,l.O5,W.y,$e.n,Je,Ve.E,je.P,Ot,ui.D,mi,T.Zt],pipes:[l.Ov],styles:[""]}),n})();var ht=p(94),bi=p(471),Ii=p(1789),xi=p(9879),Ci=p(3128),wi=p(5686),Rt=p(5389);function Ti(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"div",10),t.TgZ(2,"select",11),t.TgZ(3,"option",12),t._uU(4," < "),t.qZA(),t.TgZ(5,"option",13),t._uU(6," \u2264 "),t.qZA(),t.TgZ(7,"option",14),t._uU(8," > "),t.qZA(),t.TgZ(9,"option",15),t._uU(10," \u2265 "),t.qZA(),t.qZA(),t._UZ(11,"input",16),t.TgZ(12,"fa-icon",17),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw().removeDiscretizationStep(a)}),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=o.index,i=t.oxw();t.Q6J("formGroupName",e),t.xp6(12),t.Q6J("icon",i.faMinusCircle)("size","1x")}}let Ai=(()=>{class n extends ht.e{constructor(e){super(),this.formBuilder=e,this.discretizationInfo$=new t.vpe(null),this.faPlusCircle=X.KtF,this.faMinusCircle=X.uMC,this.discretizationStepsForm=this.formBuilder.group({discretizationSettings:this.formBuilder.array([this._createDiscretizationSettingFormGroup()]),matchType:new u.NI("and")})}ngOnInit(){this.discretizationStepsForm.valueChanges.pipe((0,wi.b)(500),(0,Rt.x)(),(0,D.U)(e=>{const i=e.discretizationSettings.filter(s=>s.discretizationType&&s.discretizationValue);return{matchType:e.matchType,discretizationSettings:i}}),(0,Rt.x)((e,i)=>JSON.stringify(e)===JSON.stringify(i)),(0,M.R)(this.destroyNotifier$)).subscribe(e=>{this.discretizationInfo$.next(e)})}removeDiscretizationStep(e){this.discretizationStepsForm.get("discretizationSettings").removeAt(e)}addDiscretizationStepFormGroup(){this.discretizationStepsForm.get("discretizationSettings").push(this._createDiscretizationSettingFormGroup())}_createDiscretizationSettingFormGroup(){return new u.cw({discretizationType:new u.NI("<=",u.kI.required),discretizationValue:new u.NI("",u.kI.required)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-define-discretization-steps"]],inputs:{values:"values"},outputs:{discretizationInfo$:"discretizationInfo$"},features:[t.qOj],decls:12,vars:5,consts:[[3,"formGroup"],["formArrayName","discretizationSettings"],[1,"mb-1"],[1,"form-inline"],[1,"form-control","form-control-sm",3,"formControl"],["value","and"],["value","or"],[3,"formGroupName",4,"ngFor","ngForOf"],["ngbTooltip","Add a step",1,"hoverBigger","mt-1","ml-1",3,"icon","size","click"],[3,"formGroupName"],[1,"form-inline","form-group-sm"],["formControlName","discretizationType",1,"form-control","form-control-sm",2,"width","8rem"],["value","less"],["value","lessAndEqual"],["value","greater"],["value","greaterAndEqual"],["formControlName","discretizationValue","type","number","data-testid","inputFilterValue",1,"form-control","form-control-sm",2,"width","5rem"],["ngbTooltip","Remove a step",1,"ml-1","hoverBigger",3,"icon","size","click"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"form",3),t.TgZ(4,"select",4),t.TgZ(5,"option",5),t._uU(6,"Match all (AND)"),t.qZA(),t.TgZ(7,"option",6),t._uU(8,"Match any (OR)"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(9,Ti,13,3,"div",7),t.qZA(),t.qZA(),t.TgZ(10,"div",3),t.TgZ(11,"fa-icon",8),t.NdJ("click",function(){return i.addDiscretizationStepFormGroup()}),t.qZA(),t.qZA()),2&e&&(t.Q6J("formGroup",i.discretizationStepsForm),t.xp6(4),t.Q6J("formControl",i.discretizationStepsForm.get("matchType")),t.xp6(5),t.Q6J("ngForOf",i.discretizationStepsForm.get("discretizationSettings").controls),t.xp6(2),t.Q6J("icon",i.faPlusCircle)("size","1x"))},directives:[u._Y,u.JL,u.sg,u.CE,u.F,u.EJ,u.JJ,u.oH,u.YN,u.Kr,l.sg,F.BN,Z._L,u.x0,u.u,u.Fj,u.wV],styles:[""],changeDetection:0}),n})();var Pt=p(4813),Zi=p(5903),Fi=p(3991);function $i(n,o){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit;t.hij(" ",e.get("name").value," ")}}function Ni(n,o){if(1&n&&t._UZ(0,"input",11),2&n){const e=t.oxw().index,i=t.oxw(2);t.Q6J("formControl",i.getControl(e,"name"))}}function Li(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"div",3),t.TgZ(3,"fa-icon",5),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw(2).removeCategoryFormGroup(a)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"td"),t.TgZ(5,"app-editable",6),t.YNc(6,$i,1,1,"ng-template",7),t.YNc(7,Ni,1,1,"ng-template",8),t.qZA(),t.qZA(),t.TgZ(8,"td"),t.TgZ(9,"app-define-discretization-steps",9),t.NdJ("discretizationInfo$",function(s){const c=t.CHM(e).index;return t.oxw(2).obtainCategoryPatientIDs(s,c)}),t.qZA(),t.qZA(),t.TgZ(10,"td"),t._UZ(11,"app-display-limited-items",10),t.qZA(),t.qZA()}if(2&n){const e=o.index,i=t.oxw(2);t.xp6(3),t.Q6J("icon",i.faMinus)("size","1x"),t.xp6(6),t.Q6J("values",i.values),t.xp6(2),t.Q6J("items",i.getControlValue(e,"patientIDs"))("displayNum",3)}}function Mi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"table",1),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t._UZ(3,"th"),t.TgZ(4,"th"),t._uU(5,"Category Name"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Filter"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Patients In the Category"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"tbody"),t.YNc(11,Li,12,5,"tr",2),t.TgZ(12,"tr"),t.TgZ(13,"td"),t.TgZ(14,"div",3),t.TgZ(15,"fa-icon",4),t.NdJ("click",function(){return t.CHM(e),t.oxw().addCategoryFormGroup()}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(11),t.Q6J("ngForOf",e.categoriesForm.get("categories").controls),t.xp6(4),t.Q6J("icon",e.faPlus)("size","1x")}}let Ui=(()=>{class n extends ht.e{constructor(e){super(),this.formBuilder=e,this.outputCategories$=new t.vpe(null),this.faPlus=X.r8p,this.faMinus=X.Kl4,this.categoriesForm=this.formBuilder.group({categories:this.formBuilder.array([this._ceateCategoryForm()])})}ngOnInit(){this.categoriesForm.get("categories").statusChanges.pipe((0,M.R)(this.destroyNotifier$)).subscribe(e=>{this.outputCategories$.next("VALID"===e?this.categoriesForm.get("categories").value:null)})}obtainCategoryPatientIDs(e,i){const s=e.matchType;let a=[],c=[];if(e.discretizationSettings.length>=1){for(let g of e.discretizationSettings){const I=k.PK[g.discretizationType](this.values,g.discretizationValue);a.push(new Set(I))}c=[...a.reduce(bi.JN[s])].map(g=>this.patientIDs[g])}this.categoriesForm.get("categories").at(i).patchValue({patientIDs:c})}removeCategoryFormGroup(e){this.categoriesForm.get("categories").removeAt(e)}addCategoryFormGroup(){this.categoriesForm.get("categories").push(this._ceateCategoryForm())}getControl(e,i){return this.categoriesForm.get("categories").at(e).get(i)}getControlValue(e,i){return this.categoriesForm.get("categories").at(e).get(i).value}_ceateCategoryForm(){return new u.cw({name:new u.NI("New Category",u.kI.required),patientIDs:new u.NI([],[u.kI.required,u.kI.minLength(1)])})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-discretize-continuous-variables"]],inputs:{values:"values",patientIDs:"patientIDs"},outputs:{outputCategories$:"outputCategories$"},features:[t.qOj],decls:1,vars:1,consts:[["class","table",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"form-inline"],["ngbTooltip","Add a new group","data-testid","addGroup",1,"hoverBigger",3,"icon","size","click"],["ngbTooltip","Delete this group",1,"hoverBigger",3,"icon","size","click"],["initialMode","edit"],["appEditableView",""],["appEditableEdit",""],[3,"values","discretizationInfo$"],[3,"items","displayNum"],["appEditableOnEnter","","appFocusable","","ngDefaultControl","","placeholder","Category Name","data-testid","inputCategoryName","required","",1,"form-control","form-control-sm",3,"formControl"]],template:function(e,i){1&e&&t.YNc(0,Mi,16,3,"table",0),2&e&&t.Q6J("ngIf",i.values)},directives:[l.O5,l.sg,F.BN,Z._L,Ii.y,xi.i,Ci.O,Ai,Pt.w,u.Fj,Zi._,Fi.x,u.Q7,u.JJ,u.oH],styles:[""],changeDetection:0}),n})();function Gi(n,o){if(1&n&&(t.TgZ(0,"tr",4),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"app-display-limited-items",5),t.qZA(),t.qZA()),2&n){const e=o.$implicit;t.Q6J("ngbTooltip","Click to drag and move category to re-order the categories"),t.xp6(2),t.hij(" ",e.name," "),t.xp6(2),t.hij(" ",e.patientIDs.length," "),t.xp6(2),t.Q6J("items",e.patientIDs)("displayNum",3)}}function qi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"table",1),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th"),t._uU(4,"Group Name"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Samples Num"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Samples in the Group"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"tbody",2),t.NdJ("cdkDropListDropped",function(s){return t.CHM(e),t.oxw().onDrop(s)}),t.YNc(10,Gi,7,5,"tr",3),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(10),t.Q6J("ngForOf",e.categories)}}let Oi=(()=>{class n{constructor(){this.reorderedCategories$=new t.vpe}ngOnInit(){}onDrop(e){(0,T.bA)(this.categories,e.previousIndex,e.currentIndex),this.reorderedCategories$.next(this.categories)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-re-order-clincial-catetories"]],inputs:{categories:"categories"},outputs:{reorderedCategories$:"reorderedCategories$"},decls:1,vars:1,consts:[["class","table",4,"ngIf"],[1,"table"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","","cdkDragLockAxis","y",3,"ngbTooltip",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y",3,"ngbTooltip"],[3,"items","displayNum"]],template:function(e,i){1&e&&t.YNc(0,qi,11,1,"table",0),2&e&&t.Q6J("ngIf",i.categories.length>=1)},directives:[l.O5,T.Wj,l.sg,T.Zt,Z._L,Pt.w],styles:[""],changeDetection:0}),n})();function Ei(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-discretize-continuous-variables",5),t.NdJ("outputCategories$",function(s){return t.CHM(e),t.oxw().processClinicalCategories(s)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("values",e.numberFormatAttributeValues)("patientIDs",e.followUpInfo.patientIDs)}}function Ri(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-re-order-clincial-catetories",6),t.NdJ("reorderedCategories$",function(s){return t.CHM(e),t.oxw().processClinicalCategories(s)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("categories",e.rawOrderCategories)}}let Pi=(()=>{class n{constructor(){this.clinicalCategoryInfo$=new t.vpe,this.ifOrNotDiscretize=["Yes","No"],this.ifDiscretize=!1,this.ifReOrder=!1}ngOnInit(){}processSelectedClinicalFeature(e){this.rawAttributeValues=[...this.followUpInfo.followUpAttrValues[e]],this.selectedAttribute=e}processIfOrNotDiscretize(e){if("Yes"===e)this.ifDiscretize=!0,this.ifReOrder=!1,this.numberFormatAttributeValues=this.rawAttributeValues.map(i=>parseFloat(i));else{this.ifDiscretize=!1,this.ifReOrder=!0;const i=this.rawAttributeValues.map(s=>s.toString());this.rawOrderCategories=this._obtainCategories(i),this.clinicalCategoryInfo$.next({attributeName:this.selectedAttribute,categories:this.rawOrderCategories})}}processClinicalCategories(e){this.clinicalCategoryInfo$.next({attributeName:this.selectedAttribute,categories:e})}_obtainCategories(e){return[...new Set(e)].map(a=>({name:a,patientIDs:(0,k.B3)(e,a).map(r=>this.followUpInfo.patientIDs[r])}))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-clinical-feature-survival-settings"]],inputs:{followUpInfo:"followUpInfo"},outputs:{clinicalCategoryInfo$:"clinicalCategoryInfo$"},decls:7,vars:8,consts:[["data-testid","clinicalFeature",3,"inputItems","itemLabel","ifWidthAuto","selectedItem$"],[1,"mt-2"],["data-testid","ifDiscretize",3,"inputItems","ifWidthAuto","itemLabel","selectedItem$"],[3,"values","patientIDs","outputCategories$",4,"ngIf"],[3,"categories","reorderedCategories$",4,"ngIf"],[3,"values","patientIDs","outputCategories$"],[3,"categories","reorderedCategories$"]],template:function(e,i){1&e&&(t.TgZ(0,"app-select-item",0),t.NdJ("selectedItem$",function(a){return i.processSelectedClinicalFeature(a)}),t.qZA(),t.TgZ(1,"div",1),t.TgZ(2,"app-select-item",2),t.NdJ("selectedItem$",function(a){return i.processIfOrNotDiscretize(a)}),t.qZA(),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,Ei,1,2,"app-discretize-continuous-variables",3),t.qZA(),t.TgZ(5,"div",1),t.YNc(6,Ri,1,1,"app-re-order-clincial-catetories",4),t.qZA()),2&e&&(t.Q6J("inputItems",null==i.followUpInfo?null:i.followUpInfo.followUpAttributes)("itemLabel","Clinical Feature")("ifWidthAuto",!0),t.xp6(2),t.Q6J("inputItems",i.ifOrNotDiscretize)("ifWidthAuto",!0)("itemLabel","If Discretize the Feature"),t.xp6(2),t.Q6J("ngIf",i.ifDiscretize),t.xp6(2),t.Q6J("ngIf",i.ifReOrder))},directives:[W.y,l.O5,Ui,Oi],styles:[""],changeDetection:0}),n})();const Ji=["submitButton"];function Vi(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(s){return t.CHM(e),t.oxw().importFollowUpData(s)}),t._uU(1," Import Follow-up Data\n"),t.qZA()}}function ji(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"p",9),t._uU(1," If the follow-up data you want to analyze is not in the list. "),t.TgZ(2,"a",10),t.NdJ("click",function(s){return t.CHM(e),t.oxw().importFollowUpData(s)}),t._uU(3,"Import New Follow-up Data"),t.qZA(),t.qZA()}}let Hi=(()=>{class n extends ht.e{constructor(){super(),this.importFollowUpSignal$=new t.vpe,this.selectedFollowUpDataID$=new t.vpe,this.categorySurvivalRequestInfo$=new t.vpe,this.followUpDataIDsubject=new _.X(null),this.endPointSettingsSubject=new _.X(null),this.clinicalCategorySurvivalSettingsSubject=new _.X(null)}ngOnInit(){this.ifSubmitAvailable$=(0,J.aj)([this.followUpDataIDsubject,this.endPointSettingsSubject,this.clinicalCategorySurvivalSettingsSubject]).pipe((0,D.U)(([e,i,s])=>!!(e&&i&&s)),(0,Q.O)(),(0,M.R)(this.destroyNotifier$))}ngAfterViewInit(){this.submitStream$=(0,Ft.R)(this.submitButton.nativeElement,"click"),this.submitStream$.subscribe(e=>{}),this.submitStream$.pipe((0,S.h)(e=>null!=e),(0,H.M)(this.followUpDataIDsubject,this.endPointSettingsSubject,this.clinicalCategorySurvivalSettingsSubject),(0,D.U)(([e,i,s,a])=>({followUpDataID:i,endpointSettings:s,clinicalCategory:a})),(0,M.R)(this.destroyNotifier$)).subscribe(e=>{this.categorySurvivalRequestInfo$.next(e)})}ngOnChanges(e){e.followUpDataInfo&&e.followUpDataInfo.isFirstChange()}importFollowUpData(e){this.importFollowUpSignal$.next(!0)}processSelectedFollowUpDataID(e){this.selectedFollowUpDataID$.next(e),this.followUpDataIDsubject.next(e)}processSelectedStatusAttribute(e){const i=[...this.followUpDataInfo.followUpAttrValues[e]];this.availableStatusValues=[...new Set(i)]}processEndpointSettings(e){this.endPointSettingsSubject.next(e)}processCategorySurvivalSettings(e){this.clinicalCategorySurvivalSettingsSubject.next(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-generate-new-survival-analysis-clinical-feature"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ji,5),2&e){let s;t.iGM(s=t.CRH())&&(i.submitButton=s.first)}},inputs:{availableFollowUpDataIDs:"availableFollowUpDataIDs",clinicalAttributes:"clinicalAttributes",followUpDataInfo:"followUpDataInfo"},outputs:{importFollowUpSignal$:"importFollowUpSignal$",selectedFollowUpDataID$:"selectedFollowUpDataID$",categorySurvivalRequestInfo$:"categorySurvivalRequestInfo$"},features:[t.qOj,t.TTD],decls:10,vars:12,consts:[["data-testid","selectFollowUpData",3,"inputItems","itemLabel","emptyNote","ifWidthAuto","selectedItem$"],["class","btn btn-sm btn-expressvis","data-testid","importFollowUpData",3,"click",4,"ngIf"],["data-testid","newImportFollowUpData",4,"ngIf"],[1,"mt-2"],[3,"clinicalAttributes","availableStatusValues","selectedStatusAttribute$","endpointSettings$"],[3,"followUpInfo","clinicalCategoryInfo$"],["data-testid","submitCategorySurvivalAnalysis",1,"mt-3","btn","btn-expressvis",3,"disabled"],["submitButton",""],["data-testid","importFollowUpData",1,"btn","btn-sm","btn-expressvis",3,"click"],["data-testid","newImportFollowUpData"],["href","javascript:void(0)",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"app-select-item",0),t.NdJ("selectedItem$",function(a){return i.processSelectedFollowUpDataID(a)}),t.qZA(),t.YNc(1,Vi,2,0,"button",1),t.YNc(2,ji,4,0,"p",2),t.TgZ(3,"div",3),t.TgZ(4,"app-generate-endpoint-settings",4),t.NdJ("selectedStatusAttribute$",function(a){return i.processSelectedStatusAttribute(a)})("endpointSettings$",function(a){return i.processEndpointSettings(a)}),t.qZA(),t.qZA(),t.TgZ(5,"app-generate-clinical-feature-survival-settings",5),t.NdJ("clinicalCategoryInfo$",function(a){return i.processCategorySurvivalSettings(a)}),t.qZA(),t.TgZ(6,"button",6,7),t.ALo(8,"async"),t._uU(9," Submit\n"),t.qZA()),2&e&&(t.Q6J("inputItems",i.availableFollowUpDataIDs)("itemLabel","FollowUp Data")("emptyNote","Please load follow up data first")("ifWidthAuto",!0),t.xp6(1),t.Q6J("ngIf",!((null==i.availableFollowUpDataIDs?null:i.availableFollowUpDataIDs.length)>0)),t.xp6(1),t.Q6J("ngIf",(null==i.availableFollowUpDataIDs?null:i.availableFollowUpDataIDs.length)>0),t.xp6(2),t.Q6J("clinicalAttributes",null==i.followUpDataInfo?null:i.followUpDataInfo.followUpAttributes)("availableStatusValues",i.availableStatusValues),t.xp6(1),t.Q6J("followUpInfo",i.followUpDataInfo),t.xp6(1),t.Q6J("disabled",!t.lcZ(8,10,i.ifSubmitAvailable$)))},directives:[W.y,l.O5,$t,Pi],pipes:[l.Ov],styles:[""],changeDetection:0}),n})();const ki=["importClinicalData"];function Yi(n,o){if(1&n&&t._UZ(0,"app-d3-kmline-plot",11),2&n){const e=t.oxw().ngIf;t.Q6J("kmlineData",e)}}function Wi(n,o){if(1&n&&(t.TgZ(0,"div",9),t.YNc(1,Yi,1,1,"app-d3-kmline-plot",10),t.qZA()),2&n){const e=o.ngIf;t.xp6(1),t.Q6J("ngIf",e)}}function zi(n,o){1&n&&(t.TgZ(0,"p",12),t._uU(1,"Please Generate a new analysis in the left sidebar"),t.qZA())}function Qi(n,o){1&n&&(t.TgZ(0,"p",21),t._uU(1," Success: The follow-up data has been successfully loaded. Close the modal and go back to the main page "),t.qZA())}function Ki(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",13),t.TgZ(1,"button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return null==s.importClinicalModalRef?null:s.importClinicalModalRef.hide()}),t.TgZ(2,"span",15),t._uU(3,"\xd7"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",16),t.TgZ(5,"app-import-clinical-data",17),t.NdJ("followUpData$",function(s){return t.CHM(e),t.oxw().processFollowUpData(s)}),t.ALo(6,"async"),t.ALo(7,"async"),t.qZA(),t.qZA(),t.TgZ(8,"div",18),t.YNc(9,Qi,2,0,"p",19),t.TgZ(10,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().importClinicalModalRef.hide()}),t._uU(11," close "),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("availableDatasetIDs",t.lcZ(6,4,e.availableDatasetIDs$))("latestFollowUpDataID",t.lcZ(7,6,e.latestFollowUpDataID$))("ifRelatedWithDatasetDefault","No"),t.xp6(4),t.Q6J("ngIf",e.ifShowClinicalSuccessNote)}}let Bi=(()=>{class n{constructor(e,i,s){this.facade=e,this.modalService=i,this.cdr=s,this.ifShowClinicalSuccessNote=!1,this.latestFollowUpDataID$=this.facade.latestFollowUpDataID$,this.latestFollowUpDataID$.subscribe(a=>{this.cdr.detectChanges()}),this.availableFollowUpDataIDs$=this.facade.availableFollowUpDataIDs$,this.availableDatasetIDs$=this.facade.allDatasetInfoForDisplay$.pipe((0,D.U)(a=>a.map(c=>c.datasetID))),this.followUpDataInfo$=this.facade.followUpDataInfoForClinicalFeature$,this.categoryKMlineDataInfoForPlot$=this.facade.categoryKMlineDataInfoForPlot$}ngOnInit(){}processSelectedFollowUpDataID(e){this.facade.processSelectedFollowUpDataID(e)}processCategorySurvivalRequestInfo(e){this.facade.processCategorySurvivalRequestInfo(e)}processImportClinicalDataSignal(e){this.importClinicalModalRef=this.modalService.show(this.importClinicalData,{class:"modal-lg"}),this.cdr.detectChanges()}processFollowUpData(e){this.facade.processFollowUpData(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(dt),t.Y36(R.tT),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-survival-analysis-clinical-features"]],viewQuery:function(e,i){if(1&e&&t.Gf(ki,5,t.Rgc),2&e){let s;t.iGM(s=t.CRH())&&(i.importClinicalData=s.first)}},decls:18,vars:10,consts:[[1,"row"],[1,"col-12","col-md-5","col-xl-4","border","mt-2","pl-4"],[1,"mt-4"],[3,"availableFollowUpDataIDs","followUpDataInfo","selectedFollowUpDataID$","categorySurvivalRequestInfo$","importFollowUpSignal$"],[1,"col-12","col-md-7","col-xl-8","mt-2"],[1,"text-center"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["newNote",""],["importClinicalData",""],[1,"d-flex","justify-content-center"],["appD3ExportMap","",3,"kmlineData",4,"ngIf"],["appD3ExportMap","",3,"kmlineData"],[1,"text-danger"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"availableDatasetIDs","latestFollowUpDataID","ifRelatedWithDatasetDefault","followUpData$"],[1,"modal-footer"],["class","text-success","data-testid","clinicalSuccessNote",4,"ngIf"],["data-testid","closeClinicalImport","type","button",1,"btn","btn-default",3,"click"],["data-testid","clinicalSuccessNote",1,"text-success"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h4",2),t._uU(3,"Generate a New Survival Analysis"),t.qZA(),t.TgZ(4,"app-generate-new-survival-analysis-clinical-feature",3),t.NdJ("selectedFollowUpDataID$",function(a){return i.processSelectedFollowUpDataID(a)})("categorySurvivalRequestInfo$",function(a){return i.processCategorySurvivalRequestInfo(a)})("importFollowUpSignal$",function(a){return i.processImportClinicalDataSignal(a)}),t.ALo(5,"async"),t.ALo(6,"async"),t.qZA(),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"div"),t.TgZ(9,"h5",5),t._uU(10," KM plot "),t.qZA(),t.TgZ(11,"div"),t.YNc(12,Wi,2,1,"div",6),t.ALo(13,"async"),t.YNc(14,zi,2,0,"ng-template",null,7,t.W1O),t.qZA(),t.qZA(),t.YNc(16,Ki,12,8,"ng-template",null,8,t.W1O),t.qZA(),t.qZA()),2&e){const s=t.MAs(15);t.xp6(4),t.Q6J("availableFollowUpDataIDs",t.lcZ(5,4,i.availableFollowUpDataIDs$))("followUpDataInfo",t.lcZ(6,6,i.followUpDataInfo$)),t.xp6(8),t.Q6J("ngIf",t.lcZ(13,8,i.categoryKMlineDataInfoForPlot$))("ngIfElse",s)}},directives:[Hi,l.O5,Et,ft.I,Ot],pipes:[l.Ov],styles:[""]}),n})();function Xi(n,o){1&n&&t._UZ(0,"app-survival-analysis-expression-split",1)}function tn(n,o){1&n&&t._UZ(0,"app-survival-analysis-clinical-features",1)}const Jt=function(n){return{active:n}},en=[{path:"",component:(()=>{class n{constructor(){this.survivalPurpose="GeneSplit"}ngOnInit(){}setActiveSurvivalPurpose(e){this.survivalPurpose=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-survival-exp"]],decls:14,vars:8,consts:[[1,"row","flex-xl-nowrap"],[1,"col-12"],["data-testid","differentSurvivalPurpose",1,"nav","nav-tabs"],[1,"nav-item"],["href","javascript:void(0)",1,"nav-link",3,"ngClass","click"],[1,"row"],["class","col-12",4,"ngIf"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"nav",2),t.TgZ(3,"li",3),t.TgZ(4,"a",4),t.NdJ("click",function(){return i.setActiveSurvivalPurpose("GeneSplit")}),t.TgZ(5,"h4"),t._uU(6,"Explore Genes's Effects on Patient Survival"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"li",3),t.TgZ(8,"a",4),t.NdJ("click",function(){return i.setActiveSurvivalPurpose("clinicalFeature")}),t.TgZ(9,"h4"),t._uU(10,"Explore Clinical Features on Patient Survival"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",5),t.YNc(12,Xi,1,0,"app-survival-analysis-expression-split",6),t.YNc(13,tn,1,0,"app-survival-analysis-clinical-features",6),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngClass",t.VKq(4,Jt,"GeneSplit"===i.survivalPurpose)),t.xp6(4),t.Q6J("ngClass",t.VKq(6,Jt,"clinicalFeature"===i.survivalPurpose)),t.xp6(4),t.Q6J("ngIf","GeneSplit"===i.survivalPurpose),t.xp6(1),t.Q6J("ngIf","clinicalFeature"===i.survivalPurpose))},directives:[l.mk,l.O5,yi,Bi],styles:[".sidebar[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:1rem;max-height:calc(100vh - 4rem);margin-right:-1rem;overflow-x:hidden;overflow-y:auto}"]}),n})()}];let nn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[v.Bz.forChild(en)],v.Bz]}),n})(),sn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[dt],imports:[[l.ez,u.u5,u.UX,R.zk.forRoot(),T._t,Z.HK,F.uH,m.m,$.D,P.f,C.r,nn]]}),n})()},3945:(nt,E,p)=>{p.d(E,{q:()=>F});var l=p(3668),u=p(6019),T=p(8638),Z=p(9133);function R($,P){if(1&$){const m=l.EpF();l.TgZ(0,"div",6),l.TgZ(1,"button",7),l._uU(2),l._UZ(3,"span",8),l.qZA(),l.TgZ(4,"ul",9),l.TgZ(5,"li"),l.TgZ(6,"input",10),l.NdJ("ngModelChange",function(v){const _=l.CHM(m).$implicit;return l.oxw().modifiedSettings[_.name]=v})("mouseup",function(v){return l.CHM(m),l.oxw().changePlotSetting(v),v.stopPropagation()}),l.qZA(),l._uU(7),l.qZA(),l.qZA(),l.qZA()}if(2&$){const m=P.$implicit,C=l.oxw();l.xp6(2),l.hij(" ",m.name," "),l.xp6(4),l.Q6J("step",m.stepValue)("min",m.minValue)("max",m.maxValue)("ngModel",C.modifiedSettings[m.name]),l.xp6(1),l.hij(" ",C.modifiedSettings[m.name]," ")}}let F=(()=>{class ${constructor(m,C){this.elem=m,this.renderer=C,this.modifiedSettings$=new l.vpe,this.closeSignal$=new l.vpe,this.modifiedSettings={}}ngOnInit(){this.plotSettingInfoList&&this.plotSettingInfoList.forEach(m=>{this.modifiedSettings[m.name]=m.defaultValue})}ngAfterViewInit(){}onClick(m){m.stopPropagation(),["BUTTON","INPUT"].indexOf(m.target.tagName)<0&&(this.elem.nativeElement.querySelectorAll(".dropdown-menu").forEach(_=>{this.renderer.removeClass(_,"show")}),this.elem.nativeElement.querySelectorAll(".dropdown").forEach(_=>{this.renderer.removeClass(_,"show")}),this.elem.nativeElement.querySelectorAll("button[aria-expanded='true']").forEach(_=>{this.renderer.setAttribute(_,"aria-expanded","false")}))}onMousemove(m){this.checkIfEventOnDropdownMenu(m)&&m.stopPropagation()}onMouseup(m){this.checkIfEventOnDropdownMenu(m)&&m.stopPropagation()}onMousedown(m){this.checkIfEventOnDropdownMenu(m)&&m.stopPropagation()}checkIfEventOnDropdownMenu(m){return["BUTTON","INPUT","LI","UL"].includes(m.target.nodeName)}changePlotSetting(m){this.modifiedSettings$.next(this.modifiedSettings)}closeThisComponent(m){this.closeSignal$.next(!0)}}return $.\u0275fac=function(m){return new(m||$)(l.Y36(l.SBq),l.Y36(l.Qsj))},$.\u0275cmp=l.Xpm({type:$,selectors:[["app-change-figure-settings"]],hostBindings:function(m,C){1&m&&l.NdJ("click",function(t){return C.onClick(t)})("mousemove",function(t){return C.onMousemove(t)})("mouseup",function(t){return C.onMouseup(t)})("mousedown",function(t){return C.onMousedown(t)})},inputs:{plotSettingInfoList:"plotSettingInfoList"},outputs:{modifiedSettings$:"modifiedSettings$",closeSignal$:"closeSignal$"},decls:9,vars:1,consts:[[2,"height","1rem"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[2,"height","50%","min-height","20rem"],[1,"d-flex","flex-column"],["ngbDropdown","","class","align-self-start btn-group mt-1 ","style","display:block","role","group",4,"ngFor","ngForOf"],["ngbDropdown","","role","group",1,"align-self-start","btn-group","mt-1",2,"display","block"],["ngbDropdownToggle","","type","button","id","drowdownSetting","data-toggle","dropdown","aria-haspopup","true","aria-expanded","true",1,"btn","btn-light","btn-sm","dropdown-toggle"],[1,"caret"],["ngbDropdownMenu","","aria-labelledby","drowdownSetting",1,"dropdown-menu"],["type","range","name","points","value","settingInfo.defaultValue","data-show-value","true","data-popup-enabled","true",3,"step","min","max","ngModel","ngModelChange","mouseup"]],template:function(m,C){1&m&&(l.TgZ(0,"div",0),l.TgZ(1,"button",1),l.NdJ("click",function(t){return C.closeThisComponent(t)}),l.TgZ(2,"span",2),l._uU(3,"\xd7"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(4,"div",3),l.TgZ(5,"div",4),l.TgZ(6,"p"),l._uU(7,"Plot Settings"),l.qZA(),l.YNc(8,R,8,6,"div",5),l.qZA(),l.qZA()),2&m&&(l.xp6(8),l.Q6J("ngForOf",C.plotSettingInfoList))},directives:[u.sg,T.jt,T.iD,T.Vi,Z.eT,Z.Fj,Z.JJ,Z.On],styles:[""],changeDetection:0}),$})()},9918:(nt,E,p)=>{p.d(E,{n:()=>P});var l=p(3668),u=p(9256),T=p(8638),Z=p(6019);const R=["displayTutorialGifComponent"];function F(m,C){if(1&m){const v=l.EpF();l.TgZ(0,"button",5),l.NdJ("click",function(){const J=l.CHM(v).$implicit;return l.oxw().outputTutorialGif(J)}),l._uU(1),l.qZA()}if(2&m){const v=C.$implicit;l.xp6(1),l.hij(" ",v.name," ")}}function $(m,C){if(1&m){const v=l.EpF();l.TgZ(0,"div",6),l.TgZ(1,"button",7),l.NdJ("click",function(){l.CHM(v);const _=l.oxw();return null==_.displayTutorialModalRef?null:_.displayTutorialModalRef.hide()}),l.TgZ(2,"span",8),l._uU(3,"\xd7"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(4,"div",9),l.TgZ(5,"h4"),l._uU(6),l.qZA(),l._UZ(7,"img",10),l.qZA(),l.TgZ(8,"div",11),l.TgZ(9,"button",12),l.NdJ("click",function(){return l.CHM(v),l.oxw().displayTutorialModalRef.hide()}),l._uU(10,"close"),l.qZA(),l.qZA()}if(2&m){const v=l.oxw();l.xp6(6),l.Oqu(v.selectedTutorialGifInfo.name),l.xp6(1),l.Q6J("src",v.selectedTutorialGifInfo.src,l.LSH)}}let P=(()=>{class m{constructor(v,t){this.modalService=v,this.cdr=t,this.selectedTutorialGif$=new l.vpe}ngOnInit(){}outputTutorialGif(v){this.displayTutorialModalRef=this.modalService.show(this.displayTutorialGifComponent,Object.assign({},{class:"modal-lg"})),this.selectedTutorialGifInfo=Object.assign({},v)}}return m.\u0275fac=function(v){return new(v||m)(l.Y36(u.tT),l.Y36(l.sBO))},m.\u0275cmp=l.Xpm({type:m,selectors:[["app-trigger-to-display-tutorial-gif"]],viewQuery:function(v,t){if(1&v&&l.Gf(R,5,l.Rgc),2&v){let _;l.iGM(_=l.CRH())&&(t.displayTutorialGifComponent=_.first)}},inputs:{tutorialGifInfos:"tutorialGifInfos"},outputs:{selectedTutorialGif$:"selectedTutorialGif$"},decls:7,vars:1,consts:[["ngbDropdown","",1,"d-inline-block"],["id","tutorialGifs","ngbDropdownToggle","",1,"btn","btn-sm","btn-outline-expressvis"],["ngbDropdownMenu","","aria-labelledby","tutorialGifs"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],["displayTutorialGifComponent",""],["ngbDropdownItem","",3,"click"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"img-fluid","rounded","mx-auto","d-block",3,"src"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default","btn-sm",3,"click"]],template:function(v,t){1&v&&(l.TgZ(0,"div",0),l.TgZ(1,"button",1),l._uU(2,"Key Operations"),l.qZA(),l.TgZ(3,"div",2),l.YNc(4,F,2,1,"button",3),l.qZA(),l.qZA(),l.YNc(5,$,11,2,"ng-template",null,4,l.W1O)),2&v&&(l.xp6(4),l.Q6J("ngForOf",t.tutorialGifInfos))},directives:[T.jt,T.iD,T.Vi,Z.sg,T.TH],styles:[""],changeDetection:0}),m})()},277:(nt,E,p)=>{p.d(E,{Y:()=>T});var l=p(3668);const u={asc:"desc",desc:"","":"asc"};let T=(()=>{class Z{constructor(F,$){this.renderer=F,this.el=$,this.sortableColumn="",this.direction="",this.sort=new l.vpe}rotate(){const F=this.el.nativeElement;this.direction&&this.renderer.removeClass(F,this.direction),this.direction=u[this.direction],this.direction&&this.renderer.addClass(F,this.direction),this.sort.emit({column:this.sortableColumn,direction:this.direction})}}return Z.\u0275fac=function(F){return new(F||Z)(l.Y36(l.Qsj),l.Y36(l.SBq))},Z.\u0275dir=l.lG2({type:Z,selectors:[["th","sortable",""]],hostVars:4,hostBindings:function(F,$){1&F&&l.NdJ("click",function(){return $.rotate()}),2&F&&l.ekj("asc","asc"===$.direction)("desc","desc"===$.direction)},inputs:{sortableColumn:"sortableColumn",direction:"direction"},outputs:{sort:"sort"}}),Z})()}}]);