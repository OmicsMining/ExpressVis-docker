"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[785],{9785:(_l,Ne,D)=>{D.r(Ne),D.d(Ne,{KeggExploreModule:()=>vl});var B=D(6019),oe=D(1144),Gt=D(9133),Me=D(9256),Fe=D(8638),Le=D(3553),Ce=D(3856),es=D(8702),ns=D(3928),ss=D(3667),i=D(3668),R=D(4099),q=D(9220),x=D(8735),T=D(8053),at=D(5571),m=D(8472),Ot=D(8526),ft=D(2668),X=D(2411),tt=D(6813),P=D(9204),G=D(6636),le=D(1366),dt=D(2047),ce=D(5389),is=D(7194),ot=D(6723);const as=(0,m.P1)(t=>t.keggExpState.availableKeggPathwaysList,t=>t),Re=t=>t.keggExpState.pathwayGenesClusteringResultInDatasetState,ke=(0,m.P1)(Re,(t,n)=>t.ids),Ze=(0,m.P1)(ke,(t,n)=>!!t.includes(n.clusterResultID)),os=(0,m.P1)(Re,(t,n)=>t.entities[n.clusterResultID]),He=t=>t.keggExpState.mapTransformationState,Oe=(0,m.P1)(He,(t,n)=>t.ids),ls=(0,m.P1)(Oe,(t,n)=>!!t.includes(n.pathwayID)),cs=(0,m.P1)(He,(t,n)=>t.entities[n.pathwayID].transform),ze=t=>t.keggExpState.expPatternMapVisTransformSettingState,qe=(0,m.P1)(ze,(t,n)=>t.ids),us=(0,m.P1)(qe,(t,n)=>!!t.includes(n.mapID)),hs=(0,m.P1)(ze,(t,n)=>t.entities[n.mapID]),Ue=t=>t.keggExpState.geneListForHighlightState,gs=(0,m.P1)(Ue,(t,n)=>t.ids),ps=(0,m.P1)(Ue,(t,n)=>t.entities[n.name].entryIDs);var Ye=D(8425),fs=D(661),z=D(7473),ds=D(9744),ms=D(9712),ys=D(471);const Ve=t=>t.geneIDmappingState.withinSpeciesIDmappingInfo,{selectIds:Is,selectEntities:Ds}=ms.PX.getSelectors(),zt=(0,m.P1)(Ve,Is),vs=(0,m.P1)(Ve,Ds),Tt=(0,m.P1)(zt,(t,n)=>n.sourceIDtype===n.targetIDtype||!!t.includes(`${n.speciesID}-${n.sourceIDtype}-${n.targetIDtype}`)),_t=(0,m.P1)(vs,(t,n)=>function(t,n){const e=new Set(Object.keys(t)),s=new Set(n),r=(0,ys.jV)(e,s);let o=[];for(let l of r)o=o.concat(t[l]);return Array.from(new Set(o))}(t[`${n.speciesID}-${n.sourceIDtype}-${n.targetIDtype}`].sourceID2targetID,n.sourceIDs));var ue=D(6531),_s=D(1890),Ss=D(8970),Pt=D(3052),he=D(6149),ge=D(4223);const Be=t=>t.keggPathwayState.availableKeggSpecies,xs=(0,m.P1)(Be,t=>[...t]),bs=(0,m.P1)(Be,t=>t.length>0),{selectAll:Ts}=ge.DM.getSelectors(),Xe=((0,m.P1)(t=>t.keggPathwayState.KOpathwayState,Ts),t=>t.keggPathwayState.speciesPathwaysState),{selectIds:Ps,selectEntities:Es}=ge.QM.getSelectors(),Je=(0,m.P1)(Xe,Ps),As=(0,m.P1)(Xe,Es),Ks=(0,m.P1)(Je,(t,n)=>!!t.includes(n.speciesID)),$s=(0,m.P1)(As,(t,n)=>t.hasOwnProperty(n.speciesID)?t[n.speciesID].pathways:null),Qe=t=>t.keggPathwayState.kgmlState,{selectIds:Ns,selectEntities:Ms}=ge.D1.getSelectors(),je=(0,m.P1)(Qe,Ns),We=(0,m.P1)(Qe,Ms),pe=(0,m.P1)(je,(t,n)=>!!t.includes(n.pathwayID)),Fs=(0,m.P1)(We,(t,n)=>t.hasOwnProperty(n.pathwayID)?t[n.pathwayID]:null),Ls=(0,m.P1)(We,(t,n)=>Object.keys(t[n.pathwayID].entryID2Symbol));var qt=D(5814),tn=D(7548),Cs=D(1118),Rs=D(877),mt=D(1218),en=D(4967),ks=D(8956),Zs=D(7089);const Ut=function(t,n,e){return[t,n,e].join("/")};var nn=D(540),Et=D(8260),Hs=D(4522);let Os=(()=>{class t{constructor(e){this.http=e,this.urlForAllKOpathways=Et.N.serverUrl+"restful/keggExplore/allkopathways/",this.urlForAllKeggSpecies=Et.N.serverUrl+"restful/keggExplore/allkeggspecies/",this.urlForOneSpeciesPathway=Et.N.serverUrl+"restful/keggExplore/onespeciespathways/",this.urlForKGMLentryIDinfo=Et.N.serverUrl+"restful/keggExplore/kgmlentryidinfo/"}requestKeggAllSpecies(){return this.http.get(this.urlForAllKeggSpecies).pipe((0,T.U)(e=>e.allKeggSpecies))}requestAllKOpathways(){return this.http.get(this.urlForAllKOpathways).pipe((0,T.U)(e=>e.keggKOpathways))}requestOneSpeciesPathways(e){return this.http.get(`${this.urlForOneSpeciesPathway}?speciesID=${e}`).pipe((0,T.U)(s=>s.pathways),(0,dt.K)(s=>(0,nn._)(s)))}requestOnePathwayKGMLentryIDinfo(e,s){return this.http.get(`${this.urlForKGMLentryIDinfo}?speciesID=${e}&pathwayID=${s}`).pipe((0,T.U)(r=>r.KEGGkgmlEntryIDInfo),(0,dt.K)(r=>(0,nn._)(r)))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Hs.eN))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var zs=D(4165),qs=D(726),Us=D(9990),Ys=D(9868),Vs=D(4205),Bs=D(5535),Xs=D(4473);let sn=(()=>{class t extends is.g{constructor(e,s,r,o,c,l,h,g,f){super(e,h,g,f),this.store=e,this.keggService=s,this.clusterService=r,this.diffAnalysisRequestService=o,this.trySamppleService=c,this.interAppsInteractService=l,this.requestKeggAllSpecies$=new R.X(null),this.speciesForKeggPathways$=new R.X(null),this.pathwayKgmlEntryRequestFromKeggPage$=new R.X(null),this.datasetHierarRequestSubject=new R.X(null),this.datasetForDiffGenesHighlight$=new R.X(null),this.groupPairForDiffGenesHighlight$=new R.X(null),this.diffFilterInput$=new R.X(null),this.addGeneListIDForSpecificGenesHighlight$=new R.X(null),this.removeGeneListIDForSpecificGenesHighlight$=new R.X(null),this.obtainGenesForSpecificGenesHighlight$=new R.X(null),this.genesSelectedFromExpressionPattern$=new R.X(null),this.genesSelectedFromPathwayMap$=new R.X(null),this.modifyKeggMapTransformation$=new R.X(null),this.requestDiffAnalysisOfRemoteDataFromServer$=new R.X(null),this.requestDiffAnalysisOfLocalDataFromServer$=new R.X(null),this.keggKgmlEntryID2SymbolTransformStatusSubject=new R.X(null),this.currentVisKeggPathwayIDsubject=new R.X(null),this.addAvailableKeggPathwaySubject=new R.X(null),this.genesClusteringResultStatusSubject=new R.X(null),this.datasetGroupsWithStatusNoteSubject=new R.X(null),this.addGeneListForHighlightNoteSubject=new R.X(null),this.updateGenesExpressionVisSettingsSubject=new R.X(null),this.genesClusteringResultStatus$=this.genesClusteringResultStatusSubject.asObservable(),this.keggKgmlEntryID2SymbolTransformStatus$=this.keggKgmlEntryID2SymbolTransformStatusSubject.asObservable(),this.currentVisKeggPathwayID$=this.currentVisKeggPathwayIDsubject.asObservable(),this.datasetGroupsWithStatusNote$=this.datasetGroupsWithStatusNoteSubject.asObservable(),this.addGeneListForHighlightNote$=this.addGeneListForHighlightNoteSubject.asObservable(),this.pathwayRequestFromOtherApp$=this.interAppsInteractService.keggPathwayFromOtherApp$,this.pathwayKgmlEntryRequest$=(0,Ot.T)(this.pathwayKgmlEntryRequestFromKeggPage$,this.pathwayRequestFromOtherApp$),this.requestKeggAllSpecies$.pipe((0,x.h)(a=>null!=a),(0,x.h)(a=>a),(0,P.w)(a=>this.store.pipe((0,m.Ys)(bs),(0,G.q)(1)).pipe((0,x.h)(u=>!u),(0,P.w)(u=>this.keggService.requestKeggAllSpecies())))).subscribe(a=>{this.store.dispatch(qt.rt({availableKeggSpecies:a}))}),this.availableKeggSpecies$=this.store.pipe((0,m.Ys)(xs)),this.speciesForKeggPathways$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>this.store.pipe((0,m.Ys)(Ks,{speciesID:a.taxID}),(0,G.q)(1)).pipe((0,x.h)(u=>!u),(0,P.w)(u=>this.keggService.requestOneSpeciesPathways(a.taxID)),(0,T.U)(u=>({speciesID:a.taxID,speciesName:a.name,pathways:u}))))).subscribe(a=>{this.store.dispatch(qt.yl({speciesPathways:a}))}),this.speciesKeggPathways$=(0,ft.aj)([this.store.pipe((0,m.Ys)(Je)),this.speciesForKeggPathways$.pipe((0,x.h)(a=>null!=a))]).pipe((0,P.w)(([a,u])=>this.store.pipe((0,m.Ys)($s,{speciesID:u.taxID}),(0,G.q)(1)))),this.availableKeggPathways$=this.store.pipe((0,m.Ys)(as)),this.allDatasetInfoForDisplay$=this.store.pipe((0,m.Ys)(z.yz)).pipe((0,T.U)(a=>[...a].reverse())),this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>this.store.pipe((0,m.Ys)(pe,{pathwayID:a.pathwayID}),(0,G.q)(1)).pipe((0,x.h)(u=>!u),(0,le.b)(u=>{this.keggKgmlEntryID2SymbolTransformStatusSubject.next({status:"loading",statusValue:"Request Pathway KGML file from the server"})}),(0,P.w)(u=>this.keggService.requestOnePathwayKGMLentryIDinfo(a.speciesID,a.pathwayID)),(0,dt.K)(u=>(0,X.of)({status:"error",statusValue:`error:${u.status}, errorText:${u.statusText}`}))))).subscribe(a=>{a.hasOwnProperty("status")?this.keggKgmlEntryID2SymbolTransformStatusSubject.next(a):(this.store.dispatch(qt.Te({kgmlEntryIDInfo:a})),this.store.dispatch(ot.bZ({KeggMapTransformationInfo:{pathwayID:a.ID,transform:{x:0,y:0,k:1}}})),this.addAvailableKeggPathwaySubject.next(a.ID))}),this.addAvailableKeggPathwaySubject.pipe((0,x.h)(a=>null!=a),(0,at.M)(this.speciesForKeggPathways$,this.speciesKeggPathways$),(0,T.U)(([a,u,d])=>{let y;for(let I of d)if(I.ID===a){y=I.name;break}return{ID:a,name:y,speciesName:u.name,speciesID:u.taxID}})).subscribe(a=>{this.store.dispatch(ot.Pu({KeggPathwayInfo:a}))}),(0,ft.aj)([this.store.pipe((0,m.Ys)(je)),this.store.pipe((0,m.Ys)(Oe)),this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a))]).pipe((0,P.w)(([a,u,d])=>{const y=this.store.pipe((0,m.Ys)(pe,{pathwayID:d.pathwayID}),(0,G.q)(1),(0,x.h)(v=>v)),I=this.store.pipe((0,m.Ys)(ls,{pathwayID:d.pathwayID}),(0,G.q)(1),(0,x.h)(v=>v));return(0,tt.D)([y,I]).pipe((0,T.U)(([v,_])=>({pathwayID:d.pathwayID,ifHasKGML:v,ifHasTransforms:_})))}),(0,x.h)(a=>a.ifHasKGML&&a.ifHasTransforms),(0,P.w)(a=>{const u=this.store.pipe((0,m.Ys)(Fs,{pathwayID:a.pathwayID}),(0,G.q)(1)),d=this.store.pipe((0,m.Ys)(cs,{pathwayID:a.pathwayID}),(0,G.q)(1));return(0,tt.D)([u,d]).pipe((0,T.U)(([y,I])=>Object.assign(Object.assign({},y),{transform:I})),(0,T.U)(y=>({status:"finished",statusValue:"finished",result:y})))})).subscribe(a=>{this.keggKgmlEntryID2SymbolTransformStatusSubject.next(a)}),(0,ft.aj)([this.datasetHierarRequestSubject.pipe((0,x.h)(a=>null!=a)),this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>this.store.pipe((0,m.Ys)(pe,{pathwayID:a.pathwayID}),(0,x.h)(u=>u),(0,T.U)(u=>a.pathwayID)))),this.store.pipe((0,m.Ys)(zt))]).pipe((0,P.w)(([a,u,d])=>{const y=Ut(u,a.datasetID,a.acrossGroupsOrSamples);return this.store.pipe((0,m.Ys)(Ze,{ID:y}),(0,G.q)(1),(0,x.h)(I=>!I),(0,T.U)(I=>({datasetID:a.datasetID,acrossGroupsOrSamples:a.acrossGroupsOrSamples,pathwayID:u})))}),(0,P.w)(a=>this.store.pipe((0,m.Ys)(z.iR,{datasetID:a.datasetID}),(0,G.q)(1),(0,T.U)(u=>({pathwayID:a.pathwayID,datasetID:a.datasetID,acrossGroupsOrSamples:a.acrossGroupsOrSamples,IDtype:u.IDtype})))),(0,at.M)(this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a),(0,T.U)(a=>({speciesID:a.speciesID,keggEntryIDtype:q.Qm.get(a.speciesID)})))),(0,T.U)(([a,u])=>({pathwayID:a.pathwayID,datasetID:a.datasetID,acrossGroupsOrSamples:a.acrossGroupsOrSamples,datasetGeneIDtype:a.IDtype,speciesID:u.speciesID,keggEntryIDtype:u.keggEntryIDtype})),(0,P.w)(a=>a.datasetGeneIDtype===a.keggEntryIDtype?(0,X.of)(Object.assign(Object.assign({},a),{ifIDmapingInfoExisted:!0})):this.store.pipe((0,m.Ys)(Tt,{speciesID:a.speciesID,sourceIDtype:a.keggEntryIDtype,targetIDtype:a.datasetGeneIDtype}),(0,G.q)(1),(0,T.U)(u=>Object.assign(Object.assign({},a),{ifIDmapingInfoExisted:u})))),(0,x.h)(a=>a.ifIDmapingInfoExisted),(0,ce.x)((a,u)=>JSON.stringify(a)===JSON.stringify(u)),(0,P.w)(a=>this.store.pipe((0,m.Ys)(Ls,{pathwayID:a.pathwayID}),(0,G.q)(1)).pipe((0,P.w)(u=>a.keggEntryIDtype===a.datasetGeneIDtype?(0,X.of)({pathwayID:a.pathwayID,datasetID:a.datasetID,genesInPathway:u,acrossGroupsOrSamples:a.acrossGroupsOrSamples}):this.store.pipe((0,m.Ys)(_t,{speciesID:a.speciesID,sourceIDtype:a.keggEntryIDtype,targetIDtype:a.datasetGeneIDtype,sourceIDs:u}),(0,G.q)(1),(0,T.U)(d=>({pathwayID:a.pathwayID,datasetID:a.datasetID,genesInPathway:d,acrossGroupsOrSamples:a.acrossGroupsOrSamples})))))),(0,P.w)(a=>{const u=this.store.pipe((0,m.Ys)(tn.l,{datasetID:a.datasetID,geneIDs:a.genesInPathway}),(0,G.q)(1)),d=this.store.pipe((0,m.Ys)(z.iR,{datasetID:a.datasetID}),(0,G.q)(1));return(0,tt.D)([u,d]).pipe((0,P.w)(([y,I])=>{const _=`${I.speciesID}-${I.IDtype}`,K=this.clusterService.requestNormalizedValuesSpecificClusterResult({experimentType:I.experimentType,dataArray:y.expressionValues,genes:y.geneIDs,samples:I.samples,groups:I.groups,acrossGroupsOrSamples:a.acrossGroupsOrSamples,clusterMethod:"Hierarchical",clusterMethodSetting:"average"}),N=this.store.pipe((0,m.Ys)(_s.MR,{ID:_,geneIDs:y.geneIDs}),(0,G.q)(1));return(0,tt.D)([K,N]).pipe((0,T.U)(([L,F])=>{const E=L.leftUniqueTerms.map(V=>F.get(V)),Z=Object.assign(Object.assign({},L),{leftDisplayTerms:E});return{clusterResultID:Ut(a.pathwayID,a.datasetID,a.acrossGroupsOrSamples),pathwayID:a.pathwayID,datasetID:a.datasetID,acrossGroupsOrSamples:a.acrossGroupsOrSamples,result:Z}}))}))})).subscribe(a=>{const u={mapID:a.clusterResultID,transform:{realTranslateX:0,realTranslateY:0,realScaleX:1,realScaleY:1,zoomTranslateX:0,zoomTranslateY:0,zoomScale:1},basicSetting:null};this.store.dispatch(ot.c3({pathwayGenesHierarClus:a})),this.store.dispatch(ot.vG({keggExpPatternTransform:u}))}),this.expressionPatternInfoInDataset$=(0,ft.aj)([this.datasetHierarRequestSubject.pipe((0,x.h)(a=>null!=a)),this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a)),this.store.pipe((0,m.Ys)(qe)),this.store.pipe((0,m.Ys)(ke))]).pipe((0,P.w)(([a,u,d,y])=>{const I=Ut(u.pathwayID,a.datasetID,a.acrossGroupsOrSamples),v=this.store.pipe((0,m.Ys)(Ze,{clusterResultID:I}),(0,G.q)(1),(0,x.h)(K=>K)),_=this.store.pipe((0,m.Ys)(us,{mapID:I}),(0,G.q)(1),(0,x.h)(K=>K));return(0,tt.D)([v,_]).pipe((0,x.h)(([K,N])=>K&&N),(0,P.w)(K=>{const N=this.store.pipe((0,m.Ys)(os,{clusterResultID:I}),(0,G.q)(1)),L=this.store.pipe((0,m.Ys)(hs,{mapID:I}),(0,G.q)(1));return(0,tt.D)([N,L]).pipe((0,T.U)(([F,E])=>({clusterResultID:F.clusterResultID,pathwayID:F.pathwayID,datasetID:F.datasetID,acrossGroupsOrSamples:F.acrossGroupsOrSamples,result:F.result,transform:E.transform,basicSetting:E.basicSetting})))}))})),this.updateGenesExpressionVisSettingsSubject.pipe((0,x.h)(a=>null!=a),(0,at.M)(this.pathwayKgmlEntryRequest$,this.datasetHierarRequestSubject),(0,T.U)(([a,u,d])=>{const y=Ut(u.pathwayID,d.datasetID,d.acrossGroupsOrSamples);return Object.assign(Object.assign({},a),{mapID:y})})).subscribe(a=>{this.store.dispatch(ot.WB({keggExpPatternTransform:a}))}),(0,Ot.T)(this.datasetHierarRequestSubject.pipe((0,x.h)(a=>null!=a),(0,T.U)(a=>({datasetID:a.datasetID,source:"expressionPattern"}))),this.datasetForDiffGenesHighlight$.pipe((0,x.h)(a=>null!=a),(0,T.U)(a=>({datasetID:a,source:"diffGenesHighlight"})))).pipe((0,P.w)(a=>this.store.pipe((0,m.Ys)(z.iR,{datasetID:a.datasetID}),(0,G.q)(1),(0,T.U)(u=>({IDtype:u.IDtype,source:a.source})))),(0,at.M)(this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!=a),(0,T.U)(a=>({speciesID:a.speciesID,keggEntryIDtype:q.Qm.get(a.speciesID)})))),(0,T.U)(([a,u])=>({speciesID:u.speciesID,datasetGeneIDtype:a.IDtype,keggEntryIDtype:u.keggEntryIDtype,source:a.source})),(0,x.h)(a=>a.datasetGeneIDtype!=a.keggEntryIDtype),(0,P.w)(a=>{const{speciesID:u,datasetGeneIDtype:d,keggEntryIDtype:y,source:I}=Object.assign({},a);return this.store.pipe((0,m.Ys)(Tt,{speciesID:u,sourceIDtype:d,targetIDtype:y}),(0,G.q)(1),(0,x.h)(v=>!v)).pipe((0,le.b)(v=>{"expressionPattern"===I&&this.genesClusteringResultStatusSubject.next({status:"loading",statusValue:"loading ID mapping data"}),"diffGenesHighlight"===I&&this.datasetGroupsWithStatusNoteSubject.next({status:"loading",statusValue:"Waiting for a moment. The app is requesting ID mapping infor from the server"})}),(0,P.w)(v=>this.geneAnnotationRequestService.requestSpeciesIDmappingInfoBetweenTwoIDtypes(u,d,y)),(0,dt.K)(v=>(0,X.of)({status:"error",statusValue:`error:${v.status}, errorText:${v.statusText}`})))})).subscribe(a=>{a.hasOwnProperty("status")?this.genesClusteringResultStatusSubject.next(a):this.store.dispatch(ue.S$({source2targetList:a}))}),this.datasetForDiffGenesHighlight$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>{let u=this.store.pipe((0,m.Ys)(z.XF,{datasetID:a}),(0,G.q)(1)),d=this.store.pipe((0,m.Ys)(Pt.ON,{datasetID:a}),(0,G.q)(1));return(0,tt.D)([u,d]).pipe((0,T.U)(([y,I])=>{const v=(0,mt.S8)(y,I);return{datasetID:a,diffGroupPairs:v}}))}),(0,x.h)(a=>a.diffGroupPairs.length>=1),(0,P.w)(a=>{const u=a.datasetID;return this.store.pipe((0,m.Ys)(z.iR,{datasetID:u}),(0,G.q)(1)).pipe((0,T.U)(d=>({datasetID:u,datasetLocalOrRemote:d.expressLocalOrRemote,experimentType:d.experimentType,diffGroupPairs:a.diffGroupPairs})))})).subscribe(a=>{this.datasetGroupsWithStatusNoteSubject.next({status:"loading",statusValue:"Wait for a moment. The app is requesting differential analysis results from the server"});const u={experimentType:a.experimentType,datasetID:a.datasetID,groupPairs:a.diffGroupPairs};a.datasetLocalOrRemote===Rs.M.remote?this.requestDiffAnalysisOfRemoteDataFromServer$.next(u):this.requestDiffAnalysisOfLocalDataFromServer$.next(u)}),this.requestDiffAnalysisOfLocalDataFromServer$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>{const u=a.datasetID,d=a.groupPairs;return this.store.pipe((0,m.Ys)(z.iR,{datasetID:u}),(0,G.q)(1)).pipe((0,P.w)(y=>{const I=y.experimentType,v=y.speciesID,_=y.IDtype,K=(0,mt.XU)(d),N=y.groups.filter(E=>K.has(E.name)),L=(0,en.Z)(N),F=(0,mt.FV)(d,L);return this.store.pipe((0,m.Ys)(tn.ZM,{datasetID:u}),(0,G.q)(1)).pipe((0,P.w)(E=>{const V=E.genes,it=(0,ks.l)(E.values,E.samples,F),vt=q.e8.get(I);return this.diffAnalysisRequestService.requestLocalDatasetDiffAnalysisMultipleGroupPairs({valuesDic:it,genes:V,groupPairs:d,groups2samples:L,experimentType:I,diffSoftware:vt})}),(0,T.U)(E=>{const O=E.diffSoftware;return E.diffResultList.map((it,vt)=>{const Q=d[vt];return{id:`${u}-${Q.targetGroup} VS ${Q.baseGroup}-${O}`,datasetID:u,baseGroup:Q.baseGroup,targetGroup:Q.targetGroup,diffSoftware:O,IDtype:_,speciesID:v,diffResults:it}})}),(0,dt.K)(E=>(0,X.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${E.status}, errorText:${E.statusText}`})))}))})).subscribe(a=>{a.hasOwnProperty("status")?this.datasetGroupsWithStatusNoteSubject.next(a):(this.store.dispatch(he.rv({diffAnalysisResultInfos:a})),this.datasetGroupsWithStatusNoteSubject.next({status:"finished",statusValue:"finished"}))}),this.requestDiffAnalysisOfRemoteDataFromServer$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>{const u=a.datasetID,d=a.groupPairs;return this.store.pipe((0,m.Ys)(z.iR,{datasetID:u}),(0,G.q)(1)).pipe((0,P.w)(y=>{const I=y.experimentType,v=y.speciesID,_=y.idType,K=y.database,N=(0,mt.XU)(d),L=y.groups.filter(E=>N.has(E.name)),F=(0,en.Z)(L);return this.diffAnalysisRequestService.requestRemoteDatasetDiffAnalysisMultipleGroupParis({database:K,datasetID:u,experimentType:I,IDtype:_,groupPairs:d,groups2samples:F,diffSoftware:q.e8[I]}).pipe((0,T.U)(E=>{const O=E.diffSoftware;return E.diffResultList.map((it,vt)=>{const Q=d[vt];return{id:`${u}-${Q.targetGroup} VS ${Q.baseGroup}-${O}`,datasetID:u,baseGroup:Q.baseGroup,targetGroup:Q.targetGroup,diffSoftware:O,IDtype:_,speciesID:v,diffResults:it}})}),(0,dt.K)(E=>(0,X.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${E.status}, errorText:${E.statusText}`})))}))})).subscribe(a=>{a.hasOwnProperty("status")?this.datasetGroupsWithStatusNoteSubject.next(a):(this.store.dispatch(he.rv({diffAnalysisResultInfos:a})),this.datasetGroupsWithStatusNoteSubject.next({status:"finished",statusValue:"finished"}))}),this.datasetGroupsWithStatus$=(0,ft.aj)([this.store.pipe((0,m.Ys)(Pt.Nq),(0,x.h)(a=>a.length>=1)),this.store.pipe((0,m.Ys)(zt)),this.datasetForDiffGenesHighlight$.pipe((0,x.h)(a=>null!=a))]).pipe((0,P.w)(([a,u,d])=>this.store.pipe((0,m.Ys)(z.iR,{datasetID:d}),(0,G.q)(1),(0,T.U)(y=>({datasetID:d,datasetIDtype:y.IDtype})))),(0,at.M)(this.pathwayKgmlEntryRequest$.pipe((0,x.h)(a=>null!==a))),(0,P.w)(([a,u])=>{const d=u.speciesID,y=q.Qm.get(d),{datasetID:I,datasetIDtype:v}=Object.assign({},a);return this.store.pipe((0,m.Ys)(Tt,{speciesID:d,sourceIDtype:v,targetIDtype:y}),(0,G.q)(1),(0,T.U)(_=>({datasetID:I,datasetIDtype:v,keggEntryIDtype:y,ifIDmappingExisted:_})))}),(0,ce.x)((a,u)=>JSON.stringify(a)===JSON.stringify(u)),(0,P.w)(a=>{const{datasetID:u,datasetIDtype:d,keggEntryIDtype:y,ifIDmappingExisted:I}=Object.assign({},a);if(I){if(d===y){let v=this.store.pipe((0,m.Ys)(z.XF,{datasetID:u}),(0,G.q)(1)),_=this.store.pipe((0,m.Ys)(Pt.ON,{datasetID:u}),(0,G.q)(1));return(0,tt.D)([v,_]).pipe((0,T.U)(([K,N])=>(0,mt.HI)(K,N)))}{let v=this.store.pipe((0,m.Ys)(z.XF,{datasetID:u}),(0,G.q)(1)),_=this.store.pipe((0,m.Ys)(Pt.ON,{datasetID:u}),(0,G.q)(1));return(0,tt.D)([v,_]).pipe((0,T.U)(([K,N])=>(0,mt.HI)(K,N)))}}return this.store.pipe((0,m.Ys)(z.XF,{datasetID:u}),(0,G.q)(1)).pipe((0,T.U)(v=>(0,mt.HI)(v,[])))})),this.diffGenesEntryIDForHighlighting$=(0,ft.aj)([this.diffFilterInput$.pipe((0,x.h)(a=>null!=a)),this.groupPairForDiffGenesHighlight$.pipe((0,x.h)(a=>null!=a))]).pipe((0,T.U)(([a,u])=>({diffFilterInput:a,diffGroupPair:u})),(0,at.M)(this.datasetForDiffGenesHighlight$),(0,P.w)(([a,u])=>{const d=a.diffGroupPair.baseGroup,y=a.diffGroupPair.targetGroup,I=a.diffFilterInput;return d===y?(0,X.of)({source:"fromDiffGenes",sourceName:u,genesType:"diff",genes:{up:[],down:[]}}):this.store.pipe((0,m.Ys)(Pt.fh,{datasetID:u,baseGroup:d,targetGroup:y}),(0,G.q)(1),(0,T.U)(v=>({diffGenes:(0,Zs.IT)(v.diffSoftware,v.diffResults,I),speciesID:v.speciesID,IDtype:v.IDtype})),(0,P.w)(v=>{const _=v.diffGenes.up,K=v.diffGenes.down,N=v.IDtype,L=v.speciesID,F=q.Qm.get(L);if(N===F)return(0,X.of)({source:"fromDiffGenes",sourceName:u,genesType:"diff",genes:{up:_,down:K}});{let E=this.store.pipe((0,m.Ys)(_t,{speciesID:L,sourceIDtype:N,targetIDtype:F,sourceIDs:_}),(0,G.q)(1)),Z=this.store.pipe((0,m.Ys)(_t,{speciesID:L,sourceIDtype:N,targetIDtype:F,sourceIDs:K}),(0,G.q)(1));return(0,tt.D)([E,Z]).pipe((0,T.U)(([O,V])=>({source:"fromDiffGenes",sourceName:u,genesType:"diff",genes:{up:O,down:V}})))}}))})),this.addGeneListIDForSpecificGenesHighlight$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>this.store.pipe((0,m.Ys)(Ye.Vq,{ID:a}))),(0,P.w)(a=>{const u=a.speciesID,d=a.IDtype,y=q.Qm.get(u);return this.store.pipe((0,m.Ys)(Tt,{speciesID:u,sourceIDtype:d,targetIDtype:y}),(0,G.q)(1)).pipe((0,x.h)(I=>!I),(0,le.b)(I=>{this.addGeneListForHighlightNoteSubject.next({status:"loaded",statusValue:"Wait for a moment, the app is loading ID mapping infor"})}),(0,P.w)(I=>this.geneAnnotationRequestService.requestSpeciesIDmappingInfoBetweenTwoIDtypes(u,d,y)),(0,dt.K)(I=>(0,X.of)({status:"error",statusValue:`Eorror occured while loading ID mapping info. Error: ${I.status}, errorText: ${I.statusText}`})))})).subscribe(a=>{a.hasOwnProperty("status")?this.addGeneListForHighlightNoteSubject.next(a):this.store.dispatch(ue.S$({source2targetList:a}))}),(0,ft.aj)([this.addGeneListIDForSpecificGenesHighlight$.pipe((0,x.h)(a=>null!=a)),this.store.pipe((0,m.Ys)(zt))]).pipe((0,P.w)(([a,u])=>this.store.pipe((0,m.Ys)(Ye.Vq,{ID:a}),(0,G.q)(1))),(0,P.w)(a=>{const u=a.speciesID,d=a.IDtype,y=q.Qm.get(u);return this.store.pipe((0,m.Ys)(Tt,{speciesID:u,sourceIDtype:d,targetIDtype:y}),(0,G.q)(1)).pipe((0,x.h)(I=>I),(0,T.U)(I=>a))}),(0,ce.x)((a,u)=>a.name===u.name),(0,P.w)(a=>{const u=a.speciesID,d=a.IDtype,y=a.genes,I=q.Qm.get(u);return d===I?(0,X.of)({name:a.name,entryIDs:y}):this.store.pipe((0,m.Ys)(_t,{speciesID:u,sourceIDtype:d,targetIDtype:I,sourceIDs:y}),(0,G.q)(1),(0,T.U)(v=>({name:a.name,entryIDs:v})))})).subscribe(a=>{this.store.dispatch(ot.V6({geneList:a})),this.addGeneListForHighlightNoteSubject.next({status:"finished",statusValue:"finished"})}),this.removeGeneListIDForSpecificGenesHighlight$.pipe((0,x.h)(a=>null!=a)).subscribe(a=>{this.store.dispatch(ot.hx({geneListID:a}))}),this.availableGeneListsForHighlight$=this.store.pipe((0,m.Ys)(gs)),this.geneListEntryIDsForHighlighting$=this.obtainGenesForSpecificGenesHighlight$.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>"noList"===a?(0,X.of)({source:"fromSpecificGenes",sourceName:a,genesType:"geneList",genes:[]}):this.store.pipe((0,m.Ys)(ps,{name:a}),(0,G.q)(1),(0,T.U)(u=>({source:"fromSpecificGenes",sourceName:a,genesType:"geneList",genes:u}))))),this.genesFromExpressionPatternEntryIDsForHighlighting$=this.genesSelectedFromExpressionPattern$.pipe((0,x.h)(a=>null!=a),(0,at.M)(this.datasetHierarRequestSubject.pipe((0,x.h)(a=>null!=a),(0,P.w)(a=>{const u=a.datasetID;return this.store.pipe((0,m.Ys)(z.iR,{datasetID:u}),(0,T.U)(d=>({speciesID:d.speciesID,datasetIDtype:d.IDtype,datasetID:u})),(0,G.q)(1))}))),(0,P.w)(([a,u])=>{const{speciesID:d,datasetIDtype:y}=Object.assign({},u),I=q.Qm.get(d);return this.store.pipe((0,m.Ys)(_t,{speciesID:u.speciesID,sourceIDtype:y,targetIDtype:I,sourceIDs:a}),(0,G.q)(1),(0,T.U)(v=>({source:"fromExpressionPattern",sourceName:u.datasetID,genesType:"geneList",genes:v})))})),this.entryIDsForHighlightPathway$=(0,Ot.T)(this.genesFromExpressionPatternEntryIDsForHighlighting$,this.geneListEntryIDsForHighlighting$),this.genesForHighlightingExpressionPattern$=this.genesSelectedFromPathwayMap$.pipe((0,x.h)(a=>null!=a),(0,at.M)(this.datasetHierarRequestSubject.pipe((0,x.h)(a=>null!=a))),(0,P.w)(([a,u])=>this.store.pipe((0,m.Ys)(z.iR,{datasetID:u.datasetID}),(0,G.q)(1),(0,T.U)(y=>({speciesID:y.speciesID,datasetIDtype:y.IDtype})),(0,P.w)(y=>{const{speciesID:I,datasetIDtype:v}=Object.assign({},y),_=q.Qm.get(I);return this.store.pipe((0,m.Ys)(_t,{speciesID:I,sourceIDtype:_,targetIDtype:v,sourceIDs:a}),(0,G.q)(1))})))),this.modifyKeggMapTransformation$.pipe((0,x.h)(a=>null!=a)).subscribe(a=>{this.store.dispatch(ot.X9({keggMapTransformation:a}))}),this.highlightGenesInfo$=(0,Ot.T)(this.diffGenesEntryIDForHighlighting$.pipe((0,x.h)(a=>null!=a)),this.entryIDsForHighlightPathway$.pipe((0,x.h)(a=>null!=a))),this.trySamppleService.trySampleData$.pipe((0,x.h)(Boolean)).subscribe(a=>{this.store.dispatch(ds.CF({newState:a.datasetListState})),this.store.dispatch(Cs.gw({newState:a.localExpressDataState})),this.store.dispatch(Ss.A({newState:a.geneAnnotationsState})),this.store.dispatch(ue.dy({newState:a.geneIDmappingState})),this.store.dispatch(fs.c({newState:a.geneListState})),this.store.dispatch(he.Uw({newState:a.diffAnalysisResultState})),this.store.dispatch(ot.Y6({newState:a.keggExpState})),this.store.dispatch(qt.yx({newState:a.keggPathwayState}))}),this.trySamplePercentage$=this.trySamppleService.trySamplePercentage$}retrieveAllKeggSpecies(){this.requestKeggAllSpecies$.next(!0)}retrieveKeggPathwaysOfOneSpecies(e){this.speciesForKeggPathways$.next(e)}requestKeggPathwayKgmlPNG(e){this.pathwayKgmlEntryRequestFromKeggPage$.next(e)}requestExpressionPatternForDataset(e){this.datasetHierarRequestSubject.next(e)}updateVisSettingsOfPathwayGenesExpressionInDataset(e){this.updateGenesExpressionVisSettingsSubject.next(e)}requestDiffGenesForSelectedDataset(e){this.datasetForDiffGenesHighlight$.next(e)}requestDiffGenesForSelectedDiffGroupPair(e){this.groupPairForDiffGenesHighlight$.next(e)}requestDiffGenesWithModifiedFilterCriteria(e){this.diffFilterInput$.next(e)}modifyKeggMapTransformation(e){this.modifyKeggMapTransformation$.next(e)}addGeneListForHighlightingInPathwayMap(e){this.addGeneListIDForSpecificGenesHighlight$.next(e)}removeGeneListForHighlightingInPathwayMap(e){this.removeGeneListIDForSpecificGenesHighlight$.next(e)}requestGenesForSpecificGenesHighlight(e){this.obtainGenesForSpecificGenesHighlight$.next(e)}requestEntryIDsForGenesSelectedFromExpressionPattern(e){this.genesSelectedFromExpressionPattern$.next(e)}requestGeneIDsForGenesSelectedFromPathwayMap(e){this.genesSelectedFromPathwayMap$.next(e)}prepareTrySampleData(e){this.trySamppleService.requestTrySampleData(e)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(m.yh),i.LFG(Os),i.LFG(zs.W),i.LFG(qs.h),i.LFG(Us.v),i.LFG(Ys.h),i.LFG(Vs.b),i.LFG(Bs.f),i.LFG(Xs.h))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();var Js=D(4863);let Qs=(()=>{class t{constructor(){this.inputKeggPathway$=new i.vpe}ngOnInit(){}ngOnChanges(e){}selectKeggPathway(e){this.inputKeggPathway$.next(e.item)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-input-pathway"]],inputs:{speciesKeggPathways:"speciesKeggPathways"},outputs:{inputKeggPathway$:"inputKeggPathway$"},features:[i.TTD],decls:3,vars:3,consts:[["for","species"],["typeaheadOptionField","name","placeholder","like NF-kappa, Wnt, or Fatty acids",1,"form-control","form-control-sm",3,"disabled","typeahead","ngModel","ngModelChange","typeaheadOnSelect"]],template:function(e,s){1&e&&(i.TgZ(0,"h5",0),i._uU(1,"Pathway Name"),i.qZA(),i.TgZ(2,"input",1),i.NdJ("ngModelChange",function(o){return s.asyncSelected=o})("typeaheadOnSelect",function(o){return s.selectKeggPathway(o)}),i.qZA()),2&e&&(i.xp6(2),i.Q6J("disabled",!((null==s.speciesKeggPathways?null:s.speciesKeggPathways.length)>0))("typeahead",s.speciesKeggPathways)("ngModel",s.asyncSelected))},directives:[Gt.Fj,Le.Bp,Gt.JJ,Gt.On],styles:[""],changeDetection:0}),t})();var yt=D(5043);const js=function(t,n){return{pathwayActive:t,pathwayNormal:n}};function Ws(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"li",13),i.NdJ("click",function(){const o=i.CHM(e).$implicit;return i.oxw(3).showThisPathway(o)}),i.TgZ(1,"small"),i._uU(2),i.qZA(),i.qZA()}if(2&t){const e=n.$implicit,s=i.oxw(3);i.Q6J("ngClass",i.WLB(2,js,e.ID===s.selectedPathwayID,e.ID!=s.selectedPathwayID)),i.xp6(2),i.Oqu(e.name)}}function ti(t,n){if(1&t&&(i.TgZ(0,"ul",11),i.YNc(1,Ws,3,5,"li",12),i.qZA()),2&t){const e=i.oxw(2);i.xp6(1),i.Q6J("ngForOf",e.availableKeggPathways)}}function ei(t,n){1&t&&(i.TgZ(0,"p"),i._uU(1,"No pathway is available, input a pathway in the left side"),i.qZA())}function ni(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"div",5),i.TgZ(1,"fa-icon",6),i.NdJ("click",function(){return i.CHM(e),i.oxw().closePathwayList()}),i.qZA(),i.TgZ(2,"div",7),i.TgZ(3,"h6",8),i._uU(4,"Kegg Pathways"),i.qZA(),i.YNc(5,ti,2,1,"ul",9),i.YNc(6,ei,2,0,"ng-template",null,10,i.W1O),i.qZA(),i._UZ(8,"div"),i.qZA()}if(2&t){const e=i.MAs(7),s=i.oxw();i.xp6(1),i.Q6J("icon",s.faTimes)("size","sm"),i.xp6(4),i.Q6J("ngIf",(null==s.availableKeggPathways?null:s.availableKeggPathways.length)>0)("ngIfElse",e)}}let si=(()=>{class t{constructor(e){this.cdr=e,this.selectedPathway$=new i.vpe,this.faList=yt.Zrf,this.faArrowRight=yt.eFW,this.faArrowLeft=yt.acZ,this.faMinus=yt.Kl4,this.faTimes=yt.NBC,this.faLongArrowAltRight=yt.AGO,this.faLongArrowAltLeft=yt.wzR,this.ifShowPathwayList=!1}ngOnInit(){var e;this.inputCurrentPathwayID&&(this.selectedPathwayID=this.inputCurrentPathwayID),(null===(e=this.availableKeggPathways)||void 0===e?void 0:e.length)>=1&&(this.selectedPathwayID=this.availableKeggPathways[this.availableKeggPathways.length-1].ID,this.selectedPathway$.next(this.availableKeggPathways[this.availableKeggPathways.length-1]))}ngOnChanges(e){var s;e.inputCurrentPathwayID&&!e.inputCurrentPathwayID.isFirstChange()&&(this.selectedPathwayID=this.inputCurrentPathwayID),e.availableKeggPathways&&!e.availableKeggPathways.isFirstChange()&&(null===(s=this.availableKeggPathways)||void 0===s?void 0:s.length)>=1&&(this.selectedPathwayID=this.availableKeggPathways[this.availableKeggPathways.length-1].ID,this.selectedPathway$.next(this.availableKeggPathways[this.availableKeggPathways.length-1]))}displayAvailablePathways(){this.ifShowPathwayList=!0}showPreviousPathway(){const e=this._obtainPathwayIndex();0==e?(this.selectedPathway$.next(this.availableKeggPathways[this.availableKeggPathways.length-1]),this.selectedPathwayID=this.availableKeggPathways[this.availableKeggPathways.length-1].ID):(this.selectedPathway$.next(this.availableKeggPathways[e-1]),this.selectedPathwayID=this.availableKeggPathways[e-1].ID)}showNextPathway(){const e=this._obtainPathwayIndex();e==this.availableKeggPathways.length-1?(this.selectedPathway$.next(this.availableKeggPathways[0]),this.selectedPathwayID=this.availableKeggPathways[0].ID):(this.selectedPathway$.next(this.availableKeggPathways[e+1]),this.selectedPathwayID=this.availableKeggPathways[e+1].ID)}closePathwayList(){this.ifShowPathwayList=!1}showThisPathway(e){this.selectedPathway$.next(e),this.selectedPathwayID=e.ID,this.ifShowPathwayList=!1,this.cdr.detectChanges()}deleteThisPathway(e){}_obtainPathwayIndex(){let e;for(let s=0;s<this.availableKeggPathways.length;s++)if(this.availableKeggPathways[s].ID===this.selectedPathwayID){e=s;break}return e}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.sBO))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-manage-kegg-pathways"]],inputs:{availableKeggPathways:"availableKeggPathways",inputCurrentPathwayID:"inputCurrentPathwayID"},outputs:{selectedPathway$:"selectedPathway$"},features:[i.TTD],decls:5,vars:7,consts:[[1,"form-inline"],["type","list","data-testid","pathwayList",1,"hoverBigger",3,"icon","size","mouseover"],["type","previous","ngbTooltip","Previous Pathway","placement","bottom","data-testid","previousPathway",1,"hoverBigger","ml-4",3,"icon","size","click"],["ngbTooltip","Next Pathway","type","next","placement","bottom","data-testid","nextPathway",1,"hoverBigger","ml-2",3,"icon","size","click"],["style","position: absolute;left: 1px;top: 20px;width:20vw;background-color:white;z-index:1066;","class","border","data-testid","pathwaysDiv",4,"ngIf"],["data-testid","pathwaysDiv",1,"border",2,"position","absolute","left","1px","top","20px","width","20vw","background-color","white","z-index","1066"],["data-testid","close",1,"hoverBigger","pull-right","close",3,"icon","size","click"],[1,"mt-3","mr-2","ml-1"],[1,"border","border-right-0","border-left-0","border-top-0"],["style","padding-left: 0",4,"ngIf","ngIfElse"],["inputPathway",""],[2,"padding-left","0"],["class","form-inline",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"form-inline",3,"ngClass","click"]],template:function(e,s){1&e&&(i.TgZ(0,"div",0),i.TgZ(1,"fa-icon",1),i.NdJ("mouseover",function(){return s.displayAvailablePathways()}),i.qZA(),i.TgZ(2,"fa-icon",2),i.NdJ("click",function(){return s.showPreviousPathway()}),i.qZA(),i.TgZ(3,"fa-icon",3),i.NdJ("click",function(){return s.showNextPathway()}),i.qZA(),i.qZA(),i.YNc(4,ni,9,4,"div",4)),2&e&&(i.xp6(1),i.Q6J("icon",s.faList)("size","1x"),i.xp6(1),i.Q6J("icon",s.faLongArrowAltLeft)("size","1x"),i.xp6(1),i.Q6J("icon",s.faLongArrowAltRight)("size","1x"),i.xp6(1),i.Q6J("ngIf",s.ifShowPathwayList))},directives:[Ce.BN,Fe._L,B.O5,B.sg,B.mk],styles:[".pathwayActive[_ngcontent-%COMP%]{color:#1669bb;cursor:normal}.pathwayNormal[_ngcontent-%COMP%]{color:#000;cursor:pointer}.pathwayNormal[_ngcontent-%COMP%]:hover{background-color:#dbdbdb}"],changeDetection:0}),t})();var ii=D(766),ri={value:()=>{}};function rn(){for(var s,t=0,n=arguments.length,e={};t<n;++t){if(!(s=arguments[t]+"")||s in e||/[\s.]/.test(s))throw new Error("illegal type: "+s);e[s]=[]}return new Yt(e)}function Yt(t){this._=t}function ai(t,n){return t.trim().split(/^|\s+/).map(function(e){var s="",r=e.indexOf(".");if(r>=0&&(s=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:s}})}function oi(t,n){for(var r,e=0,s=t.length;e<s;++e)if((r=t[e]).name===n)return r.value}function an(t,n,e){for(var s=0,r=t.length;s<r;++s)if(t[s].name===n){t[s]=ri,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=e&&t.push({name:n,value:e}),t}Yt.prototype=rn.prototype={constructor:Yt,on:function(t,n){var r,e=this._,s=ai(t+"",e),o=-1,c=s.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<c;)if(r=(t=s[o]).type)e[r]=an(e[r],t.name,n);else if(null==n)for(r in e)e[r]=an(e[r],t.name,null);return this}for(;++o<c;)if((r=(t=s[o]).type)&&(r=oi(e[r],t.name)))return r},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Yt(t)},call:function(t,n){if((r=arguments.length-2)>0)for(var r,o,e=new Array(r),s=0;s<r;++s)e[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,r=(o=this._[t]).length;s<r;++s)o[s].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],r=0,o=s.length;r<o;++r)s[r].value.apply(n,e)}};const on=rn;function li(){}function ln(t){return null==t?li:function(){return this.querySelector(t)}}function ui(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function hi(){return[]}function cn(t){return function(n){return n.matches(t)}}var mi=Array.prototype.find;function wi(){return this.firstElementChild}var Di=Array.prototype.filter;function vi(){return Array.from(this.children)}function un(t){return new Array(t.length)}function Vt(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function Gi(t){return function(){return t}}function Ti(t,n,e,s,r,o){for(var l,c=0,h=n.length,g=o.length;c<g;++c)(l=n[c])?(l.__data__=o[c],s[c]=l):e[c]=new Vt(t,o[c]);for(;c<h;++c)(l=n[c])&&(r[c]=l)}function Pi(t,n,e,s,r,o,c){var l,h,d,g=new Map,f=n.length,a=o.length,u=new Array(f);for(l=0;l<f;++l)(h=n[l])&&(u[l]=d=c.call(h,h.__data__,l,n)+"",g.has(d)?r[l]=h:g.set(d,h));for(l=0;l<a;++l)d=c.call(t,o[l],l,o)+"",(h=g.get(d))?(s[l]=h,h.__data__=o[l],g.delete(d)):e[l]=new Vt(t,o[l]);for(l=0;l<f;++l)(h=n[l])&&g.get(u[l])===h&&(r[l]=h)}function Ei(t){return t.__data__}function Ki(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ci(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}Vt.prototype={constructor:Vt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var fe="http://www.w3.org/1999/xhtml";const hn={svg:"http://www.w3.org/2000/svg",xhtml:fe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function gn(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),hn.hasOwnProperty(n)?{space:hn[n],local:t}:t}function qi(t){return function(){this.removeAttribute(t)}}function Ui(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Yi(t,n){return function(){this.setAttribute(t,n)}}function Vi(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Bi(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function Xi(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function pn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Qi(t){return function(){this.style.removeProperty(t)}}function ji(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Wi(t,n,e){return function(){var s=n.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,e)}}function er(t,n){return t.style.getPropertyValue(n)||pn(t).getComputedStyle(t,null).getPropertyValue(n)}function nr(t){return function(){delete this[t]}}function sr(t,n){return function(){this[t]=n}}function ir(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function fn(t){return t.trim().split(/^|\s+/)}function de(t){return t.classList||new dn(t)}function dn(t){this._node=t,this._names=fn(t.getAttribute("class")||"")}function mn(t,n){for(var e=de(t),s=-1,r=n.length;++s<r;)e.add(n[s])}function yn(t,n){for(var e=de(t),s=-1,r=n.length;++s<r;)e.remove(n[s])}function ar(t){return function(){mn(this,t)}}function or(t){return function(){yn(this,t)}}function lr(t,n){return function(){(n.apply(this,arguments)?mn:yn)(this,t)}}function ur(){this.textContent=""}function hr(t){return function(){this.textContent=t}}function gr(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function fr(){this.innerHTML=""}function dr(t){return function(){this.innerHTML=t}}function mr(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function wr(){this.nextSibling&&this.parentNode.appendChild(this)}function Dr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _r(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===fe&&n.documentElement.namespaceURI===fe?n.createElement(t):n.createElementNS(e,t)}}function Sr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wn(t){var n=gn(t);return(n.local?Sr:_r)(n)}function br(){return null}function Tr(){var t=this.parentNode;t&&t.removeChild(this)}function Er(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Ar(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Mr(t){return t.trim().split(/^|\s+/).map(function(n){var e="",s=n.indexOf(".");return s>=0&&(e=n.slice(s+1),n=n.slice(0,s)),{type:n,name:e}})}function Fr(t){return function(){var n=this.__on;if(n){for(var o,e=0,s=-1,r=n.length;e<r;++e)o=n[e],t.type&&o.type!==t.type||o.name!==t.name?n[++s]=o:this.removeEventListener(o.type,o.listener,o.options);++s?n.length=s:delete this.__on}}}function Lr(t,n,e){return function(){var r,s=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(s)for(var c=0,l=s.length;c<l;++c)if((r=s[c]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},s?s.push(r):this.__on=[r]}}function In(t,n,e){var s=pn(t),r=s.CustomEvent;"function"==typeof r?r=new r(n,e):(r=s.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}function Rr(t,n){return function(){return In(this,t,n)}}function kr(t,n){return function(){return In(this,t,n.apply(this,arguments))}}dn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Dn=[null];function U(t,n){this._groups=t,this._parents=n}function wt(t){return"string"==typeof t?new U([[document.querySelector(t)]],[document.documentElement]):new U([[t]],Dn)}U.prototype=function(){return new U([[document.documentElement]],Dn)}.prototype={constructor:U,select:function(t){"function"!=typeof t&&(t=ln(t));for(var n=this._groups,e=n.length,s=new Array(e),r=0;r<e;++r)for(var h,g,o=n[r],c=o.length,l=s[r]=new Array(c),f=0;f<c;++f)(h=o[f])&&(g=t.call(h,h.__data__,f,o))&&("__data__"in h&&(g.__data__=h.__data__),l[f]=g);return new U(s,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return ui(t.apply(this,arguments))}}(t):function(t){return null==t?hi:function(){return this.querySelectorAll(t)}}(t);for(var n=this._groups,e=n.length,s=[],r=[],o=0;o<e;++o)for(var h,c=n[o],l=c.length,g=0;g<l;++g)(h=c[g])&&(s.push(t.call(h,h.__data__,g,c)),r.push(h));return new U(s,r)},selectChild:function(t){return this.select(null==t?wi:function(t){return function(){return mi.call(this.children,t)}}("function"==typeof t?t:cn(t)))},selectChildren:function(t){return this.selectAll(null==t?vi:function(t){return function(){return Di.call(this.children,t)}}("function"==typeof t?t:cn(t)))},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,e=n.length,s=new Array(e),r=0;r<e;++r)for(var h,o=n[r],c=o.length,l=s[r]=[],g=0;g<c;++g)(h=o[g])&&t.call(h,h.__data__,g,o)&&l.push(h);return new U(s,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,Ei);var e=n?Pi:Ti,s=this._parents,r=this._groups;"function"!=typeof t&&(t=Gi(t));for(var o=r.length,c=new Array(o),l=new Array(o),h=new Array(o),g=0;g<o;++g){var f=s[g],a=r[g],u=a.length,d=Ki(t.call(f,f&&f.__data__,g,s)),y=d.length,I=l[g]=new Array(y),v=c[g]=new Array(y),_=h[g]=new Array(u);e(f,a,I,v,_,d,n);for(var L,F,K=0,N=0;K<y;++K)if(L=I[K]){for(K>=N&&(N=K+1);!(F=v[N])&&++N<y;);L._next=F||null}}return(c=new U(c,s))._enter=l,c._exit=h,c},enter:function(){return new U(this._enter||this._groups.map(un),this._parents)},exit:function(){return new U(this._exit||this._groups.map(un),this._parents)},join:function(t,n,e){var s=this.enter(),r=this,o=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=n&&(r=n(r))&&(r=r.selection()),null==e?o.remove():e(o),s&&r?s.merge(r).order():r},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,s=n._groups,r=e.length,c=Math.min(r,s.length),l=new Array(r),h=0;h<c;++h)for(var d,g=e[h],f=s[h],a=g.length,u=l[h]=new Array(a),y=0;y<a;++y)(d=g[y]||f[y])&&(u[y]=d);for(;h<r;++h)l[h]=e[h];return new U(l,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var c,s=t[n],r=s.length-1,o=s[r];--r>=0;)(c=s[r])&&(o&&4^c.compareDocumentPosition(o)&&o.parentNode.insertBefore(c,o),o=c);return this},sort:function(t){function n(a,u){return a&&u?t(a.__data__,u.__data__):!a-!u}t||(t=Ci);for(var e=this._groups,s=e.length,r=new Array(s),o=0;o<s;++o){for(var g,c=e[o],l=c.length,h=r[o]=new Array(l),f=0;f<l;++f)(g=c[f])&&(h[f]=g);h.sort(n)}return new U(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var s=t[n],r=0,o=s.length;r<o;++r){var c=s[r];if(c)return c}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,s=n.length;e<s;++e)for(var l,r=n[e],o=0,c=r.length;o<c;++o)(l=r[o])&&t.call(l,l.__data__,o,r);return this},attr:function(t,n){var e=gn(t);if(arguments.length<2){var s=this.node();return e.local?s.getAttributeNS(e.space,e.local):s.getAttribute(e)}return this.each((null==n?e.local?Ui:qi:"function"==typeof n?e.local?Xi:Bi:e.local?Vi:Yi)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?Qi:"function"==typeof n?Wi:ji)(t,n,null==e?"":e)):er(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?nr:"function"==typeof n?ir:sr)(t,n)):this.node()[t]},classed:function(t,n){var e=fn(t+"");if(arguments.length<2){for(var s=de(this.node()),r=-1,o=e.length;++r<o;)if(!s.contains(e[r]))return!1;return!0}return this.each(("function"==typeof n?lr:n?ar:or)(e,n))},text:function(t){return arguments.length?this.each(null==t?ur:("function"==typeof t?gr:hr)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?fr:("function"==typeof t?mr:dr)(t)):this.node().innerHTML},raise:function(){return this.each(wr)},lower:function(){return this.each(Dr)},append:function(t){var n="function"==typeof t?t:wn(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:wn(t),s=null==n?br:"function"==typeof n?n:ln(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function(){return this.each(Tr)},clone:function(t){return this.select(t?Ar:Er)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,c,s=Mr(t+""),o=s.length;if(!(arguments.length<2)){for(l=n?Lr:Fr,r=0;r<o;++r)this.each(l(s[r],n,e));return this}var l=this.node().__on;if(l)for(var f,h=0,g=l.length;h<g;++h)for(r=0,f=l[h];r<o;++r)if((c=s[r]).type===f.type&&c.name===f.name)return f.value},dispatch:function(t,n){return this.each(("function"==typeof n?kr:Rr)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var c,s=t[n],r=0,o=s.length;r<o;++r)(c=s[r])&&(yield c)}};const me={capture:!0,passive:!1};function ye(t){t.preventDefault(),t.stopImmediatePropagation()}function qr(t){var n=t.document.documentElement,e=wt(t).on("dragstart.drag",ye,me);"onselectstart"in n?e.on("selectstart.drag",ye,me):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Ur(t,n){var e=t.document.documentElement,s=wt(t).on("dragstart.drag",null);n&&(s.on("click.drag",ye,me),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in e?s.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function vn(t){return((t=Math.exp(t))+1/t)/2}const Xr=function t(n,e,s){function r(o,c){var v,_,l=o[0],h=o[1],g=o[2],u=c[2],d=c[0]-l,y=c[1]-h,I=d*d+y*y;if(I<1e-12)_=Math.log(u/g)/n,v=function(Z){return[l+Z*d,h+Z*y,g*Math.exp(n*Z*_)]};else{var K=Math.sqrt(I),N=(u*u-g*g+s*I)/(2*g*e*K),L=(u*u-g*g-s*I)/(2*u*e*K),F=Math.log(Math.sqrt(N*N+1)-N),E=Math.log(Math.sqrt(L*L+1)-L);_=(E-F)/n,v=function(Z){var O=Z*_,V=vn(F),it=g/(e*K)*(V*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(n*O+F)-function(t){return((t=Math.exp(t))-1/t)/2}(F));return[l+it*d,h+it*y,g*V/vn(n*O+F)]}}return v.duration=1e3*_*n/Math.SQRT2,v}return r.rho=function(o){var c=Math.max(.001,+o),l=c*c;return t(c,l,l*l)},r}(Math.SQRT2,2,4);function It(t,n){if(t=function(t){let n;for(;n=t.sourceEvent;)t=n;return t}(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var s=e.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,[(s=s.matrixTransform(n.getScreenCTM().inverse())).x,s.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop]}}return[t.pageX,t.pageY]}var Bt,Nt,At=D(5284),St=0,Kt=0,$t=0,Xt=0,Dt=0,Jt=0,Mt="object"==typeof performance&&performance.now?performance:Date,Sn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function we(){return Dt||(Sn(Qr),Dt=Mt.now()+Jt)}function Qr(){Dt=0}function Qt(){this._call=this._time=this._next=null}function xn(t,n,e){var s=new Qt;return s.restart(t,n,e),s}function bn(){Dt=(Xt=Mt.now())+Jt,St=Kt=0;try{!function(){we(),++St;for(var n,t=Bt;t;)(n=Dt-t._time)>=0&&t._call.call(null,n),t=t._next;--St}()}finally{St=0,function(){for(var t,e,n=Bt,s=1/0;n;)n._call?(s>n._time&&(s=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Bt=e);Nt=t,Ie(s)}(),Dt=0}}function Wr(){var t=Mt.now(),n=t-Xt;n>1e3&&(Jt-=n,Xt=t)}function Ie(t){St||(Kt&&(Kt=clearTimeout(Kt)),t-Dt>24?(t<1/0&&(Kt=setTimeout(bn,t-Mt.now()-Jt)),$t&&($t=clearInterval($t))):($t||(Xt=Mt.now(),$t=setInterval(Wr,1e3)),St=1,Sn(bn)))}function Gn(t,n,e){var s=new Qt;return s.restart(function(r){s.stop(),t(r+n)},n=null==n?0:+n,e),s}Qt.prototype=xn.prototype={constructor:Qt,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?we():+e)+(null==n?0:+n),!this._next&&Nt!==this&&(Nt?Nt._next=this:Bt=this,Nt=this),this._call=t,this._time=e,Ie()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ie())}};var ea=on("start","end","cancel","interrupt"),na=[];function te(t,n,e,s,r,o){var c=t.__transition;if(c){if(e in c)return}else t.__transition={};!function(t,n,e){var r,s=t.__transition;function c(g){var f,a,u,d;if(1!==e.state)return h();for(f in s)if((d=s[f]).name===e.name){if(3===d.state)return Gn(c);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete s[f]):+f<n&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete s[f])}if(Gn(function(){3===e.state&&(e.state=4,e.timer.restart(l,e.delay,e.time),l(g))}),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(u=e.tween.length),f=0,a=-1;f<u;++f)(d=e.tween[f].value.call(t,t.__data__,e.index,e.group))&&(r[++a]=d);r.length=a+1}}function l(g){for(var f=g<e.duration?e.ease.call(null,g/e.duration):(e.timer.restart(h),e.state=5,1),a=-1,u=r.length;++a<u;)r[a].call(t,f);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),h())}function h(){for(var g in e.state=6,e.timer.stop(),delete s[n],s)return;delete t.__transition}s[n]=e,e.timer=xn(function(g){e.state=1,e.timer.restart(c,e.delay,e.time),e.delay<=g&&c(g-e.delay)},0,e.time)}(t,e,{name:n,index:s,group:r,on:ea,tween:na,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function _e(t,n){var e=J(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function et(t,n){var e=J(t,n);if(e.state>3)throw new Error("too late; already running");return e}function J(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function ee(t,n){var s,r,c,e=t.__transition,o=!0;if(e){for(c in n=null==n?null:n+"",e)(s=e[c]).name===n?(r=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(r?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete e[c]):o=!1;o&&delete t.__transition}}function pt(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var ne,An=180/Math.PI,Se={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Kn(t,n,e,s,r,o){var c,l,h;return(c=Math.sqrt(t*t+n*n))&&(t/=c,n/=c),(h=t*e+n*s)&&(e-=t*h,s-=n*h),(l=Math.sqrt(e*e+s*s))&&(e/=l,s/=l,h/=l),t*s<n*e&&(t=-t,n=-n,h=-h,c=-c),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*An,skewX:Math.atan(h)*An,scaleX:c,scaleY:l}}function $n(t,n,e,s){function r(g){return g.length?g.pop()+" ":""}return function(g,f){var a=[],u=[];return g=t(g),f=t(f),function(g,f,a,u,d,y){if(g!==a||f!==u){var I=d.push("translate(",null,n,null,e);y.push({i:I-4,x:pt(g,a)},{i:I-2,x:pt(f,u)})}else(a||u)&&d.push("translate("+a+n+u+e)}(g.translateX,g.translateY,f.translateX,f.translateY,a,u),function(g,f,a,u){g!==f?(g-f>180?f+=360:f-g>180&&(g+=360),u.push({i:a.push(r(a)+"rotate(",null,s)-2,x:pt(g,f)})):f&&a.push(r(a)+"rotate("+f+s)}(g.rotate,f.rotate,a,u),function(g,f,a,u){g!==f?u.push({i:a.push(r(a)+"skewX(",null,s)-2,x:pt(g,f)}):f&&a.push(r(a)+"skewX("+f+s)}(g.skewX,f.skewX,a,u),function(g,f,a,u,d,y){if(g!==a||f!==u){var I=d.push(r(d)+"scale(",null,",",null,")");y.push({i:I-4,x:pt(g,a)},{i:I-2,x:pt(f,u)})}else(1!==a||1!==u)&&d.push(r(d)+"scale("+a+","+u+")")}(g.scaleX,g.scaleY,f.scaleX,f.scaleY,a,u),g=f=null,function(d){for(var v,y=-1,I=u.length;++y<I;)a[(v=u[y]).i]=v.x(d);return a.join("")}}}var oa=$n(function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Se:Kn(n.a,n.b,n.c,n.d,n.e,n.f)},"px, ","px)","deg)"),la=$n(function(t){return null!=t&&(ne||(ne=document.createElementNS("http://www.w3.org/2000/svg","g")),ne.setAttribute("transform",t),t=ne.transform.baseVal.consolidate())?Kn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Se},", ",")",")"),Nn=D(3438);function ca(t,n){var e,s;return function(){var r=et(this,t),o=r.tween;if(o!==e)for(var c=0,l=(s=e=o).length;c<l;++c)if(s[c].name===n){(s=s.slice()).splice(c,1);break}r.tween=s}}function ua(t,n,e){var s,r;if("function"!=typeof e)throw new Error;return function(){var o=et(this,t),c=o.tween;if(c!==s){r=(s=c).slice();for(var l={name:n,value:e},h=0,g=r.length;h<g;++h)if(r[h].name===n){r[h]=l;break}h===g&&r.push(l)}o.tween=r}}function xe(t,n,e){var s=t._id;return t.each(function(){var r=et(this,s);(r.value||(r.value={}))[n]=e.apply(this,arguments)}),function(r){return J(r,s).value[n]}}function be(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Mn(t,n){var e=Object.create(t.prototype);for(var s in n)e[s]=n[s];return e}function Ft(){}var se=1/.7,xt="\\s*([+-]?\\d+)\\s*",Ct="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",nt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ga=/^#([0-9a-f]{3,8})$/,pa=new RegExp("^rgb\\("+[xt,xt,xt]+"\\)$"),fa=new RegExp("^rgb\\("+[nt,nt,nt]+"\\)$"),da=new RegExp("^rgba\\("+[xt,xt,xt,Ct]+"\\)$"),ma=new RegExp("^rgba\\("+[nt,nt,nt,Ct]+"\\)$"),ya=new RegExp("^hsl\\("+[Ct,nt,nt]+"\\)$"),wa=new RegExp("^hsla\\("+[Ct,nt,nt,Ct]+"\\)$"),Fn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ln(){return this.rgb().formatHex()}function Cn(){return this.rgb().formatRgb()}function Rt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=ga.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Rn(n):3===e?new Y(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?ie(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?ie(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=pa.exec(t))?new Y(n[1],n[2],n[3],1):(n=fa.exec(t))?new Y(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=da.exec(t))?ie(n[1],n[2],n[3],n[4]):(n=ma.exec(t))?ie(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=ya.exec(t))?Hn(n[1],n[2]/100,n[3]/100,1):(n=wa.exec(t))?Hn(n[1],n[2]/100,n[3]/100,n[4]):Fn.hasOwnProperty(t)?Rn(Fn[t]):"transparent"===t?new Y(NaN,NaN,NaN,0):null}function Rn(t){return new Y(t>>16&255,t>>8&255,255&t,1)}function ie(t,n,e,s){return s<=0&&(t=n=e=NaN),new Y(t,n,e,s)}function Da(t){return t instanceof Ft||(t=Rt(t)),t?new Y((t=t.rgb()).r,t.g,t.b,t.opacity):new Y}function re(t,n,e,s){return 1===arguments.length?Da(t):new Y(t,n,e,null==s?1:s)}function Y(t,n,e,s){this.r=+t,this.g=+n,this.b=+e,this.opacity=+s}function kn(){return"#"+Ge(this.r)+Ge(this.g)+Ge(this.b)}function Zn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ge(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Hn(t,n,e,s){return s<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new st(t,n,e,s)}function On(t){if(t instanceof st)return new st(t.h,t.s,t.l,t.opacity);if(t instanceof Ft||(t=Rt(t)),!t)return new st;if(t instanceof st)return t;var n=(t=t.rgb()).r/255,e=t.g/255,s=t.b/255,r=Math.min(n,e,s),o=Math.max(n,e,s),c=NaN,l=o-r,h=(o+r)/2;return l?(c=n===o?(e-s)/l+6*(e<s):e===o?(s-n)/l+2:(n-e)/l+4,l/=h<.5?o+r:2-o-r,c*=60):l=h>0&&h<1?0:c,new st(c,l,h,t.opacity)}function st(t,n,e,s){this.h=+t,this.s=+n,this.l=+e,this.opacity=+s}function Te(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function zn(t,n,e,s,r){var o=t*t,c=o*t;return((1-3*t+3*o-c)*n+(4-6*o+3*c)*e+(1+3*t+3*o-3*c)*s+c*r)/6}be(Ft,Rt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ln,formatHex:Ln,formatHsl:function(){return On(this).formatHsl()},formatRgb:Cn,toString:Cn}),be(Y,re,Mn(Ft,{brighter:function(t){return t=null==t?se:Math.pow(se,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kn,formatHex:kn,formatRgb:Zn,toString:Zn})),be(st,function(t,n,e,s){return 1===arguments.length?On(t):new st(t,n,e,null==s?1:s)},Mn(Ft,{brighter:function(t){return t=null==t?se:Math.pow(se,t),new st(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new st(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,s=e+(e<.5?e:1-e)*n,r=2*e-s;return new Y(Te(t>=240?t-240:t+120,r,s),Te(t,r,s),Te(t<120?t+240:t-120,r,s),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const qn=t=>()=>t;function Yn(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):qn(isNaN(t)?n:t)}const Vn=function t(n){var e=function(t){return 1==(t=+t)?Yn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(s){return Math.pow(t+s*n,e)}}(n,e,t):qn(isNaN(n)?e:n)}}(n);function s(r,o){var c=e((r=re(r)).r,(o=re(o)).r),l=e(r.g,o.g),h=e(r.b,o.b),g=Yn(r.opacity,o.opacity);return function(f){return r.r=c(f),r.g=l(f),r.b=h(f),r.opacity=g(f),r+""}}return s.gamma=t,s}(1);function Bn(t){return function(n){var c,l,e=n.length,s=new Array(e),r=new Array(e),o=new Array(e);for(c=0;c<e;++c)l=re(n[c]),s[c]=l.r||0,r[c]=l.g||0,o[c]=l.b||0;return s=t(s),r=t(r),o=t(o),l.opacity=1,function(h){return l.r=s(h),l.g=r(h),l.b=o(h),l+""}}}Bn(function(t){var n=t.length-1;return function(e){var s=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),r=t[s],o=t[s+1];return zn((e-s/n)*n,s>0?t[s-1]:2*r-o,r,o,s<n-1?t[s+2]:2*o-r)}}),Bn(function(t){var n=t.length;return function(e){var s=Math.floor(((e%=1)<0?++e:e)*n);return zn((e-s/n)*n,t[(s+n-1)%n],t[s%n],t[(s+1)%n],t[(s+2)%n])}});var Pe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ee=new RegExp(Pe.source,"g");function Pa(t,n){var s,r,o,e=Pe.lastIndex=Ee.lastIndex=0,c=-1,l=[],h=[];for(t+="",n+="";(s=Pe.exec(t))&&(r=Ee.exec(n));)(o=r.index)>e&&(o=n.slice(e,o),l[c]?l[c]+=o:l[++c]=o),(s=s[0])===(r=r[0])?l[c]?l[c]+=r:l[++c]=r:(l[++c]=null,h.push({i:c,x:pt(s,r)})),e=Ee.lastIndex;return e<n.length&&(o=n.slice(e),l[c]?l[c]+=o:l[++c]=o),l.length<2?h[0]?function(t){return function(n){return t(n)+""}}(h[0].x):function(t){return function(){return t}}(n):(n=h.length,function(g){for(var a,f=0;f<n;++f)l[(a=h[f]).i]=a.x(g);return l.join("")})}function Xn(t,n){var e;return("number"==typeof n?pt:n instanceof Rt?Vn:(e=Rt(n))?(n=e,Vn):Pa)(t,n)}function Ea(t){return function(){this.removeAttribute(t)}}function Aa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ka(t,n,e){var s,o,r=e+"";return function(){var c=this.getAttribute(t);return c===r?null:c===s?o:o=n(s=c,e)}}function $a(t,n,e){var s,o,r=e+"";return function(){var c=this.getAttributeNS(t.space,t.local);return c===r?null:c===s?o:o=n(s=c,e)}}function Na(t,n,e){var s,r,o;return function(){var c,h,l=e(this);return null==l?void this.removeAttribute(t):(c=this.getAttribute(t))===(h=l+"")?null:c===s&&h===r?o:(r=h,o=n(s=c,l))}}function Ma(t,n,e){var s,r,o;return function(){var c,h,l=e(this);return null==l?void this.removeAttributeNS(t.space,t.local):(c=this.getAttributeNS(t.space,t.local))===(h=l+"")?null:c===s&&h===r?o:(r=h,o=n(s=c,l))}}function La(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Ca(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Ra(t,n){var e,s;function r(){var o=n.apply(this,arguments);return o!==s&&(e=(s=o)&&Ca(t,o)),e}return r._value=n,r}function ka(t,n){var e,s;function r(){var o=n.apply(this,arguments);return o!==s&&(e=(s=o)&&La(t,o)),e}return r._value=n,r}function Ha(t,n){return function(){_e(this,t).delay=+n.apply(this,arguments)}}function Oa(t,n){return n=+n,function(){_e(this,t).delay=n}}function qa(t,n){return function(){et(this,t).duration=+n.apply(this,arguments)}}function Ua(t,n){return n=+n,function(){et(this,t).duration=n}}function Va(t,n){if("function"!=typeof n)throw new Error;return function(){et(this,t).ease=n}}var Qa=D(6520);function eo(t,n,e){var s,r,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||"start"===n})}(n)?_e:et;return function(){var c=o(this,t),l=c.on;l!==s&&(r=(s=l).copy()).on(n,e),c.on=r}}var ro=D(1626),oo=D(566),co=At.ZP.prototype.constructor,kt=D(6521);function Jn(t){return function(){this.style.removeProperty(t)}}function yo(t,n,e){return function(s){this.style.setProperty(t,n.call(this,s),e)}}function wo(t,n,e){var s,r;function o(){var c=n.apply(this,arguments);return c!==r&&(s=(r=c)&&yo(t,c,e)),s}return o._value=n,o}function So(t){return function(n){this.textContent=t.call(this,n)}}function xo(t){var n,e;function s(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&So(r)),n}return s._value=t,s}var Po=0;function lt(t,n,e,s){this._groups=t,this._parents=n,this._name=e,this._id=s}function Qn(){return++Po}var ct=At.ZP.prototype;lt.prototype=function(t){return(0,At.ZP)().transition(t)}.prototype={constructor:lt,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=(0,ro.Z)(t));for(var s=this._groups,r=s.length,o=new Array(r),c=0;c<r;++c)for(var f,a,l=s[c],h=l.length,g=o[c]=new Array(h),u=0;u<h;++u)(f=l[u])&&(a=t.call(f,f.__data__,u,l))&&("__data__"in f&&(a.__data__=f.__data__),g[u]=a,te(g[u],n,e,u,g,J(f,e)));return new lt(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=(0,oo.Z)(t));for(var s=this._groups,r=s.length,o=[],c=[],l=0;l<r;++l)for(var f,h=s[l],g=h.length,a=0;a<g;++a)if(f=h[a]){for(var d,u=t.call(f,f.__data__,a,h),y=J(f,e),I=0,v=u.length;I<v;++I)(d=u[I])&&te(d,n,e,I,u,y);o.push(u),c.push(f)}return new lt(o,c,n,e)},selectChild:ct.selectChild,selectChildren:ct.selectChildren,filter:function(t){"function"!=typeof t&&(t=(0,Qa.Z)(t));for(var n=this._groups,e=n.length,s=new Array(e),r=0;r<e;++r)for(var h,o=n[r],c=o.length,l=s[r]=[],g=0;g<c;++g)(h=o[g])&&t.call(h,h.__data__,g,o)&&l.push(h);return new lt(s,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,s=n.length,o=Math.min(s,e.length),c=new Array(s),l=0;l<o;++l)for(var u,h=n[l],g=e[l],f=h.length,a=c[l]=new Array(f),d=0;d<f;++d)(u=h[d]||g[d])&&(a[d]=u);for(;l<s;++l)c[l]=n[l];return new lt(c,this._parents,this._name,this._id)},selection:function(){return new co(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Qn(),s=this._groups,r=s.length,o=0;o<r;++o)for(var h,c=s[o],l=c.length,g=0;g<l;++g)if(h=c[g]){var f=J(h,n);te(h,t,e,g,c,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new lt(s,this._parents,t,e)},call:ct.call,nodes:ct.nodes,node:ct.node,size:ct.size,empty:ct.empty,each:ct.each,on:function(t,n){var e=this._id;return arguments.length<2?J(this.node(),e).on.on(t):this.each(eo(e,t,n))},attr:function(t,n){var e=(0,Nn.Z)(t),s="transform"===e?la:Xn;return this.attrTween(t,"function"==typeof n?(e.local?Ma:Na)(e,s,xe(this,"attr."+t,n)):null==n?(e.local?Aa:Ea)(e):(e.local?$a:Ka)(e,s,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var s=(0,Nn.Z)(t);return this.tween(e,(s.local?Ra:ka)(s,n))},style:function(t,n,e){var s="transform"==(t+="")?oa:Xn;return null==n?this.styleTween(t,function(t,n){var e,s,r;return function(){var o=(0,kt.S)(this,t),c=(this.style.removeProperty(t),(0,kt.S)(this,t));return o===c?null:o===e&&c===s?r:r=n(e=o,s=c)}}(t,s)).on("end.style."+t,Jn(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var s,r,o;return function(){var c=(0,kt.S)(this,t),l=e(this),h=l+"";return null==l&&(this.style.removeProperty(t),h=l=(0,kt.S)(this,t)),c===h?null:c===s&&h===r?o:(r=h,o=n(s=c,l))}}(t,s,xe(this,"style."+t,n))).each(function(t,n){var e,s,r,l,o="style."+n,c="end."+o;return function(){var h=et(this,t),g=h.on,f=null==h.value[o]?l||(l=Jn(n)):void 0;(g!==e||r!==f)&&(s=(e=g).copy()).on(c,r=f),h.on=s}}(this._id,t)):this.styleTween(t,function(t,n,e){var s,o,r=e+"";return function(){var c=(0,kt.S)(this,t);return c===r?null:c===s?o:o=n(s=c,e)}}(t,s,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==n)return this.tween(s,null);if("function"!=typeof n)throw new Error;return this.tween(s,wo(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(xe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,xo(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}));var t},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var c,s=J(this.node(),e).tween,r=0,o=s.length;r<o;++r)if((c=s[r]).name===t)return c.value;return null}return this.each((null==n?ca:ua)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Ha:Oa)(n,t)):J(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?qa:Ua)(n,t)):J(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(Va(n,t)):J(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;et(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,s=e._id,r=e.size();return new Promise(function(o,c){var l={value:c},h={value:function(){0==--r&&o()}};e.each(function(){var g=et(this,s),f=g.on;f!==t&&((n=(t=f).copy())._.cancel.push(l),n._.interrupt.push(l),n._.end.push(h)),g.on=n}),0===r&&o()})},[Symbol.iterator]:ct[Symbol.iterator]};var Ko={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function $o(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}At.ZP.prototype.interrupt=function(t){return this.each(function(){ee(this,t)})},At.ZP.prototype.transition=function(t){var n,e;t instanceof lt?(n=t._id,t=t._name):(n=Qn(),(e=Ko).time=we(),t=null==t?null:t+"");for(var s=this._groups,r=s.length,o=0;o<r;++o)for(var h,c=s[o],l=c.length,g=0;g<l;++g)(h=c[g])&&te(h,t,n,g,c,e||$o(h,n));return new lt(s,this._parents,t,n)};const ae=t=>()=>t;function Mo(t,{sourceEvent:n,target:e,transform:s,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:r}})}function ut(t,n,e){this.k=t,this.x=n,this.y=e}ut.prototype={constructor:ut,scale:function(t){return 1===t?this:new ut(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new ut(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bt=new ut(1,0,0);function Ae(t){for(;!t.__zoom;)if(!(t=t.parentNode))return bt;return t.__zoom}function Ke(t){t.stopImmediatePropagation()}function Zt(t){t.preventDefault(),t.stopImmediatePropagation()}function Fo(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Lo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function jn(){return this.__zoom||bt}function Co(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ro(){return navigator.maxTouchPoints||"ontouchstart"in this}function ko(t,n,e){var s=t.invertX(n[0][0])-e[0][0],r=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],c=t.invertY(n[1][1])-e[1][1];return t.translate(r>s?(s+r)/2:Math.min(0,s)||Math.max(0,r),c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c))}function Wn(){var f,a,u,t=Fo,n=Lo,e=ko,s=Co,r=Ro,o=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,h=Xr,g=on("start","zoom","end"),d=500,I=0,v=10;function _(p){p.property("__zoom",jn).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",V).on("dblclick.zoom",it).filter(r).on("touchstart.zoom",vt).on("touchmove.zoom",Q).on("touchend.zoom touchcancel.zoom",Ht).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function K(p,S){return(S=Math.max(o[0],Math.min(o[1],S)))===p.k?p:new ut(S,p.x,p.y)}function N(p,S,w){var b=S[0]-w[0]*p.k,A=S[1]-w[1]*p.k;return b===p.x&&A===p.y?p:new ut(p.k,b,A)}function L(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function F(p,S,w,b){p.on("start.zoom",function(){E(this,arguments).event(b).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(b).end()}).tween("zoom",function(){var A=this,$=arguments,M=E(A,$).event(b),C=n.apply(A,$),k=null==w?L(C):"function"==typeof w?w.apply(A,$):w,rt=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),H=A.__zoom,j="function"==typeof S?S.apply(A,$):S,ht=h(H.invert(k).concat(rt/H.k),j.invert(k).concat(rt/j.k));return function(W){if(1===W)W=j;else{var gt=ht(W),$e=rt/gt[2];W=new ut($e,k[0]-gt[0]*$e,k[1]-gt[1]*$e)}M.zoom(null,W)}})}function E(p,S,w){return!w&&p.__zooming||new Z(p,S)}function Z(p,S){this.that=p,this.args=S,this.active=0,this.sourceEvent=null,this.extent=n.apply(p,S),this.taps=0}function O(p,...S){if(t.apply(this,arguments)){var w=E(this,S).event(p),b=this.__zoom,A=Math.max(o[0],Math.min(o[1],b.k*Math.pow(2,s.apply(this,arguments)))),$=It(p);if(w.wheel)(w.mouse[0][0]!==$[0]||w.mouse[0][1]!==$[1])&&(w.mouse[1]=b.invert(w.mouse[0]=$)),clearTimeout(w.wheel);else{if(b.k===A)return;w.mouse=[$,b.invert($)],ee(this),w.start()}Zt(p),w.wheel=setTimeout(M,150),w.zoom("mouse",e(N(K(b,A),w.mouse[0],w.mouse[1]),w.extent,c))}function M(){w.wheel=null,w.end()}}function V(p,...S){if(!u&&t.apply(this,arguments)){var w=p.currentTarget,b=E(this,S,!0).event(p),A=wt(p.view).on("mousemove.zoom",k,!0).on("mouseup.zoom",rt,!0),$=It(p,w),M=p.clientX,C=p.clientY;qr(p.view),Ke(p),b.mouse=[$,this.__zoom.invert($)],ee(this),b.start()}function k(H){if(Zt(H),!b.moved){var j=H.clientX-M,ht=H.clientY-C;b.moved=j*j+ht*ht>I}b.event(H).zoom("mouse",e(N(b.that.__zoom,b.mouse[0]=It(H,w),b.mouse[1]),b.extent,c))}function rt(H){A.on("mousemove.zoom mouseup.zoom",null),Ur(H.view,b.moved),Zt(H),b.event(H).end()}}function it(p,...S){if(t.apply(this,arguments)){var w=this.__zoom,b=It(p.changedTouches?p.changedTouches[0]:p,this),A=w.invert(b),$=w.k*(p.shiftKey?.5:2),M=e(N(K(w,$),b,A),n.apply(this,S),c);Zt(p),l>0?wt(this).transition().duration(l).call(F,M,b,p):wt(this).call(_.transform,M,b,p)}}function vt(p,...S){if(t.apply(this,arguments)){var $,M,C,k,w=p.touches,b=w.length,A=E(this,S,p.changedTouches.length===b).event(p);for(Ke(p),M=0;M<b;++M)k=[k=It(C=w[M],this),this.__zoom.invert(k),C.identifier],A.touch0?!A.touch1&&A.touch0[2]!==k[2]&&(A.touch1=k,A.taps=0):(A.touch0=k,$=!0,A.taps=1+!!f);f&&(f=clearTimeout(f)),$&&(A.taps<2&&(a=k[0],f=setTimeout(function(){f=null},d)),ee(this),A.start())}}function Q(p,...S){if(this.__zooming){var $,M,C,k,w=E(this,S).event(p),b=p.changedTouches,A=b.length;for(Zt(p),$=0;$<A;++$)C=It(M=b[$],this),w.touch0&&w.touch0[2]===M.identifier?w.touch0[0]=C:w.touch1&&w.touch1[2]===M.identifier&&(w.touch1[0]=C);if(M=w.that.__zoom,w.touch1){var rt=w.touch0[0],H=w.touch0[1],j=w.touch1[0],ht=w.touch1[1],W=(W=j[0]-rt[0])*W+(W=j[1]-rt[1])*W,gt=(gt=ht[0]-H[0])*gt+(gt=ht[1]-H[1])*gt;M=K(M,Math.sqrt(W/gt)),C=[(rt[0]+j[0])/2,(rt[1]+j[1])/2],k=[(H[0]+ht[0])/2,(H[1]+ht[1])/2]}else{if(!w.touch0)return;C=w.touch0[0],k=w.touch0[1]}w.zoom("touch",e(N(M,C,k),w.extent,c))}}function Ht(p,...S){if(this.__zooming){var $,M,w=E(this,S).event(p),b=p.changedTouches,A=b.length;for(Ke(p),u&&clearTimeout(u),u=setTimeout(function(){u=null},d),$=0;$<A;++$)M=b[$],w.touch0&&w.touch0[2]===M.identifier?delete w.touch0:w.touch1&&w.touch1[2]===M.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),2===w.taps&&(M=It(M,this),Math.hypot(a[0]-M[0],a[1]-M[1])<v)){var C=wt(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return _.transform=function(p,S,w,b){var A=p.selection?p.selection():p;A.property("__zoom",jn),p!==A?F(p,S,w,b):A.interrupt().each(function(){E(this,arguments).event(b).start().zoom(null,"function"==typeof S?S.apply(this,arguments):S).end()})},_.scaleBy=function(p,S,w,b){_.scaleTo(p,function(){var A=this.__zoom.k,$="function"==typeof S?S.apply(this,arguments):S;return A*$},w,b)},_.scaleTo=function(p,S,w,b){_.transform(p,function(){var A=n.apply(this,arguments),$=this.__zoom,M=null==w?L(A):"function"==typeof w?w.apply(this,arguments):w,C=$.invert(M),k="function"==typeof S?S.apply(this,arguments):S;return e(N(K($,k),M,C),A,c)},w,b)},_.translateBy=function(p,S,w,b){_.transform(p,function(){return e(this.__zoom.translate("function"==typeof S?S.apply(this,arguments):S,"function"==typeof w?w.apply(this,arguments):w),n.apply(this,arguments),c)},null,b)},_.translateTo=function(p,S,w,b,A){_.transform(p,function(){var $=n.apply(this,arguments),M=this.__zoom,C=null==b?L($):"function"==typeof b?b.apply(this,arguments):b;return e(bt.translate(C[0],C[1]).scale(M.k).translate("function"==typeof S?-S.apply(this,arguments):-S,"function"==typeof w?-w.apply(this,arguments):-w),$,c)},b,A)},Z.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,S){return this.mouse&&"mouse"!==p&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&"touch"!==p&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&"touch"!==p&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var S=wt(this.that).datum();g.call(p,this.that,new Mo(p,{sourceEvent:this.sourceEvent,target:_,type:p,transform:this.that.__zoom,dispatch:g}),S)}},_.wheelDelta=function(p){return arguments.length?(s="function"==typeof p?p:ae(+p),_):s},_.filter=function(p){return arguments.length?(t="function"==typeof p?p:ae(!!p),_):t},_.touchable=function(p){return arguments.length?(r="function"==typeof p?p:ae(!!p),_):r},_.extent=function(p){return arguments.length?(n="function"==typeof p?p:ae([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),_):n},_.scaleExtent=function(p){return arguments.length?(o[0]=+p[0],o[1]=+p[1],_):[o[0],o[1]]},_.translateExtent=function(p){return arguments.length?(c[0][0]=+p[0][0],c[1][0]=+p[1][0],c[0][1]=+p[0][1],c[1][1]=+p[1][1],_):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},_.constrain=function(p){return arguments.length?(e=p,_):e},_.duration=function(p){return arguments.length?(l=+p,_):l},_.interpolate=function(p){return arguments.length?(h=p,_):h},_.on=function(){var p=g.on.apply(g,arguments);return p===g?_:p},_.clickDistance=function(p){return arguments.length?(I=(p=+p)*p,_):Math.sqrt(I)},_.tapDistance=function(p){return arguments.length?(v=+p,_):v},_}Ae.prototype=ut.prototype;var Zo=D(3405),Ho=D(5686);let Oo=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-compound-visualization"]],inputs:{compoundSrc:"compoundSrc"},decls:1,vars:1,consts:[["alt","Loading...",1,"border","border-success",2,"background-color","#f7f7f9",3,"src"]],template:function(e,s){1&e&&i._UZ(0,"img",0),2&e&&i.Q6J("src",s.compoundSrc,i.LSH)},styles:["[_nghost-%COMP%]{position:fixed}"],changeDetection:0}),t})();const zo=function(t,n){return{enzymeUp:t,enzymeDown:n}};function qo(t,n){if(1&t&&(i.TgZ(0,"tr"),i.TgZ(1,"td",2),i._uU(2),i.qZA(),i.qZA()),2&t){const e=n.$implicit;i.xp6(1),i.Q6J("ngClass",i.WLB(2,zo,e.ifUp,e.ifDown)),i.xp6(1),i.Oqu(e.name)}}let Uo=(()=>{class t{constructor(e){this.cdr=e}ngOnInit(){this._preprocessGenes()}ngOnChanges(e){(e.enzymeGenes&&!e.enzymeGenes.isFirstChange()||e.diffGenesSymbol&&!e.diffGenesSymbol.isFirstChange())&&this._preprocessGenes()}_preprocessGenes(){if(null!=this.enzymeGenes){let e=this.enzymeGenes.map(r=>null!=this.diffGenesSymbol?this.diffGenesSymbol.up.indexOf(r)>=0?{name:r,ifUp:!0,ifDown:!1}:this.diffGenesSymbol.down.indexOf(r)>=0?{name:r,ifUp:!1,ifDown:!0}:{name:r,ifUp:!1,ifDown:!1}:{name:r,ifDown:!1,ifUp:!1}),s=[];e.forEach(r=>{r.ifUp||r.ifDown?s.unshift(r):s.push(r)}),this.enzymesShow=s}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.sBO))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-enzyme-visualization"]],inputs:{enzymeGenes:"enzymeGenes",diffGenesSymbol:"diffGenesSymbol"},features:[i.TTD],decls:3,vars:1,consts:[[1,"border","border-success"],[4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(e,s){1&e&&(i.TgZ(0,"table",0),i.TgZ(1,"tbody"),i.YNc(2,qo,3,5,"tr",1),i.qZA(),i.qZA()),2&e&&(i.xp6(2),i.Q6J("ngForOf",s.enzymesShow))},directives:[B.sg,B.mk],styles:['[_nghost-%COMP%]{position:fixed;background-color:"green";background-color:#f1f1f1}.enzymeUp[_ngcontent-%COMP%]{color:red}.enzymeDown[_ngcontent-%COMP%]{color:green}'],changeDetection:0}),t})();const Yo=["keggMapSvg"],ts=function(t,n,e){return{left:t,top:n,visibility:e}};let Vo=(()=>{class t{constructor(e){this.cdr=e,this.selectedRectEntries$=new i.vpe,this.selectedKeggId$=new i.vpe,this.transformingInfo$=new i.vpe,this.pathwayImageUrl=Et.N.pathwayImageUrl,this.compoundIfVis="hidden",this.compoundSrc="",this.enzymeIfVis="hidden",this.allGenesInPathway=[],this.transformingInfoDeboucer=new Zo.xQ,this.transformingInfoDeboucer.pipe((0,Ho.b)(500),(0,x.h)(s=>null!=s)).subscribe(s=>{this.transformingInfo$.next(s)})}ngOnInit(){}ngAfterViewInit(){this.keggKgmlEntryIDtoSymbolTransform&&(this._removeGraphic(),this._initMap(),this._highlightGenes())}ngOnChanges(e){e.keggKgmlEntryIDtoSymbolTransform&&!e.keggKgmlEntryIDtoSymbolTransform.isFirstChange()&&(this._removeGraphic(),this._initMap(),this._highlightGenes()),e.highlightGenesInfo&&!e.highlightGenesInfo.isFirstChange()&&this._highlightGenes()}ngOnDestroy(){this.transformingInfoDeboucer.complete()}_removeGraphic(){this.d3Svg&&this.d3Svg.selectAll("*").remove()}_initMap(){this.d3Svg=(0,ii.Z)(this.keggMapSvg.nativeElement),this._convertXmlString2Document(),this._obtainGeneID2rectID(),this._obtainGenesInPathway(),this._loadImage().then(e=>{let s=e.width,r=e.height;this._drawBasicElements(s,r),this._drawElementsForMouseEvents(),this._transformMap(s,r)})}_highlightGenes(){this.highlightGenesInfo&&("geneList"===this.highlightGenesInfo.genesType&&(this._obtainHighlightGeneSymbols(),setTimeout(()=>{this._highlightGeneList(this.highlightGenesInfo.genes)},200)),"diff"===this.highlightGenesInfo.genesType&&(this._obtainDiffGeneSymbols(),setTimeout(()=>{this._highlightDiffGenes()},200)))}_loadImage(){let e=this;return new Promise(function(s,r){const o=String(e.kgmlStringDoc.querySelector("pathway").getAttribute("number")),c=e.pathwayImageUrl+"/map"+o+".png";let l=new Image;l.src=c,l.onload=function(){s(l)}})}_convertXmlString2Document(){let e=new DOMParser;this.kgmlStringDoc=e.parseFromString(this.keggKgmlEntryIDtoSymbolTransform.kgmlString,"text/xml"),this.entryID2Symbol=this.keggKgmlEntryIDtoSymbolTransform.entryID2Symbol,this.pathwayID=this.keggKgmlEntryIDtoSymbolTransform.ID}_drawBasicElements(e,s){let r=this,o=r.kgmlStringDoc.querySelectorAll("entry[type='gene']");this.d3Svg.selectAll(".rect").data(o).enter().append("svg:rect").attr("id",function(c,l){return"geneUp"+o[l].getAttribute("id")}).attr("width",function(c,l){return.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("height",function(c,l){return o[l].getElementsByTagName("graphics")[0].getAttribute("height")}).attr("x",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("x"))-.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("y",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("y"))-.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("height"))}).style("stroke","grey").style("stroke-width",0).attr("class","geneRectNormal"),r.d3Svg.selectAll(".rect").data(o).enter().append("svg:rect").attr("id",function(c,l){return"geneDown"+o[l].getAttribute("id")}).attr("width",function(c,l){return.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("height",function(c,l){return o[l].getElementsByTagName("graphics")[0].getAttribute("height")}).attr("x",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("x"))}).attr("y",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("y"))-.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("height"))}).style("stroke","grey").style("stroke-width",0).attr("class","geneRectNormal"),this.d3Svg.selectAll("image").data([1]).enter().append("image").attr("xlink:href",function(c,l){return r.pathwayImageUrl+"/map"+r.kgmlStringDoc.getElementsByTagName("pathway")[0].getAttribute("number")+".png"}).style("mix-blend-mode","multiply").attr("width",e).attr("height",s)}_drawElementsForMouseEvents(){let e=this,s=this.kgmlStringDoc.querySelectorAll("entry[type='gene']");e.d3Svg.selectAll(".rect").data(s).enter().append("svg:rect").attr("id",function(c,l){return"Click"+s[l].getAttribute("id")}).attr("class","gene").attr("width",function(c,l){return s[l].getElementsByTagName("graphics")[0].getAttribute("width")}).attr("height",function(c,l){return s[l].getElementsByTagName("graphics")[0].getAttribute("height")}).attr("x",function(c,l){return parseFloat(s[l].getElementsByTagName("graphics")[0].getAttribute("x"))-.5*parseFloat(s[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("y",function(c,l){return parseFloat(s[l].getElementsByTagName("graphics")[0].getAttribute("y"))-.5*parseFloat(s[l].getElementsByTagName("graphics")[0].getAttribute("height"))}).style("fill","white").style("opacity",0).style("stroke","grey").style("stroke-width",1).style("z-index",1062).on("click",function(c,l){let h=l.getAttribute("name").split(" ").map(g=>g.split(":")[1]);e.selectedRectEntries$.emit(h)},{passive:!0}).on("mouseover",function(c,l){c.stopPropagation();let h=l.getAttribute("name").split(" ").map(function(u){return e.entryID2Symbol[u.split(":")[1]]});e.enzymeGenes=[...h];const g=document.getElementById("Click"+l.getAttribute("id")).getBoundingClientRect(),f=g.top;e.enzymeLeft=String(g.left)+"px",e.enzymeTop=String(f+30)+"px",e.enzymeIfVis="visible",e.compoundIfVis="hidden",e.cdr.detectChanges()},{passive:!0}).on("mouseout",function(c,l){setTimeout(function(){e.enzymeIfVis="hidden",e.cdr.detectChanges()},500)});let r=e.kgmlStringDoc.querySelectorAll("entry[type=compound]");e.d3Svg.selectAll("coumpound").data(r).enter().append("circle").attr("id",function(c,l){return"Click"+r[l].getAttribute("id")}).attr("class","compound").attr("r",function(c,l){return.5*parseFloat(r[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("cx",function(c,l){return parseFloat(r[l].getElementsByTagName("graphics")[0].getAttribute("x"))}).attr("cy",function(c,l){return parseFloat(r[l].getElementsByTagName("graphics")[0].getAttribute("y"))}).style("fill","white").style("opacity",0).style("stroke","grey").style("stroke-width",1).on("mouseover",function(c,l){c.stopPropagation();let h=document.getElementById("Click"+l.getAttribute("id")).getBoundingClientRect(),g=h.top;e.compoundLeft=String(h.left-20)+"px",e.compoundTop=String(g+50)+"px",e.compoundIfVis="visible",e.compoundSrc="http://www.genome.jp/Fig/compound/"+l.getElementsByTagName("graphics")[0].getAttribute("name")+".gif",e.enzymeIfVis="hidden",e.cdr.detectChanges()},{passive:!0}).on("mouseout",function(c,l){setTimeout(function(){e.compoundIfVis="hidden",e.cdr.detectChanges()},2e3)},{passive:!0}).on("click",function(c,l){window.open(l.getAttribute("link"))},{passive:!0});let o=e.kgmlStringDoc.querySelectorAll("entry[type=map]");e.d3Svg.selectAll(".map").data(o).enter().append("rect").attr("class","map").attr("id",function(c,l){return o[l].getAttribute("name").split(":")[1]}).attr("width",function(c,l){return o[l].getElementsByTagName("graphics")[0].getAttribute("width")}).attr("height",function(c,l){return o[l].getElementsByTagName("graphics")[0].getAttribute("height")}).attr("x",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("x"))-.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("width"))}).attr("y",function(c,l){return parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("y"))-.5*parseFloat(o[l].getElementsByTagName("graphics")[0].getAttribute("height"))}).attr("rx",10).attr("ry",10).style("fill","white").style("opacity",0).style("stroke","grey").style("stroke-width",1).on("click",function(c,l){let h=l.getAttribute("name").split(":")[1];e.selectedKeggId$.emit(h)},{passive:!0})}_transformMap(e,s){let r=this;const o=this.keggKgmlEntryIDtoSymbolTransform.transform;if(JSON.stringify(o)===JSON.stringify({x:0,y:0,k:1})){const g=r.keggMapSvg.nativeElement.width.baseVal.value/e,f=r.keggMapSvg.nativeElement.height.baseVal.value/s;let a=1;a=g<=f?g:f;const u=20,d=5,y=`translate(${d},${d})scale(${a})`;r.d3Svg.selectAll("*").attr("transform",y);let I=r.d3Svg.node();const v=bt.translate(d,u).scale(a);I.__zoom=v,r.d3Svg.call(Wn().scaleExtent([.2,5]).on("zoom",function(_){const K=Ae(this);let{x:N,y:L,k:F}=K;r.d3Svg.selectAll("*").attr("transform",`translate(${N}, ${L})scale(${F})`);let E=bt.translate(N,L).scale(F);r.transformingInfoDeboucer.next({pathwayID:r.pathwayID,transform:E})})).on("dblclick.zoom",null)}else{const{x:l,y:h,k:g}=o,f=`translate(${l}, ${h})scale(${g})`;r.d3Svg.selectAll("*").attr("transform",f);let a=r.d3Svg.node(),u=bt;u=u.translate(l,h),u=u.scale(g),a.__zoom=u,r.d3Svg.call(Wn().scaleExtent([.2,5]).on("zoom",function(){const d=Ae(this),{x:y,y:I,k:v}=d;r.d3Svg.selectAll("*").attr("transform",`translate(${y}, ${I})scale(${v})`),r.transformingInfoDeboucer.next({pathwayID:r.pathwayID,transform:d})})).on("dblclick.zoom",null)}}_obtainGeneID2rectID(){let e=this.kgmlStringDoc.querySelectorAll("entry[type='gene']"),s=new Map;e.forEach((r,o)=>{let c=r.getAttribute("id");r.getAttribute("name").split(" ").map(g=>g.split(":")[1]).forEach(g=>{if(s.has(g)){let f=[...s.get(g)];f.push(c),s.set(g,f)}else s.set(g,[c])})}),this.geneID2RectID=s}_obtainDiffGeneSymbols(){let e={up:[],down:[]},s=[],r=[];this.highlightGenesInfo.genes.up.forEach(o=>{this.allGenesInPathway.includes(o)&&s.push(this.entryID2Symbol[o])}),e.up=s,this.highlightGenesInfo.genes.down.forEach(o=>{this.allGenesInPathway.includes(o)&&r.push(this.entryID2Symbol[o])}),e.down=r,this.diffGenesSymbol=Object.assign({},e),this.cdr.detectChanges()}_obtainGenesInPathway(){this.entryID2Symbol&&(this.allGenesInPathway=Object.keys(this.entryID2Symbol))}_highlightDiffGenes(){this._highLightUpRect(this.highlightGenesInfo.genes.up),this._highLightDownRect(this.highlightGenesInfo.genes.down)}_highLightUpRect(e){Array.from(document.getElementsByClassName("geneRectRed")).forEach(l=>{l.classList.remove("geneRectRed"),l.classList.add("geneRectNormal")});let r=[];e.forEach(l=>{r=r.concat(this.geneID2RectID.get(l))});let c=r.map(l=>"#geneUp"+l).toString();""!=c&&Array.from(document.querySelectorAll(c)).forEach(h=>{h.classList.remove("geneRectNormal"),h.classList.add("geneRectRed")})}_highLightDownRect(e){Array.from(document.getElementsByClassName("geneRectGreen")).forEach(l=>{l.classList.remove("geneRectGreen"),l.classList.add("geneRectNormal")});let r=[];e.forEach(l=>{r=r.concat(this.geneID2RectID.get(l))});let c=r.map(l=>"#geneDown"+l).toString();""!==c&&Array.from(document.querySelectorAll(c)).forEach(h=>{h.classList.remove("geneRectNormal"),h.classList.add("geneRectGreen")})}_highlightGeneList(e){Array.from(document.getElementsByClassName("geneRectRed")).forEach(h=>{h.classList.remove("geneRectRed"),h.classList.add("geneRectNormal")}),Array.from(document.getElementsByClassName("geneRectGreen")).forEach(h=>{h.classList.remove("geneRectGreen"),h.classList.add("geneRectNormal")});let o=[];e.forEach(h=>{o=o.concat(this.geneID2RectID.get(h))});let l=o.map(h=>"#geneDown"+h+",#geneUp"+h).toString();""!=l&&Array.from(document.querySelectorAll(l)).forEach(g=>{g.classList.remove("geneRectNormal"),g.classList.add("geneRectRed")})}_obtainHighlightGeneSymbols(){let e=[];this.highlightGenesInfo.genes.forEach(s=>{this.allGenesInPathway.includes(s)&&e.push(this.entryID2Symbol[s])}),this.diffGenesSymbol={up:e,down:[]},this.cdr.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.sBO))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-kegg-map-visualization"]],viewQuery:function(e,s){if(1&e&&i.Gf(Yo,5),2&e){let r;i.iGM(r=i.CRH())&&(s.keggMapSvg=r.first)}},inputs:{keggKgmlEntryIDtoSymbolTransform:"keggKgmlEntryIDtoSymbolTransform",highlightGenesInfo:"highlightGenesInfo"},outputs:{selectedRectEntries$:"selectedRectEntries$",selectedKeggId$:"selectedKeggId$",transformingInfo$:"transformingInfo$"},features:[i.TTD],decls:4,vars:13,consts:[["data-testid","keggMapSvg",2,"height","70vh","width","100%"],["keggMapSvg",""],[3,"ngStyle","compoundSrc"],[3,"ngStyle","enzymeGenes","diffGenesSymbol"]],template:function(e,s){1&e&&(i.O4$(),i._UZ(0,"svg",0,1),i.kcU(),i._UZ(2,"app-compound-visualization",2),i._UZ(3,"app-enzyme-visualization",3)),2&e&&(i.xp6(2),i.Q6J("ngStyle",i.kEZ(5,ts,s.compoundLeft,s.compoundTop,s.compoundIfVis))("compoundSrc",s.compoundSrc),i.xp6(1),i.Q6J("ngStyle",i.kEZ(9,ts,s.enzymeLeft,s.enzymeTop,s.enzymeIfVis))("enzymeGenes",s.enzymeGenes)("diffGenesSymbol",s.diffGenesSymbol))},directives:[Oo,B.PC,Uo],styles:[".geneRectNormal{fill:#bfffbf}.geneRectRed{fill:red}.geneRectGreen{fill:green}\n"],encapsulation:2,changeDetection:0}),t})(),Bo=(()=>{class t{constructor(e){this.el=e}onMousewheel(e){return e.preventDefault(),!(e.deltaY>0&&this.el.nativeElement.clientHeight+this.el.nativeElement.scrollTop>=this.el.nativeElement.scrollHeight||e.deltaY<0&&this.el.nativeElement.scrollTop<=0)||(e.stopPropagation(),e.preventDefault(),!1)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t,selectors:[["","appIsolateScroll",""]],hostBindings:function(e,s){1&e&&i.NdJ("mousewheel",function(o){return s.onMousewheel(o)})}}),t})();function Xo(t,n){1&t&&(i.TgZ(0,"p",2),i._uU(1,"Input a pathway in the left sidebar"),i.qZA(),i._UZ(2,"div",3))}function Jo(t,n){if(1&t&&(i.TgZ(0,"p"),i._uU(1),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Oqu(null==e.keggKgmlEntryIDtoSymbolTransformStatus?null:e.keggKgmlEntryIDtoSymbolTransformStatus.statusValue)}}function Qo(t,n){if(1&t&&(i.TgZ(0,"p",2),i._uU(1),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Oqu(null==e.keggKgmlEntryIDtoSymbolTransformStatus?null:e.keggKgmlEntryIDtoSymbolTransformStatus.statusValue)}}function jo(t,n){if(1&t&&(i.TgZ(0,"p",9),i._uU(1),i.qZA()),2&t){const e=i.oxw(2);i.xp6(1),i.hij(" Genes with similar expression pattern from ",null==e.highlightGenesInfo?null:e.highlightGenesInfo.sourceName," are highlighted in the map ")}}function Wo(t,n){if(1&t&&(i.TgZ(0,"p",10),i._uU(1),i.qZA()),2&t){const e=i.oxw(2);i.xp6(1),i.hij(" Genes from gene list ",null==e.highlightGenesInfo?null:e.highlightGenesInfo.sourceName," are highlighted in the map ")}}function tl(t,n){if(1&t&&(i.TgZ(0,"p",11),i._uU(1),i.qZA()),2&t){const e=i.oxw(2);i.xp6(1),i.hij(" Differentially-expressed genes from ",null==e.highlightGenesInfo?null:e.highlightGenesInfo.sourceName," are highlighted in the map ")}}function el(t,n){1&t&&(i.TgZ(0,"p",12),i._uU(1," You can highlight genes from expression profile map, a differential analysis or a specific genelist in the pathway map. "),i.qZA())}function nl(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"div"),i.TgZ(1,"app-kegg-map-visualization",4),i.NdJ("transformingInfo$",function(r){return i.CHM(e),i.oxw().processKeggMapTransformingInfo(r)}),i.qZA(),i.YNc(2,jo,2,1,"p",5),i.YNc(3,Wo,2,1,"p",6),i.YNc(4,tl,2,1,"p",7),i.YNc(5,el,2,0,"p",8),i.qZA()}if(2&t){const e=i.oxw();i.xp6(1),i.Q6J("keggKgmlEntryIDtoSymbolTransform",e.keggKgmlEntryIDtoSymbolTransform)("highlightGenesInfo",e.highlightGenesInfo),i.xp6(1),i.Q6J("ngIf","fromExpressionPattern"===(null==e.highlightGenesInfo?null:e.highlightGenesInfo.source)&&e.highlightGenesInfo.genes.length>0),i.xp6(1),i.Q6J("ngIf","fromSpecificGenes"===(null==e.highlightGenesInfo?null:e.highlightGenesInfo.source)&&e.highlightGenesInfo.genes.length>0),i.xp6(1),i.Q6J("ngIf","fromDiffGenes"===(null==e.highlightGenesInfo?null:e.highlightGenesInfo.source)&&(e.highlightGenesInfo.genes.up.length>0||e.highlightGenesInfo.genes.down.length>0)),i.xp6(1),i.Q6J("ngIf",e.ifShowHighlightGenesNote)}}let sl=(()=>{class t{constructor(){this.mapTransformation$=new i.vpe}ngOnInit(){this._extractKeggKgmlEntryIDtoSymbolTransformResult(),this._determineIfShowHighlightGenesNote()}ngOnChanges(e){e.keggKgmlEntryIDtoSymbolTransformStatus&&!e.keggKgmlEntryIDtoSymbolTransformStatus.isFirstChange()&&this._extractKeggKgmlEntryIDtoSymbolTransformResult(),e.highlightGenesInfo&&!e.highlightGenesInfo.isFirstChange()&&this._determineIfShowHighlightGenesNote()}processKeggMapTransformingInfo(e){this.mapTransformation$.next(e)}_extractKeggKgmlEntryIDtoSymbolTransformResult(){this.keggKgmlEntryIDtoSymbolTransformStatus&&this.keggKgmlEntryIDtoSymbolTransformStatus.hasOwnProperty("result")&&(this.keggKgmlEntryIDtoSymbolTransform=Object.assign({},this.keggKgmlEntryIDtoSymbolTransformStatus.result))}_determineIfShowHighlightGenesNote(){var e;this.ifShowHighlightGenesNote=!this.highlightGenesInfo||("geneList"===this.highlightGenesInfo.genesType?0===(null===(e=this.highlightGenesInfo.genes)||void 0===e?void 0:e.length):0===this.highlightGenesInfo.genes.up.length&&0===this.highlightGenesInfo.genes.down.length)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-manage-map-visualization"]],inputs:{keggKgmlEntryIDtoSymbolTransformStatus:"keggKgmlEntryIDtoSymbolTransformStatus",highlightGenesInfo:"highlightGenesInfo"},outputs:{mapTransformation$:"mapTransformation$"},features:[i.TTD],decls:4,vars:4,consts:[[3,"ngIf"],[4,"ngIf"],[2,"color","red"],[2,"height","100%","width","50%"],["appIsolateScroll","",3,"keggKgmlEntryIDtoSymbolTransform","highlightGenesInfo","transformingInfo$"],["data-testid","fromExpressionPatternNote","class","text-muted",4,"ngIf"],["data-testid","fromSpecificGenesNote","class","text-muted",4,"ngIf"],["data-testid","fromDiffGenesNot","class","text-muted",4,"ngIf"],["data-testid","selectedGenesNote","class","text-info",4,"ngIf"],["data-testid","fromExpressionPatternNote",1,"text-muted"],["data-testid","fromSpecificGenesNote",1,"text-muted"],["data-testid","fromDiffGenesNot",1,"text-muted"],["data-testid","selectedGenesNote",1,"text-info"]],template:function(e,s){1&e&&(i.YNc(0,Xo,3,0,"ng-template",0),i.YNc(1,Jo,2,1,"ng-template",0),i.YNc(2,Qo,2,1,"ng-template",0),i.YNc(3,nl,6,6,"div",1)),2&e&&(i.Q6J("ngIf",!s.keggKgmlEntryIDtoSymbolTransformStatus),i.xp6(1),i.Q6J("ngIf","loading"===(null==s.keggKgmlEntryIDtoSymbolTransformStatus?null:s.keggKgmlEntryIDtoSymbolTransformStatus.status)),i.xp6(1),i.Q6J("ngIf","error"===(null==s.keggKgmlEntryIDtoSymbolTransformStatus?null:s.keggKgmlEntryIDtoSymbolTransformStatus.status)),i.xp6(1),i.Q6J("ngIf",null==s.keggKgmlEntryIDtoSymbolTransformStatus?null:s.keggKgmlEntryIDtoSymbolTransformStatus.result))},directives:[B.O5,Vo,Bo],styles:[""],changeDetection:0}),t})();var il=D(7075),rl=D(1545),al=D(4234),ol=D(7360);function ll(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"div"),i.TgZ(1,"app-select-gene-list",6),i.NdJ("selectedGeneListName",function(r){return i.CHM(e),i.oxw().processGeneListIDforAdding(r)}),i.qZA(),i.TgZ(2,"a",7),i.NdJ("click",function(r){return i.CHM(e),i.oxw().triggerInputGeneListSignal(r)}),i._uU(3,"Import A New Gene List"),i.qZA(),i.qZA()}if(2&t){const e=i.oxw();i.xp6(1),i.Q6J("availableGeneListNames",e.allGeneListIDs)}}function cl(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"p"),i._uU(1,"Please import a gene list first. "),i.TgZ(2,"a",7),i.NdJ("click",function(r){return i.CHM(e),i.oxw().triggerInputGeneListSignal(r)}),i._uU(3,"Import Gene List"),i.qZA(),i.qZA()}}function ul(t,n){if(1&t&&(i.TgZ(0,"p"),i._uU(1),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Oqu(null==e.addGeneListForHighlightStatus?null:e.addGeneListForHighlightStatus.statusValue)}}function hl(t,n){if(1&t&&(i.TgZ(0,"p",8),i._uU(1),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Oqu(null==e.addGeneListForHighlightStatus?null:e.addGeneListForHighlightStatus.statusValue)}}let gl=(()=>{class t{constructor(){this.geneListIDforAdding$=new i.vpe,this.geneListIDforRemove$=new i.vpe,this.geneListIDforHighlight$=new i.vpe,this.inputGeneListSignal$=new i.vpe}ngOnInit(){}processGeneListIDforAdding(e){this.geneListIDforAdding$.next(e)}processGeneListIDforHighlight(e){this.geneListIDforHighlight$.next(e)}processGeneListIDforRemove(e){this.geneListIDforRemove$.next(e)}triggerInputGeneListSignal(e){this.inputGeneListSignal$.next(!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-manage-gene-lists-for-kegg"]],inputs:{allGeneListIDs:"allGeneListIDs",availableKeggGenelistIDs:"availableKeggGenelistIDs",addGeneListForHighlightStatus:"addGeneListForHighlightStatus",disActiveAllGenelist:"disActiveAllGenelist"},outputs:{geneListIDforAdding$:"geneListIDforAdding$",geneListIDforRemove$:"geneListIDforRemove$",geneListIDforHighlight$:"geneListIDforHighlight$",inputGeneListSignal$:"inputGeneListSignal$"},decls:9,vars:6,consts:[[1,"text-center"],[1,"col-12","border-right"],[4,"ngIf","ngIfElse"],["importGeneListNote",""],[3,"ngIf"],[3,"availableGenelistIDs","disActiveAll","selectedGeneListIDforHighlight$","selectedGeneListIDforRemove$"],[3,"availableGeneListNames","selectedGeneListName"],["href","javascript:void(0)","data-testid","importGeneList",3,"click"],[2,"color","red"]],template:function(e,s){if(1&e&&(i.TgZ(0,"h5",0),i._uU(1,"Highlight specific Genes"),i.qZA(),i.TgZ(2,"div",1),i.YNc(3,ll,4,1,"div",2),i.YNc(4,cl,4,0,"ng-template",null,3,i.W1O),i.qZA(),i.YNc(6,ul,2,1,"ng-template",4),i.YNc(7,hl,2,1,"ng-template",4),i.TgZ(8,"app-click-gene-list-for-highlighting",5),i.NdJ("selectedGeneListIDforHighlight$",function(o){return s.processGeneListIDforHighlight(o)})("selectedGeneListIDforRemove$",function(o){return s.processGeneListIDforRemove(o)}),i.qZA()),2&e){const r=i.MAs(5);i.xp6(3),i.Q6J("ngIf",(null==s.allGeneListIDs?null:s.allGeneListIDs.length)>0)("ngIfElse",r),i.xp6(3),i.Q6J("ngIf","loading"===(null==s.addGeneListForHighlightStatus?null:s.addGeneListForHighlightStatus.status)),i.xp6(1),i.Q6J("ngIf","error"===(null==s.addGeneListForHighlightStatus?null:s.addGeneListForHighlightStatus.status)),i.xp6(1),i.Q6J("availableGenelistIDs",s.availableKeggGenelistIDs)("disActiveAll",s.disActiveAllGenelist)}},directives:[B.O5,al.T,ol.i],styles:[""],changeDetection:0}),t})();var pl=D(4547),fl=D(5826),dl=D(6588);const ml=["inputGeneListComponent"];function yl(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"div",21),i.TgZ(1,"div",7),i.TgZ(2,"app-try-sample",22),i.NdJ("sampleForTryName$",function(r){return i.CHM(e),i.oxw().processTrySampleFileName(r)})("sampleForImportName$",function(r){return i.CHM(e),i.oxw().processDownloadSampleData(r)})("closeMe$",function(r){return i.CHM(e),i.oxw().closeTrySampleComponent(r)}),i.ALo(3,"async"),i.qZA(),i.qZA(),i.qZA()}if(2&t){const e=i.oxw();i.xp6(2),i.Q6J("fileInfos",e.trySamplesInfos)("trySamplePercentage",i.lcZ(3,2,e.trySamplePercentage$))}}function wl(t,n){if(1&t){const e=i.EpF();i.TgZ(0,"div",23),i.TgZ(1,"h3"),i._uU(2,"Generate a New Gene List"),i.qZA(),i.TgZ(3,"button",24),i.NdJ("click",function(){i.CHM(e);const r=i.oxw();return null==r.inputGenelistModalRef?null:r.inputGenelistModalRef.hide()}),i.TgZ(4,"span",25),i._uU(5,"\xd7"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(6,"div",26),i.TgZ(7,"app-generate-new-gene-list",27),i.NdJ("outputGeneList$",function(r){return i.CHM(e),i.oxw().processInputGeneList(r)})("annotationTermsRequest$",function(r){return i.CHM(e),i.oxw().processAnnotationTermsRequest(r)})("annotationGenesRequest$",function(r){return i.CHM(e),i.oxw().processAnnotationGenesRequest(r)}),i.ALo(8,"async"),i.ALo(9,"async"),i.ALo(10,"async"),i.qZA(),i.qZA(),i.TgZ(11,"div",28),i.TgZ(12,"button",29),i.NdJ("click",function(){return i.CHM(e),i.oxw().inputGenelistModalRef.hide()}),i._uU(13,"close"),i.qZA(),i.qZA()}if(2&t){const e=i.oxw();i.xp6(7),i.Q6J("availableSpecies",i.lcZ(8,4,e.availableSpeciesForGeneList$))("availableGeneIDtypes",e.availableGeneIDtypes)("latestAddedGeneListID",i.lcZ(9,6,e.latestAddedGenelistName$))("annotationTerms",i.lcZ(10,8,e.annotationTerms$))}}const Il=[{path:"",component:(()=>{class t{constructor(e,s,r){this.facade=e,this.modalService=s,this.cdr=r,this.trySamplesInfos=[{fileForTry:"RNAseqKeggExp.json.gz",fileForImport:"RNA-seq-sample-data1.zip",description:"RNA-seq data"},{fileForTry:"ProteomicsKeggExp.json.gz",fileForImport:"proteomics with clinical.zip",description:"Proteomics data"}],this.availableSpecies=q.it,this.availableGeneIDtypes=q.k1,this.availableKeggSpecies$=this.facade.availableKeggSpecies$,this.speciesKeggPathways$=this.facade.speciesKeggPathways$,this.allDatasetInfoForDisplay$=this.facade.allDatasetInfoForDisplay$,this.keggKgmlEntryIDtoSymbolTransformStatus$=this.facade.keggKgmlEntryID2SymbolTransformStatus$,this.availableKeggPathways$=this.facade.availableKeggPathways$,this.currentVisKeggPathwayID$=this.facade.currentVisKeggPathwayID$,this.selectedDatasetGroupNamesWithStatus$=this.facade.datasetGroupsWithStatus$,this.highlightGenesInfo$=this.facade.highlightGenesInfo$,this.availableSpeciesForGeneList$=new R.X(null),this.latestAddedGenelistName$=this.facade.latestAddedGenelistName$,this.annotationTerms$=this.facade.annotationTerms$,this.allGeneListIDs$=this.facade.allGeneListIDs$,this.availableKeggGenelistIDs$=this.facade.availableGeneListsForHighlight$,this.addGeneListForHighlightStatus$=this.facade.addGeneListForHighlightNote$,this.selectedSpeciesInfoSubject=new R.X(null),this.inputKeggPathwaySubject=new R.X(null),this.disActiveAllGenelist=!1,this.disActiveAllDiffGroupPairs=!1,this.disSelectedGenesInExpressionPattern=!1,this.trySamplePercentage$=this.facade.trySamplePercentage$,this.ifShowTrySampleComponent=!0,this.facade.requestDiffGenesWithModifiedFilterCriteria({pValueType:"rawPvalue",pValue:.05,foldChangeType:"log2FoldChange",foldChange:1})}ngOnInit(){this.facade.retrieveAllKeggSpecies(),this.hierarClusteringResult$=this.facade.expressionPatternInfoInDataset$.pipe((0,x.h)(e=>null!=e),(0,T.U)(e=>({clusterResult:e.result,transform:e.transform,basicSetting:e.basicSetting}))),this.inputKeggPathwaySubject.pipe((0,x.h)(e=>null!=e),(0,at.M)(this.selectedSpeciesInfoSubject.pipe((0,x.h)(e=>null!=e))),(0,T.U)(([e,s])=>({pathwayID:e.ID,speciesID:s.taxID}))).subscribe(e=>{this.facade.requestKeggPathwayKgmlPNG(e)})}processSelectedSpecies(e){this.selectedSpeciesInfoSubject.next(e),this.facade.retrieveKeggPathwaysOfOneSpecies(e)}processInputKeggPathway(e){this.inputKeggPathwaySubject.next(e)}processSelectedPathway(e){this.facade.requestKeggPathwayKgmlPNG({pathwayID:e.ID,speciesID:e.speciesID}),this.availableSpeciesForGeneList$.next([{taxID:e.speciesID,name:e.speciesName}])}processKeggMapTransformingInfo(e){this.facade.modifyKeggMapTransformation(e)}processExpressionPatternInDataset(e){this.facade.requestExpressionPatternForDataset(e)}processExpressionPatternMapVisSettings(e){this.facade.updateVisSettingsOfPathwayGenesExpressionInDataset(e)}processSelectedDatasetIDforDiffGenes(e){this.facade.requestDiffGenesForSelectedDataset(e)}processSelectedDiffGroupPair(e){this.facade.requestDiffGenesForSelectedDiffGroupPair(e),this.disActiveAllDiffGroupPairs=!1,this.disSelectedGenesInExpressionPattern=!0,this.disActiveAllGenelist=!0}processGeneListIDforAdding(e){this.facade.addGeneListForHighlightingInPathwayMap(e)}processGeneListIDforRemove(e){this.facade.removeGeneListForHighlightingInPathwayMap(e)}processGeneListIDforHighlight(e){this.facade.requestGenesForSpecificGenesHighlight(e),this.disActiveAllGenelist=!1,this.disActiveAllDiffGroupPairs=!0,this.disSelectedGenesInExpressionPattern=!0}processSelectedNodesFromHierarchicalMap(e){this.facade.requestEntryIDsForGenesSelectedFromExpressionPattern(e.selectedNodes),this.disSelectedGenesInExpressionPattern=!1,this.disActiveAllDiffGroupPairs=!0,this.disActiveAllGenelist=!0}processInputGeneListSignal(e){this.inputGenelistModalRef=this.modalService.show(this.inputGeneListComponent),this.cdr.detectChanges()}processInputGeneList(e){this.facade.addGeneListToTheStore(e)}processAnnotationTermsRequest(e){this.facade.requestAnnotationTerms(e)}processAnnotationGenesRequest(e){this.facade.requestAnnotationGenes(e)}processTrySampleFileName(e){this.facade.prepareTrySampleData(e)}closeTrySampleComponent(e){this.ifShowTrySampleComponent=!1}processDownloadProjectSignal(e){this.facade.downloadProjectSignal()}processDownloadSampleData(e){this.facade.downloadSampleData(e)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(sn),i.Y36(Me.tT),i.Y36(i.sBO))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-kegg-exp"]],viewQuery:function(e,s){if(1&e&&i.Gf(ml,5,i.Rgc),2&e){let r;i.iGM(r=i.CRH())&&(s.inputGeneListComponent=r.first)}},decls:39,vars:44,consts:[[1,"row","flex-xl-nowrap"],[1,"col-12","col-md-3","col-xl-2","border","bd-sidebar"],[1,"row"],[1,"col-12","mt-4",3,"availableSpecies","formWidth","selectedSpecies$"],[1,"col-12","mt-3",3,"speciesKeggPathways","inputKeggPathway$"],[1,"col-12","col-md-9","col-xl-10","mt-2"],["class","row border",4,"ngIf"],[1,"col-12","p-1"],[3,"availableKeggPathways","inputCurrentPathwayID","selectedPathway$"],[1,"row","row-cols-3","mt-2"],[1,"col-12","col-md-7","border"],[1,"text-center",2,"margin-bottom","0"],[3,"keggKgmlEntryIDtoSymbolTransformStatus","highlightGenesInfo","mapTransformation$"],[1,"col-12","col-md-5","border"],[1,"text-center"],[3,"allDatasetInfoForDisplay","hierarClusteringResult","disSelectedGenes","datasetHierarRequest$","mapVisSettings$","selectedNodes$"],[1,"row",3,"allDatasetInfoForDisplay","datasetGroupsWithStatus","disActiveAllDiffGroupPairs","selectedDatasetID$","diffGroupPair$"],[1,"row",3,"allGeneListIDs","availableKeggGenelistIDs","addGeneListForHighlightStatus","disActiveAllGenelist","geneListIDforAdding$","geneListIDforRemove$","geneListIDforHighlight$","inputGeneListSignal$"],[1,"row","mt-4"],[3,"downloadProjectSignal$"],["inputGeneListComponent",""],[1,"row","border"],[3,"fileInfos","trySamplePercentage","sampleForTryName$","sampleForImportName$","closeMe$"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"availableSpecies","availableGeneIDtypes","latestAddedGeneListID","annotationTerms","outputGeneList$","annotationTermsRequest$","annotationGenesRequest$"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default","btn-sm",3,"click"]],template:function(e,s){1&e&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"app-select-species",3),i.NdJ("selectedSpecies$",function(o){return s.processSelectedSpecies(o)}),i.ALo(4,"async"),i.qZA(),i.TgZ(5,"app-input-pathway",4),i.NdJ("inputKeggPathway$",function(o){return s.processInputKeggPathway(o)}),i.ALo(6,"async"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",5),i.YNc(8,yl,4,4,"div",6),i.TgZ(9,"div",2),i.TgZ(10,"div",7),i.TgZ(11,"app-manage-kegg-pathways",8),i.NdJ("selectedPathway$",function(o){return s.processSelectedPathway(o)}),i.ALo(12,"async"),i.ALo(13,"async"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(14,"div",9),i.TgZ(15,"div",10),i.TgZ(16,"h5",11),i._uU(17," Pathway Map "),i.qZA(),i.TgZ(18,"app-manage-map-visualization",12),i.NdJ("mapTransformation$",function(o){return s.processKeggMapTransformingInfo(o)}),i.ALo(19,"async"),i.ALo(20,"async"),i.qZA(),i.qZA(),i.TgZ(21,"div",13),i.TgZ(22,"h5",14),i._uU(23," Expression of Pathway Genes "),i.qZA(),i.TgZ(24,"app-manage-genes-expression-in-dataset",15),i.NdJ("datasetHierarRequest$",function(o){return s.processExpressionPatternInDataset(o)})("mapVisSettings$",function(o){return s.processExpressionPatternMapVisSettings(o)})("selectedNodes$",function(o){return s.processSelectedNodesFromHierarchicalMap(o)}),i.ALo(25,"async"),i.ALo(26,"async"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(27,"app-manage-diff-genes-for-highlight",16),i.NdJ("selectedDatasetID$",function(o){return s.processSelectedDatasetIDforDiffGenes(o)})("diffGroupPair$",function(o){return s.processSelectedDiffGroupPair(o)}),i.ALo(28,"async"),i.ALo(29,"async"),i.qZA(),i.TgZ(30,"app-manage-gene-lists-for-kegg",17),i.NdJ("geneListIDforAdding$",function(o){return s.processGeneListIDforAdding(o)})("geneListIDforRemove$",function(o){return s.processGeneListIDforRemove(o)})("geneListIDforHighlight$",function(o){return s.processGeneListIDforHighlight(o)})("inputGeneListSignal$",function(o){return s.processInputGeneListSignal(o)}),i.ALo(31,"async"),i.ALo(32,"async"),i.ALo(33,"async"),i.qZA(),i.TgZ(34,"div",18),i.TgZ(35,"app-download-project",19),i.NdJ("downloadProjectSignal$",function(o){return s.processDownloadProjectSignal(o)}),i.qZA(),i.qZA(),i._UZ(36,"div"),i.YNc(37,wl,14,10,"ng-template",null,20,i.W1O),i.qZA(),i.qZA()),2&e&&(i.xp6(3),i.Q6J("availableSpecies",i.lcZ(4,18,s.availableKeggSpecies$))("formWidth","100%"),i.xp6(2),i.Q6J("speciesKeggPathways",i.lcZ(6,20,s.speciesKeggPathways$)),i.xp6(3),i.Q6J("ngIf",s.ifShowTrySampleComponent),i.xp6(3),i.Q6J("availableKeggPathways",i.lcZ(12,22,s.availableKeggPathways$))("inputCurrentPathwayID",i.lcZ(13,24,s.currentVisKeggPathwayID$)),i.xp6(7),i.Q6J("keggKgmlEntryIDtoSymbolTransformStatus",i.lcZ(19,26,s.keggKgmlEntryIDtoSymbolTransformStatus$))("highlightGenesInfo",i.lcZ(20,28,s.highlightGenesInfo$)),i.xp6(6),i.Q6J("allDatasetInfoForDisplay",i.lcZ(25,30,s.allDatasetInfoForDisplay$))("hierarClusteringResult",i.lcZ(26,32,s.hierarClusteringResult$))("disSelectedGenes",s.disSelectedGenesInExpressionPattern),i.xp6(3),i.Q6J("allDatasetInfoForDisplay",i.lcZ(28,34,s.allDatasetInfoForDisplay$))("datasetGroupsWithStatus",i.lcZ(29,36,s.selectedDatasetGroupNamesWithStatus$))("disActiveAllDiffGroupPairs",s.disActiveAllDiffGroupPairs),i.xp6(3),i.Q6J("allGeneListIDs",i.lcZ(31,38,s.allGeneListIDs$))("availableKeggGenelistIDs",i.lcZ(32,40,s.availableKeggGenelistIDs$))("addGeneListForHighlightStatus",i.lcZ(33,42,s.addGeneListForHighlightStatus$))("disActiveAllGenelist",s.disActiveAllGenelist))},directives:[Js.a,Qs,B.O5,si,sl,il.h,rl.d,gl,pl.E,fl.P,dl.D],pipes:[B.Ov],styles:[""],changeDetection:0}),t})(),data:{key:"KeggExp"}}];let Dl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[oe.Bz.forChild(Il)],oe.Bz]}),t})(),vl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[sn],imports:[[B.ez,oe.Bz,Fe.HK,Ce.uH,Gt.u5,Gt.UX,Me.zk.forRoot(),Le.H3.forRoot(),ns.m,es.f,ss.D,Dl]]}),t})()}}]);