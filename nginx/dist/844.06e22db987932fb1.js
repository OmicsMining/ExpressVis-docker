"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[844],{877:(V,$,p)=>{p.d($,{M:()=>a});var a=(()=>{return(d=a||(a={}))[d.local=0]="local",d[d.remote=1]="remote",a;var d})()},4844:(V,$,p)=>{p.r($),p.d($,{ImportDataModule:()=>js});var a=p(6019),d=p(4522),u=p(9133),O=p(9256),b=p(8638),v=p(3856),D=p(7695);function y(i,s,t,n){var l,o=arguments.length,r=o<3?s:null===n?n=Object.getOwnPropertyDescriptor(s,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(i,s,t,n);else for(var c=i.length-1;c>=0;c--)(l=i[c])&&(r=(o<3?l(r):o>3?l(s,t,r):l(s,t))||r);return o>3&&r&&Object.defineProperty(s,t,r),r}function h(i,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,s)}var e=p(3668);function rt(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(t._placeholder)}}function at(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",14),e._uU(1),e.TgZ(2,"a",15),e.NdJ("click",function(o){const l=e.CHM(t).$implicit;return e.oxw().onItemClick(o,l)}),e._uU(3,"x"),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit,n=s.index,o=e.oxw();e.Q6J("hidden",n>o._settings.itemsShowLimit-1),e.xp6(1),e.hij(" ",t.text," ")}}function lt(i,s){if(1&i&&(e.TgZ(0,"span",16),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("+",t.itemShowRemaining(),"")}}function pt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleSelectAll()}),e._UZ(1,"input",18),e.TgZ(2,"div"),e._uU(3),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("checked",t.isAllItemsSelected())("disabled",t.disabled||t.isLimitSelectionReached()),e.xp6(2),e.Oqu(t.isAllItemsSelected()?t._settings.unSelectAllText:t._settings.selectAllText)}}function ct(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",19),e.TgZ(1,"input",20),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().filter.text=o})("ngModelChange",function(o){return e.CHM(t),e.oxw().onFilterTextChange(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("readOnly",t.disabled)("placeholder",t._settings.searchPlaceholderText)("ngModel",t.filter.text)}}function ut(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",21),e.NdJ("click",function(o){const l=e.CHM(t).$implicit;return e.oxw().onItemClick(o,l)}),e._UZ(1,"input",22),e.TgZ(2,"div"),e._uU(3),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("checked",n.isSelected(t))("disabled",n.disabled||n.isLimitSelectionReached()&&!n.isSelected(t)||t.isDisabled),e.uIk("aria-label",t.text),e.xp6(2),e.Oqu(t.text)}}function mt(i,s){if(1&i&&(e.TgZ(0,"li",23),e.TgZ(1,"h5"),e._uU(2),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t._settings.noDataAvailablePlaceholderText)}}const dt=function(i){return{"dropdown-multiselect--active":i}};class k{constructor(s){("string"==typeof s||"number"==typeof s)&&(this.id=this.text=s,this.isDisabled=!1),"object"==typeof s&&(this.id=s.id,this.text=s.text,this.isDisabled=s.isDisabled)}}let pe=(()=>{let i=class{transform(t,n){return t&&n?t.filter(o=>this.applyFilter(o,n)):t}applyFilter(t,n){return"string"==typeof t.text&&"string"==typeof n.text?!(n.text&&t.text&&-1===t.text.toLowerCase().indexOf(n.text.toLowerCase())):!(n.text&&t.text&&-1===t.text.toString().toLowerCase().indexOf(n.text.toString().toLowerCase()))}};return i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=e.Yjl({name:"multiSelectFilter",type:i,pure:!1}),i})();const ht={provide:u.JU,useExisting:(0,e.Gpc)(()=>ge),multi:!0},Me=()=>{};let ge=(()=>{let i=class{constructor(t){this.listFilterPipe=t,this._data=[],this.selectedItems=[],this.isDropdownOpen=!0,this._placeholder="Select",this._sourceDataType=null,this._sourceDataFields=[],this.filter=new k(this.data),this.defaultSettings={singleSelection:!1,idField:"id",textField:"text",disabledField:"isDisabled",enableCheckAll:!0,selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!1,limitSelection:-1,clearSearchFilter:!0,maxHeight:197,itemsShowLimit:999999999999,searchPlaceholderText:"Search",noDataAvailablePlaceholderText:"No data available",closeDropDownOnSelection:!1,showSelectedItemsAtTop:!1,defaultOpen:!1,allowRemoteDataSearch:!1},this.disabled=!1,this.onFilterChange=new e.vpe,this.onDropDownClose=new e.vpe,this.onSelect=new e.vpe,this.onDeSelect=new e.vpe,this.onSelectAll=new e.vpe,this.onDeSelectAll=new e.vpe,this.onTouchedCallback=Me,this.onChangeCallback=Me}set placeholder(t){this._placeholder=t||"Select"}set settings(t){this._settings=t?Object.assign(this.defaultSettings,t):Object.assign(this.defaultSettings)}set data(t){if(t){const n=t[0];this._sourceDataType=typeof n,this._sourceDataFields=this.getFields(n),this._data=t.map(o=>new k("string"==typeof o||"number"==typeof o?o:{id:o[this._settings.idField],text:o[this._settings.textField],isDisabled:o[this._settings.disabledField]}))}else this._data=[]}onFilterTextChange(t){this.onFilterChange.emit(t)}onItemClick(t,n){if(this.disabled||n.isDisabled)return!1;const o=this.isSelected(n),r=-1===this._settings.limitSelection||this._settings.limitSelection>0&&this.selectedItems.length<this._settings.limitSelection;o?this.removeSelected(n):r&&this.addSelected(n),this._settings.singleSelection&&this._settings.closeDropDownOnSelection&&this.closeDropdown()}writeValue(t){if(null!=t&&t.length>0)if(this._settings.singleSelection)try{if(t.length>=1){const n=t[0];this.selectedItems=[new k("string"==typeof n||"number"==typeof n?n:{id:n[this._settings.idField],text:n[this._settings.textField],isDisabled:n[this._settings.disabledField]})]}}catch(n){}else{const n=t.map(o=>new k("string"==typeof o||"number"==typeof o?o:{id:o[this._settings.idField],text:o[this._settings.textField],isDisabled:o[this._settings.disabledField]}));this.selectedItems=this._settings.limitSelection>0?n.splice(0,this._settings.limitSelection):n}else this.selectedItems=[];this.onChangeCallback(t)}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}onTouched(){this.closeDropdown(),this.onTouchedCallback()}trackByFn(t,n){return n.id}isSelected(t){let n=!1;return this.selectedItems.forEach(o=>{t.id===o.id&&(n=!0)}),n}isLimitSelectionReached(){return this._settings.limitSelection===this.selectedItems.length}isAllItemsSelected(){let t=this.listFilterPipe.transform(this._data,this.filter);const n=t.filter(o=>o.isDisabled).length;return!((!this.data||0===this.data.length)&&this._settings.allowRemoteDataSearch)&&t.length===this.selectedItems.length+n}showButton(){return!(this._settings.singleSelection||this._settings.limitSelection>0)}itemShowRemaining(){return this.selectedItems.length-this._settings.itemsShowLimit}addSelected(t){this._settings.singleSelection?(this.selectedItems=[],this.selectedItems.push(t)):this.selectedItems.push(t),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onSelect.emit(this.emittedValue(t))}removeSelected(t){this.selectedItems.forEach(n=>{t.id===n.id&&this.selectedItems.splice(this.selectedItems.indexOf(n),1)}),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onDeSelect.emit(this.emittedValue(t))}emittedValue(t){const n=[];if(Array.isArray(t))t.map(o=>{n.push(this.objectify(o))});else if(t)return this.objectify(t);return n}objectify(t){if("object"===this._sourceDataType){const n={};return n[this._settings.idField]=t.id,n[this._settings.textField]=t.text,this._sourceDataFields.includes(this._settings.disabledField)&&(n[this._settings.disabledField]=t.isDisabled),n}return"number"===this._sourceDataType?Number(t.id):t.text}toggleDropdown(t){t.preventDefault(),(!this.disabled||!this._settings.singleSelection)&&(this._settings.defaultOpen=!this._settings.defaultOpen,this._settings.defaultOpen||this.onDropDownClose.emit())}closeDropdown(){this._settings.defaultOpen=!1,this._settings.clearSearchFilter&&(this.filter.text=""),this.onDropDownClose.emit()}toggleSelectAll(){if(this.disabled)return!1;this.isAllItemsSelected()?(this.selectedItems=[],this.onDeSelectAll.emit(this.emittedValue(this.selectedItems))):(this.selectedItems=this.listFilterPipe.transform(this._data,this.filter).filter(t=>!t.isDisabled).slice(),this.onSelectAll.emit(this.emittedValue(this.selectedItems))),this.onChangeCallback(this.emittedValue(this.selectedItems))}getFields(t){const n=[];if("object"!=typeof t)return n;for(const o in t)n.push(o);return n}};return i.\u0275fac=function(t){return new(t||i)(e.Y36(pe))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ng-multiselect-dropdown"]],hostBindings:function(t,n){1&t&&e.NdJ("blur",function(){return n.onTouched()})},inputs:{disabled:"disabled",placeholder:"placeholder",settings:"settings",data:"data"},outputs:{onFilterChange:"onFilterChange",onDropDownClose:"onDropDownClose",onSelect:"onSelect",onDeSelect:"onDeSelect",onSelectAll:"onSelectAll",onDeSelectAll:"onDeSelectAll"},features:[e._Bn([ht])],decls:16,vars:19,consts:[["tabindex","0",1,"multiselect-dropdown",3,"blur","clickOutside"],["tabindex","-1",1,"dropdown-btn",3,"click"],[4,"ngIf"],["class","selected-item",3,"hidden",4,"ngFor","ngForOf","ngForTrackBy"],[2,"float","right !important","padding-right","4px",3,"ngClass"],["style","padding-right: 6px;",4,"ngIf"],[1,"dropdown-multiselect__caret"],[1,"dropdown-list",3,"hidden"],[1,"item1"],["class","multiselect-item-checkbox","style","border-bottom: 1px solid #ccc;padding:10px",3,"click",4,"ngIf"],["class","filter-textbox",4,"ngIf"],[1,"item2"],["class","multiselect-item-checkbox",3,"click",4,"ngFor","ngForOf"],["class","no-data",4,"ngIf"],[1,"selected-item",3,"hidden"],[2,"padding-top","2px","padding-left","2px","color","white",3,"click"],[2,"padding-right","6px"],[1,"multiselect-item-checkbox",2,"border-bottom","1px solid #ccc","padding","10px",3,"click"],["type","checkbox","aria-label","multiselect-select-all",3,"checked","disabled"],[1,"filter-textbox"],["type","text","aria-label","multiselect-search",3,"readOnly","placeholder","ngModel","ngModelChange"],[1,"multiselect-item-checkbox",3,"click"],["type","checkbox",3,"checked","disabled"],[1,"no-data"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.NdJ("blur",function(){return n.onTouched()})("clickOutside",function(){return n.closeDropdown()}),e.TgZ(1,"div"),e.TgZ(2,"span",1),e.NdJ("click",function(r){return n.toggleDropdown(r)}),e.YNc(3,rt,2,1,"span",2),e.YNc(4,at,4,2,"span",3),e.TgZ(5,"span",4),e.YNc(6,lt,2,1,"span",5),e._UZ(7,"span",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",7),e.TgZ(9,"ul",8),e.YNc(10,pt,4,3,"li",9),e.YNc(11,ct,2,3,"li",10),e.qZA(),e.TgZ(12,"ul",11),e.YNc(13,ut,4,4,"li",12),e.ALo(14,"multiSelectFilter"),e.YNc(15,mt,3,1,"li",13),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.ekj("disabled",n.disabled),e.xp6(2),e.Q6J("ngIf",0==n.selectedItems.length),e.xp6(1),e.Q6J("ngForOf",n.selectedItems)("ngForTrackBy",n.trackByFn),e.xp6(1),e.Q6J("ngClass",e.VKq(17,dt,n._settings.defaultOpen)),e.xp6(1),e.Q6J("ngIf",n.itemShowRemaining()>0),e.xp6(2),e.Q6J("hidden",!n._settings.defaultOpen),e.xp6(2),e.Q6J("ngIf",(n._data.length>0||n._settings.allowRemoteDataSearch)&&!n._settings.singleSelection&&n._settings.enableCheckAll&&-1===n._settings.limitSelection),e.xp6(1),e.Q6J("ngIf",(n._data.length>0||n._settings.allowRemoteDataSearch)&&n._settings.allowSearchFilter),e.xp6(1),e.Udp("max-height",n._settings.maxHeight+"px"),e.xp6(1),e.Q6J("ngForOf",e.xi3(14,14,n._data,n.filter)),e.xp6(2),e.Q6J("ngIf",0==n._data.length&&!n._settings.allowRemoteDataSearch))},directives:function(){return[ft,a.O5,a.sg,a.mk,u.Fj,u.JJ,u.On]},pipes:function(){return[pe]},styles:['.multiselect-dropdown[_ngcontent-%COMP%]{position:relative;width:100%;font-size:inherit;font-family:inherit}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]{display:inline-block;border:1px solid #adadad;width:100%;padding:6px 12px;margin-bottom:0;font-weight:400;line-height:1.52857143;text-align:left;vertical-align:middle;cursor:pointer;background-image:none;border-radius:4px}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]{border:1px solid #337ab7;margin-right:4px;background:#337ab7;padding:0 5px;color:#fff;border-radius:2px;float:left}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]:hover{box-shadow:1px 1px #959595}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{line-height:16px;display:block;position:absolute;box-sizing:border-box;width:40px;height:38px;right:1px;top:0;padding:4px 8px;margin:0;text-decoration:none;text-align:center;cursor:pointer;transition:transform .2s}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]:before{position:relative;right:0;top:65%;color:#999;margin-top:4px;border-style:solid;border-width:8px 8px 0;border-color:#999 transparent;content:""}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect--active[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{transform:rotateZ(180deg)}.multiselect-dropdown[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{background-color:#eceeef}.dropdown-list[_ngcontent-%COMP%]{position:absolute;padding-top:6px;width:100%;z-index:9999;border:1px solid #ccc;border-radius:3px;background:#fff;margin-top:10px;box-shadow:0 1px 5px #959595}.dropdown-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none;overflow:auto;margin:0}.dropdown-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:6px 10px;cursor:pointer;text-align:left}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;position:relative;padding:10px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:0;width:100%;padding:0 0 0 26px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:0}.multiselect-item-checkbox[_ngcontent-%COMP%]:hover{background-color:#e4e3e3}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:focus + div[_ngcontent-%COMP%]:before, .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]:before{border-color:#337ab7;background-color:#f2f2f2}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active + div[_ngcontent-%COMP%]:before{transition-duration:0s}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{position:relative;padding-left:2em;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;margin:0;color:#000}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:before{box-sizing:content-box;content:"";color:#337ab7;position:absolute;top:50%;left:0;width:14px;height:14px;margin-top:-9px;border:2px solid #337ab7;text-align:center;transition:.4s}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:after{box-sizing:content-box;content:"";position:absolute;transform:scale(0);transform-origin:50%;transition:transform .2s ease-out;background-color:transparent;top:50%;left:4px;width:8px;height:3px;margin-top:-4px;border-style:solid;border-color:#fff;border-width:0 0 3px 3px;-o-border-image:none;border-image:none;transform:rotate(-45deg) scale(0)}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled + div[_ngcontent-%COMP%]:before{border-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:focus + div[_ngcontent-%COMP%]:before   .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:hover + div[_ngcontent-%COMP%]:before{background-color:inherit}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:checked + div[_ngcontent-%COMP%]:before{background-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:after{content:"";transition:transform .2s ease-out;transform:rotate(-45deg) scale(1)}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:before{-webkit-animation:.2s ease-in borderscale;animation:.2s ease-in borderscale;background:#337ab7}@-webkit-keyframes borderscale{50%{box-shadow:0 0 0 2px #337ab7}}@keyframes borderscale{50%{box-shadow:0 0 0 2px #337ab7}}'],changeDetection:0}),y([(0,e.IIB)(),h("design:type",String),h("design:paramtypes",[String])],i.prototype,"placeholder",null),y([(0,e.IIB)(),h("design:type",Object)],i.prototype,"disabled",void 0),y([(0,e.IIB)(),h("design:type",Object),h("design:paramtypes",[Object])],i.prototype,"settings",null),y([(0,e.IIB)(),h("design:type",Array),h("design:paramtypes",[Array])],i.prototype,"data",null),y([(0,e.r_U)("onFilterChange"),h("design:type",e.vpe)],i.prototype,"onFilterChange",void 0),y([(0,e.r_U)("onDropDownClose"),h("design:type",e.vpe)],i.prototype,"onDropDownClose",void 0),y([(0,e.r_U)("onSelect"),h("design:type",e.vpe)],i.prototype,"onSelect",void 0),y([(0,e.r_U)("onDeSelect"),h("design:type",e.vpe)],i.prototype,"onDeSelect",void 0),y([(0,e.r_U)("onSelectAll"),h("design:type",e.vpe)],i.prototype,"onSelectAll",void 0),y([(0,e.r_U)("onDeSelectAll"),h("design:type",e.vpe)],i.prototype,"onDeSelectAll",void 0),y([(0,e.L6J)("blur"),h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],i.prototype,"onTouched",null),i=y([h("design:paramtypes",[pe])],i),i})(),ft=(()=>{let i=class{constructor(t){this._elementRef=t,this.clickOutside=new e.vpe}onClick(t,n){n&&(this._elementRef.nativeElement.contains(n)||this.clickOutside.emit(t))}};return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275dir=e.lG2({type:i,selectors:[["","clickOutside",""]],hostBindings:function(t,n){1&t&&e.NdJ("click",function(r){return n.onClick(r,r.target)},!1,e.evT)},outputs:{clickOutside:"clickOutside"}}),y([(0,e.r_U)(),h("design:type",Object)],i.prototype,"clickOutside",void 0),y([(0,e.L6J)("document:click",["$event","$event.target"]),h("design:type",Function),h("design:paramtypes",[MouseEvent,HTMLElement]),h("design:returntype",void 0)],i.prototype,"onClick",null),i=y([h("design:paramtypes",[e.SBq])],i),i})();var Pe;let H=Pe=class{static forRoot(){return{ngModule:Pe}}};H.\u0275fac=function(s){return new(s||H)},H.\u0275mod=e.oAB({type:H}),H.\u0275inj=e.cJS({providers:[pe],imports:[[a.ez,u.u5]]});var gt=p(5658),_t=p(8702),yt=p(3928),qe=p(1144),W=p(8472),g=p(4099),_e=p(172),St=p(4102),m=p(8735),J=p(9204),ye=p(5389),Se=p(1366),j=p(5571),Z=p(8053),z=p(877),xe=p(1118),be=p(9744),Ee=p(8970),bt=p(1890),Ue=p(7548),Je=p(7473),Dt=p(2277),Tt=p(6149),vt=p(839),It=p(6531),Zt=p(661),Ct=p(5136),At=p(6723),wt=p(5814),Nt=p(1430),Ot=p(1672),A=p(9232),Ft=p(4205),Re=p(8260);let $t=(()=>{class i{constructor(t){this.http=t,this.datasetUrl=Re.N.serverUrl+"restful/dataset/",this.checkStatusUrl=this.datasetUrl+"checkIfExist",this.phenotypeDataUrl=this.datasetUrl+"requestPhenotypeData",this.datasetInfoUrl=this.datasetUrl+"requestDatasetInfo"}checkRemoteDatasetStatus(t,n){return this.http.get(`${this.checkStatusUrl}?database=${t}&datasetID=${n}`).pipe((0,Z.U)(o=>({ifDataExist:o.ifDataExist,ifProcessedDataExist:o.ifProcessedDataExist})))}loadRemoteDatasetInfo(t,n){return this.http.get(`${this.datasetInfoUrl}?database=${t}&datasetID=${n}`).pipe((0,Z.U)(o=>({expressLocalOrRemote:z.M.remote,database:t,datasetID:n,description:o.description,speciesID:o.speciesID,experimentType:o.experimentType,IDtype:o.IDtype,samples:o.samples})))}loadDatasetPhenotypeData(t,n){return this.http.get(`${this.phenotypeDataUrl}?database=${t}&datasetID=${n}`).pipe(o=>o)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(d.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Mt=p(540),Pt=p(2047);let qt=(()=>{class i{constructor(t){this.http=t,this.preprocessUrl=Re.N.serverUrl+"restful/proteomics/preprocessproteomics/"}handleResponse(t){return t.type===d.dt.Response?t.body:_e.E}preprocessProteomicsIntensities(t){const n=new d.aW("POST",this.preprocessUrl,t,{reportProgress:!1,responseType:"json"});return this.http.request(n).pipe((0,Z.U)(o=>this.handleResponse(o)),(0,m.h)(o=>o!==_e.E),(0,Z.U)(o=>o),(0,Pt.K)(o=>(0,Mt._)(o)))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(d.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),X=(()=>{class i{constructor(t,n,o,r){this.store=t,this.geneAnnotationRequestService=n,this.manageRemoteDatasetService=o,this.preprocessProteomicsService=r,this.downloadGEOmatrixDataProgress$=new g.X(null),this.ifDownloadingGEOmatrixData$=new g.X(!1),this.downloadGEOgplDataProgress$=new g.X(null),this.ifDownloadingGEOgplData$=new g.X(!1),this.selectedSpeciesIDforMicroarraySubject=new g.X(null),this.addProteomicsSubject=new g.X(null),this.loadRemoteDatasetInfo$=new g.X(null),this.remoteDatasetStatus$=new g.X(null),this.requestDatabaseGeneID2info$=new g.X(null),this.currentDatasetPCAinfo$=new g.X(null),this.currentDatasetSamplesCorInfo$=new g.X(null),this.currentDatasetID$=new g.X(null),this.currentExpressDataPhenotypeDataSubject=new g.X(null),this.requestExpressDataPhenotypeData$=new g.X(null),this.currentGroups$=new g.X(null),this.updateDatasetGroups$=new g.X(null),this.allDatasetInfoForDisplay$=this.store.pipe((0,W.Ys)(Je.yz),(0,St.d)(2)),this.currentDatasetInfo$=this.currentDatasetID$.pipe((0,m.h)(l=>null!=l),(0,J.w)(l=>this.store.pipe((0,W.Ys)(Je.iR,{datasetID:l})))),this.currentExpressDataPhenotypeData$=this.currentExpressDataPhenotypeDataSubject.asObservable(),this.theLatestAddedDatasetID$=this.store.pipe((0,W.Ys)(Ue.mV)),this.availableMicrorrayIDtypes$=this.selectedSpeciesIDforMicroarraySubject.pipe((0,m.h)(l=>null!=l),(0,J.w)(l=>this.geneAnnotationRequestService.requestArrayIDtypesInOneSpecies(l))),this.loadRemoteDatasetInfo$.pipe((0,m.h)(l=>null!=l),(0,ye.x)(),(0,J.w)(l=>this.manageRemoteDatasetService.checkRemoteDatasetStatus(l.database,l.datasetID).pipe((0,Se.b)(c=>{this.remoteDatasetStatus$.next(c)}),(0,J.w)(c=>c.ifDataExist&&c.ifProcessedDataExist?this.manageRemoteDatasetService.loadRemoteDatasetInfo(l.database,l.datasetID):_e.E),(0,Se.b)(()=>{this.requestExpressDataPhenotypeData$.next({expressLocalOrRemote:z.M.remote,database:l.database,datasetID:l.datasetID}),this.currentDatasetID$.next(l.datasetID)})))).subscribe(l=>{this.addDatasetInfo(l)}),this.requestDatabaseGeneID2info$.pipe((0,m.h)(l=>null!=l),(0,J.w)(l=>this.store.pipe((0,W.Ys)(bt.tw,{ID:`${l.speciesID}-${l.idType}`}))),(0,m.h)(l=>!l),(0,j.M)(this.requestDatabaseGeneID2info$),(0,J.w)(([l,c])=>this.geneAnnotationRequestService.requestGenesAnnoFromServer(c.speciesID,c.idType))).subscribe(l=>{this.store.dispatch(Ee.n({geneID2info:l}))}),this.requestExpressDataPhenotypeData$.pipe((0,m.h)(l=>null!=l),(0,J.w)(l=>l.expressLocalOrRemote===z.M.remote?this.manageRemoteDatasetService.loadDatasetPhenotypeData(l.database,l.datasetID):this.store.pipe((0,W.Ys)(Ue.nL,{datasetID:l.datasetID})))).subscribe(l=>{this.currentExpressDataPhenotypeDataSubject.next(l)}),this.updateDatasetGroups$.pipe((0,m.h)(l=>null!=l),(0,j.M)(this.currentDatasetID$.pipe((0,m.h)(l=>null!=l)))).subscribe(([l,c])=>{this.store.dispatch(be.Tl({datasetID:c,groups:l}))}),this.addProteomicsSubject.pipe((0,m.h)(l=>null!=l),function(i,s){return(0,ye.x)((t,n)=>t[i]===n[i])}("datasetID"),(0,J.w)(l=>this.preprocessProteomicsService.preprocessProteomicsIntensities({proteinIDs:l.proteinIDs,samples2intensities:l.samples2intensities,groups:l.groups,preprocessSettings:l.preprocessSettings}).pipe((0,Z.U)(c=>{const f=c.proteinIDs,C=(0,A.Ci)(c.normalizedValues,l.samples);return{datasetID:l.datasetID,geneIDs:f,samples:l.samples,phenotypeData:l.phenotypeData,expressionValues:C,defaultGroups:l.groups}})))).subscribe(l=>{this.store.dispatch(xe.LP({expressDataInfo:l}))})}requestMicroarrayIDtypesInTheSpecies(t){this.selectedSpeciesIDforMicroarraySubject.next(t)}addLocalExpressData(t){this.store.dispatch(xe.LP({expressDataInfo:t})),this.currentExpressDataPhenotypeDataSubject.next(t.phenotypeData),this.currentDatasetID$.next(t.datasetID)}addProteomicsExpressData(t){this.addProteomicsSubject.next(t)}addDatasetInfo(t){this.store.dispatch(be.LH({dataset:t}))}requestDatabaseGeneID2info(t){this.requestDatabaseGeneID2info$.next(t)}updateDatasetGroups(t){this.updateDatasetGroups$.next(t)}requestDatasetInfoForReview(t){this.currentDatasetID$.next(t)}requestRemoteDatasetInfo(t){this.loadRemoteDatasetInfo$.next(t)}prepareLocalProject(t){this.store.dispatch(xe.gw({newState:t.localExpressDataState})),this.store.dispatch(be.CF({newState:t.datasetListState})),this.store.dispatch(wt.yx({newState:t.keggPathwayState})),this.store.dispatch(Ee.A({newState:t.geneAnnotationsState})),this.store.dispatch(It.dy({newState:t.geneIDmappingState})),this.store.dispatch(Zt.c({newState:t.geneListState})),this.store.dispatch(Ct.V({newState:t.geneListEnrichedAnnotationsState})),this.store.dispatch(Tt.Uw({newState:t.diffAnalysisResultState})),this.store.dispatch(vt.lO({newState:t.diffExpState})),this.store.dispatch(Dt.N8({newState:t.clusterExpState})),this.store.dispatch(At.Y6({newState:t.keggExpState})),this.store.dispatch(Nt.iS({newState:t.PPIexpState})),this.store.dispatch(Ot.R({newState:t.survivalExpState}))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(W.yh),e.LFG(Ft.b),e.LFG($t),e.LFG(qt))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var B=p(5043);function Et(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1,"No dataset. Please import one first"),e.qZA())}function Ut(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ul",3),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().outputSelectedDatasetIDForView(r.datasetID)}),e.TgZ(1,"a",4),e._uU(2),e.qZA(),e.TgZ(3,"div",5),e.TgZ(4,"fa-icon",6),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().outputSelectDatasetIDforDelete(r.datasetID)}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.datasetID),e.xp6(2),e.Q6J("icon",n.faMinus)("size","1x")}}let Jt=(()=>{class i{constructor(){this.selectedDatasetIDforView$=new e.vpe,this.selectedDatasetIDforDelete$=new e.vpe,this.faMinus=B.Kl4}ngOnInit(){}outputSelectedDatasetIDForView(t){this.selectedDatasetIDforView$.next(t)}outputSelectDatasetIDforDelete(t){this.selectedDatasetIDforDelete$.next(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-present-datasets"]],inputs:{datasets:"datasets"},outputs:{selectedDatasetIDforView$:"selectedDatasetIDforView$",selectedDatasetIDforDelete$:"selectedDatasetIDforDelete$"},decls:4,vars:2,consts:[[1,"mt-3"],[4,"ngIf"],["class","d-flex",3,"click",4,"ngFor","ngForOf"],[1,"d-flex",3,"click"],["href","javascript:void(0)"],[1,"form-inline","ml-1"],["ngbTooltip","Delete this dataset",1,"hoverBigger",3,"icon","size","click"]],template:function(t,n){1&t&&(e.TgZ(0,"h5",0),e._uU(1,"Available Datasets"),e.qZA(),e.YNc(2,Et,2,0,"p",1),e.YNc(3,Ut,5,3,"ul",2)),2&t&&(e.xp6(2),e.Q6J("ngIf",!n.datasets||0===(null==n.datasets?null:n.datasets.length)),e.xp6(1),e.Q6J("ngForOf",n.datasets))},directives:[a.O5,a.sg,v.BN,b._L],styles:[""],changeDetection:0}),i})();var P=p(3405),q=p(2668),G=p(6087),Q=p(1125),x=p(8805),Qe=p(4168),Rt=p(8178);const Ge={leading:!0,trailing:!1};function De(i,s=Rt.P,t=Ge){return n=>n.lift(new Lt(i,s,t.leading,t.trailing))}class Lt{constructor(s,t,n,o){this.duration=s,this.scheduler=t,this.leading=n,this.trailing=o}call(s,t){return t.subscribe(new jt(s,this.duration,this.scheduler,this.leading,this.trailing))}}class jt extends Qe.L{constructor(s,t,n,o,r){super(s),this.duration=t,this.scheduler=n,this.leading=o,this.trailing=r,this._hasTrailingValue=!1,this._trailingValue=null}_next(s){this.throttled?this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Vt,this.duration,{subscriber:this})),this.leading?this.destination.next(s):this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0))}_complete(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}clearThrottle(){const s=this.throttled;s&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),s.unsubscribe(),this.remove(s),this.throttled=null)}}function Vt(i){const{subscriber:s}=i;s.clearThrottle()}const Le=function(i,s){const t=[...s.samples],n=(0,A.Wv)(i,t);let o={};for(const[r,l]of Object.entries(s)){const c=n.map(_=>l[_]);o[r]=c}return o},je=i=>{let t=!1;return i.value.forEach(n=>{(0===n.samples.length||""===n.name)&&(t=!0)}),t?{hasEmptySamples:!0}:null},Ve=i=>{const n=i.value.map(r=>r.samples).reduce((r,l)=>r.concat(l));return(0,A.ro)(n)?{groupsOverlapSamples:!0}:null},ke=i=>{const t=i.value.map(o=>o.name);return(0,A.ro)(t)?{groupNamesDuplicate:!0}:null};var K=p(9220),Yt=p(4473);function Ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ol"),e.TgZ(1,"a",1),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().downloadSampleData(r.name)}),e._uU(2),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t.description)}}let Te=(()=>{class i{constructor(t){this.downloadService=t}ngOnInit(){}downloadSampleData(t){this.downloadService.downloadSampleData(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Yt.h))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-download-sample-data"]],inputs:{fileInfos:"fileInfos"},decls:3,vars:1,consts:[[4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"p"),e._uU(1,"If you are the first time using ExpressVis, you can download sample data and follow the steps in readme.txt to import it, or click try sample button in each app (DiffExp, ClusterExp, KEGGexp, PPIexp, SurvivalExp) to experience the app without importing data"),e.qZA(),e.YNc(2,Ht,3,1,"ol",0)),2&t&&(e.xp6(2),e.Q6J("ngForOf",n.fileInfos))},directives:[a.sg],styles:[""],changeDetection:0}),i})(),ve=(()=>{class i{constructor(t){this.ele=t}set appAddRequiredOptionalSign(t){"required"===t?this.ele.nativeElement.insertAdjacentHTML("beforeend","<span style = 'color: red'>*</span>"):"optional"===t&&(this.ele.nativeElement.textContent=this.ele.nativeElement.textContent+" (optional)")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275dir=e.lG2({type:i,selectors:[["","appAddRequiredOptionalSign",""]],inputs:{appAddRequiredOptionalSign:"appAddRequiredOptionalSign"}}),i})();var Ie=p(4863),R=p(3314),te=p(3139);let Be=(()=>{class i extends te.S{constructor(){super(),this.IDcolumnSubject=new g.X(null),this.samplesSubject=new g.X(null),this.IDcolumn$=this.IDcolumnSubject.asObservable(),this.samples$=this.samplesSubject.asObservable()}obtainValuesInfo(t,n){return((i,s,t)=>{let n=[],o=[];const r=i[0];let l=[];r.forEach((_,f)=>{t.indexOf(_)>=0&&l.push(f)});const c=r.indexOf(s);return i.slice(1).forEach(_=>{let f=[];l.forEach(C=>{f.push(parseFloat(_[C]))}),o.push(f),n.push(_[c])}),{IDs:n,samples:t,values:o}})(this.textMatrix,t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();const zt=["selectButton"];function Xt(i,s){if(1&i&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.description)}}function Kt(i,s){if(1&i&&(e.TgZ(0,"th"),e.TgZ(1,"p",11),e._uU(2),e.qZA(),e.qZA()),2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t," ")}}function ei(i,s){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ti(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ei,2,1,"td",8),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function ii(i,s){if(1&i&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ni(i,s){if(1&i&&(e.TgZ(0,"div"),e.TgZ(1,"p"),e._uU(2,"The values columns are: "),e.qZA(),e.TgZ(3,"div",12),e.YNc(4,ii,2,1,"p",13),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"async"),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",e.lcZ(5,2,t.samples$)),e.xp6(3),e.hij("The ID column is: ",e.lcZ(8,4,t.IDcolumn$),"")}}const si={defaultFile:"Expression Values File","RNA-seq-counts":"Counts File","RNA-seq-TPM":"TPM/FPKM/RPKM File"};let oi=(()=>{class i{constructor(t){this.importExpressionService=t,this.dataType="defaultFile",this.formWidth="15rem",this.expressionImported$=new e.vpe(null),this.fileHeaders$=new R.y(null),this.firstLines$=new R.y(null),this.samples$=new R.y(null),this.IDcolumn$=new R.y(null),this.selectedIDtype$=new g.X(null),this.destroyNotifier$=new P.xQ}ngOnInit(){this.firstLines$=this.importExpressionService.firstLines$.pipe((0,x.R)(this.destroyNotifier$)),this.fileHeaders$=this.importExpressionService.fileHeaders$.pipe((0,x.R)(this.destroyNotifier$)),this.IDcolumn$=this.fileHeaders$.pipe((0,m.h)(t=>null!=t),(0,Z.U)(t=>t[0])),this.samples$=this.fileHeaders$.pipe((0,m.h)(t=>null!=t),(0,Z.U)(t=>t.slice(1))),this.fileType=this._obtainFileType()}ngAfterViewInit(){(0,q.aj)([this.samples$.pipe((0,m.h)(t=>null!=t)),this.selectedIDtype$.pipe((0,m.h)(t=>null!==t)),this.IDcolumn$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n,o])=>this.importExpressionService.obtainValuesInfo(o,t)),(0,j.M)(this.selectedIDtype$),(0,Z.U)(([t,n])=>Object.assign(Object.assign({},t),{IDtype:n,logTransformedMethod:"No Log Transformed"}))).subscribe(t=>{this.expressionImported$.next(t)})}ngOnChanges(t){t.dataType&&!t.dataType.isFirstChange()&&(this.fileType=this._obtainFileType())}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedFile(t){this.importExpressionService.initLoadedFile(t)}outputIDtype(t){this.selectedIDtype$.next(t.target.value)}_obtainFileType(){if(this.dataType)return si[this.dataType]}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Be))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-expression-values"]],viewQuery:function(t,n){if(1&t&&e.Gf(zt,5),2&t){let o;e.iGM(o=e.CRH())&&(n.selectButton=o.first)}},inputs:{dataType:"dataType",availableIDtypes:"availableIDtypes",formWidth:"formWidth"},outputs:{expressionImported$:"expressionImported$"},features:[e._Bn([Be]),e.TTD],decls:22,vars:15,consts:[["for","IDtype"],["name","IDtype",1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],["role","form"],["data-testid","fileType"],["type","file",1,"form-control","form-control-sm",3,"change"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-bordered","mt-2",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[1,"font-weight-bold"],[1,"d-flex","justify-content-start","flex-wrap"],["class","ml-2",4,"ngFor","ngForOf"],[1,"ml-2"]],template:function(t,n){1&t&&(e.TgZ(0,"h5",0),e._uU(1,"Gene ID type in File:"),e.qZA(),e.TgZ(2,"select",1),e.NdJ("change",function(r){return n.outputIDtype(r)}),e.TgZ(3,"option"),e._uU(4,"---"),e.qZA(),e.YNc(5,Xt,2,2,"option",2),e.qZA(),e.TgZ(6,"form",3),e.TgZ(7,"div"),e.TgZ(8,"h5",4),e._uU(9),e.qZA(),e.TgZ(10,"input",5),e.NdJ("change",function(r){return n.processSelectedFile(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",6),e.TgZ(12,"table",7),e.TgZ(13,"thead"),e.TgZ(14,"tr"),e.YNc(15,Kt,3,1,"th",8),e.ALo(16,"async"),e.qZA(),e.qZA(),e.TgZ(17,"tbody"),e.YNc(18,ti,2,1,"tr",8),e.ALo(19,"async"),e.qZA(),e.qZA(),e.qZA(),e.YNc(20,ni,9,6,"div",9),e.ALo(21,"async")),2&t&&(e.xp6(2),e.Udp("width",n.formWidth),e.xp6(3),e.Q6J("ngForOf",n.availableIDtypes),e.xp6(4),e.hij("",n.fileType,":"),e.xp6(1),e.Udp("width",n.formWidth),e.xp6(5),e.Q6J("ngForOf",e.lcZ(16,9,n.fileHeaders$)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(19,11,n.firstLines$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(21,13,n.samples$)))},directives:[u.YN,u.Kr,a.sg,u._Y,u.JL,u.F,a.O5],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();var Y=p(8526);let Ye=(()=>{class i extends te.S{constructor(){super(),this.phenotypeDataSubject=new g.X(null),this.phenotypeData$=this.phenotypeDataSubject.asObservable()}obtainPhenotypeObject(){return(i=>{let s={},t={};const n=[...i][0].slice(1);n.forEach((r,l)=>{s[l]=[]});let o=[];return[...i].slice(1).forEach(r=>{o.push(r[0]),r.slice(1).forEach((l,c)=>{s[c].push(l)})}),t.samples=o,n.forEach((r,l)=>{t[r]=[...s[l]]}),t})(this.textMatrix)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var Ze=p(6872);const ai=["fileForm"],li=["presentFirstLinesComponent"];function pi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"a",6),e.NdJ("click",function(o){return e.CHM(t),e.oxw().presentFirstLinesOfTheFile(o)}),e._uU(1," View first lines of the file\n"),e.qZA()}}function ci(i,s){if(1&i&&(e.TgZ(0,"th"),e.TgZ(1,"p",17),e._uU(2),e.qZA(),e.qZA()),2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t," ")}}function ui(i,s){if(1&i&&(e.TgZ(0,"td",19),e._uU(1),e.ALo(2,"trimString"),e.qZA()),2&i){const t=s.$implicit;e.s9C("title",t),e.xp6(1),e.hij(" ",e.xi3(2,2,t,20)," ")}}function mi(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ui,3,5,"td",18),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function di(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"h3"),e._uU(2,"The first five lines of the file"),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return null==o.presentFirstLinesModalRef?null:o.presentFirstLinesModalRef.hide()}),e.TgZ(4,"span",9),e._uU(5,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",10),e.TgZ(7,"div",11),e.TgZ(8,"table",12),e.TgZ(9,"thead"),e.TgZ(10,"tr"),e.YNc(11,ci,3,1,"th",13),e.qZA(),e.qZA(),e.TgZ(12,"tbody",14),e.YNc(13,mi,2,1,"tr",13),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",15),e.TgZ(15,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().presentFirstLinesModalRef.hide()}),e._uU(16," close "),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.phenotypeShowInfo.fileHeaders),e.xp6(2),e.Q6J("ngForOf",t.phenotypeShowInfo.firstLines)}}let Ce=(()=>{class i{constructor(t,n,o){this.phenoDataService=t,this.modalService=n,this.cdr=o,this.resetToDefault=!1,this.formWidth="15rem",this.phenotypeData$=new e.vpe,this.fileHeaders$=new R.y(null),this.fileHeadersFromReset$=new g.X(null),this.firstLines$=new R.y(null),this.firstLinesFromReset$=new g.X(null),this.destroyNotifier$=new P.xQ}ngOnInit(){this.firstLines$=(0,Y.T)(this.firstLinesFromReset$,this.phenoDataService.firstLines$).pipe((0,x.R)(this.destroyNotifier$)),this.fileHeaders$=(0,Y.T)(this.fileHeadersFromReset$,this.phenoDataService.fileHeaders$).pipe((0,x.R)(this.destroyNotifier$)),(0,q.aj)([this.firstLines$,this.fileHeaders$]).subscribe(([t,n])=>{t&&n&&(this.phenotypeShowInfo=Object.assign(Object.assign({},this.phenotypeShowInfo),{firstLines:t,fileHeaders:n}),this.cdr.detectChanges())}),this.fileHeaders$.pipe((0,m.h)(t=>null!=t),(0,Z.U)(t=>this.phenoDataService.obtainPhenotypeObject())).subscribe(t=>{console.log("phenotypeObject",t),this.phenotypeData$.next(t),this.phenotypeData=t,this.cdr.detectChanges()})}ngOnChanges(t){t.resetToDefault&&!t.resetToDefault.isFirstChange()&&this.resetToDefault&&this._resetThisComponent()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processPhenotypeFile(t){this.phenoDataService.initLoadedFile(t)}presentFirstLinesOfTheFile(t){this.presentFirstLinesModalRef=this.modalService.show(this.presentFirstLinesComponent,Object.assign({},{class:"modal-xl"})),this.cdr.detectChanges()}_resetThisComponent(){this._resetSelectedFile(),this.fileHeadersFromReset$.next(null),this.firstLinesFromReset$.next(null),this.phenotypeData$.next(null)}_resetSelectedFile(){this.fileForm.nativeElement.reset()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Ye),e.Y36(O.tT),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-phenotype-data"]],viewQuery:function(t,n){if(1&t&&(e.Gf(ai,7),e.Gf(li,5,e.Rgc)),2&t){let o;e.iGM(o=e.CRH())&&(n.fileForm=o.first),e.iGM(o=e.CRH())&&(n.presentFirstLinesComponent=o.first)}},inputs:{resetToDefault:"resetToDefault",formWidth:"formWidth"},outputs:{phenotypeData$:"phenotypeData$"},features:[e._Bn([Ye]),e.TTD],decls:10,vars:3,consts:[["role","form"],["fileForm",""],[1,"form-group"],["type","file",1,"form","ml-2",3,"change"],["href","javascript:void(0)","class","inline",3,"click",4,"ngIf"],["presentFirstLinesComponent",""],["href","javascript:void(0)",1,"inline",3,"click"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-striped","mt-2"],[4,"ngFor","ngForOf"],[1,"border-bottom"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default","btn-sm",3,"click"],[1,"font-weight-bold"],[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0,1),e.TgZ(2,"div",2),e.TgZ(3,"h5"),e._uU(4,"Phenotype File: "),e.qZA(),e.TgZ(5,"input",3),e.NdJ("change",function(r){return n.processPhenotypeFile(r)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(6,pi,2,0,"a",4),e.ALo(7,"async"),e.YNc(8,di,17,2,"ng-template",null,5,e.W1O)),2&t&&(e.xp6(6),e.Q6J("ngIf",e.lcZ(7,1,n.firstLines$)))},directives:[u._Y,u.JL,u.F,a.O5,a.sg],pipes:[a.Ov,Ze.K],styles:[""],changeDetection:0}),i})();function hi(i,s){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.hij("",t," ")}}function fi(i,s){if(1&i&&(e.TgZ(0,"td",5),e._uU(1),e.ALo(2,"trimString"),e.qZA()),2&i){const t=s.$implicit,n=e.oxw().$implicit;e.s9C("title",n[t]),e.xp6(1),e.hij("",e.xi3(2,2,n[t],20)," ")}}function gi(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,fi,3,5,"td",4),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allAttributes)}}function _i(i,s){if(1&i&&(e.TgZ(0,"table",2),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e.YNc(3,hi,2,1,"th",3),e.qZA(),e.qZA(),e.TgZ(4,"tbody"),e.YNc(5,gi,2,1,"tr",3),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.allAttributes),e.xp6(2),e.Q6J("ngForOf",t.phenotypeDataArray)}}let yi=(()=>{class i{constructor(){this.allAttributes=[],this.phenotypeDataArray=[]}ngOnInit(){this.phenotypeData&&this._processPhenotypeData()}ngOnChanges(t){t.phenotypeData&&!t.phenotypeData.isFirstChange()&&this._processPhenotypeData()}_processPhenotypeData(){this.allAttributes=Object.keys(this.phenotypeData),this.phenotypeDataArray=(0,A.gG)(this.phenotypeData)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-present-phenotype-data"]],inputs:{phenotypeData:"phenotypeData"},features:[e.TTD],decls:2,vars:1,consts:[[1,"table-responsive","border"],["class","table table-striped",4,"ngIf"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,_i,6,2,"table",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.phenotypeDataArray.length>=1))},directives:[a.O5,a.sg],pipes:[Ze.K],styles:["table[_ngcontent-%COMP%]{max-height:80vh}tbody[_ngcontent-%COMP%]{text-align:start;overflow-y:scroll;overflow-x:hidden}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left;height:2em;white-space:nowrap}th[sortable][_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0}),i})();var Si=p(471);let ie=(()=>{class i{constructor(t){this.tpl=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.Rgc))},i.\u0275dir=e.lG2({type:i,selectors:[["","appEditableView",""]]}),i})(),ne=(()=>{class i{constructor(t){this.tpl=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.Rgc))},i.\u0275dir=e.lG2({type:i,selectors:[["","appEditableEdit",""]]}),i})();var xi=p(5433),bi=p(5894),ce=p(4352),Ae=p(8345);class Ti{constructor(s){this.resultSelector=s}call(s,t){return t.subscribe(new vi(s,this.resultSelector))}}class vi extends Qe.L{constructor(s,t,n=Object.create(null)){super(s),this.resultSelector=t,this.iterators=[],this.active=0,this.resultSelector="function"==typeof t?t:void 0}_next(s){const t=this.iterators;(0,bi.k)(s)?t.push(new Zi(s)):t.push("function"==typeof s[ce.hZ]?new Ii(s[ce.hZ]()):new Ci(this.destination,this,s))}_complete(){const s=this.iterators,t=s.length;if(this.unsubscribe(),0!==t){this.active=t;for(let n=0;n<t;n++){let o=s[n];o.stillUnsubscribed?this.destination.add(o.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const s=this.iterators,t=s.length,n=this.destination;for(let l=0;l<t;l++){let c=s[l];if("function"==typeof c.hasValue&&!c.hasValue())return}let o=!1;const r=[];for(let l=0;l<t;l++){let c=s[l],_=c.next();if(c.hasCompleted()&&(o=!0),_.done)return void n.complete();r.push(_.value)}this.resultSelector?this._tryresultSelector(r):n.next(r),o&&n.complete()}_tryresultSelector(s){let t;try{t=this.resultSelector.apply(this,s)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}class Ii{constructor(s){this.iterator=s,this.nextResult=s.next()}hasValue(){return!0}next(){const s=this.nextResult;return this.nextResult=this.iterator.next(),s}hasCompleted(){const s=this.nextResult;return Boolean(s&&s.done)}}class Zi{constructor(s){this.array=s,this.index=0,this.length=0,this.length=s.length}[ce.hZ](){return this}next(s){const t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class Ci extends Ae.Ds{constructor(s,t,n){super(s),this.parent=t,this.observable=n,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[ce.hZ](){return this}next(){const s=this.buffer;return 0===s.length&&this.isComplete?{value:null,done:!0}:{value:s.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(s){this.buffer.push(s),this.parent.checkIterators()}subscribe(){return(0,Ae.ft)(this.observable,new Ae.IY(this))}}var He=p(6636);function We(i,s){return s?(0,J.w)(()=>i,s):(0,J.w)(()=>i)}function Ai(i,s){1&i&&e.GkF(0)}let se=(()=>{class i{constructor(t,n,o){this.host=t,this.cdr=n,this.update=new e.vpe,this.editMode=new P.xQ,this.editMode$=this.editMode.asObservable(),this.destroyNotifier$=new P.xQ,this.mode=o}ngOnInit(){this.viewModeHander(),this.editModeHandler(),"edit"===this.mode&&this.editMode.next(!0)}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}toViewMode(){this.update.next(),this.mode="view"}get currentView(){return"view"===this.mode?this.viewModeTpl.tpl:this.editModeTpl.tpl}get element(){return this.host.nativeElement}viewModeHander(){(0,G.R)(this.element,"dblclick").pipe((0,x.R)(this.destroyNotifier$)).subscribe(()=>{this.mode="edit",this.editMode.next(!0),this.cdr.detectChanges()})}editModeHandler(){const o=function(...i){const s=i[i.length-1];return"function"==typeof s&&i.pop(),(0,xi.n)(i,void 0).lift(new Ti(s))}((0,G.R)(document,"mousedown").pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(()=>this.element.querySelector("input")),(0,m.h)(()=>this.element.querySelector("input").value)),(0,G.R)(document,"mouseup").pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(()=>this.element.querySelector("input")),(0,m.h)(()=>this.element.querySelector("input").value))).pipe((0,Z.U)(([r,l])=>!1===this.element.contains(r.target)&&!1===this.element.contains(l.target)),(0,m.h)(r=>r),(0,He.q)(1));if("edit"===this.mode){const r=(0,G.R)(this.element,"input").pipe((0,Z.U)(l=>l.target.value),(0,m.h)(l=>""!==l),(0,He.q)(1));(0,q.aj)([this.editMode$,r]).pipe(We(o),(0,x.R)(this.destroyNotifier$)).subscribe(l=>{this.element.querySelector("input").value&&(this.update.next(),this.mode="view")})}else this.editMode$.pipe(We(o),(0,x.R)(this.destroyNotifier$)).subscribe(r=>{this.element.querySelector("input").value&&(this.update.next(),this.mode="view",this.cdr.detectChanges())})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(e.sBO),e.$8M("initialMode"))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-editable"]],contentQueries:function(t,n,o){if(1&t&&(e.Suo(o,ie,5),e.Suo(o,ne,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.viewModeTpl=r.first),e.iGM(r=e.CRH())&&(n.editModeTpl=r.first)}},outputs:{update:"update"},decls:1,vars:1,consts:[[4,"ngTemplateOutlet"]],template:function(t,n){1&t&&e.YNc(0,Ai,1,0,"ng-container",0),2&t&&e.Q6J("ngTemplateOutlet",n.currentView)},directives:[a.tP],encapsulation:2}),i})();var wi=p(4250);function Ni(i,s){if(1&i&&(e.TgZ(0,"p",3),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Oqu(t)}}function Oi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p",4),e.NdJ("click",function(o){return e.CHM(t),e.oxw().displayAllItems(o)}),e.TgZ(1,"a",5),e._uU(2,"more"),e.qZA(),e.qZA()}}function Fi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p",4),e.NdJ("click",function(o){return e.CHM(t),e.oxw().displayLimitedItems(o)}),e.TgZ(1,"a",6),e._uU(2,"less"),e.qZA(),e.qZA()}}let ue=(()=>{class i{constructor(){this.ifDisplayAll=!1}ngOnInit(){this.items&&this._preprocessItems()}ngOnChanges(t){t.items&&!t.items.isFirstChange()&&this._preprocessItems()}_preprocessItems(){this.ifDisplayAll=!1,this.displayedItems=this.items.slice(0,this.displayNum).map(t=>t),this.items.length<=this.displayNum&&(this.ifDisplayAll=!0)}displayAllItems(t){this.displayedItems=this.items,this.ifDisplayAll=!0}displayLimitedItems(t){this._preprocessItems()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-display-limited-items"]],inputs:{items:"items",displayNum:"displayNum"},features:[e.TTD],decls:4,vars:3,consts:[[1,"d-flex","justify-content-start","flex-wrap"],["class","ml-2",4,"ngFor","ngForOf"],["class","ml-2",3,"click",4,"ngIf"],[1,"ml-2"],[1,"ml-2",3,"click"],["href","javascript:void(0)"],["href","javascript:void(0);"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Ni,2,1,"p",1),e.YNc(2,Oi,3,0,"p",2),e.YNc(3,Fi,3,0,"p",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",n.displayedItems),e.xp6(1),e.Q6J("ngIf",!n.ifDisplayAll&&(null==n.displayedItems?null:n.displayedItems.length)>0),e.xp6(1),e.Q6J("ngIf",n.ifDisplayAll&&(null==n.displayedItems?null:n.displayedItems.length)>n.displayNum))},directives:[a.sg,a.O5],styles:[""],changeDetection:0}),i})(),me=(()=>{class i{constructor(t,n){this.editable=t,this.host=n}onEnter(){""!=this.host.nativeElement.value&&this.editable.toViewMode()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(se),e.Y36(e.SBq))},i.\u0275dir=e.lG2({type:i,selectors:[["","appEditableOnEnter",""]],hostBindings:function(t,n){1&t&&e.NdJ("keyup.enter",function(){return n.onEnter()})}}),i})(),we=(()=>{class i{constructor(t){this.host=t}ngAfterViewInit(){this.host.nativeElement.focus()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275dir=e.lG2({type:i,selectors:[["","appFocusable",""]]}),i})();const $i=["submitButton"];function Mi(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1," Import phenotype data first "),e.qZA())}function Pi(i,s){if(1&i&&e._uU(0),2&i){const t=e.oxw().$implicit;e.hij(" ",t.get("name").value," ")}}function qi(i,s){if(1&i&&e._UZ(0,"input",16),2&i){const t=e.oxw().index,n=e.oxw(2);e.Q6J("formControl",n.getControl(t,"name"))}}function Ei(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"div",8),e.TgZ(3,"fa-icon",10),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw(2).removeGroupFormGroup(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"app-editable",11),e.YNc(6,Pi,1,1,"ng-template",12),e.YNc(7,qi,1,1,"ng-template",13),e.qZA(),e.qZA(),e.TgZ(8,"td"),e.TgZ(9,"app-define-filter-steps",14),e.NdJ("filterStepsInfo$",function(o){const l=e.CHM(t).index;return e.oxw(2).obtainGroupSamples(o,l)}),e.qZA(),e.qZA(),e.TgZ(10,"td"),e._UZ(11,"app-display-limited-items",15),e.qZA(),e.qZA()}if(2&i){const t=s.index,n=e.oxw(2);e.xp6(3),e.Q6J("icon",n.faMinus)("size","1x"),e.xp6(6),e.Q6J("dataAttributes",n.allAttributes),e.xp6(2),e.Q6J("items",n.getControlValue(t,"samples"))("displayNum",3)}}function Ui(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"table",6),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e._UZ(3,"th"),e.TgZ(4,"th"),e._uU(5,"Group Name"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Filter"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Samples In the Group"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"tbody"),e.YNc(11,Ei,12,5,"tr",7),e.TgZ(12,"tr"),e.TgZ(13,"td"),e.TgZ(14,"div",8),e.TgZ(15,"fa-icon",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().addGroupFormGroup()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.groupsForm.get("groups").controls),e.xp6(4),e.Q6J("icon",t.faPlus)("size","1x")}}function Ji(i,s){if(1&i&&(e.TgZ(0,"p",18),e._uU(1),e.qZA()),2&i){const t=e.oxw().ngIf;e.xp6(1),e.hij("Sample ",t.samplesString," are assigned to multiple groups")}}function Ri(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Ji,2,1,"p",17),e.qZA()),2&i){const t=s.ngIf;e.xp6(1),e.Q6J("ngIf",t.ifOverlap)}}function Qi(i,s){1&i&&(e.TgZ(0,"p",19),e._uU(1,"Group names should be unique"),e.qZA())}function Gi(i,s){1&i&&(e.TgZ(0,"p",19),e._uU(1,"Group names or samples should not be empty"),e.qZA())}function Li(i,s){if(1&i&&(e.TgZ(0,"button",20,21),e.ALo(2,"async"),e._uU(3,"Submit Groups"),e.qZA()),2&i){const t=e.oxw();e.Q6J("disabled",!e.lcZ(2,1,t.ifSubmitAvailable$))}}let ji=(()=>{class i{constructor(t,n){this.formBuilder=t,this.cdr=n,this.sampleAttribute="samples",this.ifShowSubmitButton=!0,this.outGroups=new e.vpe,this.faPlus=B.r8p,this.faMinus=B.Kl4,this.groups=[],this.destroyNotifier$=new P.xQ,this.groupsForm=this.formBuilder.group({groups:this.formBuilder.array([this._createGroupFormGroup()],[u.kI.required,je,Ve,ke])})}ngOnInit(){this.phenotypeData&&this._processPhenotypeData(),this.ifSubmitAvailable$=this.groupsForm.get("groups").statusChanges.pipe((0,x.R)(this.destroyNotifier$),(0,Z.U)(t=>"VALID"===t)),this.groupsForm.get("groups").statusChanges.pipe((0,x.R)(this.destroyNotifier$)).subscribe(t=>{this.ifShowSubmitButton||this.outGroups.next("VALID"===t?this.groupsForm.get("groups").value:null)}),this.ifGroupsOverlapSamplesNote$=this.groupsForm.get("groups").valueChanges.pipe((0,x.R)(this.destroyNotifier$),(0,Z.U)(t=>{const o=t.map(l=>l.samples).reduce((l,c)=>l.concat(c)),r=(0,A.ro)(o);if(r){const l=(0,A.kX)(o);return{ifOverlap:r,samplesString:(0,A.w6)(l)}}return{ifOverlap:r}}),(0,Q.O)({ifOverlap:!1}))}ngOnChanges(t){t.phenotypeData&&!t.phenotypeData.isFirstChange()&&this._processPhenotypeData()}ngAfterViewInit(){this.ifShowSubmitButton&&(this.submitStream$=(0,G.R)(this.submitButton.nativeElement,"click"),this.submitStream$.pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(t=>null!=t)).subscribe(t=>{this.outGroups.next(this.groupsForm.get("groups").value)}))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_processPhenotypeData(){this.allAttributes=[...Object.keys(this.phenotypeData)],this.allSamples=[...this.phenotypeData[this.sampleAttribute]]}_createGroupFormGroup(){return new u.cw({name:new u.NI("New Group",u.kI.required),samples:new u.NI([],[u.kI.required,u.kI.minLength(1)])})}getControl(t,n){return this.groupsForm.get("groups").at(t).get(n)}getControlValue(t,n){return this.groupsForm.get("groups").at(t).get(n).value}addGroupFormGroup(){this.groupsForm.get("groups").push(this._createGroupFormGroup())}removeGroupFormGroup(t){this.groupsForm.get("groups").removeAt(t)}obtainGroupSamples(t,n){const o=t.matchType;let r=[],l=[];if(t.filterSteps.length>=1){for(let f of t.filterSteps){const C=f.attribute,U=f.filterType,F=f.filterValue.toLowerCase(),ae=A.qP[U](this.phenotypeData[C],F);r.push(new Set(ae))}l=[...r.reduce(Si.JN[o])].map(f=>this.allSamples[f])}this.groupsForm.get("groups").at(n).patchValue({samples:l})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.qu),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-define-groups-using-multiple-attributes"]],viewQuery:function(t,n){if(1&t&&e.Gf($i,5),2&t){let o;e.iGM(o=e.CRH())&&(n.submitButton=o.first)}},inputs:{phenotypeData:"phenotypeData",sampleAttribute:"sampleAttribute",ifShowSubmitButton:"ifShowSubmitButton"},outputs:{outGroups:"outGroups"},features:[e.TTD],decls:9,vars:8,consts:[[1,"d-flex","justify-content-center"],[4,"ngIf"],["class","table",4,"ngIf"],["class","alertP",4,"ngIf"],[1,"mt-3"],["class","btn btn-expressvis","data-testid","submitGroups",3,"disabled",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"form-inline"],["ngbTooltip","Add a new group","data-testid","addGroup",1,"hoverBigger",3,"icon","size","click"],["ngbTooltip","Delete this group",1,"hoverBigger",3,"icon","size","click"],["initialMode","edit"],["appEditableView",""],["appEditableEdit",""],[3,"dataAttributes","filterStepsInfo$"],[3,"items","displayNum"],["appEditableOnEnter","","appFocusable","","ngDefaultControl","","placeholder","Group Name","data-testid","inputGroupName","required","",1,"form-control","form-control-sm",3,"formControl"],["data-testid","samplesOverlapNote",4,"ngIf"],["data-testid","samplesOverlapNote"],[1,"alertP"],["data-testid","submitGroups",1,"btn","btn-expressvis",3,"disabled"],["submitButton",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Mi,2,0,"p",1),e.qZA(),e.YNc(2,Ui,16,3,"table",2),e.YNc(3,Ri,2,1,"div",1),e.ALo(4,"async"),e.YNc(5,Qi,2,0,"p",3),e.YNc(6,Gi,2,0,"p",3),e.TgZ(7,"div",4),e.YNc(8,Li,4,3,"button",5),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.phenotypeData),e.xp6(1),e.Q6J("ngIf",n.phenotypeData),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,6,n.ifGroupsOverlapSamplesNote$)),e.xp6(2),e.Q6J("ngIf",null==n.groupsForm.get("groups").errors?null:n.groupsForm.get("groups").errors.groupNamesDuplicate),e.xp6(1),e.Q6J("ngIf",null==n.groupsForm.get("groups").errors?null:n.groupsForm.get("groups").errors.hasEmptySamples),e.xp6(2),e.Q6J("ngIf",n.ifShowSubmitButton))},directives:[a.O5,a.sg,v.BN,b._L,se,ie,ne,wi.u,ue,u.Fj,me,we,u.Q7,u.JJ,u.oH],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();const Vi=["submitButton"];function ki(i,s){if(1&i&&e._uU(0),2&i){const t=e.oxw().$implicit;e.hij(" ",t.get("name").value," ")}}function Bi(i,s){if(1&i&&e._UZ(0,"input",14),2&i){const t=e.oxw().index,n=e.oxw();e.Q6J("formControl",n.getControl(t,"name"))}}function Yi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"div",2),e.TgZ(3,"fa-icon",8),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw().removeGroupFormGroup(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"td"),e.TgZ(5,"app-editable",9),e.NdJ("update",function(){const r=e.CHM(t).index;return e.oxw().updateGroupName(r,"name")}),e.YNc(6,ki,1,1,"ng-template",10),e.YNc(7,Bi,1,1,"ng-template",11),e.qZA(),e.qZA(),e.TgZ(8,"td"),e.TgZ(9,"ng-multiselect-dropdown",12),e.NdJ("ngModelChange",function(o){const l=e.CHM(t).index;return e.oxw().groups[l].samples=o})("onSelect",function(o){const l=e.CHM(t).index;return e.oxw().updateGroupSamples(o,l)})("onDeSelect",function(o){const l=e.CHM(t).index;return e.oxw().updateGroupSamples(o,l)}),e.qZA(),e.qZA(),e.TgZ(10,"td"),e._UZ(11,"app-display-limited-items",13),e.qZA(),e.qZA()}if(2&i){const t=s.index,n=e.oxw();e.xp6(3),e.Q6J("icon",n.faMinus)("size","1x"),e.xp6(6),e.Q6J("placeholder","Select samples")("settings",n.dropdownSettings)("data",n.samples)("ngModel",n.groups[t].samples),e.xp6(2),e.Q6J("items",n.getControlValue(t,"samples"))("displayNum",3)}}function Hi(i,s){if(1&i&&(e.TgZ(0,"p",15),e._uU(1),e.qZA()),2&i){const t=e.oxw().ngIf;e.xp6(1),e.hij("Sample ",t.samplesString," are assigned to multiple groups")}}function Wi(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Hi,2,1,"p",5),e.qZA()),2&i){const t=s.ngIf;e.xp6(1),e.Q6J("ngIf",t.ifOverlap)}}function zi(i,s){1&i&&(e.TgZ(0,"p",15),e._uU(1,"Group names should be unique"),e.qZA())}function Xi(i,s){if(1&i&&(e.TgZ(0,"button",16,17),e.ALo(2,"async"),e._uU(3,"Submit Groups"),e.qZA()),2&i){const t=e.oxw();e.Q6J("disabled",!e.lcZ(2,1,t.ifSubmitAvailable$))}}let Ki=(()=>{class i{constructor(t){this.formBuilder=t,this.ifShowSubmitButton=!0,this.outGroups=new e.vpe,this.faPlus=B.r8p,this.faMinus=B.Kl4,this.groups=[],this.dropdownSettings={singleSelection:!1,selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!1,allowSearchFilter:!0},this.destroyNotifier$=new P.xQ,this.groupsForm=this.formBuilder.group({groups:this.formBuilder.array([this._createGroupFormGroup()],[je,Ve,ke])}),this.groups.push({name:"New Group",samples:[]})}ngOnInit(){this.groupsForm.get("groups").controls[0].get("name"),this.ifSubmitAvailable$=this.groupsForm.get("groups").statusChanges.pipe((0,x.R)(this.destroyNotifier$),(0,Z.U)(t=>"VALID"===t)),this.groupsForm.get("groups").statusChanges.pipe((0,x.R)(this.destroyNotifier$)).subscribe(t=>{this.ifShowSubmitButton||this.outGroups.next("VALID"===t?this.groupsForm.get("groups").value:null)}),this.ifGroupsOverlapSamplesNote$=this.groupsForm.get("groups").valueChanges.pipe((0,x.R)(this.destroyNotifier$),(0,Z.U)(t=>{const o=t.map(l=>l.samples).reduce((l,c)=>l.concat(c)),r=(0,A.ro)(o);if(r){const l=(0,A.kX)(o);return{ifOverlap:r,samplesString:(0,A.w6)(l)}}return{ifOverlap:r}}),(0,Q.O)({ifOverlap:!1}))}ngAfterViewInit(){this.ifShowSubmitButton&&(this.submitStream$=(0,G.R)(this.submitButton.nativeElement,"click"),this.submitStream$.pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(t=>null!=t)).subscribe(t=>{this.outGroups.next(this.groupsForm.get("groups").value)}))}ngOnChanges(t){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_createGroupFormGroup(){return new u.cw({name:new u.NI("New Group",u.kI.required),samples:new u.NI([],u.kI.required)})}getControl(t,n){return this.groupsForm.get("groups").at(t).get(n)}getControlValue(t,n){return this.groupsForm.get("groups").at(t).get(n).value}addGroupFormGroup(){this.groupsForm.get("groups").push(this._createGroupFormGroup()),this.groups.push({name:"New Group",samples:[]})}removeGroupFormGroup(t){this.groupsForm.get("groups").removeAt(t),this.groups=this.groups.filter((o,r)=>r!=t)}updateGroupName(t,n){const o=this.groupsForm.get("groups").controls[t].get("name").value,r=[...this.groups];this.groups=r.map((l,c)=>c===t?Object.assign(Object.assign({},l),{name:o}):Object.assign({},l))}updateGroupSamples(t,n){this.groupsForm.get("groups").controls[n].patchValue({samples:this.groups[n].samples})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.qu))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-define-groups-manually"]],viewQuery:function(t,n){if(1&t&&e.Gf(Vi,5),2&t){let o;e.iGM(o=e.CRH())&&(n.submitButton=o.first)}},inputs:{samples:"samples",ifShowSubmitButton:"ifShowSubmitButton"},outputs:{outGroups:"outGroups"},features:[e.TTD],decls:21,vars:8,consts:[[1,"table"],[4,"ngFor","ngForOf"],[1,"form-inline"],["ngbTooltip","Add a new group",1,"hoverBigger",3,"icon","size","click"],[4,"ngIf"],["class","alertP",4,"ngIf"],[1,"mt-3"],["class","btn btn-expressvis","data-testid","submitGroups",3,"disabled",4,"ngIf"],["ngbTooltip","Delete this group",1,"hoverBigger",3,"icon","size","click"],["initialMode","edit",3,"update"],["appEditableView",""],["appEditableEdit",""],["ngDefaultControl","",3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onDeSelect"],[3,"items","displayNum"],["appEditableOnEnter","","appFocusable","","ngDefaultControl","","placeholder","Group Name","required","",1,"form-control","form-control-sm",3,"formControl"],[1,"alertP"],["data-testid","submitGroups",1,"btn","btn-expressvis",3,"disabled"],["submitButton",""]],template:function(t,n){1&t&&(e.TgZ(0,"table",0),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e._UZ(3,"th"),e.TgZ(4,"th"),e._uU(5,"Group Name"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Manually Select"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Samples In the Group"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"tbody"),e.YNc(11,Yi,12,8,"tr",1),e.TgZ(12,"tr"),e.TgZ(13,"td"),e.TgZ(14,"div",2),e.TgZ(15,"fa-icon",3),e.NdJ("click",function(){return n.addGroupFormGroup()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(16,Wi,2,1,"div",4),e.ALo(17,"async"),e.YNc(18,zi,2,0,"p",5),e.TgZ(19,"div",6),e.YNc(20,Xi,4,3,"button",7),e.qZA()),2&t&&(e.xp6(11),e.Q6J("ngForOf",n.groupsForm.get("groups").controls),e.xp6(4),e.Q6J("icon",n.faPlus)("size","1x"),e.xp6(1),e.Q6J("ngIf",e.lcZ(17,6,n.ifGroupsOverlapSamplesNote$)),e.xp6(2),e.Q6J("ngIf",null==n.groupsForm.get("groups").errors?null:n.groupsForm.get("groups").errors.groupNamesDuplicate),e.xp6(2),e.Q6J("ngIf",n.ifShowSubmitButton))},directives:[a.sg,v.BN,b._L,a.O5,se,ie,ne,ge,u.Fj,u.JJ,u.On,ue,me,we,u.Q7,u.oH],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();const en=["submitButton"];function tn(i,s){1&i&&(e.TgZ(0,"p",6),e._uU(1," Import phenotype data first "),e.qZA())}function nn(i,s){if(1&i&&(e.TgZ(0,"option",11),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function sn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"form"),e.TgZ(1,"div",7),e.TgZ(2,"h6",8),e._uU(3,"Select Group Attribute In Phenotype Data: "),e.qZA(),e.TgZ(4,"select",9),e.NdJ("change",function(o){return e.CHM(t),e.oxw().defineGroupsAccordingToAttribute(o)}),e.YNc(5,nn,2,2,"option",10),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.allAttributes)}}function on(i,s){if(1&i&&(e.TgZ(0,"tr",15),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"app-display-limited-items",16),e.qZA(),e.qZA()),2&i){const t=s.$implicit,n=s.index,o=e.oxw(2);e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.samples.length," "),e.xp6(2),e.Q6J("items",o.groups[n].samples)("displayNum",3)}}function rn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"table",12),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e.TgZ(3,"th"),e._uU(4,"Group Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Samples Num"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Samples in the Group"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"tbody",13),e.NdJ("cdkDropListDropped",function(o){return e.CHM(t),e.oxw().onDrop(o)}),e.YNc(10,on,7,4,"tr",14),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(10),e.Q6J("ngForOf",t.groups)}}function an(i,s){if(1&i&&(e.TgZ(0,"button",17,18),e.ALo(2,"async"),e._uU(3,"Submit Groups "),e.qZA()),2&i){const t=e.oxw();e.Q6J("disabled",!e.lcZ(2,1,t.ifSubmitAvailable$))}}let ln=(()=>{class i{constructor(){this.sampleAttribute="samples",this.ifShowSubmitButton=!0,this.outGroups=new e.vpe,this.groups=[],this.allAttributes=[],this.groupsChangedSubject=new P.xQ,this.destroyNotifier$=new P.xQ}ngOnInit(){this.phenotypeData&&(this.allAttributes=Object.keys(this.phenotypeData)),this.ifSubmitAvailable$=this.groupsChangedSubject.asObservable(),this.groupsChangedSubject.next(!1)}ngOnChanges(t){t.phenotypeData&&!t.phenotypeData.isFirstChange()&&(this.allAttributes=Object.keys(this.phenotypeData))}ngAfterViewInit(){this.ifShowSubmitButton&&(this.submitStream$=(0,G.R)(this.submitButton.nativeElement,"click"),this.submitStream$.pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(t=>null!=t)).subscribe(t=>{this.outGroups.next([...this.groups])}))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}defineGroupsAccordingToAttribute(t){const n=[...this.phenotypeData[t.target.value]],o=[...this.phenotypeData[this.sampleAttribute]];let r=new Object;new Set(n).forEach(_=>{r[_]=[]}),n.forEach((_,f)=>{r[_].push(o[f])});const c=Object.keys(r).map(_=>({name:_,samples:r[_]}));this.groups=c,this.groupsChangedSubject.next(!0),this.ifShowSubmitButton||this.outGroups.next(c)}onDrop(t){(0,D.bA)(this.groups,t.previousIndex,t.currentIndex),this.ifShowSubmitButton||this.outGroups.next(this.groups)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-define-groups-using-phenotype-data"]],viewQuery:function(t,n){if(1&t&&e.Gf(en,5),2&t){let o;e.iGM(o=e.CRH())&&(n.submitButton=o.first)}},inputs:{phenotypeData:"phenotypeData",sampleAttribute:"sampleAttribute",ifShowSubmitButton:"ifShowSubmitButton"},outputs:{outGroups:"outGroups"},features:[e.TTD],decls:6,vars:4,consts:[[1,"d-flex","justify-content-center"],["class","",4,"ngIf"],[4,"ngIf"],["class","table",4,"ngIf"],[1,"mt-3"],["class","btn btn-expressvis","data-testid","submitGroups",3,"disabled",4,"ngIf"],[1,""],[1,"form-group","form-group-sm"],["for","defineGroups",2,"margin-bottom","5px"],[1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"table"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","","cdkDragLockAxis","y",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y"],[3,"items","displayNum"],["data-testid","submitGroups",1,"btn","btn-expressvis",3,"disabled"],["submitButton",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,tn,2,0,"p",1),e.qZA(),e.YNc(2,sn,6,1,"form",2),e.YNc(3,rn,11,1,"table",3),e.TgZ(4,"div",4),e.YNc(5,an,4,3,"button",5),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.phenotypeData),e.xp6(1),e.Q6J("ngIf",n.phenotypeData),e.xp6(1),e.Q6J("ngIf",n.groups.length>=1),e.xp6(2),e.Q6J("ngIf",n.ifShowSubmitButton))},directives:[a.O5,u._Y,u.JL,u.F,a.sg,u.YN,u.Kr,D.Wj,D.Zt,ue],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();const pn=["phenotypeContent"];function cn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"h4",9),e._uU(2," Phenotype data"),e.qZA(),e.TgZ(3,"button",10),e.NdJ("click",function(){return e.CHM(t).$implicit.dismiss("Cross click")}),e.TgZ(4,"span",11),e._uU(5,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",12),e._UZ(7,"app-present-phenotype-data",13),e.qZA()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("phenotypeData",t.phenotypeData)}}function un(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"input",15),e.NdJ("change",function(){const r=e.CHM(t).$implicit;return e.oxw().updateCheckbox(r)}),e.qZA(),e.TgZ(2,"label"),e._uU(3),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("checked",t===n.currentMethod),e.xp6(2),e.Oqu(t)}}function mn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-define-groups-using-multiple-attributes",16),e.NdJ("outGroups",function(o){return e.CHM(t),e.oxw().processGroups(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("phenotypeData",t.phenotypeData)("ifShowSubmitButton",t.ifShowSubmitButton)}}function dn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-define-groups-manually",17),e.NdJ("outGroups",function(o){return e.CHM(t),e.oxw().processGroups(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ifShowSubmitButton",t.ifShowSubmitButton)("samples",t.samples)}}function hn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-define-groups-using-phenotype-data",18),e.NdJ("outGroups",function(o){return e.CHM(t),e.oxw().processGroups(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ifShowSubmitButton",t.ifShowSubmitButton)("phenotypeData",t.phenotypeData)}}function fn(i,s){1&i&&(e.TgZ(0,"p",19),e._uU(1," Select one Method\n"),e.qZA())}let Ne=(()=>{class i{constructor(t){this.modalService=t,this.ifShowSubmitButton=!0,this.resetToDefault=!1,this.outGroups=new e.vpe,this.DEFINE_GROUP_METHODS=["Filter Using Multiple Attributes","Manually Select","Assign Using Group Attribute"],this.currentMethod="",this.samplesAttribte="samples"}ngOnInit(){this.phenotypeData&&(this.samples=this._obtainSamples())}ngOnChanges(t){t.phenotypeData&&!t.phenotypeData.isFirstChange()&&this.phenotypeData&&(this.samples=this._obtainSamples()),t.resetToDefault&&!t.resetToDefault.isFirstChange()&&this.resetToDefault&&(this.currentMethod="",this.outGroups.next(null))}_obtainSamples(){return[...this.phenotypeData[this.samplesAttribte]]}updateCheckbox(t){this.currentMethod=this.currentMethod!=t?t:""}processGroups(t){this.outGroups.next((null==t?void 0:t.length)>0?[...t]:[])}displayTableToDisplayPhenotype(t){this.modalService.open(this.phenotypeContent,{size:"xl",backdrop:"static"})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(b.FF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-define-groups"]],viewQuery:function(t,n){if(1&t&&e.Gf(pn,7),2&t){let o;e.iGM(o=e.CRH())&&(n.phenotypeContent=o.first)}},inputs:{phenotypeData:"phenotypeData",ifShowSubmitButton:"ifShowSubmitButton",resetToDefault:"resetToDefault"},outputs:{outGroups:"outGroups"},features:[e.TTD],decls:12,vars:5,consts:[["href","javascript:void(0)","data-testid","displayPhenotype",1,"inline",3,"click"],["phenotypeContent",""],[1,"d-flex","flex-wrap","justify-content-around"],["data-testid","selectGroupMethod",4,"ngFor","ngForOf"],[3,"phenotypeData","ifShowSubmitButton","outGroups",4,"ngIf"],[3,"ifShowSubmitButton","samples","outGroups",4,"ngIf"],[3,"ifShowSubmitButton","phenotypeData","outGroups",4,"ngIf"],["class","text-danger",4,"ngIf"],["calss","modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"phenotypeData"],["data-testid","selectGroupMethod"],["type","checkbox",3,"checked","change"],[3,"phenotypeData","ifShowSubmitButton","outGroups"],[3,"ifShowSubmitButton","samples","outGroups"],[3,"ifShowSubmitButton","phenotypeData","outGroups"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"p"),e._uU(1," There are three ways to define samples in each group. If there are hundreds of samples, you would better generate a phenotype data containing a group attribute and import it, then check Use Group Attribute or Use Multple attributes. In the Using One Group Attribute case, the app automatically geneate groups using the unique attribute values and assign samples to the groups according to attribute values. In Using Multiple Attributes case, you can construct complex select steps to select samples. If the number of samples is small, you can generate groups and select samples manually. "),e.TgZ(2,"a",0),e.NdJ("click",function(r){return n.displayTableToDisplayPhenotype(r)}),e._uU(3,"View Phenotype Data"),e.qZA(),e.qZA(),e.YNc(4,cn,8,1,"ng-template",null,1,e.W1O),e.TgZ(6,"div",2),e.YNc(7,un,4,2,"div",3),e.qZA(),e.YNc(8,mn,1,2,"app-define-groups-using-multiple-attributes",4),e.YNc(9,dn,1,2,"app-define-groups-manually",5),e.YNc(10,hn,1,2,"app-define-groups-using-phenotype-data",6),e.YNc(11,fn,2,0,"p",7)),2&t&&(e.xp6(7),e.Q6J("ngForOf",n.DEFINE_GROUP_METHODS),e.xp6(1),e.Q6J("ngIf","Filter Using Multiple Attributes"===n.currentMethod),e.xp6(1),e.Q6J("ngIf","Manually Select"===n.currentMethod),e.xp6(1),e.Q6J("ngIf","Assign Using Group Attribute"===n.currentMethod),e.xp6(1),e.Q6J("ngIf",""===n.currentMethod))},directives:[a.sg,a.O5,yi,ji,Ki,ln],styles:[""],changeDetection:0}),i})();function gn(i,s){if(1&i&&e._uU(0),2&i){const t=e.oxw();e.hij(" ",t.inputStringControl.value," ")}}function _n(i,s){if(1&i&&e._UZ(0,"input",3),2&i){const t=e.oxw();e.s9C("placeholder",t.placeholder),e.Q6J("formControl",t.inputStringControl)}}let Oe=(()=>{class i{constructor(t){this.cdr=t,this.resetToDefault=!1,this.placeholder="default placeholder",this.inputString$=new e.vpe(null),this.inputStringControl=new u.NI(""),this.destroyNotifier$=new P.xQ}ngOnInit(){this.inputStringControl.valueChanges.pipe((0,m.h)(t=>t),(0,x.R)(this.destroyNotifier$),(0,ye.x)()).subscribe(t=>{this.inputString$.emit(t),this.cdr.detectChanges()})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-click-focus-input"]],inputs:{resetToDefault:"resetToDefault",placeholder:"placeholder"},outputs:{inputString$:"inputString$"},decls:3,vars:0,consts:[["initialMode","edit"],["appEditableView",""],["appEditableEdit",""],["appEditableOnEnter","","required","",1,"form-control","form-control-sm",3,"placeholder","formControl"]],template:function(t,n){1&t&&(e.TgZ(0,"app-editable",0),e.YNc(1,gn,1,1,"ng-template",1),e.YNc(2,_n,1,2,"ng-template",2),e.qZA())},directives:[se,ie,ne,u.Fj,me,u.Q7,u.JJ,u.oH],styles:[""],changeDetection:0}),i})();const yn=["submitButton"];function Sn(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1,"Gene ID types of counts data and TPM/RPKM/FPKM data should be the same"),e.qZA())}function xn(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1,"Samples of counts data and TPM/RPKM/FPKM data should be the same"),e.qZA())}function bn(i,s){1&i&&(e.TgZ(0,"p",15),e._uU(1,"Data is uploaded successfully, click one of the apps for later analysis"),e.qZA())}let Dn=(()=>{class i{constructor(t){this.facade=t,this.availableSpecies=K.it,this.availableRNAseqIDtypes=K.v$,this.samplesFilesInfo=[{name:"RNA-seq-sample-data1.zip",description:"RNA-seq sample data1"}],this.selectedSpecies$=new g.X(null),this.countsInfo$=new g.X(null),this.tpmsInfo$=new g.X(null),this.inputPhenotypeData$=new g.X(null),this.datasetName$=new g.X(null),this.groups$=new g.X(null),this.destroyNotifier$=new P.xQ}ngOnInit(){this.ifSubmitAvailable$=(0,q.aj)([this.selectedSpecies$,this.countsInfo$,this.tpmsInfo$,this.inputPhenotypeData$,this.datasetName$,this.groups$]).pipe((0,Z.U)(([t,n,o,r,l,c])=>{if(t&&n&&o&&r&&l&&c){const _=(0,A.z7)(n.samples,o.samples),f=(0,A.z7)(n.samples,r.samples),C=this._determineIfCountsIDtypeEqualsTPMidType(n.IDtype,o.IDtype);return!!(_&&f&&C)}return!1}),(0,Q.O)(!1)),this.ifShowIDtypesNote$=(0,q.aj)([this.countsInfo$.pipe((0,m.h)(t=>null!=t)),this.tpmsInfo$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n])=>!this._determineIfCountsIDtypeEqualsTPMidType(t.IDtype,n.IDtype)),(0,Q.O)(!1)),this.ifShowSamplesNote$=(0,q.aj)([this.countsInfo$.pipe((0,m.h)(t=>null!=t)),this.tpmsInfo$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n])=>!(0,A.z7)([...t.samples],[...n.samples])),(0,Q.O)(!1)),this.ifShowUploadNote$=this.facade.theLatestAddedDatasetID$.pipe((0,m.h)(t=>null!=t),(0,j.M)(this.datasetName$.pipe((0,m.h)(t=>null!=t))),(0,Z.U)(([t,n])=>t===n),(0,x.R)(this.destroyNotifier$),(0,Q.O)(!1))}ngAfterViewInit(){this.submitStream$=(0,G.R)(this.submitButton.nativeElement,"click"),this.submitStream$.pipe((0,x.R)(this.destroyNotifier$),(0,m.h)(t=>null!=t),De(500),(0,j.M)(this.selectedSpecies$.pipe((0,m.h)(t=>null!=t)),this.countsInfo$.pipe((0,m.h)(t=>null!=t)),this.tpmsInfo$.pipe((0,m.h)(t=>null!=t)),this.inputPhenotypeData$.pipe((0,m.h)(t=>null!=t)),this.datasetName$.pipe((0,m.h)(t=>null!=t)),this.groups$.pipe((0,m.h)(Boolean)))).subscribe(([t,n,o,r,l,c,_])=>{const f=Le([...o.samples],l),C=function(i,s,t){if((0,A.a)(s,t))return i;performance.now();const o=(0,A.Wv)(t,s),l=(performance.now(),i[0].length);let c=[];for(let _ of o)c.push(_<0?Array(l).fill(null):i[_]);return c}([...r.values],[...r.geneIDs],[...o.geneIDs]),U=function(i,s,t){if((0,A.a)(s,t))return i;const n=(0,A.Wv)(t,s);let o=[];for(let r of i){const l=n.map(c=>r[c]);o.push(l)}return o}([...C],[...r.samples],[...o.samples]),L={expressLocalOrRemote:z.M.local,datasetID:c,description:c,speciesID:n.taxID,speciesName:n.name,IDtype:o.IDtype,ifLogTransformed:!1,experimentType:"RNA-seq of coding RNA",samples:o.samples,groups:_};this.facade.addLocalExpressData({geneIDs:o.geneIDs,samples:o.samples,counts:o.counts,datasetID:c,phenotypeData:f,expressionValues:U}),this.facade.addDatasetInfo(L),this.facade.requestDatabaseGeneID2info({speciesID:n.taxID,idType:o.IDtype})})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_determineIfCountsIDtypeEqualsTPMidType(t,n){return t==n}processSelectedSpecies(t){this.selectedSpecies$.next(t)}processCountsInfo(t){this.countsInfo$.next({geneIDs:t.IDs,samples:t.samples,counts:t.values,IDtype:t.IDtype}),this.inputPhenotypeData$.next({samples:t.samples})}processTPMinfo(t){this.tpmsInfo$.next({geneIDs:t.IDs,samples:t.samples,values:t.values,IDtype:t.IDtype})}processPhenotypeData(t){this.inputPhenotypeData$.next(t)}processInputDatasetName(t){this.datasetName$.next(t)}processGroups(t){this.groups$.next(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-rna-seq"]],viewQuery:function(t,n){if(1&t&&e.Gf(yn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.submitButton=o.first)}},decls:39,vars:29,consts:[[1,"mt-4","p-1","border"],[3,"fileInfos"],[3,"appAddRequiredOptionalSign"],[3,"availableSpecies","selectedSpecies$"],["data-testid","loadCounts",3,"availableIDtypes","dataType","expressionImported$"],["data-testid","loadTpms",3,"availableIDtypes","dataType","expressionImported$"],[1,"mt-3"],[4,"ngIf"],[1,"mt-3",3,"appAddRequiredOptionalSign"],["data-testid","loadPhenotype",3,"phenotypeData$"],[3,"phenotypeData","ifShowSubmitButton","outGroups"],["data-testid","inputDatasetName",3,"placeholder","inputString$"],["data-testid","submitRnaseq",1,"btn","btn-expressvis",3,"disabled"],["submitButton",""],["data-testid","uploadNote",4,"ngIf"],["data-testid","uploadNote"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-download-sample-data",1),e.qZA(),e.TgZ(2,"div",0),e.TgZ(3,"h3",2),e._uU(4," Step 1. Select species "),e.qZA(),e.TgZ(5,"app-select-species",3),e.NdJ("selectedSpecies$",function(r){return n.processSelectedSpecies(r)}),e.qZA(),e.qZA(),e.TgZ(6,"div",0),e.TgZ(7,"h3",2),e._uU(8," Step 2. Import counts data "),e.qZA(),e.TgZ(9,"app-import-expression-values",4),e.NdJ("expressionImported$",function(r){return n.processCountsInfo(r)}),e.qZA(),e.qZA(),e.TgZ(10,"div",0),e.TgZ(11,"h3",2),e._uU(12," Step 3. Import TPM/RPKM/FPKM data "),e.qZA(),e.TgZ(13,"app-import-expression-values",5),e.NdJ("expressionImported$",function(r){return n.processTPMinfo(r)}),e.qZA(),e.qZA(),e.TgZ(14,"div",6),e.YNc(15,Sn,2,0,"p",7),e.ALo(16,"async"),e.YNc(17,xn,2,0,"p",7),e.ALo(18,"async"),e.qZA(),e.TgZ(19,"div",0),e.TgZ(20,"h3",8),e._uU(21," Step 4. Import Phenotype data "),e.qZA(),e.TgZ(22,"app-import-phenotype-data",9),e.NdJ("phenotypeData$",function(r){return n.processPhenotypeData(r)}),e.qZA(),e.qZA(),e.TgZ(23,"div",0),e.TgZ(24,"h3",2),e._uU(25," Step 5. Define Groups"),e.qZA(),e.TgZ(26,"app-define-groups",10),e.NdJ("outGroups",function(r){return n.processGroups(r)}),e.ALo(27,"async"),e.qZA(),e.qZA(),e.TgZ(28,"div",0),e.TgZ(29,"h3",2),e._uU(30," Step 6. Input Dataset name "),e.qZA(),e.TgZ(31,"app-click-focus-input",11),e.NdJ("inputString$",function(r){return n.processInputDatasetName(r)}),e.qZA(),e.qZA(),e.TgZ(32,"div",0),e.TgZ(33,"button",12,13),e.ALo(35,"async"),e._uU(36," Upload RNA-seq Data "),e.qZA(),e.qZA(),e.YNc(37,bn,2,0,"p",14),e.ALo(38,"async")),2&t&&(e.xp6(1),e.Q6J("fileInfos",n.samplesFilesInfo),e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("availableSpecies",n.availableSpecies),e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("availableIDtypes",n.availableRNAseqIDtypes)("dataType","RNA-seq-counts"),e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("availableIDtypes",n.availableRNAseqIDtypes)("dataType","RNA-seq-TPM"),e.xp6(2),e.Q6J("ngIf",e.lcZ(16,19,n.ifShowIDtypesNote$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(18,21,n.ifShowSamplesNote$)),e.xp6(3),e.Q6J("appAddRequiredOptionalSign","optional"),e.xp6(4),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("phenotypeData",e.lcZ(27,23,n.inputPhenotypeData$))("ifShowSubmitButton",!1),e.xp6(3),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("placeholder","Dataset Name"),e.xp6(2),e.Q6J("disabled",!e.lcZ(35,25,n.ifSubmitAvailable$)),e.xp6(4),e.Q6J("ngIf",!!e.lcZ(38,27,n.ifShowUploadNote$)))},directives:[Te,ve,Ie.a,oi,a.O5,Ce,Ne,Oe],pipes:[a.Ov],styles:[".bd-content[_ngcontent-%COMP%]{min-height:100vh}"]}),i})(),ze=(()=>{class i{constructor(){this.faQuestion=B.Psp}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-display-notes-with-question-mark"]],inputs:{note:"note"},decls:2,vars:3,consts:[[2,"display","inline","height","1rem"],[1,"hoverBigger",3,"icon","size","ngbTooltip"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"fa-icon",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("icon",n.faQuestion)("size","0.2x")("ngbTooltip",n.note))},directives:[v.BN,b._L],styles:[""],changeDetection:0}),i})();var Tn=p(94);let Xe=(()=>{class i extends te.S{constructor(){super(),this.IDcolumnSubject=new g.X(null),this.samplesSubject=new g.X(null),this.IDcolumn$=this.IDcolumnSubject.asObservable(),this.samples$=this.samplesSubject.asObservable()}obtainValuesInfo(t,n){return((i,s,t)=>{let n=[],o=[];const r=i[0];let l=[];r.forEach((_,f)=>{t.indexOf(_)>=0&&l.push(f)});const c=r.indexOf(s);return i.slice(1).forEach(_=>{let f=[];l.forEach(C=>{f.push(parseFloat(_[C]))}),o.push(f),n.push(_[c])}),{IDs:n,samples:t,values:o}})(this.textMatrix,t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var Ke=p(3013);const In=["presentFirstLinesComponent"];function Zn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"a",12),e.NdJ("click",function(o){return e.CHM(t),e.oxw().presentFirstLinesOfTheFile(o)}),e._uU(1," View first lines of the file\n"),e.qZA()}}function Cn(i,s){if(1&i&&(e.TgZ(0,"option",13),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.description)}}function An(i,s){if(1&i&&(e.TgZ(0,"div",7),e.TgZ(1,"h5"),e._uU(2,"Check if value columns and probe ID are correct:"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"The values columns are: "),e.qZA(),e._UZ(5,"app-display-limited-items",14),e.ALo(6,"async"),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"async"),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("items",e.lcZ(6,3,t.selectedSamples$))("displayNum",5),e.xp6(3),e.hij("The probe ID column is: ",e.lcZ(9,5,t.IDcolumn$),"")}}function wn(i,s){if(1&i&&(e.TgZ(0,"th"),e.TgZ(1,"p",24),e._uU(2),e.qZA(),e.qZA()),2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t," ")}}function Nn(i,s){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function On(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Nn,2,1,"td",21),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Fn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",15),e.TgZ(1,"h3"),e._uU(2,"The first five lines of the file"),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return null==o.presentFirstLinesModalRef?null:o.presentFirstLinesModalRef.hide()}),e.TgZ(4,"span",17),e._uU(5,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",18),e.TgZ(7,"div",19),e.TgZ(8,"table",20),e.TgZ(9,"thead"),e.TgZ(10,"tr"),e.YNc(11,wn,3,1,"th",21),e.ALo(12,"async"),e.qZA(),e.qZA(),e.TgZ(13,"tbody"),e.YNc(14,On,2,1,"tr",21),e.ALo(15,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",22),e.TgZ(17,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().presentFirstLinesModalRef.hide()}),e._uU(18," close "),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",e.lcZ(12,2,t.fileHeaders$)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(15,4,t.firstLines$))}}let $n=(()=>{class i extends Tn.e{constructor(t,n,o){super(),this.importExpressionService=t,this.modalService=n,this.cdr=o,this.formWidth="15rem",this.expressionImported$=new e.vpe(null),this.fileType="Microarray Normalized Values File",this.logTransformedItems=K.Os,this.fileHeaders$=new R.y(null),this.firstLines$=new R.y(null),this.dropdownSettings={singleSelection:!1,selectAllText:"Select All as Sample Value Columns",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0},this.candidateSamples$=new R.y(null),this.selectedSamples$=new g.X(null),this.selectedSamples=[],this.IDcolumn$=new g.X(null),this.expressionInfoInFile$=new g.X(null),this.selectedIDtype$=new g.X(null),this.selectedLogTransformMethod$=new g.X(null)}ngOnInit(){this.firstLines$=this.importExpressionService.firstLines$.pipe((0,x.R)(this.destroyNotifier$)),this.fileHeaders$=this.importExpressionService.fileHeaders$.pipe((0,x.R)(this.destroyNotifier$))}ngAfterViewInit(){this.candidateSamples$=this.fileHeaders$.pipe((0,m.h)(t=>null!=t)),this.candidateSamples$.subscribe(t=>{(null==t?void 0:t.length)>0&&(this.selectedSamples=t.slice(1),this.selectedSamples$.next(this.selectedSamples))}),(0,q.aj)([this.IDcolumn$.pipe((0,m.h)(t=>null!=t)),this.selectedSamples$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n])=>this.importExpressionService.obtainValuesInfo(t,n))).subscribe(t=>{this.expressionInfoInFile$.next(t)}),(0,q.aj)([this.expressionInfoInFile$.pipe((0,m.h)(t=>null!=t)),this.selectedIDtype$.pipe((0,m.h)(t=>null!==t)),this.selectedLogTransformMethod$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n,o])=>Object.assign(Object.assign({},t),{IDtype:n,logTransformedMethod:o}))).subscribe(t=>{this.expressionImported$.next(t)})}processSelectedFile(t){this.importExpressionService.initLoadedFile(t)}presentFirstLinesOfTheFile(t){this.presentFirstLinesModalRef=this.modalService.show(this.presentFirstLinesComponent,Object.assign({},{class:"modal-xl"})),this.cdr.detectChanges()}outputIDtype(t){this.selectedIDtype$.next(t.target.value)}processSelectedProbeColumn(t){this.IDcolumn$.next(t)}processLogTransformedMethod(t){this.selectedLogTransformMethod$.next(t)}updateSelectedSamples(t){this.selectedSamples$.next(this.selectedSamples)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Xe),e.Y36(O.tT),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-microarray-normalized-values"]],viewQuery:function(t,n){if(1&t&&e.Gf(In,5,e.Rgc),2&t){let o;e.iGM(o=e.CRH())&&(n.presentFirstLinesComponent=o.first)}},inputs:{formWidth:"formWidth",availableIDtypes:"availableIDtypes"},outputs:{expressionImported$:"expressionImported$"},features:[e._Bn([Xe]),e.qOj],decls:27,vars:30,consts:[["role","form",1,"mt-2"],["data-testid","fileType"],["type","file",1,"form-control","form-control-sm",3,"change"],["href","javascript:void(0)","class","inline",3,"click",4,"ngIf"],["for","IDtype",1,"mt-2"],["name","IDtype",1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-2"],[3,"inputItems","itemLabel","ifOutputFirstValue","formWidth","selectedItem$"],["ngDefaultControl","",3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onSelectAll","onDeSelect"],["class","mt-2",4,"ngIf"],["presentFirstLinesComponent",""],["href","javascript:void(0)",1,"inline",3,"click"],[3,"value"],[3,"items","displayNum"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[1,"table-responsive","mr-2","ml-2","mt-2"],[1,"table","table-bordered",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default","btn-sm",3,"click"],[1,"font-weight-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"div"),e.TgZ(2,"h5",1),e._uU(3),e.qZA(),e.TgZ(4,"input",2),e.NdJ("change",function(r){return n.processSelectedFile(r)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(5,Zn,2,0,"a",3),e.ALo(6,"async"),e.TgZ(7,"h5",4),e._uU(8,"Probe ID Type in the File:"),e.qZA(),e.TgZ(9,"select",5),e.NdJ("change",function(r){return n.outputIDtype(r)}),e.TgZ(10,"option"),e._uU(11,"---"),e.qZA(),e.YNc(12,Cn,2,2,"option",6),e.qZA(),e.TgZ(13,"div",7),e.TgZ(14,"app-select-item",8),e.NdJ("selectedItem$",function(r){return n.processSelectedProbeColumn(r)}),e.ALo(15,"async"),e.qZA(),e.qZA(),e.TgZ(16,"h5",7),e._uU(17,"Select value Columns:"),e.qZA(),e.TgZ(18,"div"),e.TgZ(19,"ng-multiselect-dropdown",9),e.NdJ("ngModelChange",function(r){return n.selectedSamples=r})("onSelect",function(r){return n.updateSelectedSamples(r)})("onSelectAll",function(r){return n.updateSelectedSamples(r)})("onDeSelect",function(r){return n.updateSelectedSamples(r)}),e.ALo(20,"async"),e.qZA(),e.qZA(),e.TgZ(21,"div",7),e.TgZ(22,"app-select-item",8),e.NdJ("selectedItem$",function(r){return n.processLogTransformedMethod(r)}),e.qZA(),e.qZA(),e.YNc(23,An,10,7,"div",10),e.ALo(24,"async"),e.YNc(25,Fn,19,6,"ng-template",null,11,e.W1O)),2&t&&(e.xp6(3),e.hij("",n.fileType,":"),e.xp6(1),e.Udp("width",n.formWidth),e.xp6(1),e.Q6J("ngIf",e.lcZ(6,22,n.firstLines$)),e.xp6(4),e.Udp("width",n.formWidth),e.xp6(3),e.Q6J("ngForOf",n.availableIDtypes),e.xp6(2),e.Q6J("inputItems",e.lcZ(15,24,n.fileHeaders$))("itemLabel","Select Probe Column")("ifOutputFirstValue",!0)("formWidth",n.formWidth),e.xp6(4),e.Udp("width",n.formWidth),e.xp6(1),e.Q6J("placeholder","Select sample columns")("settings",n.dropdownSettings)("data",e.lcZ(20,26,n.candidateSamples$))("ngModel",n.selectedSamples),e.xp6(3),e.Q6J("inputItems",n.logTransformedItems)("itemLabel","Values log Transformed Method")("ifOutputFirstValue",!0)("formWidth",n.formWidth),e.xp6(1),e.Q6J("ngIf",e.lcZ(24,28,n.selectedSamples$)))},directives:[u._Y,u.JL,u.F,a.O5,u.YN,u.Kr,a.sg,Ke.y,ge,u.Fj,u.JJ,u.On,ue],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();var et=p(7682);const Mn=["submitbutton"];function Pn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 2. Import normalized data "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"app-import-microarray-normalized-values",12),e.NdJ("expressionImported$",function(o){return e.CHM(t),e.oxw().processExpressionValues(o)}),e.ALo(6,"async"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","The expression data should be normalized values from software, like oligo and Affy"),e.xp6(1),e.Q6J("availableIDtypes",e.lcZ(6,4,t.availableIDtypes$))("formWidth",t.formWidth)}}function qn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 3. Import Phenotype data "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"app-import-phenotype-data",13),e.NdJ("phenotypeData$",function(o){return e.CHM(t),e.oxw().processPhenotypeData(o)}),e.qZA(),e.qZA()}2&i&&(e.xp6(2),e.Q6J("appAddRequiredOptionalSign","optional"),e.xp6(2),e.Q6J("note","Phenotype Data contain the annotations of the samples. We can use the sample annotations to define groups"))}function En(i,s){1&i&&(e.TgZ(0,"p",14),e._uU(1,"Samples in expression data and phenotype data should be the same"),e.qZA())}function Un(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"h3",3),e._uU(2," Step 4. Define Groups "),e.qZA(),e.TgZ(3,"app-define-groups",15),e.NdJ("outGroups",function(o){return e.CHM(t),e.oxw().processGroups(o)}),e.ALo(4,"async"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("phenotypeData",e.lcZ(4,3,t.inputPhenotypeData$))("ifShowSubmitButton",!1)}}function Jn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 5. Input Dataset name "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"div",7),e.TgZ(6,"app-click-focus-input",16),e.NdJ("inputString$",function(o){return e.CHM(t),e.oxw().processInputDatasetName(o)}),e.qZA(),e.qZA(),e.qZA()}2&i&&(e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","We can import multiple datasets. To distinguish them, each should has a unique name. We can select one in later analsyis"),e.xp6(2),e.Q6J("placeholder","Dataset Name"))}function Rn(i,s){1&i&&(e.TgZ(0,"p",17),e._uU(1," Data is uploaded successfully, click one of the apps for later analysis\n"),e.qZA())}let Qn=(()=>{class i{constructor(t,n){this.facade=t,this.cdr=n,this.availableSpecies=K.it,this.availableIDtypes$=this.facade.availableMicrorrayIDtypes$,this.formWidth="15rem",this.samplesFilesInfo=[{name:"Microarray-sample-data1.zip",description:"Microarray sample data 1"}],this.selectedSpecies$=new g.X(null),this.expressionValuesInfo$=new g.X(null),this.inputPhenotypeData$=new g.X(null),this.datasetName$=new g.X(null),this.groups$=new g.X(null),this.datasetName="",this.steps=[{stepName:"defineSpecies",upStep:"",nextStep:"importNormalizedData",resetChildren:!1},{stepName:"importNormalizedData",upStep:"defineSpecies",nextStep:"importPhenotypeData",resetChildren:!1},{stepName:"importPhenotypeData",upStep:"importNormalizedData",nextStep:"defineGroups",resetChildren:!1},{stepName:"defineGroups",upStep:"importPhenotypeData",nextStep:"inputDatasetName",resetChildren:!1},{stepName:"inputDatasetName",upStep:"defineGroups",nextStep:"clickSubmitButton",resetChildren:!1},{stepName:"clickSubmitButton",upStep:"inputDatasetName",nextStep:"",resetChildren:!1}],this.ifResetChildrenSteps={defineSpecies:!1,importNormalizedData:!1,importPhenotypeData:!1,defineGroups:!1,inputDatasetName:!1,clickSubmitButton:!1},this.ifShowSteps={defineSpecies:!0,importNormalizedData:!1,importPhenotypeData:!1,defineGroups:!1,inputDatasetName:!1,clickSubmitButton:!1},this.destroyNotifier$=new P.xQ}ngOnInit(){this.ifShowSamplesNotSameNote$=(0,q.aj)([this.expressionValuesInfo$.pipe((0,m.h)(t=>null!=t)),this.inputPhenotypeData$.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n])=>!(0,A.z7)([...t.samples],[...n.samples])),(0,Q.O)(!1)),this.ifSubmitAvailable$=(0,q.aj)([this.selectedSpecies$,this.expressionValuesInfo$,this.inputPhenotypeData$,this.datasetName$,this.groups$]).pipe((0,Z.U)(([t,n,o,r,l])=>!!(t&&n&&o&&r&&l)&&!!(0,A.z7)(n.samples,o.samples)),(0,Q.O)(!1))}ngAfterViewInit(){this.submitStream$=(0,G.R)(this.button.nativeElement,"click"),this.submitStream$.pipe((0,m.h)(t=>null!=t),(0,x.R)(this.destroyNotifier$),De(500),(0,j.M)(this.selectedSpecies$.pipe((0,m.h)(t=>null!=t)),this.expressionValuesInfo$.pipe((0,m.h)(t=>null!=t)),this.inputPhenotypeData$.pipe((0,m.h)(t=>null!=t)),this.datasetName$.pipe((0,m.h)(t=>null!=t)),this.groups$.pipe((0,m.h)(t=>null!=t)))).subscribe(([t,n,o,r,l,c])=>{const f=Le(o.samples,r),U={expressLocalOrRemote:z.M.local,datasetID:l,description:l,speciesID:n.taxID,speciesName:n.name,IDtype:o.IDtype,ifLogTransformed:!0,experimentType:"Expression profiling by array",samples:o.samples,groups:c};this.facade.addLocalExpressData({geneIDs:o.IDs,samples:o.samples,expressionValues:o.values,datasetID:l,phenotypeData:f}),this.facade.addDatasetInfo(U),this.facade.requestDatabaseGeneID2info({speciesID:n.taxID,idType:o.IDtype})}),(0,q.aj)([this.selectedSpecies$,this.expressionValuesInfo$,this.inputPhenotypeData$,this.groups$,this.datasetName$]).subscribe(([t,n,o,r,l])=>{t&&this._displayNextStepOfCurrentStep("defineSpecies"),t&&n&&this._displayNextStepOfCurrentStep("importNormalizedData"),t&&n&&o&&this._displayNextStepOfCurrentStep("importPhenotypeData"),t&&n&&o&&r&&this._displayNextStepOfCurrentStep("defineGroups")}),this.ifShowUploadNote$=this.facade.theLatestAddedDatasetID$.pipe((0,m.h)(t=>null!=t),(0,j.M)(this.datasetName$.pipe((0,m.h)(t=>null!=t))),(0,Z.U)(([t,n])=>t===n),(0,x.R)(this.destroyNotifier$),(0,Q.O)(!1))}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedSpecies(t){t&&(this.selectedSpecies$.next(t),this.facade.requestMicroarrayIDtypesInTheSpecies(t.taxID))}processExpressionValues(t){this.expressionValuesInfo$.next(t),this.inputPhenotypeData$.next({samples:t.samples})}processPhenotypeData(t){this.inputPhenotypeData$.next(t)}processInputDatasetName(t){this.datasetName$.next(t)}processGroups(t){this.groups$.next(t)}_displayNextStepOfCurrentStep(t){let n;this.steps.forEach((r,l)=>{r.stepName===t&&(n=l+1)}),this.ifShowSteps[this.steps[n].stepName]=!0,this.ifShowSteps=Object.assign({},this.ifShowSteps),this.cdr.detectChanges()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-microarray"]],viewQuery:function(t,n){if(1&t&&e.Gf(Mn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.button=o.first)}},decls:22,vars:18,consts:[[1,"mt-4","p-2","border"],[3,"fileInfos"],[1,"d-flex"],[3,"appAddRequiredOptionalSign"],[1,"align-self-center","ml-3","questionMark",3,"note"],[3,"availableSpecies","ifOutputFirstValue","selectedSpecies$"],["class","mt-4 p-2 border",4,"ngIf"],[1,"mt-3"],["class","alert alert-warning",4,"ngIf"],["data-testid","submitMicroarray",1,"btn","btn-expressvis",3,"disabled"],["submitbutton",""],["data-testid","uploadNote",4,"ngIf"],[3,"availableIDtypes","formWidth","expressionImported$"],["appTableHeaderBodySameWidth","",3,"phenotypeData$"],[1,"alert","alert-warning"],[3,"phenotypeData","ifShowSubmitButton","outGroups"],[3,"placeholder","inputString$"],["data-testid","uploadNote"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-download-sample-data",1),e.qZA(),e.TgZ(2,"div",0),e.TgZ(3,"div",2),e.TgZ(4,"h3",3),e._uU(5," Step 1. Select Species "),e.qZA(),e._UZ(6,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(7,"app-select-species",5),e.NdJ("selectedSpecies$",function(r){return n.processSelectedSpecies(r)}),e.qZA(),e.qZA(),e.YNc(8,Pn,7,6,"div",6),e.YNc(9,qn,6,2,"div",6),e.TgZ(10,"div",7),e.YNc(11,En,2,0,"p",8),e.ALo(12,"async"),e.qZA(),e.YNc(13,Un,5,5,"div",6),e.YNc(14,Jn,7,3,"div",6),e.TgZ(15,"div",0),e.TgZ(16,"button",9,10),e.ALo(18,"async"),e._uU(19," Upload Microarray Data "),e.qZA(),e.qZA(),e.YNc(20,Rn,2,0,"p",11),e.ALo(21,"async")),2&t&&(e.xp6(1),e.Q6J("fileInfos",n.samplesFilesInfo),e.xp6(3),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","With the species information, the app can load annotations of the genes in the dataset"),e.xp6(1),e.Q6J("availableSpecies",n.availableSpecies)("ifOutputFirstValue",!1),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.importNormalizedData),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.importPhenotypeData),e.xp6(2),e.Q6J("ngIf",e.lcZ(12,12,n.ifShowSamplesNotSameNote$)),e.xp6(2),e.Q6J("ngIf",n.ifShowSteps.defineGroups),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.inputDatasetName),e.xp6(2),e.Q6J("disabled",!e.lcZ(18,14,n.ifSubmitAvailable$)),e.xp6(4),e.Q6J("ngIf",!!e.lcZ(21,16,n.ifShowUploadNote$)))},directives:[Te,ve,ze,Ie.a,a.O5,$n,Ce,et.n,Ne,Oe],pipes:[a.Ov],styles:[""]}),i})();var de=p(2411);const tt=new Map([["PANDA",["Protein Group accession"]],["MaxQuant",["Majority protein IDs","Gene names","Unique peptides"]],["PD",["Accession"]],["Spectronaut",["PG.ProteinGroups","PG.Genes"]]]),Gn=new Map([["PANDA","Proteins.txt"],["MaxQuant","proteinGroups.txt"],["PD","xxx.txt"],["Spectronaut","Report_Protein Quant.txt"]]),Bn={Equal:function(i,s){return i===s},Unequal:function(i,s){return i!==s},Down:function(i,s){return parseFloat(i)<=parseFloat(s)}},oe=function(i,s,t,n){return{columnIndex:i.indexOf(s),columnValue:t,filterType:n}},re=function(i,s){return i.filter(n=>Bn[s.filterType](n[s.columnIndex],s.columnValue))};let it=(()=>{class i extends te.S{constructor(){super(),this.obtainProteomicsData=(t,n)=>{const o=[...this.textMatrix[0]],l=function(i,s,t){return"MaxQuant"===i?function(i,s){const t=oe(s,"Only identified by site","+","Unequal"),n=oe(s,"Reverse","+","Unequal"),o=oe(s,"Potential contaminant","+","Unequal"),r=re(i,t),l=re(r,n);return re(l,o)}(s,t):"PANDA"===i?s:"Spectronaut"===i?function(i,s){const t=oe(s,"PG.Qvalue","0.01","Down");return re(i,t)}(s,t):"PD"===i?function(i,s){const t=oe(s,"Protein FDR Confidence: Combined","High","Equal");return re(i,t)}(s,t):void 0}(t,this.textMatrix.slice(1),o),c=function(i,s,t,n){const o=function(i,s,t){let n=[];switch(i){case"PANDA":n=s.filter(o=>o.startsWith("Intensity"));break;case"MaxQuant":n=s.filter(o=>!!o.match(t));break;case"PD":n=s.filter(o=>o.startsWith("Abundances"));break;case"Spectronaut":n=s.filter(o=>!!o.match(/^\[\d+\]/i))}return n}(i,t,n),r=(0,A.yF)(o,t);return{intensityHeaders:o,values:(0,A.ip)(s,r).map(_=>_.map(f=>parseFloat(f)))}}(t,l,o,n),_=function(i,s,t){const n=tt.get(i),o=(0,A.yF)(n,t);return{annotationHeaders:n,values:(0,A.ip)(s,o)}}(t,l,o);return(0,de.of)({intensityInfo:c,annotationInfo:_})}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();const Xn=["fileForm"];function Kn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-select-item",11),e.NdJ("selectedItem$",function(o){return e.CHM(t),e.oxw().selectMaxquantAlgorithm(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("inputItems",t.maxquantAlgorithms)("itemLabel","Quantitative Algorithm")("ifOutputFirstValue",!0)("resetSelection",t.resetSelection)}}function es(i,s){if(1&i&&(e.TgZ(0,"th"),e.TgZ(1,"p",16),e._uU(2),e.qZA(),e.qZA()),2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t," ")}}function ts(i,s){if(1&i&&(e.TgZ(0,"td",18),e._uU(1),e.ALo(2,"trimString"),e.qZA()),2&i){const t=s.$implicit;e.s9C("title",t),e.xp6(1),e.hij(" ",e.xi3(2,2,t,20)," ")}}function is(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ts,3,5,"td",17),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function ns(i,s){if(1&i&&(e.TgZ(0,"div",6),e.TgZ(1,"label"),e._uU(2,"The first five lines of the quantitative file"),e.qZA(),e.TgZ(3,"div",12),e.TgZ(4,"table",13),e.TgZ(5,"thead"),e.TgZ(6,"tr"),e.YNc(7,es,3,1,"th",14),e.ALo(8,"async"),e.qZA(),e.qZA(),e.TgZ(9,"tbody",15),e.YNc(10,is,2,1,"tr",14),e.ALo(11,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngForOf",e.lcZ(8,2,t.fileHeaders$)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(11,4,t.firstLines$))}}let ss=(()=>{class i{constructor(t){this.importProteomicsDataService=t,this.resetSelection=!1,this.formWidth="15rem",this.quantificationInfo$=new e.vpe,this.fileHeaders$=new R.y(null),this.fileHeadersFromReset$=new g.X(null),this.firstLines$=new R.y(null),this.firstLinesFromReset$=new g.X(null),this.quantitativeSoftwares=["MaxQuant","PANDA","Spectronaut","PD"],this.availableProteomicsIDtypes=K.jB.map(n=>n.name),this.maxquantAlgorithms=["Intensity","iBAQ","LFQ"],this.faQuestion=B.Psp,this.defaultQuantitativeFileName="niho",this.fileEventSubject=new P.xQ,this.quantitativeSoftware$=new g.X(null),this.algorithm$=new g.X(null),this.infoFromProteimicsFile$=new g.X(null),this.proteinIDcolumn$=new g.X(null),this.proteinIDtype$=new g.X(null),this.destroyNotifier$=new P.xQ}ngOnInit(){this.firstLines$=(0,Y.T)(this.firstLinesFromReset$,this.importProteomicsDataService.firstLines$).pipe((0,x.R)(this.destroyNotifier$)),this.fileHeaders$=(0,Y.T)(this.fileHeadersFromReset$,this.importProteomicsDataService.fileHeaders$).pipe((0,x.R)(this.destroyNotifier$)),this.fileEventSubject.pipe((0,m.h)(t=>null!==t),(0,x.R)(this.destroyNotifier$)).subscribe(t=>{this.importProteomicsDataService.initLoadedFile(t)}),(0,q.aj)([this.algorithm$,this.quantitativeSoftware$,this.firstLines$]).pipe((0,J.w)(([t,n,o])=>{if(t&&n&&o){if("MaxQuant"===n&&"Not Required"!==t){const r=new RegExp(`^${t}.+`,"i");return this.importProteomicsDataService.obtainProteomicsData(n,r)}return this.importProteomicsDataService.obtainProteomicsData(n,null)}return(0,de.of)(null)}),(0,m.h)(t=>null!=t)).subscribe(this.infoFromProteimicsFile$),this.quantitativeSoftware$.pipe((0,m.h)(t=>null!=t),(0,x.R)(this.destroyNotifier$)).subscribe(t=>{this._resetSelectedFile(),this.defaultQuantitativeFileName=`The default file name from ${t} is: ${Gn.get(t)}`,this.possibleIDcolumns=tt.get(t)}),(0,q.aj)([this.quantitativeSoftware$,this.infoFromProteimicsFile$,this.proteinIDcolumn$,this.proteinIDtype$]).pipe((0,Z.U)(([t,n,o,r])=>{if(t&&n&&o&&r){const l=function(i,s){const t=i.annotationHeaders.indexOf(s);return i.values.map(o=>o[t])}(n.annotationInfo,o);return Object.assign(Object.assign({},n),{proteinIDtype:r,proteinIDs:l})}return null}),(0,m.h)(t=>null!=t)).subscribe(t=>{this.quantificationInfo$.next(t)})}ngOnChanges(t){t.resetSelection&&!t.resetSelection.isFirstChange()&&this.resetSelection&&this._resetThisComponent()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedQuantitativeSoftware(t){this.quantitativeSoftware$.next(t),"MaxQuant"!==t&&this.algorithm$.next("Not Required"),this._resetThisComponent()}processProteomicsFile(t){this.fileEventSubject.next(t)}selectMaxquantAlgorithm(t){this.algorithm$.next(t)}processSelectedProteinIDColumn(t){this.proteinIDcolumn$.next(t)}processSelectedProteinIDtype(t){this.proteinIDtype$.next(t)}_resetThisComponent(){this._resetSelectedFile(),this.fileHeadersFromReset$.next(null),this.firstLinesFromReset$.next(null),this.infoFromProteimicsFile$.next(null),this.quantificationInfo$.next(null)}_resetSelectedFile(){this.fileForm.nativeElement.reset()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(it))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-proteomics-quantitative-data"]],viewQuery:function(t,n){if(1&t&&e.Gf(Xn,7),2&t){let o;e.iGM(o=e.CRH())&&(n.fileForm=o.first)}},inputs:{resetSelection:"resetSelection",formWidth:"formWidth"},outputs:{quantificationInfo$:"quantificationInfo$"},features:[e._Bn([it]),e.TTD],decls:16,vars:21,consts:[["data-testid","selectProSource",3,"inputItems","itemLabel","ifOutputFirstValue","resetSelection","selectedItem$"],[1,"mt-3"],["role","form"],["fileForm",""],[1,"form-group"],["data-testid","quantitativeFile","type","file",1,"form-control","form-control-sm",3,"ngbTooltip","change"],[1,"mt-2"],["data-testid","selectAlgorithm",3,"inputItems","itemLabel","ifOutputFirstValue","resetSelection","selectedItem$",4,"ngIf"],["data-testid","proteomicsIDcolumn",3,"inputItems","itemLabel","ifOutputFirstValue","resetSelection","selectedItem$"],["data-testid","proteomicsIDtype",3,"inputItems","itemLabel","ifOutputFirstValue","resetSelection","selectedItem$"],["class","mt-2",4,"ngIf"],["data-testid","selectAlgorithm",3,"inputItems","itemLabel","ifOutputFirstValue","resetSelection","selectedItem$"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-bordered",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[2,"max-height","40vh"],[1,"font-weight-bold"],[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(t,n){1&t&&(e.TgZ(0,"app-select-item",0),e.NdJ("selectedItem$",function(r){return n.processSelectedQuantitativeSoftware(r)}),e.qZA(),e.TgZ(1,"h5",1),e._uU(2,"Select File from the Quantitative Software:"),e.qZA(),e.TgZ(3,"form",2,3),e.TgZ(5,"div",4),e.TgZ(6,"input",5),e.NdJ("change",function(r){return n.processProteomicsFile(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",6),e.YNc(8,Kn,1,4,"app-select-item",7),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"div",6),e.TgZ(11,"app-select-item",8),e.NdJ("selectedItem$",function(r){return n.processSelectedProteinIDColumn(r)}),e.qZA(),e.qZA(),e.TgZ(12,"div",6),e.TgZ(13,"app-select-item",9),e.NdJ("selectedItem$",function(r){return n.processSelectedProteinIDtype(r)}),e.qZA(),e.qZA(),e.YNc(14,ns,12,6,"div",10),e.ALo(15,"async")),2&t&&(e.Q6J("inputItems",n.quantitativeSoftwares)("itemLabel","Quantitative Software")("ifOutputFirstValue",!0)("resetSelection",n.resetSelection),e.xp6(6),e.Udp("width",n.formWidth),e.Q6J("ngbTooltip",n.defaultQuantitativeFileName),e.xp6(2),e.Q6J("ngIf","MaxQuant"===e.lcZ(9,17,n.quantitativeSoftware$)),e.xp6(3),e.Q6J("inputItems",n.possibleIDcolumns)("itemLabel","Protein ID Column")("ifOutputFirstValue",!0)("resetSelection",n.resetSelection),e.xp6(2),e.Q6J("inputItems",n.availableProteomicsIDtypes)("itemLabel","Protein ID Type")("ifOutputFirstValue",!0)("resetSelection",n.resetSelection),e.xp6(1),e.Q6J("ngIf",e.lcZ(15,19,n.firstLines$)))},directives:[Ke.y,u._Y,u.JL,u.F,b._L,a.O5,a.sg],pipes:[a.Ov,Ze.K],styles:[""],changeDetection:0}),i})();var os=p(1954);function rs(i,s){if(1&i&&e._uU(0),2&i){const t=e.oxw().$implicit;e.hij(" ",t.controls.newName.value," ")}}function as(i,s){1&i&&(e.TgZ(0,"p",11),e._uU(1," Sample name should not be empty "),e.qZA())}function ls(i,s){if(1&i&&(e._UZ(0,"input",9),e.YNc(1,as,2,0,"p",10)),2&i){const t=e.oxw().index,n=e.oxw(2);e.Q6J("formControl",n.getControl(t,"newName")),e.xp6(1),e.Q6J("ngIf",null==n.getControl(t,"newName").errors?null:n.getControl(t,"newName").errors.required)}}function ps(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.TgZ(4,"app-editable",6),e.NdJ("update",function(){const r=e.CHM(t).index;return e.oxw(2).updateSampleName(r,"newName")}),e.YNc(5,rs,1,1,"ng-template",7),e.YNc(6,ls,2,2,"ng-template",8),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t.controls.rawName.value," ")}}function cs(i,s){if(1&i&&(e.TgZ(0,"table",3),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e.TgZ(3,"th"),e._uU(4,"Raw Sample Name"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"New Sample Name"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"tbody",4),e.YNc(8,ps,7,1,"tr",5),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.sampleNameFormArray.controls)}}let us=(()=>{class i{constructor(){this.resetToDefault=!1,this.rawNames2newNames$=new e.vpe}ngOnInit(){if(this.rawSampleNames){const t=this.rawSampleNames.map(n=>new u.cw({rawName:new u.NI(n,[u.kI.required]),newName:new u.NI(n,[u.kI.required])}));this.sampleNameFormArray=new u.Oe(t)}}ngOnChanges(t){if(t.rawSampleNames&&!t.rawSampleNames.isFirstChange()){const n=this.rawSampleNames.map(o=>new u.cw({rawName:new u.NI(o,[u.kI.required]),newName:new u.NI(o,[u.kI.required])}));this.sampleNameFormArray=new u.Oe(n)}t.resetToDefault&&!t.resetToDefault.isFirstChange()&&this.rawNames2newNames$.next(null)}getControl(t,n){return this.sampleNameFormArray.at(t).get(n)}updateSampleName(t,n){const o=new Map;this.sampleNameFormArray.value.forEach(r=>{o.set(r.rawName,r.newName)}),this.rawNames2newNames$.next(o)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-rename-samples-manually"]],inputs:{rawSampleNames:"rawSampleNames",resetToDefault:"resetToDefault"},outputs:{rawNames2newNames$:"rawNames2newNames$"},features:[e.TTD],decls:4,vars:1,consts:[[1,"table-responsive",2,"max-height","40vh"],[1,"text-info"],["class","table",4,"ngIf"],[1,"table"],[2,"max-height","500px"],[4,"ngFor","ngForOf"],["initialMode","view",3,"update"],["appEditableView",""],["appEditableEdit",""],["appEditableOnEnter","","appFocusable","","ngDefaultControl","","required","",3,"formControl"],["style","color: red",4,"ngIf"],[2,"color","red"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p",1),e._uU(2,"Double click to input new sample name"),e.qZA(),e.YNc(3,cs,9,1,"table",2),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",n.sampleNameFormArray))},directives:[a.O5,a.sg,se,ie,ne,u.Fj,me,we,u.Q7,u.JJ,u.oH],styles:[""],changeDetection:0}),i})(),nt=(()=>{class i extends te.S{constructor(){super()}obtainRawtoNew(){let t=new Map;return this.textMatrix.slice(1,this.textMatrix.length+1).forEach(o=>{t.set(o[0],o[1])}),(0,de.of)(t)}determineIfSamplesAreEqual(t){const o=[...this.textLines].slice(1,this.textLines.length+1).map(r=>r.split("\t")[0]);return(0,de.of)((0,A.z7)(t,o))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();const ms=["fileForm"];function ds(i,s){1&i&&(e.TgZ(0,"p",7),e._uU(1,"Samples in the mapping file are not the same as those in the quantification file"),e.qZA())}function hs(i,s){if(1&i&&(e.TgZ(0,"th"),e.TgZ(1,"p",11),e._uU(2),e.qZA(),e.qZA()),2&i){const t=s.$implicit;e.xp6(2),e.hij(" ",t," ")}}function fs(i,s){if(1&i&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function gs(i,s){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,fs,2,1,"td",10),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function _s(i,s){if(1&i&&(e.TgZ(0,"div"),e.TgZ(1,"div",8),e.TgZ(2,"table",9),e.TgZ(3,"thead"),e.TgZ(4,"tr"),e.YNc(5,hs,3,1,"th",10),e.ALo(6,"async"),e.qZA(),e.qZA(),e.TgZ(7,"tbody"),e.YNc(8,gs,2,1,"tr",10),e.ALo(9,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",e.lcZ(6,2,t.fileHeaders$)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(9,4,t.firstLines$))}}let ys=(()=>{class i{constructor(t){this.mappingFileService=t,this.rawSampleNames=[],this.resetToDefault=!1,this.rawNames2newNames$=new e.vpe,this.fileHeaders$=new R.y(null),this.fileHeadersFromReset$=new g.X(null),this.firstLines$=new R.y(null),this.firstLinesFromReset$=new g.X(null),this.destroyNotifier$=new P.xQ}ngOnInit(){this.firstLines$=(0,Y.T)(this.firstLinesFromReset$,this.mappingFileService.firstLines$).pipe((0,x.R)(this.destroyNotifier$)),this.fileHeaders$=(0,Y.T)(this.fileHeadersFromReset$,this.mappingFileService.fileHeaders$).pipe((0,x.R)(this.destroyNotifier$)),this.ifShowSamplesNote$=this.firstLines$.pipe((0,m.h)(t=>null!=t),(0,J.w)(t=>this.mappingFileService.determineIfSamplesAreEqual(this.rawSampleNames)),(0,Z.U)(t=>!t),(0,Q.O)(!1)),this.ifShowSamplesNote$.pipe((0,m.h)(t=>null!=t),(0,m.h)(t=>!t),(0,J.w)(t=>this.mappingFileService.obtainRawtoNew())).subscribe(t=>{this.rawNames2newNames$.next(t)})}ngOnChanges(t){t.resetToDefault&&!t.resetToDefault.isFirstChange()&&this.resetToDefault&&this._resetThisComponent()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedFile(t){this.mappingFileService.initLoadedFile(t)}_resetThisComponent(){this._resetSelectedFile(),this.fileHeadersFromReset$.next(null),this.firstLinesFromReset$.next(null),this.rawNames2newNames$.next(null)}_resetSelectedFile(){this.fileForm.nativeElement.reset()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(nt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-rename-samples-with-mapping-file"]],viewQuery:function(t,n){if(1&t&&e.Gf(ms,7),2&t){let o;e.iGM(o=e.CRH())&&(n.fileForm=o.first)}},inputs:{rawSampleNames:"rawSampleNames",resetToDefault:"resetToDefault"},outputs:{rawNames2newNames$:"rawNames2newNames$"},features:[e._Bn([nt]),e.TTD],decls:12,vars:6,consts:[[1,"text-info"],["role","form"],["fileForm",""],[1,"form-group"],["data-testid","selectRenameFile","type","file",1,"form-control","form-control-sm",3,"change"],["data-testid","notEqualNote","class","text-danger",4,"ngIf"],[4,"ngIf"],["data-testid","notEqualNote",1,"text-danger"],[1,"table-responsive","mr-2","ml-2"],[1,"table","table-bordered","mt-2",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"p",0),e._uU(1,"The sample names from the quantification file should be in the first column, and the renamed ones in the second column."),e.qZA(),e.TgZ(2,"form",1,2),e.TgZ(4,"div",3),e.TgZ(5,"h5"),e._uU(6,"Samples Name Mapping File:"),e.qZA(),e.TgZ(7,"input",4),e.NdJ("change",function(r){return n.processSelectedFile(r)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(8,ds,2,0,"p",5),e.ALo(9,"async"),e.YNc(10,_s,10,6,"div",6),e.ALo(11,"async")),2&t&&(e.xp6(8),e.Q6J("ngIf",e.lcZ(9,2,n.ifShowSamplesNote$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(11,4,n.firstLines$)))},directives:[u._Y,u.JL,u.F,a.O5,a.sg],pipes:[a.Ov],styles:[""],changeDetection:0}),i})();function Ss(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-rename-samples-manually",2),e.NdJ("rawNames2newNames$",function(o){return e.CHM(t),e.oxw().processRawNames2newNames(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("rawSampleNames",t.rawSampleNames)("resetToDefault",t.resetToDefault)}}function xs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-rename-samples-with-mapping-file",2),e.NdJ("rawNames2newNames$",function(o){return e.CHM(t),e.oxw().processRawNames2newNames(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("rawSampleNames",t.rawSampleNames)("resetToDefault",t.resetToDefault)}}let bs=(()=>{class i{constructor(){this.resetToDefault=!1,this.rawNames2newNames$=new e.vpe,this.methodsForRenameSamples=["Rename Manually","Rename Using Mapping File"]}ngOnInit(){}ngOnChanges(t){t.resetToDefault&&t.resetToDefault.isFirstChange()}processSelectedRenameMethod(t){this.renameMethod=t}processRawNames2newNames(t){this.rawNames2newNames$.next(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-rename-sample-names"]],inputs:{rawSampleNames:"rawSampleNames",resetToDefault:"resetToDefault"},outputs:{rawNames2newNames$:"rawNames2newNames$"},features:[e.TTD],decls:3,vars:6,consts:[["data-testid","renameMethod",3,"inputItems","itemLabel","formInlineOrNot","resetToDefault","selectedItem$"],["appTableHeaderBodySameWidth","",3,"rawSampleNames","resetToDefault","rawNames2newNames$",4,"ngIf"],["appTableHeaderBodySameWidth","",3,"rawSampleNames","resetToDefault","rawNames2newNames$"]],template:function(t,n){1&t&&(e.TgZ(0,"app-select-between-two-using-radio",0),e.NdJ("selectedItem$",function(r){return n.processSelectedRenameMethod(r)}),e.qZA(),e.YNc(1,Ss,1,2,"app-rename-samples-manually",1),e.YNc(2,xs,1,2,"app-rename-samples-with-mapping-file",1)),2&t&&(e.Q6J("inputItems",n.methodsForRenameSamples)("itemLabel","Rename Method")("formInlineOrNot",!1)("resetToDefault",n.resetToDefault),e.xp6(1),e.Q6J("ngIf","Rename Manually"===n.renameMethod),e.xp6(1),e.Q6J("ngIf","Rename Using Mapping File"===n.renameMethod))},directives:[os.W,a.O5,us,et.n,ys],styles:[""],changeDetection:0}),i})();var st=p(4816),Fe=p(438);let Ds=(()=>{class i{constructor(){this.formWidth="15rem",this.filterSetting$=new e.vpe,this.percentageSubject=new g.X(null),this.filterTypeSubject=new g.X(null),this.NAsAcceptanceTypes=[{name:"all",description:"Filter NA Based on All Samples"},{name:"alo",description:"NAs of at least 1 Groups Meet Requirement"}],this.destroyNotifier$=new P.xQ}ngOnInit(){(0,q.aj)([this.percentageSubject.pipe((0,m.h)(t=>null!=t)),this.filterTypeSubject.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n])=>({percentage:t,filterType:n})),(0,x.R)(this.destroyNotifier$)).subscribe(t=>{this.filterSetting$.next(t)})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedAcceptanceType(t){this.filterTypeSubject.next(t.name)}processNAacceptancePercentage(t){this.percentageSubject.next(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-proteomics-preprocess-filter-settings"]],inputs:{formWidth:"formWidth"},outputs:{filterSetting$:"filterSetting$"},decls:2,vars:14,consts:[[3,"minValue","maxValue","defaultValue","formInlineOrNot","step","itemLabel","outputNumber$"],[3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","emptyNote","formWidth","selectedItemObject$"]],template:function(t,n){1&t&&(e.TgZ(0,"app-input-number-with-range",0),e.NdJ("outputNumber$",function(r){return n.processNAacceptancePercentage(r)}),e.qZA(),e.TgZ(1,"app-select-item-object",1),e.NdJ("selectedItemObject$",function(r){return n.processSelectedAcceptanceType(r)}),e.qZA()),2&t&&(e.Q6J("minValue",.05)("maxValue",.95)("defaultValue",.3)("formInlineOrNot",!1)("step",.01)("itemLabel","Max Acceptable Percentage of NAs"),e.xp6(1),e.Q6J("inputObjects",n.NAsAcceptanceTypes)("idAttribute","name")("displayAttribute","description")("itemLabel","NAs Acceptance Type")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("emptyNote","no types is available")("formWidth",n.formWidth))},directives:[st.C,Fe.w],styles:[""],changeDetection:0}),i})();function Ts(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-select-item-object",3),e.NdJ("selectedItemObject$",function(o){return e.CHM(t),e.oxw().processMinMethodSubSetting(o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("inputObjects",t.availableMinMethodsSettings)("idAttribute","name")("displayAttribute","description")("itemLabel","Settings for Impute with Minimum Value")("formInlineOrNot",!1)("ifOutputFirstValue",!0)("emptyNote","No MinMethods settings")}}function vs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-input-number-with-range",4),e.NdJ("outputNumber$",function(o){return e.CHM(t),e.oxw().processRandomMethodPercent(o)}),e.qZA()}2&i&&e.Q6J("minValue",.01)("maxValue",.3)("defaultValue",.05)("formInlineOrNot",!1)("step",.01)("itemLabel","Smallest n Percent Value to Construct Random Number")}let Is=(()=>{class i{constructor(t){this.cdr=t,this.imputeSetting$=new e.vpe,this.availableImputeMethods=[{name:"minimum_value_impute",description:"Impute with Minimum Value"},{name:"random_number_impute",description:"impute with Random Number Based on Distribution"},{name:"knn_impute",description:"kNN Imputation"},{name:"group_minimum_value_impute",description:"Impute with Minimum Value of Protein in Group"}],this.availableMinMethodsSettings=[{name:"global",description:"Min of All Samples"},{name:"sample",description:"Min of Each Sample"}]}ngOnInit(){}processSelectedImputeMethod(t){this.imputeMethod=t,("knn_impute"===t.name||"group_minimum_value_impute"===t.name)&&this.imputeSetting$.next({method:t.name}),this.cdr.detectChanges()}processMinMethodSubSetting(t){this.imputeSetting$.next({method:"minimum_value_impute",subSetting:t.name}),this.cdr.detectChanges()}processRandomMethodPercent(t){this.imputeSetting$.next({method:"random_number_impute",subSetting:.02})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-proteomics-preprocess-impute-settings"]],outputs:{imputeSetting$:"imputeSetting$"},decls:3,vars:8,consts:[["data-testid","selectImputeMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","emptyNote","selectedItemObject$"],["class","mt-2","data-testid","selectMinMethodSetting",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","emptyNote","selectedItemObject$",4,"ngIf"],[3,"minValue","maxValue","defaultValue","formInlineOrNot","step","itemLabel","outputNumber$",4,"ngIf"],["data-testid","selectMinMethodSetting",1,"mt-2",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","emptyNote","selectedItemObject$"],[3,"minValue","maxValue","defaultValue","formInlineOrNot","step","itemLabel","outputNumber$"]],template:function(t,n){1&t&&(e.TgZ(0,"app-select-item-object",0),e.NdJ("selectedItemObject$",function(r){return n.processSelectedImputeMethod(r)}),e.qZA(),e.YNc(1,Ts,1,7,"app-select-item-object",1),e.YNc(2,vs,1,6,"app-input-number-with-range",2)),2&t&&(e.Q6J("inputObjects",n.availableImputeMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","Method for Missing Value Impute")("formInlineOrNot",!1)("ifOutputFirstValue",!0),e.xp6(1),e.Q6J("ngIf","minimum_value_impute"===(null==n.imputeMethod?null:n.imputeMethod.name)),e.xp6(1),e.Q6J("ngIf","random_number_impute"===(null==n.imputeMethod?null:n.imputeMethod.name)))},directives:[Fe.w,a.O5,st.C],styles:[""],changeDetection:0}),i})(),Zs=(()=>{class i{constructor(){this.preProcessSettings$=new e.vpe,this.filterSettingsSubject=new g.X(null),this.imputeSettingsSubject=new g.X(null),this.normalizationMethodSubject=new g.X(null),this.normalizationMethod=[{name:"median_normalize",description:"Median Normalization"},{name:"mean_normalize",description:"Mean Normalization"},{name:"max_normalize",description:"Max Normalization"},{name:"fot_normalize",description:"Fot Normalization"},{name:"quantile_normalize",description:"Quantile Normalization"}],this.destroyNotifier$=new P.xQ}ngOnInit(){(0,q.aj)([this.filterSettingsSubject.pipe((0,m.h)(t=>null!=t)),this.imputeSettingsSubject.pipe((0,m.h)(t=>null!=t)),this.normalizationMethodSubject.pipe((0,m.h)(t=>null!=t))]).pipe((0,Z.U)(([t,n,o])=>({filterSettings:t,imputeSettings:n,normalizationMethod:o})),(0,x.R)(this.destroyNotifier$)).subscribe(t=>{this.preProcessSettings$.next(t)})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processFilterSettings(t){this.filterSettingsSubject.next(t)}processImputeSettings(t){this.imputeSettingsSubject.next(t)}processNormalizationMethod(t){this.normalizationMethodSubject.next(t.name)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-proteomics-preprocess-settings"]],inputs:{resetToDefault:"resetToDefault"},outputs:{preProcessSettings$:"preProcessSettings$"},decls:9,vars:7,consts:[[3,"filterSetting$"],[1,"mt-2"],[3,"imputeSetting$"],[3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","emptyNote","selectedItemObject$"]],template:function(t,n){1&t&&(e.TgZ(0,"h4"),e._uU(1,"Filter Proteins With NAs"),e.qZA(),e.TgZ(2,"app-proteomics-preprocess-filter-settings",0),e.NdJ("filterSetting$",function(r){return n.processFilterSettings(r)}),e.qZA(),e.TgZ(3,"h4",1),e._uU(4,"NAs Impute Settings"),e.qZA(),e.TgZ(5,"app-proteomics-preprocess-impute-settings",2),e.NdJ("imputeSetting$",function(r){return n.processImputeSettings(r)}),e.qZA(),e.TgZ(6,"h4",1),e._uU(7,"Normalization Settings"),e.qZA(),e.TgZ(8,"app-select-item-object",3),e.NdJ("selectedItemObject$",function(r){return n.processNormalizationMethod(r)}),e.qZA()),2&t&&(e.xp6(8),e.Q6J("inputObjects",n.normalizationMethod)("idAttribute","name")("displayAttribute","description")("itemLabel","Method")("formInlineOrNot",!0)("ifOutputFirstValue",!0)("emptyNote","No Normalization methods is available"))},directives:[Ds,Is,Fe.w],styles:[""],changeDetection:0}),i})();const Cs=["submitButton"];function As(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 2. Import Quantitative Data "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"app-import-proteomics-quantitative-data",10),e.NdJ("quantificationInfo$",function(o){return e.CHM(t),e.oxw().processProteomicsQuantificationData(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","The file required in this step should be directly from the quantitative software, like PANDA and MaxQuant."),e.xp6(1),e.Q6J("formWidth",t.formWidth)("resetSelection",t.ifResetChildrenSteps.importProteomicsQuantitative)}}function ws(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 3. Rename Samples "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"app-rename-sample-names",11),e.NdJ("rawNames2newNames$",function(o){return e.CHM(t),e.oxw().processRawSampleNames2NewSampleNames(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","optional"),e.xp6(2),e.Q6J("note","The sample names in the quantification file usually contains prefixes or suffixes. We can rename to make them more readable"),e.xp6(1),e.Q6J("rawSampleNames",t.rawSampleNames)("resetToDefault",t.ifResetChildrenSteps.renameSamples)}}function Ns(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 4. Import Phenotype data "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",12),e.qZA(),e.TgZ(5,"div"),e.TgZ(6,"app-import-phenotype-data",13),e.NdJ("phenotypeData$",function(o){return e.CHM(t),e.oxw().processPhenotypeData(o)}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","optional"),e.xp6(2),e.Q6J("note","Phenotype Data contain the annotations of the samples. We can use the sample annotations to define groups"),e.xp6(2),e.Q6J("resetToDefault",t.ifResetChildrenSteps.importPhenotypeData)}}function Os(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"h3",3),e._uU(2," Step 5. Define Groups "),e.qZA(),e.TgZ(3,"app-define-groups",14),e.NdJ("outGroups",function(o){return e.CHM(t),e.oxw().processGroups(o)}),e.ALo(4,"async"),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("phenotypeData",e.lcZ(4,4,t.inputPhenotypeData$))("ifShowSubmitButton",!1)("resetToDefault",t.ifResetChildrenSteps.defineGroups)}}function Fs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step6. Input Preprocess Settings "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"app-proteomics-preprocess-settings",15),e.NdJ("preProcessSettings$",function(o){return e.CHM(t),e.oxw().processPreProcessSettings(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","The preprocess settings will be used to preprocess quantitative values"),e.xp6(1),e.Q6J("resetToDefault",t.ifResetChildrenSteps.inputPreprocessSettings)}}function $s(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",2),e.TgZ(2,"h3",3),e._uU(3," Step 7. Input Dataset name "),e.qZA(),e._UZ(4,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(5,"div",16),e.TgZ(6,"app-click-focus-input",17),e.NdJ("inputString$",function(o){return e.CHM(t),e.oxw().processInputDatasetName(o)}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","We can import multiple datasets. To distinguish them, each should has a unique name. We can select one in later analsyis"),e.xp6(2),e.Q6J("placeholder","Dataset Name")("resetToDefault",t.ifResetChildrenSteps.inputDatasetName)}}function Ms(i,s){1&i&&(e.TgZ(0,"p",18),e._uU(1," Data is uploaded successfully, click one of the apps for later analysis. Importing data may took a long time, you should download the project to local storage before closing the browser and then re-load it to restore your analysis later.\n"),e.qZA())}let Ps=(()=>{class i{constructor(t,n){this.facade=t,this.cdr=n,this.quantitativeSoftwares=["MaxQuant","PANDA","Spectronaut","PD"],this.availableSpecies=K.it,this.formWidth="15rem",this.samplesFilesInfo=[{name:"proteomics with clinical.zip",description:"proteomics data with clinical information"}],this.speciesID$=new g.X(null),this.quantitativeInfo$=new g.X(null),this.samples$=new g.X(null),this.inputPhenotypeData$=new g.X(null),this.groups$=new g.X(null),this.preProcessSettings$=new g.X(null),this.datasetName$=new g.X(null),this.ifShowUploadNoteFromReset$=new g.X(null),this.destroyNotifier$=new P.xQ,this.steps=[{stepName:"defineSpecies",upStep:"",nextStep:"importProteomicsQuantitative",resetChildren:!1},{stepName:"importProteomicsQuantitative",upStep:"defineSpecies",nextStep:"renameSamples",resetChildren:!1},{stepName:"renameSamples",upStep:"importProteomicsQuantitative",nextStep:"importPhenotypeData",resetChildren:!1},{stepName:"importPhenotypeData",upStep:"renameSamples",nextStep:"defineGroups",resetChildren:!1},{stepName:"defineGroups",upStep:"importPhenotypeData",nextStep:"inputPreprocessSettings",resetChildren:!1},{stepName:"inputPreprocessSettings",upStep:"importPhenotypeData",nextStep:"inputDatasetName",resetChildren:!1},{stepName:"inputDatasetName",upStep:"inputPreprocessSettings",nextStep:"clickSubmitButton",resetChildren:!1},{stepName:"clickSubmitButton",upStep:"inputDatasetName",nextStep:"",resetChildren:!1}],this.ifResetChildrenSteps={defineSpecies:!1,importProteomicsQuantitative:!1,renameSamples:!1,importPhenotypeData:!1,defineGroups:!1,inputPreprocessSettings:!1,inputDatasetName:!1,clickSubmitButton:!1},this.ifShowSteps={defineSpecies:!0,importProteomicsQuantitative:!1,renameSamples:!1,importPhenotypeData:!1,defineGroups:!1,inputPreprocessSettings:!1,inputDatasetName:!1,clickSubmitButton:!1}}ngOnInit(){}ngAfterViewInit(){this.ifSubmitAvailable$=(0,q.aj)([this.speciesID$,this.quantitativeInfo$,this.samples$,this.inputPhenotypeData$,this.groups$,this.preProcessSettings$,this.datasetName$]).pipe((0,Z.U)(([t,n,o,r,l,c,_])=>!!(t&&n&&o&&r&&l&&c&&_)),(0,Se.b)(()=>{this.cdr.detectChanges()}),(0,Q.O)(!1),(0,x.R)(this.destroyNotifier$)),(0,q.aj)([this.speciesID$,this.quantitativeInfo$,this.samples$,this.inputPhenotypeData$,this.groups$,this.preProcessSettings$,this.datasetName$]).subscribe(([t,n,o,r,l,c,_])=>{t&&this._displayNextStepOfCurrentStep("defineSpecies"),t&&n&&this._displayNextStepOfCurrentStep("importProteomicsQuantitative"),t&&n&&o&&this._displayNextStepOfCurrentStep("renameSamples"),t&&n&&o&&r&&this._displayNextStepOfCurrentStep("importPhenotypeData"),t&&n&&o&&r&&l&&this._displayNextStepOfCurrentStep("defineGroups"),t&&n&&o&&r&&l&&c&&this._displayNextStepOfCurrentStep("inputPreprocessSettings")}),this.submitStream$=(0,G.R)(this.submitButton.nativeElement,"click"),this.submitStream$.pipe((0,m.h)(t=>null!=t),(0,x.R)(this.destroyNotifier$),De(500),(0,j.M)(this.speciesID$.pipe((0,m.h)(t=>null!=t)),this.quantitativeInfo$.pipe((0,m.h)(t=>null!=t)),this.samples$.pipe((0,m.h)(t=>null!=t)),this.inputPhenotypeData$.pipe((0,m.h)(t=>null!=t)),this.groups$.pipe((0,m.h)(t=>null!=t)),this.preProcessSettings$.pipe((0,m.h)(t=>null!=t)),this.datasetName$.pipe((0,m.h)(t=>null!=t)))).subscribe(([t,n,o,r,l,c,_,f])=>{const C={expressLocalOrRemote:z.M.local,datasetID:f,description:f,speciesID:n,experimentType:"Protein profiling by Mass Spec",IDtype:o.proteinIDtype,samples:r,groups:c},U={datasetID:f,proteinIDs:o.proteinIDs,samples:r,phenotypeData:l,groups:c,samples2intensities:(0,A.D)(o.intensityInfo.values,r),preprocessSettings:_};this.facade.addDatasetInfo(C),this.facade.addProteomicsExpressData(U),this.facade.requestDatabaseGeneID2info({speciesID:n,idType:o.proteinIDtype})}),this.ifShowUploadNote$=(0,Y.T)(this.facade.theLatestAddedDatasetID$.pipe((0,m.h)(t=>null!=t),(0,j.M)(this.datasetName$.pipe((0,m.h)(t=>null!=t))),(0,Z.U)(([t,n])=>t===n),(0,x.R)(this.destroyNotifier$),(0,Q.O)(!1)),this.ifShowUploadNoteFromReset$)}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedSpecies(t){t&&(this.speciesID$.next(t.taxID),this._resetFollowingSteps("defineSpecies"))}processProteomicsQuantificationData(t){this.quantitativeInfo$.next(t),t?(this.rawSampleNames=[...t.intensityInfo.intensityHeaders],this.samples$.next(this.rawSampleNames),this.inputPhenotypeData$.next({samples:this.rawSampleNames}),this._resetFollowingSteps("importProteomicsQuantitative"),this.cdr.detectChanges()):(this.rawSampleNames=[],this.samples$.next(this.rawSampleNames),this.inputPhenotypeData$.next(null),this.cdr.detectChanges())}processRawSampleNames2NewSampleNames(t){if(t){const n=this.rawSampleNames.map(o=>t.get(o));this.samples$.next(n),this.inputPhenotypeData$.next({samples:n}),this._resetFollowingSteps("renameSamples")}}processPhenotypeData(t){t&&(this.inputPhenotypeData$.next(t),this._resetFollowingSteps("importPhenotypeData"))}processGroups(t){this.groups$.next(t),this._resetFollowingSteps("defineGroups")}processPreProcessSettings(t){this.preProcessSettings$.next(t),this._resetFollowingSteps("inputPreprocessSettings")}processInputDatasetName(t){this.datasetName$.next(t),this._resetFollowingSteps("inputDatasetName")}_resetFollowingSteps(t){let n=[],o=!1;this.steps.forEach((r,l)=>{r.stepName===t?(n.push(Object.assign(Object.assign({},r),{resetChildren:!1})),this.ifResetChildrenSteps[r.stepName]=!1,o=!0):o?(n.push(Object.assign(Object.assign({},r),{resetChildren:!0})),this.ifResetChildrenSteps[r.stepName]=!0):(n.push(Object.assign(Object.assign({},r),{resetChildren:!1})),this.ifResetChildrenSteps[r.stepName]=!1)}),this.steps=[...n],this.ifResetChildrenSteps=Object.assign({},this.ifResetChildrenSteps),this.ifShowUploadNoteFromReset$.next(!1)}_displayNextStepOfCurrentStep(t){let n;this.steps.forEach((r,l)=>{r.stepName===t&&(n=l+1)}),this.ifShowSteps[this.steps[n].stepName]=!0,this.ifShowSteps=Object.assign({},this.ifShowSteps),this.cdr.detectChanges()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-proteomics"]],viewQuery:function(t,n){if(1&t&&e.Gf(Cs,7),2&t){let o;e.iGM(o=e.CRH())&&(n.submitButton=o.first)}},decls:20,vars:18,consts:[[1,"mt-4","p-2","border"],[3,"fileInfos"],[1,"d-flex"],[3,"appAddRequiredOptionalSign"],[1,"align-self-center","ml-3","questionMark",3,"note"],[3,"availableSpecies","ifOutputFirstValue","formWidth","selectedSpecies$"],["class","mt-4 p-2 border",4,"ngIf"],["data-testid","submitProteomics",1,"mt-4","p-2","btn","btn-expressvis",3,"disabled"],["submitButton",""],["data-testid","uploadNote","class","text-success",4,"ngIf"],[3,"formWidth","resetSelection","quantificationInfo$"],[3,"rawSampleNames","resetToDefault","rawNames2newNames$"],[1,"align-self-enter","ml-3","questionMark",3,"note"],["data-testid","loadPhenotype",3,"resetToDefault","phenotypeData$"],[3,"phenotypeData","ifShowSubmitButton","resetToDefault","outGroups"],[3,"resetToDefault","preProcessSettings$"],[1,"mt-2"],["data-testid","inputDatasetName",3,"placeholder","resetToDefault","inputString$"],["data-testid","uploadNote",1,"text-success"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-download-sample-data",1),e.qZA(),e.TgZ(2,"div",0),e.TgZ(3,"div",2),e.TgZ(4,"h3",3),e._uU(5," Step 1. Select Species "),e.qZA(),e._UZ(6,"app-display-notes-with-question-mark",4),e.qZA(),e.TgZ(7,"app-select-species",5),e.NdJ("selectedSpecies$",function(r){return n.processSelectedSpecies(r)}),e.qZA(),e.qZA(),e.YNc(8,As,6,4,"div",6),e.YNc(9,ws,6,4,"div",6),e.YNc(10,Ns,7,3,"div",6),e.YNc(11,Os,5,6,"div",6),e.YNc(12,Fs,6,3,"div",6),e.YNc(13,$s,7,4,"div",6),e.TgZ(14,"button",7,8),e.ALo(16,"async"),e._uU(17,"Submit Data\n"),e.qZA(),e.YNc(18,Ms,2,0,"p",9),e.ALo(19,"async")),2&t&&(e.xp6(1),e.Q6J("fileInfos",n.samplesFilesInfo),e.xp6(3),e.Q6J("appAddRequiredOptionalSign","required"),e.xp6(2),e.Q6J("note","With the species information, the app can load annotations of the proteins in the dataset"),e.xp6(1),e.Q6J("availableSpecies",n.availableSpecies)("ifOutputFirstValue",!1)("formWidth",n.formWidth),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.importProteomicsQuantitative),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.renameSamples),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.importPhenotypeData),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.defineGroups),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.inputPreprocessSettings),e.xp6(1),e.Q6J("ngIf",n.ifShowSteps.inputDatasetName),e.xp6(1),e.Q6J("disabled",!e.lcZ(16,14,n.ifSubmitAvailable$)),e.xp6(4),e.Q6J("ngIf",!!e.lcZ(19,16,n.ifShowUploadNote$)))},directives:[Te,ve,ze,Ie.a,a.O5,ss,bs,Ce,Ne,Zs,Oe],pipes:[a.Ov],styles:[".questionMark[_ngcontent-%COMP%]{margin-bottom:.5rem}"]}),i})();function qs(i,s){1&i&&(e.TgZ(0,"p",4),e._uU(1," Your project have been loaded successfully. Click one app to continue your exploration\n"),e.qZA())}let Es=(()=>{class i{constructor(t,n){this.facade=t,this.cdr=n,this.datasetIDsToBeLoaded=[],this.ifShowLoadSuccessNote=!1}ngOnInit(){this.facade.allDatasetInfoForDisplay$.pipe((0,m.h)(Boolean)).subscribe(t=>{if((null==t?void 0:t.length)>=1){const n=t.map(o=>o.datasetID);this.ifShowLoadSuccessNote=(0,A.z7)(n,this.datasetIDsToBeLoaded),this.cdr.detectChanges()}})}ngOnChanges(t){}processSelectedProjectJsonFile(t){const n=t.target.files[0],o=new FileReader;o.readAsText(n),o.onload=r=>{const c=JSON.parse(o.result);this.datasetIDsToBeLoaded=c.datasetListState.ids,this.facade.prepareLocalProject(c)}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-load-existed-project"]],features:[e.TTD],decls:8,vars:1,consts:[["border","",1,"mt-4","p-1"],["data-testid","loadLocalProject",1,"mt-2"],["type","file",1,"form-control","form-control-sm",3,"change"],["class","mt-2 p-1",4,"ngIf"],[1,"mt-2","p-1"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"p"),e._uU(2,"Load the project downloaded before to restore your analysis"),e.qZA(),e.qZA(),e.TgZ(3,"div",1),e.TgZ(4,"h5"),e._uU(5,"Project Json File Downloaded Before:"),e.qZA(),e.TgZ(6,"input",2),e.NdJ("change",function(r){return n.processSelectedProjectJsonFile(r)}),e.qZA(),e.qZA(),e.YNc(7,qs,2,0,"p",3)),2&t&&(e.xp6(7),e.Q6J("ngIf",n.ifShowLoadSuccessNote))},directives:[a.O5],styles:[""]}),i})();function Us(i,s){1&i&&e._UZ(0,"app-import-rna-seq")}function Js(i,s){1&i&&e._UZ(0,"app-import-microarray")}function Rs(i,s){1&i&&e._UZ(0,"app-import-proteomics")}function Qs(i,s){1&i&&e._UZ(0,"app-load-existed-project")}const he=function(i){return{active:i}},Gs=[{path:"",component:(()=>{class i{constructor(t){this.importDataFacade=t,this.dataType="Proteomics"}ngOnInit(){this.allDatasetInfoForDisplay$=this.importDataFacade.allDatasetInfoForDisplay$,this.phenotypeData$=this.importDataFacade.currentExpressDataPhenotypeData$}setActiveDataType(t){this.dataType=t}processGroups(t){this.importDataFacade.updateDatasetGroups(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-import-data"]],decls:23,vars:19,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-3","col-xl-2","border-right","bd-sidebar"],[3,"datasets"],[1,"col-sm-12","col-md-9","col-xl-9","border-right","mb-5","bd-content"],["data-testid","differentDataSource",1,"nav","nav-tabs"],[1,"nav-item"],["href","javascript:void(0)",1,"nav-link",3,"ngClass","click"],[4,"ngIf"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"app-present-datasets",3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"nav",5),e.TgZ(7,"li",6),e.TgZ(8,"a",7),e.NdJ("click",function(){return n.setActiveDataType("rnaseq")}),e._uU(9,"RNA-seq"),e.qZA(),e.qZA(),e.TgZ(10,"li",6),e.TgZ(11,"a",7),e.NdJ("click",function(){return n.setActiveDataType("microarray")}),e._uU(12,"Microarray"),e.qZA(),e.qZA(),e.TgZ(13,"li",6),e.TgZ(14,"a",7),e.NdJ("click",function(){return n.setActiveDataType("Proteomics")}),e._uU(15,"Proteomics"),e.qZA(),e.qZA(),e.TgZ(16,"li",6),e.TgZ(17,"a",7),e.NdJ("click",function(){return n.setActiveDataType("localProject")}),e._uU(18,"Local Project"),e.qZA(),e.qZA(),e.qZA(),e.YNc(19,Us,1,0,"app-import-rna-seq",8),e.YNc(20,Js,1,0,"app-import-microarray",8),e.YNc(21,Rs,1,0,"app-import-proteomics",8),e.YNc(22,Qs,1,0,"app-load-existed-project",8),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("datasets",e.lcZ(4,9,n.allDatasetInfoForDisplay$)),e.xp6(5),e.Q6J("ngClass",e.VKq(11,he,"rnaseq"===n.dataType)),e.xp6(3),e.Q6J("ngClass",e.VKq(13,he,"microarray"===n.dataType)),e.xp6(3),e.Q6J("ngClass",e.VKq(15,he,"Proteomics"===n.dataType)),e.xp6(3),e.Q6J("ngClass",e.VKq(17,he,"localProject"===n.dataType)),e.xp6(2),e.Q6J("ngIf","rnaseq"===n.dataType),e.xp6(1),e.Q6J("ngIf","microarray"===n.dataType),e.xp6(1),e.Q6J("ngIf","Proteomics"===n.dataType),e.xp6(1),e.Q6J("ngIf","localProject"===n.dataType))},directives:[Jt,a.mk,a.O5,Dn,Qn,Ps,Es],pipes:[a.Ov],styles:[""]}),i})(),data:{key:"importData"}}];let Ls=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[qe.Bz.forChild(Gs)],qe.Bz]}),i})(),js=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[X],imports:[[a.ez,d.JF,u.u5,u.UX,O.zk.forRoot(),b.ZQ,b.lQ,b.Oz,b.HK,D._t,v.uH,H.forRoot(),gt.r,_t.f,yt.m,Ls]]}),i})()},4250:(V,$,p)=>{p.d($,{u:()=>y});var a=p(3668),d=p(9133),u=p(5043),O=p(5686),b=p(5389),v=p(8053),D=p(6019),S=p(3856),I=p(8638);function w(N,h){if(1&N&&(a.TgZ(0,"option",22),a._uU(1),a.qZA()),2&N){const T=h.$implicit;a.Q6J("value",T),a.xp6(1),a.hij(" ",T," ")}}function M(N,h){if(1&N){const T=a.EpF();a.TgZ(0,"div",9),a.TgZ(1,"div",10),a.TgZ(2,"select",11),a.YNc(3,w,2,2,"option",12),a.qZA(),a.TgZ(4,"select",13),a.TgZ(5,"option",14),a._uU(6,"contains"),a.qZA(),a.TgZ(7,"option",15),a._uU(8,"does not contain"),a.qZA(),a.TgZ(9,"option",16),a._uU(10,"is"),a.qZA(),a.TgZ(11,"option",17),a._uU(12,"is not"),a.qZA(),a.TgZ(13,"option",18),a._uU(14,"is up"),a.qZA(),a.TgZ(15,"option",19),a._uU(16,"is down"),a.qZA(),a.qZA(),a._UZ(17,"input",20),a.TgZ(18,"fa-icon",21),a.NdJ("click",function(){const $e=a.CHM(T).index;return a.oxw().removeFilterStep($e)}),a.qZA(),a.qZA(),a.qZA()}if(2&N){const T=h.index,E=a.oxw();a.Q6J("formGroupName",T),a.xp6(3),a.Q6J("ngForOf",E.dataAttributes),a.xp6(15),a.Q6J("icon",E.faMinusCircle)("size","1x")}}let y=(()=>{class N{constructor(T){this.formBuilder=T,this.filterStepsInfo$=new a.vpe,this.faPlusCircle=u.KtF,this.faMinusCircle=u.uMC,this.filterStepsForm=this.formBuilder.group({filterSteps:this.formBuilder.array([this._createFilterStepFormGroup()]),matchType:new d.NI("and")})}ngOnInit(){this.filterStepsSubscription=this.filterStepsForm.valueChanges.pipe((0,O.b)(500),(0,b.x)(),(0,v.U)(T=>{const E=T.filterSteps.filter(ee=>ee.attribute&&ee.filterValue);return{matchType:T.matchType,filterSteps:E}}),(0,b.x)((T,E)=>JSON.stringify(T)===JSON.stringify(E))).subscribe(T=>{this.filterStepsInfo$.next(T)})}ngOnDestroy(){this.filterStepsSubscription.unsubscribe()}addFilterStepFormGroup(){this.filterStepsForm.get("filterSteps").push(this._createFilterStepFormGroup())}removeFilterStep(T){this.filterStepsForm.get("filterSteps").removeAt(T)}_createFilterStepFormGroup(){return new d.cw({attribute:new d.NI("",d.kI.required),filterType:new d.NI("contain"),filterValue:new d.NI("",d.kI.required)})}}return N.\u0275fac=function(T){return new(T||N)(a.Y36(d.qu))},N.\u0275cmp=a.Xpm({type:N,selectors:[["app-define-filter-steps"]],inputs:{dataAttributes:"dataAttributes"},outputs:{filterStepsInfo$:"filterStepsInfo$"},decls:12,vars:5,consts:[[3,"formGroup"],["formArrayName","filterSteps"],[1,"mb-1"],[1,"form-inline"],[1,"form-control","form-control-sm",3,"formControl"],["value","and"],["value","or"],[3,"formGroupName",4,"ngFor","ngForOf"],["ngbTooltip","add a filter step",1,"hoverBigger","mt-1","ml-1",3,"icon","size","click"],[3,"formGroupName"],[1,"form-inline","form-group-sm"],["formControlName","attribute","data-testid","selectAttribute",1,"form-control","form-control-sm",2,"width","6rem"],[3,"value",4,"ngFor","ngForOf"],["formControlName","filterType",1,"form-control","form-control-sm",2,"width","8rem"],["value","contain"],["value","notContain"],["value","is"],["value","isNot"],["value","up"],["value","down"],["formControlName","filterValue","type","text","data-testid","inputFilterValue",1,"form-control","form-control-sm",2,"width","5rem"],["ngbTooltip","Delete a filter step",1,"ml-1","hoverBigger",3,"icon","size","click"],[3,"value"]],template:function(T,E){1&T&&(a.TgZ(0,"form",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"form",3),a.TgZ(4,"select",4),a.TgZ(5,"option",5),a._uU(6,"Match all (AND)"),a.qZA(),a.TgZ(7,"option",6),a._uU(8,"Match any (OR)"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.YNc(9,M,19,4,"div",7),a.qZA(),a.qZA(),a.TgZ(10,"div",3),a.TgZ(11,"fa-icon",8),a.NdJ("click",function(){return E.addFilterStepFormGroup()}),a.qZA(),a.qZA()),2&T&&(a.Q6J("formGroup",E.filterStepsForm),a.xp6(4),a.Q6J("formControl",E.filterStepsForm.get("matchType")),a.xp6(5),a.Q6J("ngForOf",E.filterStepsForm.get("filterSteps").controls),a.xp6(2),a.Q6J("icon",E.faPlusCircle)("size","1x"))},directives:[d._Y,d.JL,d.sg,d.CE,d.F,d.EJ,d.JJ,d.oH,d.YN,d.Kr,D.sg,S.BN,I._L,d.x0,d.u,d.Fj],styles:[""],changeDetection:0}),N})()},7682:(V,$,p)=>{p.d($,{n:()=>d});var a=p(3668);let d=(()=>{class u{constructor(b,v){this.renderer=b,this.el=v}ngAfterViewInit(){if(this.el.nativeElement.querySelector("table")){this.makeEquealHeaderBodyWidth(),this.tableObserver=new MutationObserver(()=>{this.makeEquealHeaderBodyWidth()}),this.tableObserver.observe(this.el.nativeElement.querySelector("table"),{subtree:!0,childList:!0});const b=this.el.nativeElement.querySelector("div"),v=this.el.nativeElement.querySelector("table"),D=this.el.nativeElement.querySelector("thead"),S=this.el.nativeElement.querySelector("tbody");this.renderer.listen(b,"scroll",I=>{const M=(I.srcElement.scrollLeft+v.offsetWidth).toString()+"px";this.renderer.setStyle(D,"width",M),this.renderer.setStyle(S,"width",M)})}}ngOnDestroy(){this.tableObserver&&(this.tableObserver.disconnect(),this.tableObserver=void 0)}makeEquealHeaderBodyWidth(){let b=[];b=[...this.el.nativeElement.querySelectorAll("thead tr th")].map(S=>S.offsetWidth),this.el.nativeElement.querySelectorAll("tbody tr").forEach(S=>{S.querySelectorAll("td").forEach((I,w)=>{const M=I.offsetWidth;M>=b[w]&&(b[w]=M)})});const D=b.map(S=>S.toString()+"px");this.el.nativeElement.querySelectorAll("thead tr th").forEach((S,I)=>{S.style.minWidth=D[I],S.style.maxWidth=D[I]}),this.el.nativeElement.querySelectorAll("tbody tr").forEach(S=>{S.querySelectorAll("td").forEach((I,w)=>{I.style.minWidth=D[w],I.style.maxWidth=D[w]})})}}return u.\u0275fac=function(b){return new(b||u)(a.Y36(a.Qsj),a.Y36(a.SBq))},u.\u0275dir=a.lG2({type:u,selectors:[["","appTableHeaderBodySameWidth",""]]}),u})()},94:(V,$,p)=>{p.d($,{e:()=>u});var a=p(3405),d=p(3668);let u=(()=>{class O{constructor(){this.destroyNotifier$=new a.xQ}ngOnInit(){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return O.\u0275fac=function(v){return new(v||O)},O.\u0275cmp=d.Xpm({type:O,selectors:[["app-base-with-destroynotifier"]],decls:2,vars:0,template:function(v,D){1&v&&(d.TgZ(0,"p"),d._uU(1,"base-with-destroynotifier works!"),d.qZA())},styles:[""],changeDetection:0}),O})()},4816:(V,$,p)=>{p.d($,{C:()=>v});var a=p(3668),d=p(9133),u=p(3405),O=p(6019);const b=function(D){return{"form-inline":D}};let v=(()=>{class D{constructor(I){this.cdr=I,this.formInlineOrNot=!1,this.outputNumber$=new a.vpe,this.destroyNotifier$=new u.xQ,this.numberForm=new d.cw({value:new d.NI("",d.kI.required)})}ngOnInit(){this.numberForm.valueChanges.subscribe(I=>{this.inputValue=parseFloat(I.value),this.outputNumber$.next(this.inputValue),this.cdr.detectChanges()}),this.inputValue=this.defaultValue,this.numberForm.patchValue({value:this.defaultValue})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return D.\u0275fac=function(I){return new(I||D)(a.Y36(a.sBO))},D.\u0275cmp=a.Xpm({type:D,selectors:[["app-input-number-with-range"]],inputs:{minValue:"minValue",maxValue:"maxValue",defaultValue:"defaultValue",formInlineOrNot:"formInlineOrNot",step:"step",numberFormat:"numberFormat",itemLabel:"itemLabel"},outputs:{outputNumber$:"outputNumber$"},decls:5,vars:8,consts:[[1,"mr-3","align-self-start",3,"ngClass","formGroup"],["formControlName","value","type","range","step","0.01",1,"form-control","form-control-sm",2,"width","10em",3,"min","max"]],template:function(I,w){1&I&&(a.TgZ(0,"form",0),a.TgZ(1,"h5"),a._uU(2),a.qZA(),a._UZ(3,"input",1),a._uU(4),a.qZA()),2&I&&(a.Q6J("ngClass",a.VKq(6,b,w.formInlineOrNot))("formGroup",w.numberForm),a.xp6(2),a.hij("",w.itemLabel,":"),a.xp6(1),a.Q6J("min",w.minValue)("max",w.maxValue),a.xp6(1),a.hij(" ",100*w.inputValue,"%\n"))},directives:[d._Y,d.JL,O.mk,d.sg,d.Fj,d.eT,d.JJ,d.u],styles:[""],changeDetection:0}),D})()},1954:(V,$,p)=>{p.d($,{W:()=>M});var a=p(3668),d=p(9133),u=p(3405),O=p(8735),b=p(8805),v=p(5389),D=p(6019);function S(y,N){if(1&y&&(a.TgZ(0,"h5"),a._uU(1),a.qZA()),2&y){const h=a.oxw(2);a.xp6(1),a.hij("",h.itemLabel,":")}}const I=function(y){return{"form-inline":y}};function w(y,N){if(1&y&&(a.TgZ(0,"form",1),a.TgZ(1,"div",2),a.YNc(2,S,2,1,"h5",3),a.TgZ(3,"label"),a._UZ(4,"input",4),a.TgZ(5,"span"),a._uU(6),a.qZA(),a.qZA(),a.TgZ(7,"label"),a._UZ(8,"input",4),a.TgZ(9,"span"),a._uU(10),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&y){const h=a.oxw();a.Q6J("formGroup",h.itemForm),a.xp6(1),a.Q6J("ngClass",a.VKq(7,I,h.formInlineOrNot)),a.xp6(1),a.Q6J("ngIf",h.ifShowLabel),a.xp6(2),a.Q6J("value",h.inputItems[0]),a.xp6(2),a.Oqu(h.inputItems[0]),a.xp6(2),a.Q6J("value",h.inputItems[1]),a.xp6(2),a.Oqu(h.inputItems[1])}}let M=(()=>{class y{constructor(h){this.cdr=h,this.inputItems=[],this.formInlineOrNot=!0,this.ifShowLabel=!1,this.resetToDefault=!1,this.selectedItem$=new a.vpe,this.destroyNotifier$=new u.xQ,this.ifOutputFirstValue=!0,this.itemForm=new d.cw({itemValue:new d.NI("",d.kI.required)})}ngOnInit(){this.itemForm.get("itemValue").valueChanges.pipe((0,O.h)(h=>h),(0,b.R)(this.destroyNotifier$),(0,v.x)()).subscribe(h=>{"VALID"===this.itemForm.get("itemValue").status&&this.selectedItem$.next(h),this.cdr.detectChanges()}),this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnChanges(h){h.inputItems&&!h.inputItems.isFirstChange()&&this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem(),h.resetToDefault&&!h.resetToDefault.isFirstChange()&&this.resetToDefault&&this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_outputSetFirstItemAsSelctedItem(){this.inputItems&&this.inputItems.length>=1&&this.itemForm.patchValue({itemValue:this.inputItems[0]})}}return y.\u0275fac=function(h){return new(h||y)(a.Y36(a.sBO))},y.\u0275cmp=a.Xpm({type:y,selectors:[["app-select-between-two-using-radio"]],inputs:{inputItems:"inputItems",itemLabel:"itemLabel",formInlineOrNot:"formInlineOrNot",ifShowLabel:"ifShowLabel",resetToDefault:"resetToDefault"},outputs:{selectedItem$:"selectedItem$"},features:[a.TTD],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[3,"ngClass"],[4,"ngIf"],["type","radio","formControlName","itemValue",3,"value"]],template:function(h,T){1&h&&a.YNc(0,w,11,9,"form",0),2&h&&a.Q6J("ngIf",2===T.inputItems.length)},directives:[D.O5,d._Y,d.JL,d.sg,D.mk,d._,d.Fj,d.JJ,d.u],styles:[""],changeDetection:0}),y})()},3013:(V,$,p)=>{p.d($,{y:()=>M});var a=p(3668),d=p(9133),u=p(3405),O=p(8735),b=p(8805),v=p(5389),D=p(6019);function S(y,N){if(1&y&&(a.TgZ(0,"option",5),a._uU(1),a.qZA()),2&y){const h=N.$implicit;a.Q6J("value",h),a.xp6(1),a.hij(" ",h," ")}}function I(y,N){if(1&y&&(a.TgZ(0,"label",6),a._uU(1),a.qZA()),2&y){const h=a.oxw();a.xp6(1),a.hij(" ",h.emptyNote," ")}}const w=function(y){return{"form-inline":y}};let M=(()=>{class y{constructor(h){this.cdr=h,this.formInlineOrNot=!1,this.ifOutputFirstValue=!1,this.resetSelection=!1,this.formWidth="15rem",this.selectedItem$=new a.vpe,this.destroyNotifier$=new u.xQ,this.itemForm=new d.cw({itemValue:new d.NI("",d.kI.required)})}ngOnInit(){this.itemForm.get("itemValue").valueChanges.pipe((0,O.h)(h=>h),(0,b.R)(this.destroyNotifier$),(0,v.x)()).subscribe(h=>{"VALID"===this.itemForm.get("itemValue").status&&this.selectedItem$.next(h.toString()),this.cdr.detectChanges()}),this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem()}ngOnChanges(h){h.inputItems&&!h.inputItems.isFirstChange()&&this.ifOutputFirstValue&&this._outputSetFirstItemAsSelctedItem(),h.resetSelection&&!h.resetSelection.isFirstChange()&&this.resetSelection&&(this.ifOutputFirstValue?this._outputSetFirstItemAsSelctedItem():this._resetAndoutputEmptyItem())}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}_outputSetFirstItemAsSelctedItem(){this.inputItems&&this.inputItems.length>=1&&this.itemForm.patchValue({itemValue:this.inputItems[0]})}_resetAndoutputEmptyItem(){this.itemForm.patchValue({itemValue:""}),this.selectedItem$.next("")}}return y.\u0275fac=function(h){return new(h||y)(a.Y36(a.sBO))},y.\u0275cmp=a.Xpm({type:y,selectors:[["app-select-item"]],inputs:{inputItems:"inputItems",itemLabel:"itemLabel",emptyNote:"emptyNote",formInlineOrNot:"formInlineOrNot",ifOutputFirstValue:"ifOutputFirstValue",resetSelection:"resetSelection",formWidth:"formWidth"},outputs:{selectedItem$:"selectedItem$"},features:[a.TTD],decls:7,vars:9,consts:[[3,"formGroup"],[1,"align-self-start",3,"ngClass"],["formControlName","itemValue","data-testid","selectItem",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["class","text-danger font-weight-light",4,"ngIf"],[3,"value"],[1,"text-danger","font-weight-light"]],template:function(h,T){1&h&&(a.TgZ(0,"form",0),a.TgZ(1,"div",1),a.TgZ(2,"h5"),a._uU(3),a.qZA(),a.TgZ(4,"select",2),a.YNc(5,S,2,2,"option",3),a.qZA(),a.YNc(6,I,2,1,"label",4),a.qZA(),a.qZA()),2&h&&(a.Q6J("formGroup",T.itemForm),a.xp6(1),a.Q6J("ngClass",a.VKq(7,w,T.formInlineOrNot)),a.xp6(2),a.hij("",T.itemLabel,":"),a.xp6(1),a.Udp("width",T.formWidth),a.xp6(1),a.Q6J("ngForOf",T.inputItems),a.xp6(1),a.Q6J("ngIf",!((null==T.inputItems?null:T.inputItems.length)>=1)))},directives:[d._Y,d.JL,d.sg,D.mk,d.EJ,d.JJ,d.u,D.sg,D.O5,d.YN,d.Kr],styles:[""],changeDetection:0}),y})()},4863:(V,$,p)=>{p.d($,{a:()=>b});var a=p(3668),d=p(9133),u=p(6019);function O(v,D){if(1&v&&(a.TgZ(0,"option",3),a._uU(1),a.qZA()),2&v){const S=D.$implicit;a.Q6J("value",S.taxID),a.xp6(1),a.Oqu(S.name+"("+S.taxID+")")}}let b=(()=>{class v{constructor(){this.ifOutputFirstValue=!1,this.formWidth="15rem",this.selectedSpecies$=new a.vpe}ngOnInit(){this.availableSpecies&&this.availableSpecies.length>=1&&this.selectedSpecies$.next(this.ifOutputFirstValue?this.availableSpecies[0]:null)}ngOnChanges(S){S.availableSpecies&&!S.availableSpecies.isFirstChange()&&this.selectedSpecies$.next(this.ifOutputFirstValue?this.availableSpecies[0]:null)}outputSpecies(S){const I=S.target.value;let w;for(let M of this.availableSpecies)if(M.taxID===I){w=M;break}this.selectedSpecies$.next(w)}}return v.\u0275fac=function(S){return new(S||v)},v.\u0275cmp=a.Xpm({type:v,selectors:[["app-select-species"]],inputs:{availableSpecies:"availableSpecies",ifOutputFirstValue:"ifOutputFirstValue",formWidth:"formWidth"},outputs:{selectedSpecies$:"selectedSpecies$"},features:[a.TTD],decls:6,vars:3,consts:[["for","species"],["name","species",1,"form-control","form-control-sm",3,"change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(S,I){1&S&&(a.TgZ(0,"h5",0),a._uU(1,"Species:"),a.qZA(),a.TgZ(2,"select",1),a.NdJ("change",function(M){return I.outputSpecies(M)}),a.TgZ(3,"option"),a._uU(4," --- "),a.qZA(),a.YNc(5,O,2,2,"option",2),a.qZA()),2&S&&(a.xp6(2),a.Udp("width",I.formWidth),a.xp6(3),a.Q6J("ngForOf",I.availableSpecies))},directives:[d.YN,d.Kr,u.sg],styles:[""],changeDetection:0}),v})()}}]);