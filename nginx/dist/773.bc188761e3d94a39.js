"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[773],{3063:(H,M,d)=>{d.d(M,{Q8:()=>B}),d(5139);var b=d(3668);d(3314),d(3405),d(5686);let L=(()=>{class p{create(g){return"undefined"==typeof MutationObserver?null:new MutationObserver(g)}}return p.\u0275fac=function(g){return new(g||p)},p.\u0275prov=(0,b.Yz7)({factory:function(){return new p},token:p,providedIn:"root"}),p})(),B=(()=>{class p{}return p.\u0275fac=function(g){return new(g||p)},p.\u0275mod=b.oAB({type:p}),p.\u0275inj=b.cJS({providers:[L]}),p})()},4146:(H,M,d)=>{d.d(M,{r:()=>X});var t=d(3668),b=d(5043),E=d(6019),N=d(7582),A=d(277),L=d(8638),u=d(9133),v=d(3856);function B(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"th",9),t.NdJ("sort",function(o){return t.CHM(e),t.oxw().onSort(o)}),t._uU(1),t.qZA()}if(2&l){const e=f.$implicit;t.s9C("sortableColumn",e),t.xp6(1),t.hij(" ",e," ")}}function p(l,f){if(1&l&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&l){const e=f.$implicit;t.s9C("title",e),t.xp6(1),t.hij(" ",e," ")}}const y=function(l){return{"background-color":l}};function g(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"tr",10),t.TgZ(1,"td",11),t.NdJ("click",function(){const c=t.CHM(e).index;return t.oxw().processSelectedAnnotation(c)}),t.TgZ(2,"div",12),t._UZ(3,"fa-icon",13),t.qZA(),t.qZA(),t.YNc(4,p,2,2,"td",14),t.TgZ(5,"td",11),t.NdJ("click",function(){const c=t.CHM(e).index;return t.oxw().processSelectedAnnotation(c)}),t.TgZ(6,"div",12),t._UZ(7,"fa-icon",13),t.qZA(),t.qZA(),t.qZA()}if(2&l){const e=f.$implicit,n=f.index,o=t.oxw();t.Q6J("ngStyle",t.VKq(6,y,o.clickedIndex==n?"lightskyblue":"white")),t.xp6(3),t.Q6J("icon",o.faTable)("size","1x"),t.xp6(1),t.Q6J("ngForOf",e),t.xp6(3),t.Q6J("icon",o.faTable)("size","1x")}}let P=(()=>{class l{constructor(e){this.cdr=e,this.selectedAnnotationTermGenes$=new t.vpe,this.annotationTermOrder=1,this.annotationIDOrder=0,this.annotationGenesOrder=-1,this.genesSplitRe=new RegExp(";|,"),this.page=1,this.pageSize=5,this.faTable=b.B3e,this.faArrowUp=b.FPD,this.faArrowDown=b.r5q}ngOnInit(){this.enrichedAnnotationsInfo&&(this._initDataForTable(),this.refreshSubEnrichedValues())}ngOnChanges(e){e.enrichedAnnotationsInfo&&!e.enrichedAnnotationsInfo.isFirstChange()&&(this._initDataForTable(),this.refreshSubEnrichedValues(),this.cdr.detectChanges())}_initDataForTable(){this.annotationGenesOrder=this.enrichedAnnotationsInfo.headers.length-1,this.enrichedValues=this.enrichedAnnotationsInfo.enrichedValues,this.headerNames=this.enrichedAnnotationsInfo.headers,this.collectionSize=this.enrichedValues.length}refreshSubEnrichedValues(){this._obtainSubEnrichedValues(),this._obtainCickedIndex(),this.cdr.detectChanges()}processSelectedAnnotation(e){const n=this.enrichedAnnotationsInfo.enrichedValues[e],o=n[this.annotationTermOrder],c=n[this.annotationGenesOrder].trim().split(this.genesSplitRe);this.selectedAnnotationTermGenes$.next({annotationID:n[this.annotationIDOrder],annotationTerm:o,genes:c}),this.clickedIndex=e,this.clickedAnnotationID=this.subEnrichedValues[e][0],this.cdr.detectChanges()}onSort({column:e,direction:n}){if(this.headers.forEach(o=>{o.sortableColumn!==e&&(o.direction="")}),""!=n||""!=e){const o=this.headerNames.indexOf(e);this.enrichedValues=[...this.enrichedValues].sort((c,_)=>{const F=(0,N.q)(c[o],_[o]);return"asc"===n?F:-F}),this.refreshSubEnrichedValues()}}_obtainCickedIndex(){this.clickedIndex=null;for(let e=0;e<this.subEnrichedValues.length;e++)if(this.subEnrichedValues[e][0]===this.clickedAnnotationID){this.clickedIndex=e;break}}_obtainSubEnrichedValues(){this.subEnrichedValues=this.enrichedValues.slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(t.sBO))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-enriched-annotations-table-pagination"]],viewQuery:function(e,n){if(1&e&&t.Gf(A.Y,5),2&e){let o;t.iGM(o=t.CRH())&&(n.headers=o)}},inputs:{enrichedAnnotationsInfo:"enrichedAnnotationsInfo"},outputs:{selectedAnnotationTermGenes$:"selectedAnnotationTermGenes$"},features:[t.TTD],decls:20,vars:11,consts:[[1,"table-responsive","border",2,"margin-left","10px","margin-right","10px"],[1,"table","table-striped"],["sortable","",3,"sortableColumn","sort",4,"ngFor","ngForOf"],[3,"ngStyle",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center","p-2"],["data-testid","annotationTermsNum"],[3,"collectionSize","page","pageSize","maxSize","pageChange"],[1,"custom-select","mb-3",2,"width","auto",3,"ngModel","ngModelChange"],[3,"ngValue"],["sortable","",3,"sortableColumn","sort"],[3,"ngStyle"],[3,"click"],[1,"form-inline"],["ngbTooltip","Click to Show Genes in this Annotation Term",1,"hoverBigger",3,"icon","size"],[3,"title",4,"ngFor","ngForOf"],[3,"title"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"table",1),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t._UZ(4,"th"),t.YNc(5,B,2,2,"th",2),t._UZ(6,"th"),t.qZA(),t.qZA(),t.TgZ(7,"tbody"),t.YNc(8,g,8,8,"tr",3),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",4),t.TgZ(10,"p",5),t._uU(11),t.qZA(),t.TgZ(12,"ngb-pagination",6),t.NdJ("pageChange",function(c){return n.page=c})("pageChange",function(){return n.refreshSubEnrichedValues()}),t.qZA(),t.TgZ(13,"select",7),t.NdJ("ngModelChange",function(c){return n.pageSize=c})("ngModelChange",function(){return n.refreshSubEnrichedValues()}),t.TgZ(14,"option",8),t._uU(15,"5 per page"),t.qZA(),t.TgZ(16,"option",8),t._uU(17,"10 per page"),t.qZA(),t.TgZ(18,"option",8),t._uU(19,"20 per page"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngForOf",n.enrichedAnnotationsInfo.headers),t.xp6(3),t.Q6J("ngForOf",n.subEnrichedValues),t.xp6(3),t.hij(" ",n.collectionSize," Terms "),t.xp6(1),t.Q6J("collectionSize",n.collectionSize)("page",n.page)("pageSize",n.pageSize)("maxSize",5),t.xp6(1),t.Q6J("ngModel",n.pageSize),t.xp6(1),t.Q6J("ngValue",5),t.xp6(2),t.Q6J("ngValue",10),t.xp6(2),t.Q6J("ngValue",20))},directives:[E.sg,L.N9,u.EJ,u.JJ,u.On,u.YN,u.Kr,A.Y,E.PC,v.BN,L._L],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;display:block}thead[_ngcontent-%COMP%]{text-align:center}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]{text-align:center;display:block}tbody[_ngcontent-%COMP%]{text-align:center;overflow-y:scroll;overflow-x:hidden}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left;height:2em;overflow:hidden;white-space:nowrap}"],changeDetection:0}),l})();var I=d(7682),T=d(383),O=d(8360),i=d(766),s=d(3203);const r=["svgElement"];let h=(()=>{class l{constructor(e){this.computeStringWidthService=e,this.height=300,this.width=300,this.marginTop=40,this.marginBottom=50,this.marginRight=10,this.marginLeft=50,this.gridWidth=200,this.gridHeight=200,this.borderWidth=1,this.barWidth=15,this.barColor="#ff8080",this.paddingInner=.25,this.paddingOuter=.3,this.yLabelFontSize=1,this.yLabelFontStyle="times new roman",this.axisBottomTitleFontSize=20,this.axisBottomLableSize=1,this.geneNumberTextFrontsize=10}ngOnInit(){}ngAfterViewInit(){this.enrichedInfo&&(this._removeGraphic(),this._initSettings(),this._initMap(),this._transformMap(),this._moveGraphic2center())}ngOnChanges(e){e.enrichedInfo&&!e.enrichedInfo.isFirstChange()&&(this._removeGraphic(),this._initSettings(),this._initMap(),this._transformMap(),this._moveGraphic2center())}_initMap(){let e=this;const n=this.enrichedInfo.enrichedTerms;this.d3Svg=(0,i.Z)(e.svgElement.nativeElement).attr("height",e.height).attr("width",e.width);const o=(0,s.tiA)().range([0,e.gridHeight]).domain(n).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter);e.yAxis=this.d3Svg.append("g").attr("transform","translate("+e.marginLeft+","+e.marginTop+")").call((0,s.y4O)(o).tickSize(0)),e.yAxis.selectAll("text").style("font-size",e.yLabelFontSize).style("font-style",e.yLabelFontStyle);let c=Math.max(...e.enrichedInfo.pValues);c*=1.1;const _=(0,s.BYU)().domain([0,c]).range([0,e.gridWidth]),F=e.marginTop+e.gridHeight;e.xAxis=this.d3Svg.append("g").attr("transform","translate("+e.marginLeft+","+F+")").call((0,s.LLu)(_).ticks(5)),e.xAxis.selectAll("text").style("font-size",e.axisBottomLableSize+"rem"),e.borderElement=this.d3Svg.append("rect").attr("transform","translate("+(e.marginLeft+.5*e.borderWidth)+","+e.marginTop+")").attr("width",e.gridWidth).attr("height",e.gridHeight).attr("fill","none").attr("stroke","black").attr("stroke-width",e.borderWidth);const w=e.marginTop+e.gridHeight+e.xAxis.node().getBBox().height+e.axisBottomTitleFontSize,V=e.marginLeft+.5*e.gridWidth;e.xTitle=this.d3Svg.append("text").attr("transform","translate("+V+","+w+")").style("text-anchor","middle").style("font-size",e.axisBottomTitleFontSize).text("-log10(P Value)");const G=e.marginTop-10,Z=e.marginLeft+.5*e.gridWidth;e.plotTitle=this.d3Svg.append("text").attr("transform","translate("+Z+","+G+")").attr("text-anchor","middle").text(e.enrichedInfo.annotationType);const q=e.enrichedInfo.pValues;e.barElements=this.d3Svg.append("g").attr("transform","translate("+e.marginLeft+","+e.marginTop+")"),e.barElements.selectAll("bar").data(e.enrichedInfo.pValues).enter().append("rect").attr("x",e.borderWidth).attr("y",function(D,k){return o(n[k])}).attr("height",o.bandwidth()).attr("width",function(D){return _(D)}).attr("fill",e.barColor),e.barNumberElements=this.d3Svg.append("g").attr("transform","translate("+e.marginLeft+","+e.marginTop+")"),e.barNumberElements.selectAll("numberText").data(e.enrichedInfo.geneNumbers).enter().append("text").attr("x",function(D,k){return _(q[k])+2}).attr("y",function(D,k){return o(n[k])+.5*e.barWidth+.3*e.geneNumberTextFrontsize}).attr("font-size",e.geneNumberTextFrontsize).text(function(D){return D})}_initSettings(){this.height=this.basicSettings?this.basicSettings.height:this.height,this.width=this.basicSettings?this.basicSettings.width:this.width,this.marginTop=this.basicSettings?this.basicSettings.marginTop:this.marginTop,this.marginBottom=this.basicSettings?this.basicSettings.marginBottom:this.marginBottom,this.marginRight=this.basicSettings?this.basicSettings.marginRight:this.marginRight,this.marginLeft=this.basicSettings?this.basicSettings.marginLeft:this.marginLeft,this.gridWidth=this.basicSettings?this.basicSettings.gridWidth:this.gridWidth,this.gridHeight=this.basicSettings?this.basicSettings.gridHeight:this.gridHeight,this.barWidth=this.basicSettings?this.basicSettings.barWidth:this.barWidth,this.paddingInner=this.basicSettings?this.basicSettings.paddingInner:this.paddingInner,this.paddingOuter=this.basicSettings?this.basicSettings.paddingOuter:this.paddingOuter,this.yLabelFontSize=this.basicSettings?this.basicSettings.yLabelsFontSize:this.yLabelFontSize,this.gridHeight=this.basicSettings.gridHeight}_generateMarginLeft(){const e=this.enrichedInfo.enrichedTerms.map(o=>this.computeStringWidthService.computeStringWidth(o,this.yLabelFontSize,this.yLabelFontStyle));return Math.max(...e)+20}_generateGridHeight(){const e=this.enrichedInfo.enrichedTerms.length;return e*this.barWidth+this.barWidth*this.paddingInner/(1-this.paddingInner)*(e-1)+2*this.paddingOuter*this.barWidth/(1-this.paddingInner)}_transformMap(){let e=this;e.d3Svg.call((0,s.sPX)().scaleExtent([.2,5]).on("zoom",function(n){const o=(0,s.P2S)(this);e._zoomAccordingTransform(o)})).on("dblclick.zoom",null)}_zoomAccordingTransform(e){let n=this,{x:o,y:c,k:_}=e;n.xAxis.attr("transform",`translate(${n.marginLeft+o}, ${n.marginTop+n.gridHeight*_+c}) scale(${_})`),n.yAxis.attr("transform",`translate(${n.marginLeft+o}, ${n.marginTop+c}) scale(${_})`);const Z=n.marginTop+(n.gridHeight+n.xAxis.node().getBBox().height+n.axisBottomTitleFontSize)*_+c;n.xTitle.attr("transform",`translate(${n.marginLeft+.5*n.gridWidth*_+o}, ${Z}) scale(${_})`),n.barElements.attr("transform",`translate(${n.marginLeft+o}, ${n.marginTop+c}) scale(${_})`),n.barNumberElements.attr("transform",`translate(${n.marginLeft+o}, ${n.marginTop+c}) scale(${_})`),n.borderElement.attr("transform",`translate(${n.marginLeft+.5*n.borderWidth*_+o}, ${n.marginTop+c}) scale(${_})`),n.plotTitle.attr("transform",`translate(${n.marginLeft+.5*n.gridWidth*_+o}, ${n.marginTop-10+c}) scale(${_})`)}_moveGraphic2center(){const e=.5*(this.marginLeft+this.gridWidth+this.marginRight),n=.5*this.svgElement.nativeElement.width.baseVal.value,o=s.CRH.scale(1).translate(n-e,0);this._zoomAccordingTransform(o),this.d3Svg.node().__zoom=o}_removeGraphic(){this.d3Svg&&this.d3Svg.selectAll("*").remove()}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(T.m))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-d3-enriched-bar-plot"]],viewQuery:function(e,n){if(1&e&&t.Gf(r,5),2&e){let o;t.iGM(o=t.CRH())&&(n.svgElement=o.first)}},inputs:{enrichedInfo:"enrichedInfo",basicSettings:"basicSettings"},features:[t.TTD],decls:3,vars:0,consts:[[2,"z-index","-10"],["svgElement",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.O4$(),t._UZ(1,"svg",null,1),t.qZA())},styles:["svg[_ngcontent-%COMP%]{display:block;margin:auto}"],changeDetection:0}),l})();var a=d(2326);const S=["svgContainer"],C=function(l){return{"min-height":l}};let m=(()=>{class l{constructor(e,n){this.cdr=e,this.computeStringWidthService=n,this.itemsSectionVisibility="hidden",this.dropdownSettings={singleSelection:!1,unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!1,allowSearchFilter:!0},this.selectedItems=[],this.defaultBasicSetting={width:500,height:500,barWidth:15,marginLeft:100,marginTop:40,marginRight:10,marginBottom:50,gridHeight:300,gridWidth:300,xLabelsFontSize:15,xLabelRotationDegree:-30,yLabelsFontSize:15,paddingInner:.25,paddingOuter:.3}}ngAfterViewInit(){this.enrichedAnnotations&&(this._determineContainerMinHeight(),this._prepareTermsForSelecting(),this._obtainEnrichedInfoForPlot(this.selectedItems),this._obtainBasicSettings())}ngOnChanges(e){e.enrichedAnnotations&&!e.enrichedAnnotations.isFirstChange()&&(this._determineContainerMinHeight(),this._prepareTermsForSelecting(),this._obtainEnrichedInfoForPlot(this.selectedItems),this._obtainBasicSettings())}updateSelectedItems(e){this._obtainEnrichedInfoForPlot(this.selectedItems),this._obtainBasicSettings()}_prepareTermsForSelecting(){this.allAnnotationTerms=this.enrichedAnnotations.enrichedValues.map(n=>n[1]),this.selectedItems=this.allAnnotationTerms.slice(0,5),this.downloadPngName=this.enrichedAnnotations.annotationType+".png",this.downloadPDFname=this.enrichedAnnotations.annotationType+".pdf"}_determineContainerMinHeight(){this.containerMinHeight=.6*document.documentElement.clientHeight-400>0?.7*document.documentElement.clientHeight:400}_obtainBasicSettings(){const e=this._obtainSvgWidth(),n=Object.assign({},this.defaultBasicSetting);n.marginLeft=this._generateMarginLeft(),n.marginRight+n.marginLeft+n.gridWidth<=e?n.width=n.marginRight+n.gridWidth+n.marginLeft:(n.width=e,n.gridWidth=n.width-n.marginLeft-n.marginRight),n.gridHeight=this._generateGridHeight(),n.height=n.marginTop+n.gridHeight+n.marginBottom,this.initialBasicSetting=n,this.cdr.detectChanges()}_obtainSvgWidth(){return this.svgContainer.nativeElement.clientWidth}_generateMarginLeft(){const e=this.selectedItems.map(o=>this.computeStringWidthService.computeStringWidth(o,this.defaultBasicSetting.yLabelsFontSize,"times new roman"));return Math.max(...e)+30}_generateGridHeight(){const e=this.selectedItems.length;return e*this.defaultBasicSetting.barWidth+this.defaultBasicSetting.barWidth*this.defaultBasicSetting.paddingInner/(1-this.defaultBasicSetting.paddingInner)*(e-1)+2*this.defaultBasicSetting.paddingOuter*this.defaultBasicSetting.barWidth/(1-this.defaultBasicSetting.paddingInner)}_obtainEnrichedInfoForPlot(e){const n=new Set(e);let w=[],V=[],G=[];this.enrichedAnnotations.enrichedValues.forEach(Z=>{n.has(Z[1])&&(w.push(Z[1]),V.push(Z[3]),G.push(Z[5]))}),this.enrichedInfoForPlot={annotationType:this.enrichedAnnotations.annotationType,enrichedTerms:w,pValues:V,geneNumbers:G},this._obtainBasicSettings()}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(t.sBO),t.Y36(T.m))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-enriched-annotations-plot"]],viewQuery:function(e,n){if(1&e&&t.Gf(S,5),2&e){let o;t.iGM(o=t.CRH())&&(n.svgContainer=o.first)}},inputs:{enrichedAnnotations:"enrichedAnnotations"},features:[t.TTD],decls:7,vars:11,consts:[["ngbTooltip","Select Items For Plot",2,"width","15rem"],["ngDefaultControl","",3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onDeSelect"],[1,"d-flex","flex-column","justify-content-center",3,"ngStyle"],["svgContainer",""],["appD3ExportMap","",2,"z-index","10",3,"pngName","pdfName","enrichedInfo","basicSettings"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"h5"),t._uU(2,"Select Items for Plot:"),t.qZA(),t.TgZ(3,"ng-multiselect-dropdown",1),t.NdJ("ngModelChange",function(c){return n.selectedItems=c})("onSelect",function(c){return n.updateSelectedItems(c)})("onDeSelect",function(c){return n.updateSelectedItems(c)}),t.qZA(),t.qZA(),t.TgZ(4,"div",2,3),t._UZ(6,"app-d3-enriched-bar-plot",4),t.qZA()),2&e&&(t.xp6(3),t.Q6J("placeholder","Select Items for Plot")("settings",n.dropdownSettings)("data",n.allAnnotationTerms)("ngModel",n.selectedItems),t.xp6(1),t.Q6J("ngStyle",t.VKq(9,C,n.containerMinHeight)),t.xp6(2),t.Q6J("pngName",n.downloadPngName)("pdfName",n.downloadPDFname)("enrichedInfo",n.enrichedInfoForPlot)("basicSettings",n.initialBasicSetting))},directives:[L._L,O.OP,u.Fj,u.JJ,u.On,E.PC,h,a.I],styles:[""],changeDetection:0}),l})();var x=d(6458);const W=function(l){return{active:l}};function R(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"li",13),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().changeAnnotationType(c)}),t.TgZ(1,"a",14),t._uU(2),t.qZA(),t.qZA()}if(2&l){const e=f.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(2,W,n.selectedAnnotationType===e)),t.xp6(1),t.hij("",e," ")}}function $(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"li",15),t.TgZ(1,"a",16),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().changeDisplayTypeOfAllTerms(c)}),t._uU(2),t.qZA(),t.qZA()}if(2&l){const e=f.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(2,W,n.selectedDisplayTypeOfAllTerms===e)),t.xp6(1),t.hij(" ",e," ")}}function J(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"app-enriched-annotations-table-pagination",17),t.NdJ("selectedAnnotationTermGenes$",function(o){return t.CHM(e),t.oxw().processSelectedAnnotationTermGenes(o)}),t.qZA()}if(2&l){const e=t.oxw();t.Q6J("enrichedAnnotationsInfo",e.enrichedAnnotationsInfoForTable)}}function z(l,f){if(1&l&&t._UZ(0,"app-enriched-annotations-plot",18),2&l){const e=t.oxw();t.Q6J("enrichedAnnotations",e.enrichedAnnotationsInfoForTable)}}function U(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"app-display-genes-info-table-pagination",19),t.NdJ("selectedGene$",function(o){return t.CHM(e),t.oxw().processSelectedGene(o)}),t.qZA()}if(2&l){const e=t.oxw();t.Q6J("genesInfoForTable",e.annotationTermGenesInfoForTable)}}function j(l,f){if(1&l&&(t.TgZ(0,"p",20),t._uU(1," Click "),t._UZ(2,"fa-icon",21),t._uU(3," in the annotation terms table (left) to show genes information in the selected annotation term "),t.qZA()),2&l){const e=t.oxw();t.xp6(2),t.Q6J("icon",e.faTable)("size","1x")}}function K(l,f){if(1&l){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(o){return t.CHM(e),t.oxw().processClickedKeggButton(o)}),t._uU(1," Visualize this Pathway in KeggExp "),t.qZA()}}let X=(()=>{class l{constructor(e){this.cdr=e,this.selectedAnnotationTermGenes$=new t.vpe,this.selectedKEGGpathway$=new t.vpe,this.selectedGene$=new t.vpe,this.faTable=b.B3e,this.selectedAnnotationType="KEGG Pathway",this.displayTypesOfAllTerms=["Table","Bar Plot"],this.selectedDisplayTypeOfAllTerms="Table",this.displayTypesOfOneTerm=["Table"],this.ifShowToKeggExpNote=!1}ngOnInit(){}ngOnChanges(e){e.geneListErichedResultStatus&&this.geneListErichedResultStatus&&(this.annotationTypes=this.geneListErichedResultStatus.result.enrichedAnnotations.map(n=>n.annotationType),this.selectedAnnotationType=this.annotationTypes[0],this.changeAnnotationType(this.selectedAnnotationType))}changeAnnotationType(e){this.selectedAnnotationType=e,this._obtainOneAnnotationEnrichedData(e),this.selectedAnnotationTermGenes$.next({annotationID:"",annotationTerm:"",genes:[]}),this.ifShowToKeggExpNote=!1,this.cdr.detectChanges()}_obtainOneAnnotationEnrichedData(e){let n;for(const o of this.geneListErichedResultStatus.result.enrichedAnnotations)o.annotationType==e&&(n=o);this.enrichedAnnotationsInfoForTable={annotationType:n.annotationType,headers:n.enrichedResult.attributes,enrichedValues:n.enrichedResult.enrichedInfos}}changeDisplayTypeOfAllTerms(e){this.selectedDisplayTypeOfAllTerms=e,this.cdr.detectChanges()}changeDisplayTypeOfOneTerm(e){}_formatGenesEnrichedDownloadFile(){return"string"}processSelectedAnnotationTermGenes(e){this.ifShowToKeggExpNote="KEGG Pathway"===this.selectedAnnotationType&&!["hsa01100","mus01100","rno01110"].includes(e.annotationID),this.selectedAnnotationTermGenes$.next(e),this.selectedAnnotationID=e.annotationID}processClickedKeggButton(e){this.selectedKEGGpathway$.next(this.selectedAnnotationID)}processSelectedGene(e){this.selectedGene$.next(e)}downloadEnrichedAnnotations(e){const o=this.enrichedAnnotationsInfoForTable.enrichedValues;let c=this.enrichedAnnotationsInfoForTable.headers.join("\t")+"\n";c+=o.map(G=>G.join("\t")).join("\n");const w=this._formatGenesEnrichedDownloadFile();let V=new Blob([c],{type:"text/csv;charset=utf-8"});saveAs(V,w)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(t.sBO))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-display-enriched-annotations"]],inputs:{geneListErichedResultStatus:"geneListErichedResultStatus",annotationTermGenesInfoForTable:"annotationTermGenesInfoForTable"},outputs:{selectedAnnotationTermGenes$:"selectedAnnotationTermGenes$",selectedKEGGpathway$:"selectedKEGGpathway$",selectedGene$:"selectedGene$"},features:[t.TTD],decls:17,vars:7,consts:[[1,"row"],["data-testid","switchAnnotations",1,"nav","nav-tabs"],["class","nav-item",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-lg-6","border"],[1,"text-center",2,"margin-bottom","0"],["data-testid","switchAnnoDisplayType",1,"nav","nav-tabs"],["class","nav-item",4,"ngFor","ngForOf"],["appTableHeaderBodySameWidth","",3,"enrichedAnnotationsInfo","selectedAnnotationTermGenes$",4,"ngIf"],[3,"enrichedAnnotations",4,"ngIf"],[1,"col-12","col-lg-6"],[3,"genesInfoForTable","selectedGene$",4,"ngIf"],["data-testid","clickAnnotationTermNote",4,"ngIf"],["data-testid","toKeggExp","class","btn btn-sm btn-expressvis",3,"click",4,"ngIf"],[1,"nav-item",3,"click"],["href","javascript:void(0)",1,"nav-link",3,"ngClass"],[1,"nav-item"],["href","javascript:void(0)",1,"nav-link",3,"ngClass","click"],["appTableHeaderBodySameWidth","",3,"enrichedAnnotationsInfo","selectedAnnotationTermGenes$"],[3,"enrichedAnnotations"],[3,"genesInfoForTable","selectedGene$"],["data-testid","clickAnnotationTermNote"],[3,"icon","size"],["data-testid","toKeggExp",1,"btn","btn-sm","btn-expressvis",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"ul",1),t.YNc(2,R,3,4,"li",2),t.qZA(),t.qZA(),t.TgZ(3,"div",0),t.TgZ(4,"div",3),t.TgZ(5,"h5",4),t._uU(6," Enriched Annotation Terms "),t.qZA(),t.TgZ(7,"ul",5),t.YNc(8,$,3,4,"li",6),t.qZA(),t.YNc(9,J,1,1,"app-enriched-annotations-table-pagination",7),t.YNc(10,z,1,1,"app-enriched-annotations-plot",8),t.qZA(),t.TgZ(11,"div",9),t.TgZ(12,"h5",4),t._uU(13," Genes In the Selected Annotation Term "),t.qZA(),t.YNc(14,U,1,1,"app-display-genes-info-table-pagination",10),t.YNc(15,j,4,2,"p",11),t.YNc(16,K,2,0,"button",12),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.annotationTypes),t.xp6(6),t.Q6J("ngForOf",n.displayTypesOfAllTerms),t.xp6(1),t.Q6J("ngIf","Table"===n.selectedDisplayTypeOfAllTerms&&n.geneListErichedResultStatus),t.xp6(1),t.Q6J("ngIf","Bar Plot"===n.selectedDisplayTypeOfAllTerms),t.xp6(4),t.Q6J("ngIf",(null==n.annotationTermGenesInfoForTable?null:n.annotationTermGenesInfoForTable.genesInfo.length)>0),t.xp6(1),t.Q6J("ngIf",!((null==n.annotationTermGenesInfoForTable?null:n.annotationTermGenesInfoForTable.genesInfo.length)>0)),t.xp6(1),t.Q6J("ngIf",n.ifShowToKeggExpNote))},directives:[E.sg,E.O5,E.mk,P,I.n,m,x.T,v.BN],styles:[""],changeDetection:0}),l})()},6988:(H,M,d)=>{d.d(M,{R:()=>I});var t=d(3668),b=d(2307),E=d(5043),N=d(5863),A=d(3856),L=d(8638),u=d(3203);const v=["boxPlot"];let B=(()=>{class T{constructor(i){this.elRef=i,this.groupsNames=[],this.groupsNames2Labels={},this.groupsLabels=[],this.groupPairsForPvalues=[],this.pvalueLineGap=20,this.hostElement=this.elRef.nativeElement}ngOnInit(){}ngOnChanges(i){i.geneExpForBoxPlot&&!i.geneExpForBoxPlot.isFirstChange()&&(this._removeGraphic(),this._prepareDataForVis(),this._addGraphic(),this._addPvalueLabels()),i.boxPlotSettings&&!i.boxPlotSettings.isFirstChange()&&(this._removeGraphic(),this._prepareDataForVis(),this._addGraphic(),this._addPvalueLabels())}ngAfterViewInit(){this.geneExpForBoxPlot&&(this._removeGraphic(),this._prepareDataForVis(),this._addGraphic(),this._addPvalueLabels())}_prepareDataForVis(){this.allValues=this._obtainAllValues(),this.groupsNames=this._obtainGroupNames(),this.groupSamplesValues=this._obtainGroupSampleValues(),this.groupExpStat=this._computeStatistics(),this.groupsNames2Labels=this._obtainGroupName2GroupLabel()}_obtainAllValues(){const i=[];return this.geneExpForBoxPlot.groupsExpInfo.forEach(s=>{s.samplesExpInfo.forEach(r=>{i.push(r.value)})}),i}_obtainGroupNames(){return this.geneExpForBoxPlot.groupsExpInfo.map(s=>s.groupName)}_obtainGroupSampleValues(){let i=[];return this.geneExpForBoxPlot.groupsExpInfo.forEach(s=>{s.samplesExpInfo.forEach(r=>{i.push({groupName:s.groupName,value:r.value,sampleName:r.sampleName})})}),i}_obtainGroupName2GroupLabel(){let i={};return this.geneExpForBoxPlot.groupsExpInfo.forEach(s=>{i[s.groupName]=s.groupName+"(n="+s.samplesExpInfo.length.toString()+")"}),i}_removeGraphic(){let i=(0,u.Ys)(this.hostElement).selectAll("svg");i&&i.remove()}_addGraphic(){this._initGraphicSettings(),this._addSvg(),this._addBorder(),this._addXlabels(),this._addYlabels(),this._addStaticsBox(),this._addPoints(),this._addPvalueLabels()}_initGraphicSettings(){this.marginLeft=this.boxPlotSettings.marginLeft,this.marginRight=this.boxPlotSettings.marginRight,this.marginTop=this.boxPlotSettings.marginTop,this.marginBottom=this.boxPlotSettings.marginBottom,this.marginLeft=this.boxPlotSettings.marginLeft,this.width=this.boxPlotSettings.width,this.graphicWidth=this.width-this.marginLeft-this.marginRight,this.graphicHeight=this.boxPlotSettings.height-this.marginTop-this.marginBottom,this.boxWidth=this.boxPlotSettings.boxWidth,this.pointSize=this.boxPlotSettings.pointSize,this.jitterWidth=this.boxWidth/2}_addSvg(){this.svg=(0,u.Ys)(this.boxPlot.nativeElement).append("svg").attr("width",this.width).attr("height",this.boxPlotSettings.height).style("display","block").style("margin","auto")}_addBorder(){let i=this;this.svg.append("rect").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x",0).attr("y",0).attr("height",i.graphicHeight).attr("width",i.graphicWidth).attr("fill","none").attr("stroke","black").attr("stroke-width",this.boxPlotSettings.axisStrokeWidth)}_addXlabels(){let i=this;this.xScale=(0,u.tiA)().range([0,i.graphicWidth]).domain(this.groupsNames).paddingInner(1).paddingOuter(.5);const s=i.marginTop+i.graphicHeight;this.svg.append("g").attr("transform","translate("+i.marginLeft+","+s+")").call((0,u.LLu)(this.xScale).tickFormat(h=>this.groupsNames2Labels[h])).selectAll("text").style("font-size",this.boxPlotSettings.axisBottomLableSize+"rem").attr("transform","rotate("+this.boxPlotSettings.axisBottomLableRotation+")").style("text-anchor",this._determineAxisBottomTextAnchor())}_addYlabels(){let i=this;const s=this.groupExpStat.map(z=>z.max),r=this.groupExpStat.map(z=>z.min),h=Math.max((0,u.Fp7)(this.allValues),(0,u.Fp7)(s)),a=Math.min((0,u.VV$)(this.allValues),(0,u.VV$)(r)),C=(this.geneExpForBoxPlot.groupPairsPvalue.length+.1)*this.pvalueLineGap,m=5*(h-a)/(i.graphicHeight-C-10),x=C*(h-a)/(i.graphicHeight-C-10);this.yScale=(0,u.BYU)().domain([a-m,h+m+x]).range([i.graphicHeight,0]);let W=this.svg.append("g").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").call((0,u.y4O)(this.yScale).ticks(5).tickFormat(z=>z.toString()));W.selectAll("text").style("font-size",this.boxPlotSettings.axisLeftLableSize+"rem");const R=i.marginLeft-W.node().getBBox().width-10,$=i.marginTop+.5*i.graphicHeight;this.svg.append("text").attr("transform","translate("+R+","+$+")rotate(-90)").style("text-anchor","middle").style("font-size",this.boxPlotSettings.axisLeftTitleSize).text("Expression Value")}_addStaticsBox(){let i=this,s=this.xScale,r=this.yScale,h=this.svg.append("g");h.selectAll("vertLines").data(this.groupExpStat).enter().append("line").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x1",function(a){return s(a.groupName)}).attr("x2",function(a){return s(a.groupName)}).attr("y1",function(a){return r(a.min)}).attr("y2",function(a){return r(a.max)}).attr("stroke","black").style("width",40),h.selectAll("boxes").data(this.groupExpStat).enter().append("rect").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x",function(a){return s(a.groupName)-i.boxWidth/2}).attr("y",function(a){return r(a.q3)}).attr("height",function(a){return r(a.q1)-r(a.q3)}).attr("width",i.boxWidth).attr("stroke","black").style("fill","white"),h.selectAll("medianLines").data(this.groupExpStat).enter().append("line").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x1",function(a){return s(a.groupName)-i.boxWidth/2}).attr("x2",function(a){return s(a.groupName)+i.boxWidth/2}).attr("y1",function(a){return r(a.median)}).attr("y2",function(a){return r(a.median)}).attr("stroke","black").style("width",80),h.selectAll("upLines").data(this.groupExpStat).enter().append("line").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x1",function(a){return s(a.groupName)-i.boxWidth/4}).attr("x2",function(a){return s(a.groupName)+i.boxWidth/4}).attr("y1",function(a){return r(a.max)}).attr("y2",function(a){return r(a.max)}).attr("stroke","black").style("width",80),h.selectAll("downLines").data(this.groupExpStat).enter().append("line").attr("transform","translate("+i.marginLeft+","+i.marginTop+")").attr("x1",function(a){return s(a.groupName)-i.boxWidth/4}).attr("x2",function(a){return s(a.groupName)+i.boxWidth/4}).attr("y1",function(a){return r(a.min)}).attr("y2",function(a){return r(a.min)}).attr("stroke","black").style("width",80)}_addPoints(){let i=(0,u.Ys)(this.hostElement).append("div").attr("class","tooltip").style("opacity",0);var s=this;this.svg.append("g").selectAll("samplePoints").data(this.groupSamplesValues).enter().append("circle").attr("transform","translate("+s.marginLeft+","+s.marginTop+")").attr("cx",function(h){return s.xScale(h.groupName)-s.jitterWidth/2+Math.random()*s.jitterWidth}).attr("cy",function(h){return s.yScale(h.value)}).attr("r",s.pointSize).style("fill","black").attr("stroke","black").on("mousemove",function(h){i.transition().duration(200).style("opacity",.9),i.html(h.sampleName).style("left",h.pageX+"px").style("top",h.pageY-28+"px")}).on("mouseout",function(h){i.transition().duration(500).style("opacity",0)})}_determineAxisBottomTextAnchor(){return 0==this.boxPlotSettings.axisBottomLableRotation?"center":"end"}_obtainMarginBottom(){let i=0;const s=(0,b.H9)(this.boxPlotSettings.axisBottomLableSize);let r=[];for(const h in this.groupsNames2Labels)r.push(this.groupsNames2Labels[h]);return r.forEach(h=>{const a=-this.boxPlotSettings.axisBottomLableRotation*Math.PI/180,S=h.length*s*Math.sin(a)+1.32*s*Math.cos(a);S>i&&(i=S)}),i+5}_obtainMarginLeft(){const i=-this.boxPlotSettings.axisBottomLableRotation*Math.PI/180,s=(0,b.H9)(this.boxPlotSettings.axisBottomLableSize),r=this.groupsNames[0].length*s*Math.cos(i);return r>=this.boxPlotSettings.marginLeft?r:this.boxPlotSettings.marginLeft}_computeStatistics(){return this.geneExpForBoxPlot.groupsExpInfo.map(s=>{const r=s.samplesExpInfo.map(W=>W.value).sort(u.j2p),h=(0,u.VRg)(r,.25),a=(0,u.VRg)(r,.5),S=(0,u.VRg)(r,.75),C=S-h;return{groupName:s.groupName,q1:h,median:a,q3:S,interQuantileRange:C,min:h-1.5*C,max:S+1.5*C}})}_addPvalueLabels(){const i=this.marginLeft,s=this.boxPlotSettings.marginTop;this.svg.selectAll(".pValueElement").remove();const r=this._preparePvalueLables(),h=this.pvalueLineGap;let a=this.xScale,S=this.yScale,C=this.svg.append("g").attr("class","pValueElement");C.selectAll("pValueLines").data(r).enter().append("line").attr("transform","translate("+i+","+s+")").attr("x1",function(m){return a(m.baseGroup)}).attr("x2",function(m){return a(m.targetGroup)}).attr("y1",function(m,x){return S(m.y)-(x+.5)*h}).attr("y2",function(m,x){return S(m.y)-(x+.5)*h}).attr("stroke","black").style("width",80),C.selectAll("pValueGroup1Lines").data(r).enter().append("line").attr("transform","translate("+i+","+s+")").attr("x1",function(m){return a(m.baseGroup)}).attr("x2",function(m){return a(m.baseGroup)}).attr("y1",function(m,x){return S(m.y)-(x+.5)*h+h/4}).attr("y2",function(m,x){return S(m.y)-(x+.5)*h}).attr("stroke","black").style("width",80),C.selectAll("pValueGroup1Lines").data(r).enter().append("line").attr("transform","translate("+i+","+s+")").attr("x1",function(m){return a(m.targetGroup)}).attr("x2",function(m){return a(m.targetGroup)}).attr("y1",function(m,x){return S(m.y)-(x+.5)*h+h/4}).attr("y2",function(m,x){return S(m.y)-(x+.5)*h}).attr("stroke","black").style("width",80),C.selectAll("pValuestext").data(r).enter().append("text").attr("transform","translate("+i+","+s+")").attr("x",function(m){return(a(m.targetGroup)+a(m.baseGroup))/2}).attr("y",function(m,x){return S(m.y)-(x+.5)*h}).attr("text-anchor","middle").text(function(m){const x=m.pValue;return x<=1e-4?"****":x<=.001&&x>1e-4?"***":x<=.01&&x>.001?"**":x<=.05&&x>.01?"*":"ns"})}_preparePvalueLables(){const i=this._obtainTheUppestBoxBorder();return this.geneExpForBoxPlot.groupPairsPvalue.map((r,h)=>({baseGroup:r.baseGroup,targetGroup:r.targetGroup,y:i,pValue:r.pValue}))}_obtainTheUppestBoxBorder(){let i=[];this.geneExpForBoxPlot.groupPairsPvalue.forEach(h=>{i.push(h.baseGroup),i.push(h.targetGroup)});const s=new Set(i);let r=[];return this.groupExpStat.forEach(h=>{s.has(h.groupName)&&r.push(h.max)}),(0,u.Fp7)(r)}}return T.\u0275fac=function(i){return new(i||T)(t.Y36(t.SBq))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-expression-box-plot"]],viewQuery:function(i,s){if(1&i&&t.Gf(v,5),2&i){let r;t.iGM(r=t.CRH())&&(s.boxPlot=r.first)}},inputs:{geneExpForBoxPlot:"geneExpForBoxPlot",boxPlotSettings:"boxPlotSettings"},features:[t.TTD],decls:2,vars:0,consts:[[1,"d-flex","align-items-center"],["boxPlot",""]],template:function(i,s){1&i&&t._UZ(0,"div",0,1)},styles:[""],changeDetection:0}),T})();var p=d(648),y=d(6019),g=d(3945);function P(T,O){if(1&T){const i=t.EpF();t.TgZ(0,"app-change-figure-settings",11),t.NdJ("modifiedSettings$",function(r){return t.CHM(i),t.oxw().changeBoxPlotSettings(r)})("closeSignal$",function(r){return t.CHM(i),t.oxw().showSettings(r)}),t.qZA()}if(2&T){const i=t.oxw();t.Q6J("plotSettingInfoList",i.plotSettingInfoList)}}let I=(()=>{class T{constructor(){this.closeSignal$=new t.vpe,this.faCog=E.b7W,this.ifShowSettingsComponent=!1,this.settingsRight=0,this.settingsTop=0,this.groupsNames2Labels={},this.boxPlotSettingItems=["width","height","marginTop","marginBottom","marginLeft","marginRight","pointSize","boxWidth","axisBottomLableSize","axisLeftLableSize","axisLeftTitleSize","axisStrokeWidth","axisBottomLableRotation"],this.defaultBoxPlotSettings={width:500,height:350,marginTop:30,marginBottom:70,marginLeft:100,marginRight:30,pointSize:4,boxWidth:25,axisBottomLableSize:1.5,axisLeftLableSize:1.5,axisLeftTitleSize:25,axisStrokeWidth:1.5,axisBottomLableRotation:-30},this.plotSettingInfoList=[{name:"width",defaultValue:300,minValue:50,maxValue:500,stepValue:1},{name:"height",defaultValue:250,minValue:50,maxValue:600,stepValue:1}]}ngOnInit(){this.geneExpForBoxPlot&&this._initBoxPlotSettings()}closeModalForExpression(i){this.closeSignal$.next(!0)}showSettings(i){this.ifShowSettingsComponent=!this.ifShowSettingsComponent}changeBoxPlotSettings(i){this.boxPlotSettingsForPlot=Object.assign({},i)}_initBoxPlotSettings(){this.initBoxPlotSettings=Object.assign({},this.defaultBoxPlotSettings),this.groupsNames2Labels=this._obtainGroupName2GroupLabel(),this.initBoxPlotSettings.marginBottom=this._obtainMarginBottom(),this.initBoxPlotSettings.marginLeft=this._obtainMarginLeft();const i=this.initBoxPlotSettings.boxWidth*Object.keys(this.groupsNames2Labels).length*2;this.initBoxPlotSettings.width=this.initBoxPlotSettings.marginLeft+i+this.initBoxPlotSettings.marginRight,this.boxPlotSettingsForPlot=Object.assign({},this.initBoxPlotSettings),this.plotSettingInfoList=[{name:"width",defaultValue:this.initBoxPlotSettings.width,minValue:.5*this.initBoxPlotSettings.width,maxValue:2*this.initBoxPlotSettings.width,stepValue:1},{name:"height",defaultValue:this.initBoxPlotSettings.height,minValue:.5*this.initBoxPlotSettings.height,maxValue:2*this.initBoxPlotSettings.height,stepValue:1},{name:"marginTop",defaultValue:this.initBoxPlotSettings.marginTop,minValue:.5*this.initBoxPlotSettings.marginTop,maxValue:2*this.initBoxPlotSettings.marginTop,stepValue:1},{name:"marginBottom",defaultValue:this.initBoxPlotSettings.marginBottom,minValue:.5*this.initBoxPlotSettings.marginBottom,maxValue:2*this.initBoxPlotSettings.marginBottom,stepValue:1},{name:"marginLeft",defaultValue:this.initBoxPlotSettings.marginLeft,minValue:.5*this.initBoxPlotSettings.marginLeft,maxValue:2*this.initBoxPlotSettings.marginLeft,stepValue:1},{name:"marginRight",defaultValue:this.initBoxPlotSettings.marginRight,minValue:.5*this.initBoxPlotSettings.marginRight,maxValue:2*this.initBoxPlotSettings.marginRight,stepValue:1},{name:"pointSize",defaultValue:this.initBoxPlotSettings.pointSize,minValue:1,maxValue:8,stepValue:.5},{name:"boxWidth",defaultValue:this.initBoxPlotSettings.boxWidth,minValue:.5*this.initBoxPlotSettings.boxWidth,maxValue:2*this.initBoxPlotSettings.boxWidth,stepValue:1},{name:"axisBottomLableSize",defaultValue:this.initBoxPlotSettings.axisBottomLableSize,minValue:.5*this.initBoxPlotSettings.axisBottomLableSize,maxValue:2*this.initBoxPlotSettings.axisBottomLableSize,stepValue:.1},{name:"axisLeftLableSize",defaultValue:this.initBoxPlotSettings.axisLeftLableSize,minValue:.5*this.initBoxPlotSettings.axisLeftLableSize,maxValue:2*this.initBoxPlotSettings.axisLeftLableSize,stepValue:.1},{name:"axisLeftTitleSize",defaultValue:this.initBoxPlotSettings.axisLeftTitleSize,minValue:.5*this.initBoxPlotSettings.axisLeftTitleSize,maxValue:2*this.initBoxPlotSettings.axisLeftTitleSize,stepValue:.1},{name:"axisStrokeWidth",defaultValue:this.initBoxPlotSettings.axisStrokeWidth,minValue:.5*this.initBoxPlotSettings.axisStrokeWidth,maxValue:2*this.initBoxPlotSettings.axisStrokeWidth,stepValue:1},{name:"axisBottomLableRotation",defaultValue:this.initBoxPlotSettings.axisBottomLableRotation,minValue:-90,maxValue:0,stepValue:1}]}_obtainGroupName2GroupLabel(){let i={};return this.geneExpForBoxPlot.groupsExpInfo.forEach(s=>{i[s.groupName]=s.groupName+"(n="+s.samplesExpInfo.length.toString()+")"}),i}_obtainMarginBottom(){let i=0;const s=(0,b.H9)(this.initBoxPlotSettings.axisBottomLableSize);let r=[];for(const h in this.groupsNames2Labels)r.push(this.groupsNames2Labels[h]);return r.forEach(h=>{const a=-this.initBoxPlotSettings.axisBottomLableRotation*Math.PI/180,S=h.length*s*Math.sin(a)+1.32*s*Math.cos(a);S>i&&(i=S)}),i+5}_obtainMarginLeft(){const i=-this.initBoxPlotSettings.axisBottomLableRotation*Math.PI/180,s=(0,b.H9)(this.initBoxPlotSettings.axisBottomLableSize),r=Object.keys(this.groupsNames2Labels).length*s*Math.cos(i);return r>=this.initBoxPlotSettings.marginLeft?r:this.initBoxPlotSettings.marginLeft}}return T.\u0275fac=function(i){return new(i||T)},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-display-one-gene-expression"]],inputs:{geneExpForBoxPlot:"geneExpForBoxPlot"},outputs:{closeSignal$:"closeSignal$"},decls:17,vars:9,consts:[[2,"height","1rem"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"text-center"],[1,"d-flex","justify-content-end"],[1,"align-self-center","mr-3","questionMark",3,"note","placement"],[1,"form-inline"],["ngbTooltip","Click to change settings of the plot",1,"hoverBigger","close",3,"icon","size","click"],[1,"d-flex"],["appD3Download","",3,"geneExpForBoxPlot","boxPlotSettings"],[3,"plotSettingInfoList","modifiedSettings$","closeSignal$",4,"ngIf"],[3,"plotSettingInfoList","modifiedSettings$","closeSignal$"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(h){return s.closeModalForExpression(h)}),t.TgZ(2,"span",2),t._uU(3,"\xd7"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"p"),t._uU(6),t.qZA(),t._UZ(7,"p"),t.TgZ(8,"div",4),t.TgZ(9,"div"),t._UZ(10,"app-display-notes-with-question-mark",5),t.qZA(),t.TgZ(11,"div",6),t.TgZ(12,"fa-icon",7),t.NdJ("click",function(h){return s.showSettings(h)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",8),t.TgZ(14,"div"),t._UZ(15,"app-expression-box-plot",9),t.qZA(),t.YNc(16,P,1,1,"app-change-figure-settings",10),t.qZA(),t.qZA()),2&i&&(t.xp6(6),t.AsE("",null==s.geneExpForBoxPlot?null:s.geneExpForBoxPlot.geneInfo.ID,", ",null==s.geneExpForBoxPlot?null:s.geneExpForBoxPlot.geneInfo.SYMBOL,""),t.xp6(4),t.Q6J("note","The horizontal axis represents group name with samples number, the vertical axis represents expression/intensity. Each dot represents one sample. If there is a statistical difference in expression between the two groups, * will be used to indicate its significance.  *: 1.00e-02 < p <= 5.00e-02,  **: 1.00e-03 < p <= 1.00e-02,  ***: 1.00e-04 < p <= 1.00e-03, ****: p <= 1.00e-04")("placement","auto"),t.xp6(2),t.Q6J("icon",s.faCog)("size","sm"),t.xp6(3),t.Q6J("geneExpForBoxPlot",s.geneExpForBoxPlot)("boxPlotSettings",s.boxPlotSettingsForPlot),t.xp6(1),t.Q6J("ngIf",s.ifShowSettingsComponent))},directives:[N.m,A.BN,L._L,B,p.n,y.O5,g.q],styles:[""],changeDetection:0}),T})()},7682:(H,M,d)=>{d.d(M,{n:()=>b});var t=d(3668);let b=(()=>{class E{constructor(A,L){this.renderer=A,this.el=L}ngAfterViewInit(){if(this.el.nativeElement.querySelector("table")){this.makeEquealHeaderBodyWidth(),this.tableObserver=new MutationObserver(()=>{this.makeEquealHeaderBodyWidth()}),this.tableObserver.observe(this.el.nativeElement.querySelector("table"),{subtree:!0,childList:!0});const A=this.el.nativeElement.querySelector("div"),L=this.el.nativeElement.querySelector("table"),u=this.el.nativeElement.querySelector("thead"),v=this.el.nativeElement.querySelector("tbody");this.renderer.listen(A,"scroll",B=>{const y=(B.srcElement.scrollLeft+L.offsetWidth).toString()+"px";this.renderer.setStyle(u,"width",y),this.renderer.setStyle(v,"width",y)})}}ngOnDestroy(){this.tableObserver&&(this.tableObserver.disconnect(),this.tableObserver=void 0)}makeEquealHeaderBodyWidth(){let A=[];A=[...this.el.nativeElement.querySelectorAll("thead tr th")].map(v=>v.offsetWidth),this.el.nativeElement.querySelectorAll("tbody tr").forEach(v=>{v.querySelectorAll("td").forEach((B,p)=>{const y=B.offsetWidth;y>=A[p]&&(A[p]=y)})});const u=A.map(v=>v.toString()+"px");this.el.nativeElement.querySelectorAll("thead tr th").forEach((v,B)=>{v.style.minWidth=u[B],v.style.maxWidth=u[B]}),this.el.nativeElement.querySelectorAll("tbody tr").forEach(v=>{v.querySelectorAll("td").forEach((B,p)=>{B.style.minWidth=u[p],B.style.maxWidth=u[p]})})}}return E.\u0275fac=function(A){return new(A||E)(t.Y36(t.Qsj),t.Y36(t.SBq))},E.\u0275dir=t.lG2({type:E,selectors:[["","appTableHeaderBodySameWidth",""]]}),E})()}}]);