(self.webpackChunkclient=self.webpackChunkclient||[]).push([[280],{2473:function(k,J){var N;void 0!==(N=function(){"use strict";function V(h,D,O){var I=new XMLHttpRequest;I.open("GET",h),I.responseType="blob",I.onload=function(){Q(I.response,D,O)},I.onerror=function(){console.error("could not download file")},I.send()}function j(h){var D=new XMLHttpRequest;D.open("HEAD",h,!1);try{D.send()}catch(O){}return 200<=D.status&&299>=D.status}function U(h){try{h.dispatchEvent(new MouseEvent("click"))}catch(O){var D=document.createEvent("MouseEvents");D.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(D)}}var S="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,K=S.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Q=S.saveAs||("object"!=typeof window||window!==S?function(){}:"download"in HTMLAnchorElement.prototype&&!K?function(h,D,O){var I=S.URL||S.webkitURL,e=document.createElement("a");e.download=D=D||h.name||"download",e.rel="noopener","string"==typeof h?(e.href=h,e.origin===location.origin?U(e):j(e.href)?V(h,D,O):U(e,e.target="_blank")):(e.href=I.createObjectURL(h),setTimeout(function(){I.revokeObjectURL(e.href)},4e4),setTimeout(function(){U(e)},0))}:"msSaveOrOpenBlob"in navigator?function(h,D,O){if(D=D||h.name||"download","string"!=typeof h)navigator.msSaveOrOpenBlob(function(h,D){return void 0===D?D={autoBom:!1}:"object"!=typeof D&&(console.warn("Deprecated: Expected third argument to be a object"),D={autoBom:!D}),D.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\ufeff",h],{type:h.type}):h}(h,O),D);else if(j(h))V(h,D,O);else{var I=document.createElement("a");I.href=h,I.target="_blank",setTimeout(function(){U(I)})}}:function(h,D,O,I){if((I=I||open("","_blank"))&&(I.document.title=I.document.body.innerText="downloading..."),"string"==typeof h)return V(h,D,O);var e="application/octet-stream"===h.type,B=/constructor/i.test(S.HTMLElement)||S.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||e&&B||K)&&"undefined"!=typeof FileReader){var Y=new FileReader;Y.onloadend=function(){var L=Y.result;L=z?L:L.replace(/^data:[^;]*;/,"data:attachment/file;"),I?I.location.href=L:location=L,I=null},Y.readAsDataURL(h)}else{var m=S.URL||S.webkitURL,_=m.createObjectURL(h);I?I.location=_:location.href=_,I=null,setTimeout(function(){m.revokeObjectURL(_)},4e4)}});S.saveAs=Q.saveAs=Q,k.exports=Q}.apply(J,[]))&&(k.exports=N)},9868:(k,J,l)=>{"use strict";l.d(J,{h:()=>V});var F=l(4099),N=l(3668),p=l(1144);let V=(()=>{class j{constructor(S){this.router=S,this.keggPathwayFromOtherAppSubject=new F.X(null),this.geneListIDFromOtherAppSubject=new F.X(null),this.keggPathwayFromOtherApp$=this.keggPathwayFromOtherAppSubject.asObservable(),this.geneListIDFromOtherApp$=this.geneListIDFromOtherAppSubject.asObservable()}sendPathway2KeggExp(S){this.keggPathwayFromOtherAppSubject.next(S),this.router.navigate(["/KeggExp"])}sendGeneList2PPIExp(S){this.geneListIDFromOtherAppSubject.next(S),this.router.navigate(["/PPIExp"])}}return j.\u0275fac=function(S){return new(S||j)(N.LFG(p.F0))},j.\u0275prov=N.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"}),j})()},2307:(k,J,l)=>{"use strict";l.d(J,{H:()=>F,P:()=>N});const F=function(p){return p*parseFloat(getComputedStyle(document.documentElement).fontSize)*.8},N=function(p){return p*parseFloat(getComputedStyle(document.documentElement).fontSize)}},6492:(k,J,l)=>{"use strict";l.r(J),l.d(J,{DiffExpModule:()=>Yt});var F=l(6019),N=l(4522),p=l(9133),V=l(3063),j=l(5479),U=l(7695),S=l(9256),K=l(8638),Q=l(3856),h=l(3667),D=l(3928),O=l(8702),I=l(1144),e=l(3668),B=l(3405),z=l(4102),Y=l(7089),m=l(8472),_=l(4099),L=l(2668),ne=l(2411),Se=l(6813),xe=l(8526),b=l(8053),A=l(8735),v=l(9204),C=l(6636),oe=l(2047),H=l(5571),fe=l(5389),Ge=l(877),pe=l(1890),Ce=l(8970),q=l(7473),Pe=l(9744),W=l(3052),re=l(6149),de=l(7548),$e=l(1118),ce=l(5136),ue=l(425);const he=n=>n.geneListEnrichedAnnotationsState,me=(0,m.P1)(he,ue.g$),we=(0,m.P1)(he,ue.OR),ge=(0,m.P1)(me,(n,o)=>n.includes(o.geneListID)),Ee=(0,m.P1)(we,(n,o)=>n[o.geneListID]);var Ze=l(661),le=l(8425),R=l(9220);const ee=function(n,o,t,s,a){const r=`${t} VS ${o}`;return"third_party_software"==(null==a?void 0:a.FCcalMethod)?[n,r,s].join("/"):[n,r,`${s}-${a.FCcalMethod}-${a.pValuCalMethod}-${a.pValueAdjMethod}`].join("/")},ye=function(n,o){const t=n.groups;let s;for(let a of t)if(a.name===o){s=a.samples;break}return s};var Le=l(8956),De=l(9232),Ie=l(254),Me=l(7194),Ne=l(726),Ve=l(8779),Ue=l(9990),Je=l(9868),qe=l(5535),Be=l(4473),Ye=l(4205);let Ae=(()=>{class n extends Me.g{constructor(t,s,a,r,u,x,G,E){super(t,E,x,G),this.store=t,this.diffAnalysisRequestService=s,this.enrichmentService=a,this.trySamppleService=r,this.interAppsInteractService=u,this.storeDiffAnalysisResultIDs=this.store.pipe((0,m.Ys)(W.Nq),(0,z.d)()),this.storeGeneListIDsHasEnrichedAnnotations$=this.store.pipe((0,m.Ys)(me)),this.requestGroupsOfSelectedDataset$=new _.X(null),this.datasetDiffGroupPairRequest$=new _.X(null),this.diffFilterInput$=new _.X(null),this.requestDiffGenesEnrichedAnnotations$=new _.X(null),this.oneGeneExpRequestSubject=new _.X(null),this.selectedPathwaySubject=new _.X(null),this.diffGenesPPIrequestSubject=new _.X(null),this.addDiffGenesToGeneListSubject=new _.X(null),this.requestDiffAnalysisOfRemoteDataFromServer$=new _.X(null),this.requestDiffAnalysisOfLocalDataFromServer$=new _.X(null),this.datasetIDsubject=new _.X(null),this.speciesIDsubject=new _.X(null),this.geneIDtypeSubject=new _.X(null),this.diffSoftwareSubject=new _.X(null),this.selectedDiffAnalysisResultForPresentationSubject$=new _.X(null),this.geneListEnrichedResultSubject$=new _.X(null),this.requestDiffAnalysisAllGenesDiffInfo$=new _.X(null),this.selectedDiffAnalysisResultForPresentationStatus$=this.selectedDiffAnalysisResultForPresentationSubject$.asObservable(),this.geneListEnrichedResultStatus$=this.geneListEnrichedResultSubject$.asObservable(),this.allDiffAnalysisIDsForDisplay$=this.storeDiffAnalysisResultIDs.pipe((0,b.U)(i=>(0,De.NT)(i))),this.allDatasetInfoForDisplay$=this.store.pipe((0,m.Ys)(q.yz)).pipe((0,b.U)(i=>[...i].reverse())),this.selectedDatasetGroups$=this.requestGroupsOfSelectedDataset$.pipe((0,A.h)(i=>null!==i),(0,v.w)(i=>this.store.pipe((0,m.Ys)(q.pO,{datasetID:i}),(0,C.q)(1)))),(0,L.aj)([this.datasetDiffGroupPairRequest$.pipe((0,A.h)(i=>null!=i)),this.storeDiffAnalysisResultIDs]).pipe((0,v.w)(([i,f])=>i.hasOwnProperty("id")?this._checkIfDiffAnalysisExisted(i.id).pipe((0,A.h)(d=>d),(0,b.U)(d=>i)):this.store.pipe((0,m.Ys)(q.iR,{datasetID:i.datasetID}),(0,C.q)(1),(0,b.U)(d=>{const c=R.e8.get(d.experimentType);return ee(i.datasetID,i.baseGroup,i.targetGroup,c,i.diffAnalysisSettings)}),(0,v.w)(d=>this._checkIfDiffAnalysisExisted(d).pipe((0,A.h)(c=>c),(0,b.U)(c=>i))))),(0,v.w)(i=>this._obtainDiffAnalysisResult(i).pipe((0,v.w)(f=>{const d=f.speciesID+"-"+f.IDtype,c=function(n,o,t){if("Protein profiling by Mass Spec"===t){let s=[];return n[R.dH[o]].forEach(a=>{const r=a.split(";");s=s.concat(r)}),s}return n[R.dH[o]]}(f.diffResults,f.diffSoftware,f.experimentType);return this.store.pipe((0,m.Ys)(pe.en,{IDtype:d,geneIDs:c}),(0,C.q)(1),(0,b.U)(g=>Object.assign(Object.assign({},f),{genesInfo:g||null})))}))),(0,b.U)(i=>({status:"finished",statusValue:"finished",result:i}))).subscribe(this.selectedDiffAnalysisResultForPresentationSubject$),this.datasetDiffGroupPairRequest$.pipe((0,A.h)(i=>null!=i),(0,v.w)(i=>i.hasOwnProperty("id")?this._checkIfDiffAnalysisExisted(i.id).pipe((0,A.h)(f=>!f),(0,b.U)(f=>i)):this.store.pipe((0,m.Ys)(q.iR,{datasetID:i.datasetID}),(0,C.q)(1),(0,b.U)(f=>{const c=R.e8.get(f.experimentType);return ee(i.datasetID,i.baseGroup,i.targetGroup,c,i.diffAnalysisSettings)}),(0,v.w)(f=>this._checkIfDiffAnalysisExisted(f).pipe((0,A.h)(d=>!d),(0,b.U)(d=>i))))),(0,v.w)(i=>{const f=i.datasetID,d=i.baseGroup,c=i.targetGroup;return this.store.pipe((0,m.Ys)(q.iR,{datasetID:f}),(0,b.U)(g=>{const y=g.expressLocalOrRemote,T=g.experimentType,Z=g.IDtype,M=g.speciesID,P=ye(g,d),$=ye(g,c);return{datasetID:f,localOrRemote:y,experimentType:T,IDtype:Z,speciesID:M,baseGroup:d,targetGroup:c,baseSamples:P,targetSamples:$,diffAnalysisSettings:i.diffAnalysisSettings}}))})).subscribe(i=>{const f={datasetID:i.datasetID,experimentType:i.experimentType,IDtype:i.IDtype,speciesID:i.speciesID,baseGroup:i.baseGroup,targetGroup:i.targetGroup,baseSamples:i.baseSamples,targetSamples:i.targetSamples,diffAnalysisSettings:i.diffAnalysisSettings};this.selectedDiffAnalysisResultForPresentationSubject$.next({status:"loading",statusValue:"Wait for a moment. The app is requesting differential analysis results from the server"}),i.localOrRemote===Ge.M.local?this.requestDiffAnalysisOfLocalDataFromServer$.next(f):this.requestDiffAnalysisOfRemoteDataFromServer$.next(f)}),this.requestDiffAnalysisOfLocalDataFromServer$.pipe((0,A.h)(i=>null!=i),(0,v.w)(i=>{const f=i.datasetID,d=i.experimentType,c=i.speciesID,g=i.IDtype,y=i.baseSamples,T=i.targetSamples,Z=i.targetGroup,M=i.baseGroup,P=R.e8.get(d),$=y.concat(T);return this.store.pipe((0,m.Ys)(de.ZM,{datasetID:f}),(0,C.q)(1)).pipe((0,v.w)(w=>{const ie=w.genes,ae=(0,Le.l)(w.values,w.samples,$);return"Expression profiling by array"===d?this.diffAnalysisRequestService.requestLocalArrayDiffAnalysisOneGroupPair({valuesDic:ae,genes:ie,baseSamples:y,targetSamples:T,experimentType:d,diffSoftware:P,diffAnalysisSettings:i.diffAnalysisSettings,annoLibrary:g}):"RNA-seq of coding RNA"===d||"Protein profiling by Mass Spec"===d?this.diffAnalysisRequestService.requestLocalDatasetDiffAnalysisOneGroupPair({valuesDic:ae,genes:ie,baseSamples:y,targetSamples:T,experimentType:d,diffSoftware:P,diffAnalysisSettings:i.diffAnalysisSettings}):void 0}),(0,b.U)(w=>{const X=w.diffResults;return{id:ee(f,M,Z,P,i.diffAnalysisSettings),datasetID:f,baseGroup:M,targetGroup:Z,diffSoftware:P,experimentType:d,IDtype:g,speciesID:c,diffResults:X}}),(0,oe.K)(w=>(0,ne.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${w.status}, errorText:${w.statusText}`})))})).subscribe(i=>{i.hasOwnProperty("status")?this.selectedDiffAnalysisResultForPresentationSubject$.next(i):this.store.dispatch(re.zc({diffAnalysisResultInfo:i}))}),this.requestDiffAnalysisOfRemoteDataFromServer$.pipe((0,A.h)(i=>null!=i),(0,v.w)(i=>{const f=i.datasetID,d=i.experimentType,c=i.speciesID,g=i.IDtype,y=i.baseSamples,T=i.targetSamples,Z=i.baseGroup,M=i.targetGroup,P=R.e8.get(d);return this.store.pipe((0,m.Ys)(q.iR,{datasetID:f}),(0,C.q)(1)).pipe((0,v.w)($=>this.diffAnalysisRequestService.requestRemoteDatasetDiffAnalysisOneGroupPair({database:$.database,datasetID:f,experimentType:d,IDtype:g,baseSamples:y,targetSamples:T,diffSoftware:P})),(0,b.U)($=>{const w=$.diffResults;return{id:ee(f,Z,M,P,i.diffAnalysisSettings),datasetID:f,baseGroup:Z,targetGroup:M,diffSoftware:P,experimentType:d,IDtype:g,speciesID:c,diffResults:w}}),(0,oe.K)($=>(0,ne.of)({status:"error",statusValue:`Error when requesting differential analysis results. error:${$.status}, errorText:${$.statusText}`})))})).subscribe(i=>{i.hasOwnProperty("status")?this.selectedDiffAnalysisResultForPresentationSubject$.next(i):this.store.dispatch(re.zc({diffAnalysisResultInfo:i}))}),this.datasetDiffGroupPairRequest$.pipe((0,A.h)(i=>null!=i),(0,b.U)(i=>i.hasOwnProperty("datasetID")?i.datasetID:i.id.split("/")[0]),(0,v.w)(i=>this.store.pipe((0,m.Ys)(q.iR,{datasetID:i}),(0,C.q)(1)))).subscribe(i=>{this.datasetIDsubject.next(i.datasetID),this.speciesIDsubject.next(i.speciesID),this.diffSoftwareSubject.next(R.e8.get(i.experimentType)),this.geneIDtypeSubject.next(i.IDtype)}),this.requestDiffGenesEnrichedAnnotations$.pipe((0,A.h)(i=>null!=i),(0,H.M)(this.speciesIDsubject,this.geneIDtypeSubject),(0,v.w)(([i,f,d])=>{const c={genes:i.genes,backgroundGenes:i.backgroundGenes,speciesID:f,geneIDtype:d};return this._obtainGeneListIDofDiffGenesForRequest(i.diffType).pipe((0,v.w)(g=>this.store.pipe((0,m.Ys)(ge,{geneListID:g}),(0,A.h)(y=>!y),(0,v.w)(y=>this.enrichmentService.requestGenesEnrichedAnnotations(c).pipe((0,b.U)(T=>({geneListID:g,geneIDtype:d,speciesID:f,enrichedAnnotations:T})),(0,oe.K)(T=>(0,ne.of)({status:"error",statusValue:`Error occured while requesting enriched annoations. error:${T.status}, errorText:${T.statusText}`})))))))})).subscribe(i=>{i.hasOwnProperty("status")?this.geneListEnrichedResultSubject$.next(i):this.store.dispatch(ce.w({geneListEnrichedAnnotations:i}))}),(0,L.aj)([this.requestDiffGenesEnrichedAnnotations$.pipe((0,A.h)(i=>null!=i)),this.storeGeneListIDsHasEnrichedAnnotations$]).pipe((0,b.U)(([i,f])=>i),(0,v.w)(i=>this._obtainGeneListIDofDiffGenesForRequest(i.diffType)),(0,v.w)(i=>this.store.pipe((0,m.Ys)(ge,{geneListID:i}),(0,A.h)(f=>f),(0,b.U)(f=>i))),(0,v.w)(i=>this.store.pipe((0,m.Ys)(Ee,{geneListID:i})))).subscribe(i=>{this.geneListEnrichedResultSubject$.next({status:"finished",statusValue:"finished",result:i})}),this.selectedGeneExpForBoxPlot$=this.oneGeneExpRequestSubject.pipe((0,A.h)(i=>null!=i),(0,H.M)(this.datasetIDsubject,this.geneIDtypeSubject,this.speciesIDsubject,this.diffSoftwareSubject,this.selectedDiffAnalysisResultForPresentationStatus$),(0,v.w)(([i,f,d,c,g,y])=>{const T=(0,Ie.sj)(c,d),Z=this.store.pipe((0,m.Ys)(pe.ek,{IDtype:T,geneID:i}),(0,C.q)(1)),M=this.store.pipe((0,m.Ys)(q.pO,{datasetID:f}),(0,C.q)(1)),P=this.store.pipe((0,m.Ys)(de.l,{datasetID:f,geneIDs:[i]}),(0,C.q)(1)),$=(0,Y.Y6)(y.result.diffResults,g,"rawPvalue",i);return(0,Se.D)([Z,M,P]).pipe((0,b.U)(([w,X,se])=>{const ie=se.expressionValues[0],ae=se.samples;return{geneInfo:w,groupsExpInfo:X.map(Fe=>{const Ht=Fe.samples.map(Te=>({sampleName:Te,value:ie[ae.indexOf(Te)]}));return{groupName:Fe.name,samplesExpInfo:Ht}}),groupPairsPvalue:[{baseGroup:y.result.baseGroup,targetGroup:y.result.targetGroup,pValue:$.pValue}]}}))})),this.selectedPathwaySubject.pipe((0,A.h)(Boolean),(0,H.M)(this.speciesIDsubject)).subscribe(([i,f])=>{this.interAppsInteractService.sendPathway2KeggExp({speciesID:f,pathwayID:i})}),(0,xe.T)(this.diffGenesPPIrequestSubject,this.addDiffGenesToGeneListSubject).pipe((0,A.h)(i=>null!=i),(0,H.M)(this.speciesIDsubject,this.geneIDtypeSubject),(0,v.w)(([i,f,d])=>{const c=i.genes;return this._obtainGeneListIDofDiffGenesForRequest(i.diffType).pipe((0,b.U)(g=>({name:g,speciesID:f,IDtype:d,genes:c})))}),(0,v.w)(i=>this.store.pipe((0,m.Ys)(le.Ef,{geneListID:i.name}),(0,C.q)(1),(0,A.h)(f=>!f),(0,b.U)(f=>i)))).subscribe(i=>{this.store.dispatch(Ze.J({geneList:i}))}),(0,L.aj)([this.store.pipe((0,m.Ys)(le.Dm)),this.diffGenesPPIrequestSubject.pipe((0,A.h)(i=>null!=i))]).pipe((0,v.w)(([i,f])=>this._obtainGeneListIDofDiffGenesForRequest(f.diffType).pipe((0,v.w)(d=>this.store.pipe((0,m.Ys)(le.Ef,{geneListID:d}),(0,C.q)(1),(0,A.h)(c=>c),(0,b.U)(c=>d))))),(0,fe.x)()).subscribe(i=>{this.interAppsInteractService.sendGeneList2PPIExp(i)}),this.trySamppleService.trySampleData$.pipe((0,A.h)(Boolean)).subscribe(i=>{this.store.dispatch(Pe.CF({newState:i.datasetListState})),this.store.dispatch($e.gw({newState:i.localExpressDataState})),this.store.dispatch(re.Uw({newState:i.diffAnalysisResultState})),this.store.dispatch(Ce.A({newState:i.geneAnnotationsState})),this.store.dispatch(ce.V({newState:i.geneListEnrichedAnnotationsState}))}),this.trySamplePercentage$=this.trySamppleService.trySamplePercentage$}_obtainDiffAnalysisResult(t){return t.hasOwnProperty("id")?this.store.pipe((0,m.Ys)(W.bc,{ID:t.id}),(0,C.q)(1)):this.store.pipe((0,m.Ys)(W.H5,{datasetID:t.datasetID,baseGroup:t.baseGroup,targetGroup:t.targetGroup}),(0,A.h)(s=>s),(0,v.w)(s=>this.store.pipe((0,m.Ys)(W.fh,{datasetID:t.datasetID,baseGroup:t.baseGroup,targetGroup:t.targetGroup}),(0,C.q)(1))))}_checkIfDiffAnalysisExisted(t){return this.store.pipe((0,m.Ys)(W.N8,{ID:t}),(0,C.q)(1))}_obtainGeneListIDofDiffGenesForRequest(t){return(0,ne.of)(t).pipe((0,H.M)(this.datasetDiffGroupPairRequest$,this.diffFilterInput$,this.diffSoftwareSubject),(0,b.U)(([s,a,r,u])=>function(n,o,t,s){const a=t.pValueType,r=t.pValue,u=t.foldChangeType,x=t.foldChange;if(n.hasOwnProperty("id"))return`${n.id}/${u}-${x}-${a}-${r}/${s}`;{const f=t.pValueType,d=t.pValue,c=t.foldChangeType,g=t.foldChange;return`${ee(n.datasetID,n.baseGroup,n.targetGroup,o,n.diffAnalysisSettings)}/${c}-${g}-${f}-${d}/${s}`}}(a,u,r,s)),(0,C.q)(1))}requestSelectedDatasetGroups(t){this.requestGroupsOfSelectedDataset$.next(t)}requestDatasetGroupPairDiffAnalysis(t){this.datasetDiffGroupPairRequest$.next(t)}storeDiffFilterInput(t){this.diffFilterInput$.next(t)}requestDiffGenesEnrichedAnnotations(t){this.requestDiffGenesEnrichedAnnotations$.next(t)}requestOneGeneExpressionForBoxplot(t){this.oneGeneExpRequestSubject.next(t)}visDiffGenesPPIs(t){this.diffGenesPPIrequestSubject.next(t)}addDiffGenesToGeneList(t){this.addDiffGenesToGeneListSubject.next(t)}prepareTrySampleData(t){this.trySamppleService.requestTrySampleData(t)}processSelectedKEGGpathway(t){this.selectedPathwaySubject.next(t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(m.yh),e.LFG(Ne.h),e.LFG(Ve.g),e.LFG(Ue.v),e.LFG(Je.h),e.LFG(qe.f),e.LFG(Be.h),e.LFG(Ye.b))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Qe=l(6087),_e=l(1125),te=l(8805);function He(n,o){if(1&n&&(e.TgZ(0,"option",6),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij("",t.name," ")}}function Xe(n,o){if(1&n&&(e.TgZ(0,"option",6),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function ke(n,o){1&n&&(e.TgZ(0,"label",7),e._uU(1,"Experiment group should not equal control group "),e.qZA())}const Ke=n=>{const o=n.get("baseGroup"),t=n.get("targetGroup");return o.value&&o&&t&&o.value===t.value?{identityRevealed:!0}:null};let ze=(()=>{class n{constructor(){this.diffGroupPair$=new e.vpe,this.destroyNotifier$=new B.xQ}ngOnInit(){this.groupPairForm=new p.cw({baseGroup:new p.NI("",[p.kI.required,p.kI.minLength(1)]),targetGroup:new p.NI("",[p.kI.required,p.kI.minLength(1)])},{validators:Ke}),this.groupPairForm.valueChanges.pipe((0,te.R)(this.destroyNotifier$)).subscribe(t=>{var s;"VALID"===(null===(s=this.groupPairForm)||void 0===s?void 0:s.status)?this.diffGroupPair$.next(t):this.diffGroupPair$.next(null)})}ngOnChanges(t){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-generate-diff-grouppair"]],inputs:{datasetGroups:"datasetGroups"},outputs:{diffGroupPair$:"diffGroupPair$"},features:[e.TTD],decls:13,vars:4,consts:[[3,"formGroup"],[1,"align-self-start"],["formControlName","baseGroup",1,"form-control","form-control-sm"],[3,"value",4,"ngFor","ngForOf"],["formControlName","targetGroup",1,"form-control","form-control-sm"],["class","text-danger font-weight-light",4,"ngIf"],[3,"value"],[1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"form",0),e.TgZ(2,"div",1),e.TgZ(3,"h5"),e._uU(4,"Control Group:"),e.qZA(),e.TgZ(5,"select",2),e.YNc(6,He,2,2,"option",3),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"h5"),e._uU(9,"Experiment Group:"),e.qZA(),e.TgZ(10,"select",4),e.YNc(11,Xe,2,2,"option",3),e.qZA(),e.YNc(12,ke,2,0,"label",5),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",s.groupPairForm),e.xp6(5),e.Q6J("ngForOf",s.datasetGroups),e.xp6(5),e.Q6J("ngForOf",s.datasetGroups),e.xp6(1),e.Q6J("ngIf",null==s.groupPairForm.errors?null:s.groupPairForm.errors.identityRevealed))},directives:[p._Y,p.JL,p.sg,p.EJ,p.JJ,p.u,F.sg,F.O5,p.YN,p.Kr],styles:[""],changeDetection:0}),n})();var We=l(1026),et=l(438);let tt=(()=>{class n{constructor(){this.diffAnalysisInfo$=new e.vpe,this.foldChangeCalculationMethods=[{name:"mean",description:"Mean(Exp)/Mean(Ctrl)"},{name:"median",description:"Median(Exp)/Median(Ctrl)"}],this.differentialStatisticMethod=[{name:"ranksums",description:"Wilcoxon Rank Sum Test"},{name:"welch-t",description:"Welch-t Test"},{name:"student-t",description:"Student-t Test"}],this.pValueCorrectionMethods=[{name:"fdr_bh",description:"FDR-BH"},{name:"bonferroni",description:"Bonferroni"},{name:"holm-sidak",description:"Holm-Sidak"}],this.foldChangeCalMethodSubject=new _.X(null),this.pValueCalMethodSubject=new _.X(null),this.pValueAdjMethodSubject=new _.X(null),this.destroyNotifier$=new B.xQ}ngOnInit(){(0,L.aj)([this.foldChangeCalMethodSubject.pipe((0,A.h)(t=>null!=t)),this.pValueCalMethodSubject.pipe((0,A.h)(t=>null!=t)),this.pValueAdjMethodSubject.pipe((0,A.h)(t=>null!=t))]).pipe((0,b.U)(([t,s,a])=>({FCcalMethod:t,pValuCalMethod:s,pValueAdjMethod:a}))).subscribe(t=>{this.diffAnalysisInfo$.next(t)})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processFoldChangeCalculationMethod(t){this.foldChangeCalMethodSubject.next(t.name)}processPvalueCalculationMethod(t){this.pValueCalMethodSubject.next(t.name)}processPvalueAdjustMethod(t){this.pValueAdjMethodSubject.next(t.name)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-proteomics-diff-analysis-settings"]],outputs:{diffAnalysisInfo$:"diffAnalysisInfo$"},decls:3,vars:18,consts:[["data-testid","foldChangeMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","selectedItemObject$"],["data-testid","pValueMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","selectedItemObject$"],["data-testid","pValueAdjMethod",3,"inputObjects","idAttribute","displayAttribute","itemLabel","formInlineOrNot","ifOutputFirstValue","selectedItemObject$"]],template:function(t,s){1&t&&(e.TgZ(0,"app-select-item-object",0),e.NdJ("selectedItemObject$",function(r){return s.processFoldChangeCalculationMethod(r)}),e.qZA(),e.TgZ(1,"app-select-item-object",1),e.NdJ("selectedItemObject$",function(r){return s.processPvalueCalculationMethod(r)}),e.qZA(),e.TgZ(2,"app-select-item-object",2),e.NdJ("selectedItemObject$",function(r){return s.processPvalueAdjustMethod(r)}),e.qZA()),2&t&&(e.Q6J("inputObjects",s.foldChangeCalculationMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","Method for Calculating Fold Change")("formInlineOrNot",!0)("ifOutputFirstValue",!0),e.xp6(1),e.Q6J("inputObjects",s.differentialStatisticMethod)("idAttribute","name")("displayAttribute","description")("itemLabel","Differential Statistics Method")("formInlineOrNot",!0)("ifOutputFirstValue",!0),e.xp6(1),e.Q6J("inputObjects",s.pValueCorrectionMethods)("idAttribute","name")("displayAttribute","description")("itemLabel","P vaule Adjust Method")("formInlineOrNot",!0)("ifOutputFirstValue",!0))},directives:[et.w],styles:[""],changeDetection:0}),n})();const st=["submitButton"];function nt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"app-select-dataset",7),e.NdJ("selectedDatasetID$",function(a){return e.CHM(t),e.oxw().processSelectedDataset(a)}),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("allDatasetInfoForDisplay",t.allDatasetInfoForDisplay)("formInlineOrNot",!1)}}function it(n,o){1&n&&(e.TgZ(0,"p"),e._uU(1,"Please import a Expression Profile data first. "),e.TgZ(2,"a",8),e._uU(3,"Import Data"),e.qZA(),e.qZA())}function at(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-proteomics-diff-analysis-settings",9),e.NdJ("diffAnalysisInfo$",function(a){return e.CHM(t),e.oxw().processProteomicsDiffAnalysisSettings(a)}),e.qZA()}}let ot=(()=>{class n{constructor(t){this.cdr=t,this.selectedDatasetID$=new e.vpe,this.diffGroupPairRequest$=new e.vpe,this.selectedDatasetExperimentType="RNA-seq of coding RNA",this._selectedDatasetID$=new _.X(null),this._diffGroupPair$=new _.X(null),this._diffAnalysisSettings$=new _.X(null),this.destroyNotifier$=new B.xQ}ngOnInit(){}ngAfterViewInit(){this.submitStream$=(0,Qe.R)(this.submitButton.nativeElement,"click"),this.ifSubmitAvailable$=(0,L.aj)([this._selectedDatasetID$,this._diffGroupPair$,this._diffAnalysisSettings$]).pipe((0,b.U)(([t,s,a])=>!!(t&&s&&a)),(0,_e.O)(!1),(0,te.R)(this.destroyNotifier$)),this.submitStream$.pipe((0,te.R)(this.destroyNotifier$),(0,A.h)(t=>null!=t),(0,H.M)(this._selectedDatasetID$.pipe((0,A.h)(t=>null!==t),(0,te.R)(this.destroyNotifier$)),this._diffGroupPair$.pipe((0,A.h)(t=>null!=t)),this._diffAnalysisSettings$.pipe((0,A.h)(t=>null!=t)))).subscribe(([t,s,a,r])=>{this.diffGroupPairRequest$.next({datasetID:s,targetGroup:a.targetGroup,baseGroup:a.baseGroup,diffAnalysisSettings:r}),this.cdr.detectChanges()})}ngOnChanges(t){t.allDatasetInfoForDisplay&&(this.allDatasetInfoForDisplay=[...this.allDatasetInfoForDisplay])}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedDataset(t){this._selectedDatasetID$.next(t),this.selectedDatasetID$.next(t),this.selectedDatasetExperimentType=this._obtainExprimentType(t),"Protein profiling by Mass Spec"!==this.selectedDatasetExperimentType&&this._diffAnalysisSettings$.next({FCcalMethod:"third_party_software",pValuCalMethod:"third_party_software",pValueAdjMethod:"third_party_software"})}processDiffGroupPair(t){this._diffGroupPair$.next(t),this.cdr.detectChanges()}processProteomicsDiffAnalysisSettings(t){this._diffAnalysisSettings$.next(t),this.cdr.detectChanges()}_obtainExprimentType(t){let s;for(let a of this.allDatasetInfoForDisplay)if(a.datasetID===t){s=a.experimentType;break}return s}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-generate-diff-analysis"]],viewQuery:function(t,s){if(1&t&&e.Gf(st,5),2&t){let a;e.iGM(a=e.CRH())&&(s.submitButton=a.first)}},inputs:{allDatasetInfoForDisplay:"allDatasetInfoForDisplay",datasetGroups:"datasetGroups"},outputs:{selectedDatasetID$:"selectedDatasetID$",diffGroupPairRequest$:"diffGroupPairRequest$"},features:[e.TTD],decls:12,vars:7,consts:[[1,"mt-4"],[4,"ngIf","ngIfElse"],["importDataNote",""],[3,"datasetGroups","diffGroupPair$"],[3,"diffAnalysisInfo$",4,"ngIf"],["data-testid","submitDiffAnalysis",1,"mt-3","btn","btn-expressvis",3,"disabled"],["submitButton",""],[3,"allDatasetInfoForDisplay","formInlineOrNot","selectedDatasetID$"],["routerLink","/importData"],[3,"diffAnalysisInfo$"]],template:function(t,s){if(1&t&&(e.TgZ(0,"h5",0),e._uU(1," Generate a Differential Analysis\n"),e.qZA(),e.TgZ(2,"div"),e.YNc(3,nt,2,2,"div",1),e.YNc(4,it,4,0,"ng-template",null,2,e.W1O),e.TgZ(6,"app-generate-diff-grouppair",3),e.NdJ("diffGroupPair$",function(r){return s.processDiffGroupPair(r)}),e.qZA(),e.YNc(7,at,1,0,"app-proteomics-diff-analysis-settings",4),e.TgZ(8,"button",5,6),e.ALo(10,"async"),e._uU(11," Submit "),e.qZA(),e.qZA()),2&t){const a=e.MAs(5);e.xp6(3),e.Q6J("ngIf",(null==s.allDatasetInfoForDisplay?null:s.allDatasetInfoForDisplay.length)>0)("ngIfElse",a),e.xp6(3),e.Q6J("datasetGroups",s.datasetGroups),e.xp6(1),e.Q6J("ngIf","Protein profiling by Mass Spec"===s.selectedDatasetExperimentType),e.xp6(1),e.Q6J("disabled",!e.lcZ(10,5,s.ifSubmitAvailable$))}},directives:[F.O5,ze,We.z,I.yS,tt],pipes:[F.Ov],styles:[""],changeDetection:0}),n})();var ve=l(2473),be=l(5043);const lt=function(n,o,t,s){if("Protein profiling by Mass Spec"===n){const a=t.split(";");let r=[];return a.forEach(u=>{o.hasOwnProperty(u)?r.push(o[u][s]):r.push(null)}),r.join(";")}return o.hasOwnProperty(t)?o[t][s]:null},dt={grid:{show:!0,borderWidth:1,borderColor:"black",bottom:100,left:100,right:50},xAxis:{name:"Log2(Fold Change)",nameLocation:"center",nameGap:30,splitLine:{show:!1},nameTextStyle:{fontSize:20}},yAxis:{name:"-Log10(Pvalue)",nameLocation:"middle",nameGap:30,nameTextStyle:{fontSize:20},splitLine:{show:!1}},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"empty"},{type:"slider",yAxisIndex:0,filterMode:"empty"},{type:"inside",xAxisIndex:0,filterMode:"empty"},{type:"inside",yAxisIndex:0,filterMode:"empty"}],series:[]};var ct=l(5636);let ut=(()=>{class n{constructor(t){this.cdr=t,this.idIndex=0,this.nameIndex=1,this.foldChangeIndex=2,this.pValueIndex=3,this.initOpts={width:400,height:450},this.options=dt,this.height=500,this.width=400}ngOnInit(){}ngOnViewInit(){this.circlesInfo&&this._setScattersPointsInfo(),this.diffFilterCutoff&&this._setMarkerLinesInfo()}ngOnChanges(t){var s,a;t.circlesInfo&&this.circlesInfo&&(this._setScattersPointsInfo(),this._setMarkerLinesInfo(),null===(s=this.echart)||void 0===s||s.setOption(this.options)),t.diffFilterCutoff&&!t.diffFilterCutoff.isFirstChange()&&(this._setScattersPointsInfo(),this._setMarkerLinesInfo(),null===(a=this.echart)||void 0===a||a.setOption(this.options))}onChartInit(t){this.echart=t}_setScattersPointsInfo(){let t=this.circlesInfo.map(s=>{const a=s[this.foldChangeIndex],r=s[this.pValueIndex];return{value:[a,r],name:s[this.idIndex],symbol:s[this.nameIndex],itemStyle:{color:this._determineColor(a,r,this.diffFilterCutoff.foldChangeCutoff,this.diffFilterCutoff.pValueCutoff)}}});this.options=Object.assign(Object.assign({},this.options),{series:{data:t,type:"scatter",symbolSize:5,animation:!0,tooltip:{formatter:function(s){return"ID:"+s.name+"<br>Symbol:"+s.data.symbol+"<br>log2 Fold Change:"+s.value[0]+"<br>-log10 P value:"+s.value[1]},position:"right"}},tooltip:{formatter:function(s){return""}}})}_setMarkerLinesInfo(){this.options=Object.assign(Object.assign({},this.options),{series:Object.assign(Object.assign({},this.options.series),{markLine:{symbol:"none",lineStyle:{color:"grey",width:1,type:"dashed"},data:[{xAxis:this.diffFilterCutoff.foldChangeCutoff},{xAxis:-this.diffFilterCutoff.foldChangeCutoff},{yAxis:this.diffFilterCutoff.pValueCutoff}]}})})}_determineColor(t,s,a,r){return t>=a&&s>=r?"red":t<=-a&&s>=r?"green":"grey"}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-echarts-volcano-plot"]],inputs:{circlesInfo:"circlesInfo",diffFilterCutoff:"diffFilterCutoff"},features:[e.TTD],decls:1,vars:2,consts:[["echarts","",2,"height","500px",3,"initOpts","options","chartInit"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.NdJ("chartInit",function(r){return s.onChartInit(r)}),e.qZA()),2&t&&e.Q6J("initOpts",s.initOpts)("options",s.options)},directives:[ct._w],styles:[""],changeDetection:0}),n})();function ht(n,o){1&n&&(e.TgZ(0,"p",2),e._uU(1,"Please generate a differential analysis in left sidebar first"),e.qZA())}function mt(n,o){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(null==t.diffAnalysisResultForPresentationStatus?null:t.diffAnalysisResultForPresentationStatus.statusValue)}}function gt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"app-echarts-volcano-plot",3),e.TgZ(2,"button",4),e.NdJ("click",function(a){return e.CHM(t),e.oxw().downloadAllDiffGenes(a)}),e._uU(3," Download "),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("circlesInfo",t.circlesInfo)("diffFilterCutoff",t.diffFilterCutoff)}}let yt=(()=>{class n{constructor(t){this.cdr=t,this.faFilter=be.G_j,this.faTimes=be.NBC,this.ifShowFilterBox=!1}ngOnInit(){this._obtainCirclesInfo()}ngOnChanges(t){t.diffAnalysisResultForPresentationStatus&&!t.diffAnalysisResultForPresentationStatus.isFirstChange()&&this._obtainCirclesInfo(),t.diffFilterCutoff&&!t.diffFilterCutoff.isFirstChange()&&this._obtainCirclesInfo()}processDiffFilterInfo(t){}_obtainCirclesInfo(){var t;if("finished"===(null===(t=this.diffAnalysisResultForPresentationStatus)||void 0===t?void 0:t.status)){const s=this.diffAnalysisResultForPresentationStatus.result;this.circlesInfo=function(n,o,t,s,a,r){const u=function(n){return"EnsemblGene"===n||"NcbiEntrezGene"===n||"NcbiRefseqProtein"===n?0:1}(s),x=R.gO[n].geneIDattr;let E=R.gO[n].rawPvalueAttr;"adjPvalue"===a&&(E=R.gO[n].adjPvalueAttr);const i=[...o[x]],f=[...o[E]],d=[...o[R.gO[n].foldChangeAttr]];let c=[];c.length=o[x].length;for(let y=0;y<i.length;y++){const T=i[y],Z=lt(r,t,T,u);c[y]=[T,Z,d[y],-Math.log10(f[y])]}return c.filter(y=>!isNaN(y[2])&&!isNaN(y[3])&&y[3]!=1/0)}(s.diffSoftware,s.diffResults,s.genesInfo.genesInfoDic,s.IDtype,this.diffFilterCutoff.pValueType,s.experimentType)}}_generateFilenameForDiffAnalysis(){const t=this.diffAnalysisResultForPresentationStatus.result;return`${t.datasetID}-${t.targetGroup} VS ${t.baseGroup}.txt`}downloadAllDiffGenes(t){var s;if("finished"===(null===(s=this.diffAnalysisResultForPresentationStatus)||void 0===s?void 0:s.status)){const a=this.diffAnalysisResultForPresentationStatus.result,G=function(n,o,t){const s="logFC",a="PROBEID",r="P.Value",u="adj.P.Val",x=[...o[a]],G=[...o[r]],E=[...o[u]],i=[...o[s]];let f=[];f.length=x.length;for(let[c,g,y,T,Z]of(0,De.Vi)(x,G,E,i)){const[M,P]=(0,Ie.Oi)("Expression profiling by array",t,c,1,2);f[Z]=[c,M,P,T,g,y]}return{features:[a,"Symbol","Description",s,r,u],genesInfo:f}}(0,a.diffResults,a.genesInfo.genesInfoDic),i=G.genesInfo;let f=G.features.join("\t")+"\n";f+=i.map(T=>T.join("\t")).join("\n");const g=this._generateFilenameForDiffAnalysis();let y=new Blob([f],{type:"text/csv;charset=utf-8"});(0,ve.saveAs)(y,g)}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-volcano-plot"]],inputs:{diffAnalysisResultForPresentationStatus:"diffAnalysisResultForPresentationStatus",diffFilterCutoff:"diffFilterCutoff"},features:[e.TTD],decls:3,vars:3,consts:[[3,"ngIf"],[4,"ngIf"],["data-testid","generateDiffNote",1,"mt-2","text-danger"],[3,"circlesInfo","diffFilterCutoff"],[1,"btn","btn-sm","btn-expressvis","ml-2",3,"click"]],template:function(t,s){1&t&&(e.YNc(0,ht,2,0,"ng-template",0),e.YNc(1,mt,2,1,"ng-template",0),e.YNc(2,gt,4,2,"div",1)),2&t&&(e.Q6J("ngIf",!s.diffAnalysisResultForPresentationStatus),e.xp6(1),e.Q6J("ngIf","error"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)||"loading"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(1),e.Q6J("ngIf","finished"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)))},directives:[F.O5,ut],styles:[""],changeDetection:0}),n})();var Dt=l(6458);const It=function(n){return{active:n}};function At(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"li",10),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().setActiveGenesDiffType(r.name)}),e.TgZ(1,"a",11),e._uU(2),e.qZA(),e.qZA()}if(2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngClass",e.VKq(2,It,t.ifActive)),e.xp6(1),e.hij(" ",t.name," ")}}function _t(n,o){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"p",12),e._uU(2,"Please generate a differential analysis in left sidebar first"),e.qZA(),e.qZA())}function vt(n,o){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(null==t.diffAnalysisResultForPresentationStatus?null:t.diffAnalysisResultForPresentationStatus.statusValue)}}function bt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-display-genes-info-table-pagination",13),e.NdJ("selectedGene$",function(a){return e.CHM(t),e.oxw().processedSelectedGene(a)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("genesInfoForTable",t.genesInfoForTable)}}function Ft(n,o){if(1&n&&(e.TgZ(0,"p",14),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" The differential genes named '",t.diffGeneListID,"' has been added to gene lists. You can use it in other apps\n")}}let Tt=(()=>{class n{constructor(){this.diffGenesEnrichRequest=new e.vpe,this.diffGenesPPIrequest$=new e.vpe,this.selectedGene$=new e.vpe,this.genesForAdding$=new e.vpe,this.genesDiffTypes=[{name:"Up-expressed",ifActive:!0},{name:"Down-expressed",ifActive:!1},{name:"All",ifActive:!1}],this.ifShowDiffGeneType=!0,this.ifShowPageRouter=!1,this.ifShowForwardButton=!1,this.ifDiffAnalysisPrepared=!1,this.selectedDiffType="up",this.ifShowDiffGenesHasBeenAddedNote=!1}ngOnInit(){this.diffAnalysisResultForPresentationStatus&&this.diffAnalysisResultForPresentationStatus.hasOwnProperty("result")&&(this.ifDiffAnalysisPrepared=!0,this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded())}ngOnChanges(t){var s,a,r;t.diffAnalysisResultForPresentationStatus&&!t.diffAnalysisResultForPresentationStatus.isFirstChange()&&("finished"===(null===(s=this.diffAnalysisResultForPresentationStatus)||void 0===s?void 0:s.status)?(this.ifDiffAnalysisPrepared=!0,this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()):this.ifDiffAnalysisPrepared=!1),t.diffFilterInput&&!t.diffFilterInput.isFirstChange()&&"finished"===(null===(a=this.diffAnalysisResultForPresentationStatus)||void 0===a?void 0:a.status)&&(this._prepareDataForDisplay(),this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()),t.allAvailableGenelistIDs&&"finished"===(null===(r=this.diffAnalysisResultForPresentationStatus)||void 0===r?void 0:r.status)&&this._checkIfGeneListHasBeenAdded()}_prepareDataForDisplay(){this.diffGenesInfoForTable=(0,Y.gE)(this.diffAnalysisResultForPresentationStatus.result.experimentType,this.diffAnalysisResultForPresentationStatus.result.diffSoftware,this.diffAnalysisResultForPresentationStatus.result.IDtype,this.diffAnalysisResultForPresentationStatus.result.diffResults,this.diffAnalysisResultForPresentationStatus.result.genesInfo.genesInfoDic,this.diffFilterInput)}_changeGenesInfoAccordingToDiffType(){this.ifDiffAnalysisPrepared&&(this.genesInfoForTable="up"===this.selectedDiffType?{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.upGenes}:"down"===this.selectedDiffType?{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.downGenes}:{features:this.diffGenesInfoForTable.features,genesInfo:this.diffGenesInfoForTable.upGenes.concat(this.diffGenesInfoForTable.downGenes)})}_checkIfGeneListHasBeenAdded(){var t;const s=function(n,o,t){return`${n}/${t.foldChangeType}-${t.foldChange}-${t.pValueType}-${t.pValue}/${o}`}(this.diffAnalysisResultForPresentationStatus.result.id,this.selectedDiffType,this.diffFilterInput);this.ifShowDiffGenesHasBeenAddedNote=!!(null===(t=this.allAvailableGenelistIDs)||void 0===t?void 0:t.includes(s)),this.diffGeneListID=s}setActiveGenesDiffType(t){this.genesDiffTypes=this.genesDiffTypes.map(s=>Object.assign(Object.assign({},s),s.name===t?{ifActive:!0}:{ifActive:!1})),this.selectedDiffType="Up-expressed"===t?"up":"Down-expressed"===t?"down":"allDiff",this._changeGenesInfoAccordingToDiffType(),this._checkIfGeneListHasBeenAdded()}_obtainDiffGenesForEnchriment(){const t=this.diffGenesInfoForTable.geneIDattr;return"up"===this.selectedDiffType?this.diffGenesInfoForTable.upGenes.map(a=>a[t]).map(a=>a.split(";")[0]):"down"===this.selectedDiffType?this.diffGenesInfoForTable.downGenes.map(a=>a[t]).map(a=>a.split(";")[0]):this.diffGenesInfoForTable.upGenes.concat(this.diffGenesInfoForTable.downGenes).map(a=>a[t]).map(a=>a.split(";")[0])}_obtainBackgroundGenesForEncirhment(){return this.diffAnalysisResultForPresentationStatus.result.diffResults[R.gO[this.diffAnalysisResultForPresentationStatus.result.diffSoftware].geneIDattr].map(u=>u.split(";")[0])}requestEnrichedAnalysis(t){const s=this._obtainDiffGenesForEnchriment(),a=this._obtainBackgroundGenesForEncirhment();this.diffGenesEnrichRequest.next({diffType:this.selectedDiffType,genes:s,backgroundGenes:a})}processedSelectedGene(t){this.selectedGene$.next(t)}requestPPInetwork(t){const s=this._obtainDiffGenesForEnchriment();this.diffGenesPPIrequest$.next({diffType:this.selectedDiffType,genes:s})}addDiffGenesToGeneList(t){const s=this._obtainDiffGenesForEnchriment();this.genesForAdding$.next({diffType:this.selectedDiffType,genes:s})}_formatGenesDownloadFile(){const t=this.diffAnalysisResultForPresentationStatus.result;return`${t.datasetID}-${t.targetGroup} VS ${t.baseGroup}-${this.selectedDiffType}.txt`}downloadGenes(t){const s=this.genesInfoForTable.features,a=this.genesInfoForTable.genesInfo;let r=s.join("\t")+"\n";r+=a.map(i=>s.map(d=>i[d]).join("\t")).join("\n");const G=this._formatGenesDownloadFile();let E=new Blob([r],{type:"text/csv;charset=utf-8"});(0,ve.saveAs)(E,G)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-table-management"]],inputs:{diffAnalysisResultForPresentationStatus:"diffAnalysisResultForPresentationStatus",diffFilterInput:"diffFilterInput",allAvailableGenelistIDs:"allAvailableGenelistIDs"},outputs:{diffGenesEnrichRequest:"diffGenesEnrichRequest",diffGenesPPIrequest$:"diffGenesPPIrequest$",selectedGene$:"selectedGene$",genesForAdding$:"genesForAdding$"},features:[e.TTD],decls:15,vars:9,consts:[["data-testid","switchDiffType",1,"nav","nav-tabs"],["class","nav-item",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12"],[3,"genesInfoForTable","selectedGene$",4,"ngIf"],["data-testid","enrichSubmit",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],[1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["data-testid","triggerVisPPI",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["data-testid","addToGeneList",1,"btn","btn-sm","btn-expressvis","mr-2","mt-1",3,"disabled","click"],["class","text-success","data-testid","diffGenesHasBeenAddedNote",4,"ngIf"],[1,"nav-item",3,"click"],["href","javascript:void(0)",1,"nav-link",3,"ngClass"],["data-testid","generateDiffNote",1,"mt-5","text-danger"],[3,"genesInfoForTable","selectedGene$"],["data-testid","diffGenesHasBeenAddedNote",1,"text-success"]],template:function(t,s){1&t&&(e.TgZ(0,"ul",0),e.YNc(1,At,3,4,"li",1),e.qZA(),e.YNc(2,_t,3,0,"div",2),e.YNc(3,vt,3,1,"div",2),e.TgZ(4,"div",3),e.YNc(5,bt,1,1,"app-display-genes-info-table-pagination",4),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(r){return s.requestEnrichedAnalysis(r)}),e._uU(7," Enrichment Analysis\n"),e.qZA(),e.TgZ(8,"button",6),e.NdJ("click",function(r){return s.downloadGenes(r)}),e._uU(9," Download\n"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(r){return s.requestPPInetwork(r)}),e._uU(11," Visualize PPIs in PPIExp\n"),e.qZA(),e.TgZ(12,"button",8),e.NdJ("click",function(r){return s.addDiffGenesToGeneList(r)}),e._uU(13," Add Genes To Gene Lists\n"),e.qZA(),e.YNc(14,Ft,2,1,"p",9)),2&t&&(e.xp6(1),e.Q6J("ngForOf",s.genesDiffTypes),e.xp6(1),e.Q6J("ngIf",!s.diffAnalysisResultForPresentationStatus),e.xp6(1),e.Q6J("ngIf","error"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)||"loading"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(2),e.Q6J("ngIf","finished"===(null==s.diffAnalysisResultForPresentationStatus?null:s.diffAnalysisResultForPresentationStatus.status)),e.xp6(1),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared),e.xp6(2),e.Q6J("disabled",!s.ifDiffAnalysisPrepared||s.ifShowDiffGenesHasBeenAddedNote),e.xp6(2),e.Q6J("ngIf",s.ifShowDiffGenesHasBeenAddedNote))},directives:[F.sg,F.O5,F.mk,Dt.T],styles:[".modalBigSize[_ngcontent-%COMP%]{width:100vw}"],changeDetection:0}),n})();var St=l(4547),xt=l(5826);function Gt(n,o){if(1&n&&(e.TgZ(0,"option",4),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Ct(n,o){1&n&&(e.TgZ(0,"label",5),e._uU(1,"Please Generate or Load a Differential Analysis First "),e.qZA())}let Pt=(()=>{class n{constructor(t){this.cdr=t,this.selectedDiffAnalysisId$=new e.vpe,this.destroyNotifier$=new B.xQ,this.diffAnalysisForm=new p.cw({diffAnalysisID:new p.NI("",p.kI.required)})}ngOnInit(){this.diffAnalysisForm.get("diffAnalysisID").valueChanges.pipe((0,te.R)(this.destroyNotifier$)).subscribe(t=>{var s;"VALID"===(null===(s=this.diffAnalysisForm.get("diffAnalysisID"))||void 0===s?void 0:s.status)&&(this.selectedDiffAnalysisId$.next(t),this.cdr.detectChanges())}),this.allDiffAnalysisIds&&this.allDiffAnalysisIds.length>=1&&this.diffAnalysisForm.patchValue({diffAnalysisID:this.allDiffAnalysisIds[this.allDiffAnalysisIds.length-1]})}ngAfterViewInit(){}ngOnChanges(t){t.allDiffAnalysisIds&&!t.allDiffAnalysisIds.isFirstChange()&&this.allDiffAnalysisIds&&this.allDiffAnalysisIds.length>=1&&this.diffAnalysisForm.patchValue({diffAnalysisID:this.allDiffAnalysisIds[this.allDiffAnalysisIds.length-1]})}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-select-diff-analysis"]],inputs:{allDiffAnalysisIds:"allDiffAnalysisIds"},outputs:{selectedDiffAnalysisId$:"selectedDiffAnalysisId$"},features:[e.TTD],decls:6,vars:3,consts:[[1,"form-inline",3,"formGroup"],["formControlName","diffAnalysisID","placeholder","Select a Differential Analysis",1,"form-control","form-control-sm","form-inline"],[3,"value",4,"ngFor","ngForOf"],["data-testid","diffAlert","class","text-danger font-weight-light",4,"ngIf"],[3,"value"],["data-testid","diffAlert",1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"h5"),e._uU(2,"Available Differential Analysis:"),e.qZA(),e.TgZ(3,"select",1),e.YNc(4,Gt,2,2,"option",2),e.qZA(),e.YNc(5,Ct,2,0,"label",3),e.qZA()),2&t&&(e.Q6J("formGroup",s.diffAnalysisForm),e.xp6(4),e.Q6J("ngForOf",s.allDiffAnalysisIds),e.xp6(1),e.Q6J("ngIf",!(s.allDiffAnalysisIds&&s.allDiffAnalysisIds.length>0)))},directives:[p._Y,p.JL,p.sg,p.EJ,p.JJ,p.u,F.sg,F.O5,p.YN,p.Kr],styles:[""],changeDetection:0}),n})();var $t=l(5686);function wt(n,o){1&n&&(e.TgZ(0,"label",11),e._uU(1," P value should be between 0 and 1 "),e.qZA())}function Et(n,o){1&n&&(e.TgZ(0,"label",11),e._uU(1," Raw fold change should be up 1 "),e.qZA())}function Zt(n,o){1&n&&(e.TgZ(0,"label",11),e._uU(1," Log2 fold change should be up 0 "),e.qZA())}const Ot=function(n){return{"form-inline":n}},Rt=function(n){let o=n.get("foldChangeType").value,t=n.get("foldChange").value;return"rawFoldChange"===o?t>=1?null:{foldChangeValid:!0}:t>=0?null:{foldChangeValid:!0}};let jt=(()=>{class n{constructor(){this.formInlineOrNot=!0,this.diffFilterInfo$=new e.vpe,this.diffFilterInfoForm=new p.cw({pValueType:new p.NI("rawPvalue",p.kI.required),pValue:new p.NI(.01,[p.kI.required,p.kI.min(0),p.kI.max(1)]),foldChangeType:new p.NI("rawFoldChange"),foldChange:new p.NI(2,[p.kI.required,p.kI.min(0)])},{validators:Rt}),this._defaultDiffFilterInput={pValueType:"rawPvalue",pValue:.01,foldChangeType:"rawFoldChange",foldChange:2}}ngOnInit(){this.diffFilterInfoForm.get("foldChangeType").valueChanges.subscribe(t=>{"rawFoldChange"===t?this.diffFilterInfoForm.get("foldChange").setValue(2):this.diffFilterInfoForm.get("foldChange").setValue(1)}),this.diffFilterInfoForm.get("pValueType").valueChanges.subscribe(t=>{"rawPvalue"===t?this.diffFilterInfoForm.get("pValue").setValue(.01):this.diffFilterInfoForm.get("pValue").setValue(.05)}),this.diffFilterInfoForm.valueChanges.pipe((0,$t.b)(500),(0,fe.x)(),(0,_e.O)(this._defaultDiffFilterInput)).subscribe(t=>{var s;"VALID"===(null===(s=this.diffFilterInfoForm)||void 0===s?void 0:s.status)&&this.diffFilterInfo$.next(t)})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-input-diff-filter-info"]],inputs:{formInlineOrNot:"formInlineOrNot"},outputs:{diffFilterInfo$:"diffFilterInfo$"},decls:24,vars:7,consts:[[3,"formGroup","ngClass"],[1,"mr-3","align-self-start"],["formControlName","pValueType",1,"form-control","form-control-sm"],["value","rawPvalue"],["value","adjPvalue"],["type","number","formControlName","pValue","required","",1,"form-control","form-control-sm",2,"width","5em"],["class","text-danger font-weight-light",4,"ngIf"],["formControlName","foldChangeType",1,"form-control","form-control-sm"],["value","rawFoldChange"],["value","log2FoldChange"],["type","number","formControlName","foldChange",1,"form-control","form-control-sm",2,"width","5em"],[1,"text-danger","font-weight-light"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e._uU(2," P value Type: "),e.TgZ(3,"select",2),e.TgZ(4,"option",3),e._uU(5,"Raw P-value"),e.qZA(),e.TgZ(6,"option",4),e._uU(7,"adjusted P-value"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",1),e._uU(9," P value: "),e._UZ(10,"input",5),e.YNc(11,wt,2,0,"label",6),e.qZA(),e.TgZ(12,"div",1),e._uU(13," Fold Change Type: "),e.TgZ(14,"select",7),e.TgZ(15,"option",8),e._uU(16,"Raw Fold Change"),e.qZA(),e.TgZ(17,"option",9),e._uU(18,"Log2 Fold Change"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",1),e._uU(20," Fold Change: "),e._UZ(21,"input",10),e.YNc(22,Et,2,0,"label",6),e.YNc(23,Zt,2,0,"label",6),e.qZA(),e.qZA()),2&t&&(e.Q6J("formGroup",s.diffFilterInfoForm)("ngClass",e.VKq(5,Ot,s.formInlineOrNot)),e.xp6(11),e.Q6J("ngIf",s.diffFilterInfoForm.get("pValue").invalid),e.xp6(11),e.Q6J("ngIf",(null==s.diffFilterInfoForm.errors?null:s.diffFilterInfoForm.errors.foldChangeValid)&&"rawFoldChange"===s.diffFilterInfoForm.get("foldChangeType").value),e.xp6(1),e.Q6J("ngIf",(null==s.diffFilterInfoForm.errors?null:s.diffFilterInfoForm.errors.foldChangeValid)&&"log2FoldChange"===s.diffFilterInfoForm.get("foldChangeType").value))},directives:[p._Y,p.JL,p.sg,F.mk,p.EJ,p.JJ,p.u,p.YN,p.Kr,p.wV,p.Fj,p.Q7,F.O5],styles:[""],changeDetection:0}),n})();var Lt=l(6988),Mt=l(8200);const Nt=["enrichmentContent"];function Vt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"div",17),e.TgZ(2,"div",18),e.TgZ(3,"app-try-sample",19),e.NdJ("sampleForTryName$",function(a){return e.CHM(t),e.oxw().processTrySampleFileName(a)})("sampleForImportName$",function(a){return e.CHM(t),e.oxw().processDownloadSampleData(a)})("closeMe$",function(a){return e.CHM(t),e.oxw().closeTrySampleComponent(a)}),e.ALo(4,"async"),e.qZA(),e.qZA(),e.TgZ(5,"div",20),e.TgZ(6,"app-select-diff-analysis",21),e.NdJ("selectedDiffAnalysisId$",function(a){return e.CHM(t),e.oxw().processSelectedDiffAnalysis(a)}),e.ALo(7,"async"),e.qZA(),e.qZA(),e.TgZ(8,"div",22),e.TgZ(9,"app-input-diff-filter-info",23),e.NdJ("diffFilterInfo$",function(a){return e.CHM(t),e.oxw().processDiffFilterInfo(a)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("fileInfos",t.trySamplesInfos)("trySamplePercentage",e.lcZ(4,3,t.trySamplePercentage$)),e.xp6(3),e.Q6J("allDiffAnalysisIds",e.lcZ(7,5,t.allDiffAnalysisIDsForDisplay$))}}function Ut(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"app-display-one-gene-expression",24),e.NdJ("closeSignal$",function(a){return e.CHM(t),e.oxw().closeModalForExpression(a)}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("geneExpForBoxPlot",e.lcZ(1,1,t.geneExpForBoxPlot$))}}function Jt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.TgZ(1,"h4",26),e._uU(2,"Genes Enrichment Analysis"),e.qZA(),e.TgZ(3,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return null==a.enrichedModalRef?null:a.enrichedModalRef.hide()}),e.TgZ(4,"span",28),e._uU(5,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",29),e.TgZ(7,"app-display-enriched-annotations",30),e.NdJ("selectedAnnotationTermGenes$",function(a){return e.CHM(t),e.oxw().processSelectedAnnotationTermGenes(a)})("selectedKEGGpathway$",function(a){return e.CHM(t),e.oxw().processSelectedKEGGpathway(a)})("selectedGene$",function(a){return e.CHM(t),e.oxw().processSelectedGene(a)}),e.ALo(8,"async"),e.qZA(),e.qZA(),e.TgZ(9,"div",31),e.TgZ(10,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().enrichedModalRef.hide()}),e._uU(11," close "),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("geneListErichedResultStatus",e.lcZ(8,2,t.geneListEnrichedResultStatus$))("annotationTermGenesInfoForTable",t.selectedAnnotationTermGenesInfoForTable)}}const qt=[{path:"",component:(()=>{class n{constructor(t,s,a){this.facade=t,this.modalService=s,this.cdr=a,this.trySamplesInfos=[{fileForTry:"ProteomicsDiffExp.json.gz",fileForImport:"proteomics with clinical.zip",description:"Proteomics Data"},{fileForImport:"RNA-seq-sample-data1.zip",fileForTry:"RNAseqDiffExp.json.gz",description:"RNA-seq Data"},{fileForTry:"MicroarrayDiffExp.json.gz",fileForImport:"Microarray-sample-data1.zip",description:"Microarray Data"}],this.allDatasetInfoForDisplay$=this.facade.allDatasetInfoForDisplay$,this.allAvailableGenelistIDs$=this.facade.allGeneListIDs$,this.trySamplePercentage$=this.facade.trySamplePercentage$,this.ifShowTrySampleComponent=!0,this.ifShowOneGeneExpression=!1,this.destroyNotifier$=new B.xQ,this.selectedDatasetGroups$=this.facade.selectedDatasetGroups$,this.diffAnalysisResultForPresentationStatus$=this.facade.selectedDiffAnalysisResultForPresentationStatus$.pipe((0,z.d)(1)),this.geneListEnrichedResultStatus$=this.facade.geneListEnrichedResultStatus$,this.allDiffAnalysisIDsForDisplay$=this.facade.allDiffAnalysisIDsForDisplay$,this.geneExpForBoxPlot$=this.facade.selectedGeneExpForBoxPlot$,this.diffAnalysisResultForPresentationStatus$.subscribe(r=>{this.diffAnalysisResultForPresentationStatus=r})}ngOnInit(){}ngOnDestroy(){this.destroyNotifier$.next(),this.destroyNotifier$.complete()}processSelectedDatasetID(t){this.facade.requestSelectedDatasetGroups(t)}processOutputDiffGroupPair(t){this.facade.requestDatasetGroupPairDiffAnalysis(t)}processSelectedDiffAnalysis(t){this.facade.requestDatasetGroupPairDiffAnalysis({id:t})}processOutputDiffGenesEnrichRequest(t){this.facade.requestDiffGenesEnrichedAnnotations(t),this.enrichedModalRef=this.modalService.show(this.enrichmentContent,Object.assign({},{class:"modal-xl"})),this.ifShowOneGeneExpression=!1}processSelectedGene(t){this.ifShowOneGeneExpression=!0,this.facade.requestOneGeneExpressionForBoxplot(t)}closeModalForExpression(t){this.ifShowOneGeneExpression=!1}processOutputDiffGenesPPIrequest(t){this.facade.visDiffGenesPPIs(t)}processGenesForAdding(t){this.facade.addDiffGenesToGeneList(t)}processSelectedAnnotationTermGenes(t){this.selectedAnnotationTermGenesInfoForTable=Object.assign({},(0,Y.AP)(this.diffAnalysisResultForPresentationStatus.result.experimentType,this.diffAnalysisResultForPresentationStatus.result.diffSoftware,this.diffAnalysisResultForPresentationStatus.result.IDtype,this.diffAnalysisResultForPresentationStatus.result.diffResults,this.diffAnalysisResultForPresentationStatus.result.genesInfo.genesInfoDic,t.genes))}processDiffFilterInfo(t){let s;s="rawFoldChange"===t.foldChangeType?{pValueType:t.pValueType,pValueCutoff:-Math.log10(t.pValue),foldChangeCutoff:Math.log2(t.foldChange)}:{pValueType:t.pValueType,pValueCutoff:-Math.log10(t.pValue),foldChangeCutoff:t.foldChange},this.diffFilterCutoff=Object.assign({},s),this.diffFilterInput=t,this.facade.storeDiffFilterInput(t)}processDownloadProjectSignal(t){this.facade.downloadProjectSignal()}processTrySampleFileName(t){this.facade.prepareTrySampleData(t)}processDownloadSampleData(t){this.facade.downloadSampleData(t)}closeTrySampleComponent(t){this.ifShowTrySampleComponent=!1}processSelectedKEGGpathway(t){var s;this.facade.processSelectedKEGGpathway(t),null===(s=this.enrichedModalRef)||void 0===s||s.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae),e.Y36(S.tT),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-diff-exp"]],viewQuery:function(t,s){if(1&t&&e.Gf(Nt,5,e.Rgc),2&t){let a;e.iGM(a=e.CRH())&&(s.enrichmentContent=a.first)}},decls:24,vars:19,consts:[[1,"row","flex-xl-nowrap"],[1,"col-12","col-md-3","col-xl-2","border","bd-sidebar"],[1,"pt-2",3,"allDatasetInfoForDisplay","datasetGroups","selectedDatasetID$","diffGroupPairRequest$"],[1,"col-12","col-md-9","col-xl-10","mt-2"],["class","row mt-1",4,"ngIf"],[1,"row","row-cols-3","mt-1"],[1,"col-12","col-md-7","order-1","order-md-1","border"],[1,"text-center",2,"margin-bottom","0"],[1,"col-12","col-md-5","order-3","order-md-3","border"],[1,"text-center"],[1,"col-12","col-md-7","order-2","order-md-4","border","mainVisSection",3,"diffAnalysisResultForPresentationStatus","diffFilterCutoff"],[1,"col-12","col-md-5","order-4","order-md-6","border","mainVisSection",3,"diffAnalysisResultForPresentationStatus","diffFilterInput","allAvailableGenelistIDs","diffGenesEnrichRequest","diffGenesPPIrequest$","genesForAdding$","selectedGene$"],[1,"row","mt-4"],[3,"downloadProjectSignal$"],["cdkDrag","","class","moveFreeDiv border p-2",3,"geneExpForBoxPlot","closeSignal$",4,"ngIf"],["enrichmentContent",""],[1,"row","mt-1"],[1,"col-12"],[1,"border"],[3,"fileInfos","trySamplePercentage","sampleForTryName$","sampleForImportName$","closeMe$"],[1,"mt-3"],[3,"allDiffAnalysisIds","selectedDiffAnalysisId$"],[1,"pt-3"],[3,"diffFilterInfo$"],["cdkDrag","",1,"moveFreeDiv","border","p-2",3,"geneExpForBoxPlot","closeSignal$"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],[3,"geneListErichedResultStatus","annotationTermGenesInfoForTable","selectedAnnotationTermGenes$","selectedKEGGpathway$","selectedGene$"],[1,"modal-footer"],["data-testid","closeGeneListInput","type","button",1,"btn","btn-default",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"app-generate-diff-analysis",2),e.NdJ("selectedDatasetID$",function(r){return s.processSelectedDatasetID(r)})("diffGroupPairRequest$",function(r){return s.processOutputDiffGroupPair(r)}),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.YNc(6,Vt,10,7,"div",4),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"h5",7),e._uU(10," Volcano Plot "),e.qZA(),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"h5",9),e._uU(13," Differentially-Expressed Genes "),e.qZA(),e.qZA(),e._UZ(14,"app-diff-volcano-plot",10),e.ALo(15,"async"),e.TgZ(16,"app-diff-table-management",11),e.NdJ("diffGenesEnrichRequest",function(r){return s.processOutputDiffGenesEnrichRequest(r)})("diffGenesPPIrequest$",function(r){return s.processOutputDiffGenesPPIrequest(r)})("genesForAdding$",function(r){return s.processGenesForAdding(r)})("selectedGene$",function(r){return s.processSelectedGene(r)}),e.ALo(17,"async"),e.ALo(18,"async"),e.qZA(),e.qZA(),e.TgZ(19,"div",12),e.TgZ(20,"app-download-project",13),e.NdJ("downloadProjectSignal$",function(r){return s.processDownloadProjectSignal(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(21,Ut,2,3,"app-display-one-gene-expression",14),e.YNc(22,Jt,12,4,"ng-template",null,15,e.W1O)),2&t&&(e.xp6(2),e.Q6J("allDatasetInfoForDisplay",e.lcZ(3,9,s.allDatasetInfoForDisplay$))("datasetGroups",e.lcZ(4,11,s.selectedDatasetGroups$)),e.xp6(4),e.Q6J("ngIf",s.ifShowTrySampleComponent),e.xp6(8),e.Q6J("diffAnalysisResultForPresentationStatus",e.lcZ(15,13,s.diffAnalysisResultForPresentationStatus$))("diffFilterCutoff",s.diffFilterCutoff),e.xp6(2),e.Q6J("diffAnalysisResultForPresentationStatus",e.lcZ(17,15,s.diffAnalysisResultForPresentationStatus$))("diffFilterInput",s.diffFilterInput)("allAvailableGenelistIDs",e.lcZ(18,17,s.allAvailableGenelistIDs$)),e.xp6(5),e.Q6J("ngIf",s.ifShowOneGeneExpression))},directives:[ot,F.O5,yt,Tt,St.E,xt.P,Pt,jt,Lt.R,U.Zt,Mt.r],pipes:[F.Ov],styles:[""]}),n})(),data:{key:"DiffExp"}}];let Bt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[I.Bz.forChild(qt)],I.Bz]}),n})(),Yt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[Ae],imports:[[F.ez,N.JF,p.u5,p.UX,S.zk.forRoot(),j.Cl,U._t,V.Q8,K.HK,K.jF,Q.uH,h.D,D.m,O.f,Bt]]}),n})()}}]);